{"version":3,"file":"test.js","sources":["../src/trix/config/attachments.js","../src/trix/config/block_attributes.js","../src/trix/config/browser.js","../src/trix/config/css.js","../src/trix/config/lang.js","../src/trix/config/file_size_formatting.js","../src/trix/config/input.js","../src/trix/config/key_names.js","../src/trix/config/text_attributes.js","../src/trix/config/toolbar.js","../src/trix/config/undo_interval.js","../src/trix/config.js","../src/trix/global.js","../src/trix/core/basic_object.js","../src/trix/core/utilities/utf16_string.js","../src/trix/core/object.js","../src/trix/core/helpers/arrays.js","../src/trix/constants.js","../src/trix/core/helpers/extend.js","../src/trix/core/helpers/dom.js","../src/trix/core/helpers/bidi.js","../src/trix/core/helpers/config.js","../src/trix/core/helpers/custom_elements.js","../src/trix/core/helpers/events.js","../src/trix/core/helpers/functions.js","../src/trix/core/helpers/objects.js","../src/trix/core/helpers/ranges.js","../src/trix/observers/selection_change_observer.js","../src/trix/core/helpers/strings.js","../src/trix/core/collections/hash.js","../src/trix/core/collections/object_group.js","../src/trix/core/collections/object_map.js","../src/trix/core/collections/element_store.js","../src/trix/core/utilities/operation.js","../src/trix/views/object_view.js","../src/trix/views/attachment_view.js","../src/trix/views/previewable_attachment_view.js","../src/trix/views/piece_view.js","../src/trix/views/text_view.js","../src/trix/views/block_view.js","../src/trix/views/document_view.js","../src/trix/models/piece.js","../src/trix/operations/image_preload_operation.js","../src/trix/models/attachment.js","../src/trix/models/attachment_piece.js","../src/trix/models/string_piece.js","../src/trix/models/splittable_list.js","../src/trix/models/text.js","../src/trix/models/block.js","../src/trix/models/document.js","../src/trix/models/html_sanitizer.js","../src/trix/models/html_parser.js","../src/trix/core/serialization.js","../src/trix/observers/mutation_observer.js","../src/trix/controllers/controller.js","../src/trix/operations/file_verification_operation.js","../src/trix/controllers/input_controller.js","../src/trix/controllers/level_0_input_controller.js","../src/trix/controllers/level_2_input_controller.js","../src/trix/controllers/attachment_editor_controller.js","../src/trix/controllers/composition_controller.js","../src/trix/controllers/toolbar_controller.js","../src/trix/models/line_break_insertion.js","../src/trix/models/composition.js","../src/trix/models/undo_manager.js","../src/trix/filters/attachment_gallery_filter.js","../src/trix/models/editor.js","../src/trix/models/managed_attachment.js","../src/trix/models/attachment_manager.js","../src/trix/models/location_mapper.js","../src/trix/models/point_mapper.js","../src/trix/models/selection_manager.js","../src/trix/controllers/editor_controller.js","../src/trix/elements/trix_toolbar_element.js","../src/trix/elements/trix_editor_element.js","../src/trix/core/helpers/global.js","../src/test/test_helpers/event_helpers.js","../src/test/test_helpers/assertions.js","../src/test/test_helpers/fixtures/editor_default_aria_label.js","../src/test/test_helpers/fixtures/editor_empty.js","../src/test/test_helpers/fixtures/editor_html.js","../src/test/test_helpers/fixtures/editor_in_table.js","../src/test/test_helpers/fixtures/editor_with_block_styles.js","../src/test/test_helpers/fixtures/editor_with_bold_styles.js","../src/test/test_helpers/fixtures/test_image_url.js","../src/test/test_helpers/fixtures/editor_with_image.js","../src/test/test_helpers/fixtures/editor_with_labels.js","../src/test/test_helpers/fixtures/editor_with_styled_content.js","../src/test/test_helpers/fixtures/editor_with_toolbar_and_input.js","../src/test/test_helpers/fixtures/editors_with_forms.js","../src/test/test_helpers/fixtures/fixtures.js","../src/test/test_helpers/test_helpers.js","../src/test/test_helpers/test_stubs.js","../src/test/test_helpers/functions.js","../node_modules/rangy/lib/rangy-core.js","../node_modules/rangy/lib/rangy-textrange.js","../src/test/test_helpers/selection_helpers.js","../src/test/test_helpers/input_helpers.js","../src/test/test_helpers/editor_helpers.js","../src/test/test_helpers/toolbar_helpers.js","../src/test/test_helper.js","../src/test/unit/attachment_test.js","../src/test/unit/block_test.js","../src/test/unit/composition_test.js","../src/test/unit/document_test.js","../src/test/unit/document_view_test.js","../src/test/unit/html_parser_test.js","../src/test/unit/location_mapper_test.js","../src/test/unit/mutation_observer_test.js","../src/test/unit/serialization_test.js","../src/test/unit/string_change_summary_test.js","../src/test/unit/text_test.js","../src/test/system/accessibility_test.js","../src/test/system/attachment_caption_test.js","../src/test/system/attachment_gallery_test.js","../src/test/system/attachment_test.js","../src/test/system/basic_input_test.js","../src/test/system/block_formatting_test.js","../src/test/system/caching_test.js","../src/test/system/canceled_input_test.js","../src/test/system/composition_input_test.js","../src/test/system/cursor_movement_test.js","../src/test/system/custom_element_test.js","../src/test/system/html_loading_test.js","../src/test/system/html_reparsing_test.js","../src/test/system/html_replacement_test.js","../src/test/system/installation_process_test.js","../src/test/system/level_2_input_test.js","../src/test/system/list_formatting_test.js","../src/test/system/mutation_input_test.js","../src/test/system/pasting_test.js","../src/test/system/text_formatting_test.js","../src/test/system/undo_test.js","../src/test/test.js"],"sourcesContent":["export const attachmentSelector = \"[data-trix-attachment]\"\n\nconst attachments = {\n  preview: {\n    presentation: \"gallery\",\n    caption: {\n      name: true,\n      size: true,\n    },\n  },\n  file: {\n    caption: {\n      size: true,\n    },\n  },\n}\nexport default attachments\n","const attributes = {\n  default: {\n    tagName: \"div\",\n    parse: false,\n  },\n  quote: {\n    tagName: \"blockquote\",\n    nestable: true,\n  },\n  heading1: {\n    tagName: \"h1\",\n    terminal: true,\n    breakOnReturn: true,\n    group: false,\n  },\n  code: {\n    tagName: \"pre\",\n    terminal: true,\n    text: {\n      plaintext: true,\n    },\n  },\n  bulletList: {\n    tagName: \"ul\",\n    parse: false,\n  },\n  bullet: {\n    tagName: \"li\",\n    listAttribute: \"bulletList\",\n    group: false,\n    nestable: true,\n    test(element) {\n      return tagName(element.parentNode) === attributes[this.listAttribute].tagName\n    },\n  },\n  numberList: {\n    tagName: \"ol\",\n    parse: false,\n  },\n  number: {\n    tagName: \"li\",\n    listAttribute: \"numberList\",\n    group: false,\n    nestable: true,\n    test(element) {\n      return tagName(element.parentNode) === attributes[this.listAttribute].tagName\n    },\n  },\n  attachmentGallery: {\n    tagName: \"div\",\n    exclusive: true,\n    terminal: true,\n    parse: false,\n    group: false,\n  },\n}\n\nconst tagName = (element) => element?.tagName?.toLowerCase()\n\nexport default attributes\n","export default {\n  // Android emits composition events when moving the cursor through existing text\n  // Introduced in Chrome 65: https://bugs.chromium.org/p/chromium/issues/detail?id=764439#c9\n  composesExistingText: /Android.*Chrome/.test(navigator.userAgent),\n  // IE 11 activates resizing handles on editable elements that have \"layout\"\n  forcesObjectResizing: /Trident.*rv:11/.test(navigator.userAgent),\n  // https://www.w3.org/TR/input-events-1/ + https://www.w3.org/TR/input-events-2/\n  supportsInputEvents: (function() {\n    if (typeof InputEvent === \"undefined\") {\n      return false\n    }\n    for (const property of [ \"data\", \"getTargetRanges\", \"inputType\" ]) {\n      if (!(property in InputEvent.prototype)) {\n        return false\n      }\n    }\n    return true\n  })(),\n}\n","export default {\n  attachment: \"attachment\",\n  attachmentCaption: \"attachment__caption\",\n  attachmentCaptionEditor: \"attachment__caption-editor\",\n  attachmentMetadata: \"attachment__metadata\",\n  attachmentMetadataContainer: \"attachment__metadata-container\",\n  attachmentName: \"attachment__name\",\n  attachmentProgress: \"attachment__progress\",\n  attachmentSize: \"attachment__size\",\n  attachmentToolbar: \"attachment__toolbar\",\n  attachmentGallery: \"attachment-gallery\",\n}\n","export default {\n  attachFiles: \"Attach Files\",\n  bold: \"Bold\",\n  bullets: \"Bullets\",\n  byte: \"Byte\",\n  bytes: \"Bytes\",\n  captionPlaceholder: \"Add a caption…\",\n  code: \"Code\",\n  heading1: \"Heading\",\n  indent: \"Increase Level\",\n  italic: \"Italic\",\n  link: \"Link\",\n  numbers: \"Numbers\",\n  outdent: \"Decrease Level\",\n  quote: \"Quote\",\n  redo: \"Redo\",\n  remove: \"Remove\",\n  strike: \"Strikethrough\",\n  undo: \"Undo\",\n  unlink: \"Unlink\",\n  url: \"URL\",\n  urlPlaceholder: \"Enter a URL…\",\n  GB: \"GB\",\n  KB: \"KB\",\n  MB: \"MB\",\n  PB: \"PB\",\n  TB: \"TB\",\n}\n","/* eslint-disable\n    no-case-declarations,\n*/\nimport lang from \"trix/config/lang\"\n\nconst sizes = [ lang.bytes, lang.KB, lang.MB, lang.GB, lang.TB, lang.PB ]\n\nexport default {\n  prefix: \"IEC\",\n  precision: 2,\n\n  formatter(number) {\n    switch (number) {\n      case 0:\n        return `0 ${lang.bytes}`\n      case 1:\n        return `1 ${lang.byte}`\n      default:\n        let base\n\n        if (this.prefix === \"SI\") {\n          base = 1000\n        } else if (this.prefix === \"IEC\") {\n          base = 1024\n        }\n\n        const exp = Math.floor(Math.log(number) / Math.log(base))\n        const humanSize = number / Math.pow(base, exp)\n        const string = humanSize.toFixed(this.precision)\n        const withoutInsignificantZeros = string.replace(/0*$/, \"\").replace(/\\.$/, \"\")\n        return `${withoutInsignificantZeros} ${sizes[exp]}`\n    }\n  },\n}\n","import browser from \"trix/config/browser\"\n\nconst input = {\n  level2Enabled: true,\n\n  getLevel() {\n    if (this.level2Enabled && browser.supportsInputEvents) {\n      return 2\n    } else {\n      return 0\n    }\n  },\n}\n\nexport default input\n","export default {\n  8: \"backspace\",\n  9: \"tab\",\n  13: \"return\",\n  27: \"escape\",\n  37: \"left\",\n  39: \"right\",\n  46: \"delete\",\n  68: \"d\",\n  72: \"h\",\n  79: \"o\",\n}\n","import { attachmentSelector } from \"trix/config/attachments\"\n\nexport default {\n  bold: {\n    tagName: \"strong\",\n    inheritable: true,\n    parser(element) {\n      const style = window.getComputedStyle(element)\n      return style.fontWeight === \"bold\" || style.fontWeight >= 600\n    },\n  },\n  italic: {\n    tagName: \"em\",\n    inheritable: true,\n    parser(element) {\n      const style = window.getComputedStyle(element)\n      return style.fontStyle === \"italic\"\n    },\n  },\n  href: {\n    groupTagName: \"a\",\n    parser(element) {\n      const matchingSelector = `a:not(${attachmentSelector})`\n      const link = element.closest(matchingSelector)\n      if (link) {\n        return link.getAttribute(\"href\")\n      }\n    },\n  },\n  strike: {\n    tagName: \"del\",\n    inheritable: true,\n  },\n  frozen: {\n    style: { backgroundColor: \"highlight\" },\n  },\n}\n","import lang from \"trix/config/lang\"\n\nexport default {\n  getDefaultHTML() {\n    return `\\\n<div class=\"trix-button-row\">\n  <span class=\"trix-button-group trix-button-group--text-tools\" data-trix-button-group=\"text-tools\">\n    <button type=\"button\" class=\"trix-button trix-button--icon trix-button--icon-bold\" data-trix-attribute=\"bold\" data-trix-key=\"b\" title=\"${lang.bold}\" tabindex=\"-1\">${lang.bold}</button>\n    <button type=\"button\" class=\"trix-button trix-button--icon trix-button--icon-italic\" data-trix-attribute=\"italic\" data-trix-key=\"i\" title=\"${lang.italic}\" tabindex=\"-1\">${lang.italic}</button>\n    <button type=\"button\" class=\"trix-button trix-button--icon trix-button--icon-strike\" data-trix-attribute=\"strike\" title=\"${lang.strike}\" tabindex=\"-1\">${lang.strike}</button>\n    <button type=\"button\" class=\"trix-button trix-button--icon trix-button--icon-link\" data-trix-attribute=\"href\" data-trix-action=\"link\" data-trix-key=\"k\" title=\"${lang.link}\" tabindex=\"-1\">${lang.link}</button>\n  </span>\n\n  <span class=\"trix-button-group trix-button-group--block-tools\" data-trix-button-group=\"block-tools\">\n    <button type=\"button\" class=\"trix-button trix-button--icon trix-button--icon-heading-1\" data-trix-attribute=\"heading1\" title=\"${lang.heading1}\" tabindex=\"-1\">${lang.heading1}</button>\n    <button type=\"button\" class=\"trix-button trix-button--icon trix-button--icon-quote\" data-trix-attribute=\"quote\" title=\"${lang.quote}\" tabindex=\"-1\">${lang.quote}</button>\n    <button type=\"button\" class=\"trix-button trix-button--icon trix-button--icon-code\" data-trix-attribute=\"code\" title=\"${lang.code}\" tabindex=\"-1\">${lang.code}</button>\n    <button type=\"button\" class=\"trix-button trix-button--icon trix-button--icon-bullet-list\" data-trix-attribute=\"bullet\" title=\"${lang.bullets}\" tabindex=\"-1\">${lang.bullets}</button>\n    <button type=\"button\" class=\"trix-button trix-button--icon trix-button--icon-number-list\" data-trix-attribute=\"number\" title=\"${lang.numbers}\" tabindex=\"-1\">${lang.numbers}</button>\n    <button type=\"button\" class=\"trix-button trix-button--icon trix-button--icon-decrease-nesting-level\" data-trix-action=\"decreaseNestingLevel\" title=\"${lang.outdent}\" tabindex=\"-1\">${lang.outdent}</button>\n    <button type=\"button\" class=\"trix-button trix-button--icon trix-button--icon-increase-nesting-level\" data-trix-action=\"increaseNestingLevel\" title=\"${lang.indent}\" tabindex=\"-1\">${lang.indent}</button>\n  </span>\n\n  <span class=\"trix-button-group trix-button-group--file-tools\" data-trix-button-group=\"file-tools\">\n    <button type=\"button\" class=\"trix-button trix-button--icon trix-button--icon-attach\" data-trix-action=\"attachFiles\" title=\"${lang.attachFiles}\" tabindex=\"-1\">${lang.attachFiles}</button>\n  </span>\n\n  <span class=\"trix-button-group-spacer\"></span>\n\n  <span class=\"trix-button-group trix-button-group--history-tools\" data-trix-button-group=\"history-tools\">\n    <button type=\"button\" class=\"trix-button trix-button--icon trix-button--icon-undo\" data-trix-action=\"undo\" data-trix-key=\"z\" title=\"${lang.undo}\" tabindex=\"-1\">${lang.undo}</button>\n    <button type=\"button\" class=\"trix-button trix-button--icon trix-button--icon-redo\" data-trix-action=\"redo\" data-trix-key=\"shift+z\" title=\"${lang.redo}\" tabindex=\"-1\">${lang.redo}</button>\n  </span>\n</div>\n\n<div class=\"trix-dialogs\" data-trix-dialogs>\n  <div class=\"trix-dialog trix-dialog--link\" data-trix-dialog=\"href\" data-trix-dialog-attribute=\"href\">\n    <div class=\"trix-dialog__link-fields\">\n      <input type=\"url\" name=\"href\" class=\"trix-input trix-input--dialog\" placeholder=\"${lang.urlPlaceholder}\" aria-label=\"${lang.url}\" required data-trix-input>\n      <div class=\"trix-button-group\">\n        <input type=\"button\" class=\"trix-button trix-button--dialog\" value=\"${lang.link}\" data-trix-method=\"setAttribute\">\n        <input type=\"button\" class=\"trix-button trix-button--dialog\" value=\"${lang.unlink}\" data-trix-method=\"removeAttribute\">\n      </div>\n    </div>\n  </div>\n</div>\\\n`\n  },\n}\n","const undoInterval = 5000\nexport default undoInterval\n","import attachments from \"trix/config/attachments\"\nimport blockAttributes from \"trix/config/block_attributes\"\nimport browser from \"trix/config/browser\"\nimport css from \"trix/config/css\"\nimport fileSize from \"trix/config/file_size_formatting\"\nimport input from \"trix/config/input\"\nimport keyNames from \"trix/config/key_names\"\nimport lang from \"trix/config/lang\"\nimport textAttributes from \"trix/config/text_attributes\"\nimport toolbar from \"trix/config/toolbar\"\nimport undoInterval from \"trix/config/undo_interval\"\n\nconst config = {\n  attachments,\n  blockAttributes,\n  browser,\n  css,\n  fileSize,\n  input,\n  keyNames,\n  lang,\n  textAttributes,\n  toolbar,\n  undoInterval,\n}\n\nexport default config\n","import { version } from \"../../package.json\"\nimport config from \"trix/config\"\n\nconst Trix = {\n  VERSION: version,\n  config,\n}\n\nwindow.Trix = Trix\n\nexport default Trix\n","export default class BasicObject {\n  static proxyMethod(expression) {\n    const { name, toMethod, toProperty, optional } = parseProxyMethodExpression(expression)\n\n    this.prototype[name] = function() {\n      let subject\n      let object\n\n      if (toMethod) {\n        if (optional) {\n          object = this[toMethod]?.()\n        } else {\n          object = this[toMethod]()\n        }\n      } else if (toProperty) {\n        object = this[toProperty]\n      }\n\n      if (optional) {\n        subject = object?.[name]\n        if (subject) {\n          return apply.call(subject, object, arguments)\n        }\n      } else {\n        subject = object[name]\n        return apply.call(subject, object, arguments)\n      }\n    }\n  }\n}\n\nconst parseProxyMethodExpression = function(expression) {\n  const match = expression.match(proxyMethodExpressionPattern)\n  if (!match) {\n    throw new Error(`can't parse @proxyMethod expression: ${expression}`)\n  }\n\n  const args = { name: match[4] }\n\n  if (match[2] != null) {\n    args.toMethod = match[1]\n  } else {\n    args.toProperty = match[1]\n  }\n\n  if (match[3] != null) {\n    args.optional = true\n  }\n\n  return args\n}\n\nconst { apply } = Function.prototype\n\nconst proxyMethodExpressionPattern = new RegExp(\"\\\n^\\\n(.+?)\\\n(\\\\(\\\\))?\\\n(\\\\?)?\\\n\\\\.\\\n(.+?)\\\n$\\\n\")\n","import BasicObject from \"trix/core/basic_object\"\n\nexport default class UTF16String extends BasicObject {\n  static box(value = \"\") {\n    if (value instanceof this) {\n      return value\n    } else {\n      return this.fromUCS2String(value?.toString())\n    }\n  }\n\n  static fromUCS2String(ucs2String) {\n    return new this(ucs2String, ucs2decode(ucs2String))\n  }\n\n  static fromCodepoints(codepoints) {\n    return new this(ucs2encode(codepoints), codepoints)\n  }\n\n  constructor(ucs2String, codepoints) {\n    super(...arguments)\n    this.ucs2String = ucs2String\n    this.codepoints = codepoints\n    this.length = this.codepoints.length\n    this.ucs2Length = this.ucs2String.length\n  }\n\n  offsetToUCS2Offset(offset) {\n    return ucs2encode(this.codepoints.slice(0, Math.max(0, offset))).length\n  }\n\n  offsetFromUCS2Offset(ucs2Offset) {\n    return ucs2decode(this.ucs2String.slice(0, Math.max(0, ucs2Offset))).length\n  }\n\n  slice() {\n    return this.constructor.fromCodepoints(this.codepoints.slice(...arguments))\n  }\n\n  charAt(offset) {\n    return this.slice(offset, offset + 1)\n  }\n\n  isEqualTo(value) {\n    return this.constructor.box(value).ucs2String === this.ucs2String\n  }\n\n  toJSON() {\n    return this.ucs2String\n  }\n\n  getCacheKey() {\n    return this.ucs2String\n  }\n\n  toString() {\n    return this.ucs2String\n  }\n}\n\nconst hasArrayFrom = Array.from?.(\"\\ud83d\\udc7c\").length === 1\nconst hasStringCodePointAt = \" \".codePointAt?.(0) != null\nconst hasStringFromCodePoint = String.fromCodePoint?.(32, 128124) === \" \\ud83d\\udc7c\"\n\n// UCS-2 conversion helpers ported from Mathias Bynens' Punycode.js:\n// https://github.com/bestiejs/punycode.js#punycodeucs2\n\nlet ucs2decode, ucs2encode\n\n// Creates an array containing the numeric code points of each Unicode\n// character in the string. While JavaScript uses UCS-2 internally,\n// this function will convert a pair of surrogate halves (each of which\n// UCS-2 exposes as separate characters) into a single code point,\n// matching UTF-16.\nif (hasArrayFrom && hasStringCodePointAt) {\n  ucs2decode = (string) => Array.from(string).map((char) => char.codePointAt(0))\n} else {\n  ucs2decode = function(string) {\n    const output = []\n    let counter = 0\n    const { length } = string\n\n    while (counter < length) {\n      let value = string.charCodeAt(counter++)\n      if (0xd800 <= value && value <= 0xdbff && counter < length) {\n        // high surrogate, and there is a next character\n        const extra = string.charCodeAt(counter++)\n        if ((extra & 0xfc00) === 0xdc00) {\n          // low surrogate\n          value = ((value & 0x3ff) << 10) + (extra & 0x3ff) + 0x10000\n        } else {\n          // unmatched surrogate; only append this code unit, in case the\n          // next code unit is the high surrogate of a surrogate pair\n          counter--\n        }\n      }\n      output.push(value)\n    }\n\n    return output\n  }\n}\n\n// Creates a string based on an array of numeric code points.\nif (hasStringFromCodePoint) {\n  ucs2encode = (array) => String.fromCodePoint(...Array.from(array || []))\n} else {\n  ucs2encode = function(array) {\n    const characters = (() => {\n      const result = []\n\n      Array.from(array).forEach((value) => {\n        let output = \"\"\n        if (value > 0xffff) {\n          value -= 0x10000\n          output += String.fromCharCode(value >>> 10 & 0x3ff | 0xd800)\n          value = 0xdc00 | value & 0x3ff\n        }\n        result.push(output + String.fromCharCode(value))\n      })\n\n      return result\n    })()\n\n    return characters.join(\"\")\n  }\n}\n","import BasicObject from \"trix/core/basic_object\"\nimport UTF16String from \"trix/core/utilities/utf16_string\"\n\nlet id = 0\n\nexport default class TrixObject extends BasicObject {\n  static fromJSONString(jsonString) {\n    return this.fromJSON(JSON.parse(jsonString))\n  }\n\n  constructor() {\n    super(...arguments)\n    this.id = ++id\n  }\n\n  hasSameConstructorAs(object) {\n    return this.constructor === object?.constructor\n  }\n\n  isEqualTo(object) {\n    return this === object\n  }\n\n  inspect() {\n    const parts = []\n    const contents = this.contentsForInspection() || {}\n\n    for (const key in contents) {\n      const value = contents[key]\n      parts.push(`${key}=${value}`)\n    }\n\n    return `#<${this.constructor.name}:${this.id}${parts.length ? ` ${parts.join(\", \")}` : \"\"}>`\n  }\n\n  contentsForInspection() {}\n\n  toJSONString() {\n    return JSON.stringify(this)\n  }\n\n  toUTF16String() {\n    return UTF16String.box(this)\n  }\n\n  getCacheKey() {\n    return this.id.toString()\n  }\n}\n","/* eslint-disable\n    id-length,\n*/\nexport const arraysAreEqual = function(a = [], b = []) {\n  if (a.length !== b.length) {\n    return false\n  }\n  for (let index = 0; index < a.length; index++) {\n    const value = a[index]\n    if (value !== b[index]) {\n      return false\n    }\n  }\n  return true\n}\n\nexport const arrayStartsWith = (a = [], b = []) => arraysAreEqual(a.slice(0, b.length), b)\n\nexport const spliceArray = function(array, ...args) {\n  const result = array.slice(0)\n  result.splice(...args)\n  return result\n}\n\nexport const summarizeArrayChange = function(oldArray = [], newArray = []) {\n  const added = []\n  const removed = []\n\n  const existingValues = new Set()\n\n  oldArray.forEach((value) => {\n    existingValues.add(value)\n  })\n\n  const currentValues = new Set()\n\n  newArray.forEach((value) => {\n    currentValues.add(value)\n    if (!existingValues.has(value)) {\n      added.push(value)\n    }\n  })\n\n  oldArray.forEach((value) => {\n    if (!currentValues.has(value)) {\n      removed.push(value)\n    }\n  })\n\n  return { added, removed }\n}\n","export const ZERO_WIDTH_SPACE = \"\\uFEFF\"\nexport const NON_BREAKING_SPACE = \"\\u00A0\"\nexport const OBJECT_REPLACEMENT_CHARACTER = \"\\uFFFC\"\n","export const extend = function(properties) {\n  for (const key in properties) {\n    const value = properties[key]\n    this[key] = value\n  }\n  return this\n}\n","import config from \"trix/config\"\nimport { ZERO_WIDTH_SPACE } from \"trix/constants\"\nimport { extend } from \"./extend\"\nimport { attachmentSelector } from \"trix/config/attachments\"\n\nconst html = document.documentElement\nconst match = html.matches\n\nexport const handleEvent = function(eventName, { onElement, matchingSelector, withCallback, inPhase, preventDefault, times } = {}) {\n  const element = onElement ? onElement : html\n  const selector = matchingSelector\n  const useCapture = inPhase === \"capturing\"\n\n  const handler = function(event) {\n    if (times != null && --times === 0) {\n      handler.destroy()\n    }\n    const target = findClosestElementFromNode(event.target, { matchingSelector: selector })\n    if (target != null) {\n      withCallback?.call(target, event, target)\n      if (preventDefault) {\n        event.preventDefault()\n      }\n    }\n  }\n\n  handler.destroy = () => element.removeEventListener(eventName, handler, useCapture)\n\n  element.addEventListener(eventName, handler, useCapture)\n  return handler\n}\n\nexport const handleEventOnce = function(eventName, options = {}) {\n  options.times = 1\n  return handleEvent(eventName, options)\n}\n\nexport const triggerEvent = function(eventName, { onElement, bubbles, cancelable, attributes } = {}) {\n  const element = onElement != null ? onElement : html\n  bubbles = bubbles !== false\n  cancelable = cancelable !== false\n\n  const event = document.createEvent(\"Events\")\n  event.initEvent(eventName, bubbles, cancelable)\n  if (attributes != null) {\n    extend.call(event, attributes)\n  }\n  return element.dispatchEvent(event)\n}\n\nexport const elementMatchesSelector = function(element, selector) {\n  if (element?.nodeType === 1) {\n    return match.call(element, selector)\n  }\n}\n\nexport const findClosestElementFromNode = function(node, { matchingSelector, untilNode } = {}) {\n  while (node && node.nodeType !== Node.ELEMENT_NODE) {\n    node = node.parentNode\n  }\n  if (node == null) {\n    return\n  }\n\n  if (matchingSelector != null) {\n    if (node.closest && untilNode == null) {\n      return node.closest(matchingSelector)\n    } else {\n      while (node && node !== untilNode) {\n        if (elementMatchesSelector(node, matchingSelector)) {\n          return node\n        }\n        node = node.parentNode\n      }\n    }\n  } else {\n    return node\n  }\n}\n\nexport const findInnerElement = function(element) {\n  while (element?.firstElementChild) {\n    element = element.firstElementChild\n  }\n  return element\n}\n\nexport const innerElementIsActive = (element) =>\n  document.activeElement !== element && elementContainsNode(element, document.activeElement)\n\nexport const elementContainsNode = function(element, node) {\n  if (!element || !node) {\n    return\n  }\n  while (node) {\n    if (node === element) {\n      return true\n    }\n    node = node.parentNode\n  }\n}\n\nexport const findNodeFromContainerAndOffset = function(container, offset) {\n  if (!container) {\n    return\n  }\n  if (container.nodeType === Node.TEXT_NODE) {\n    return container\n  } else if (offset === 0) {\n    return container.firstChild != null ? container.firstChild : container\n  } else {\n    return container.childNodes.item(offset - 1)\n  }\n}\n\nexport const findElementFromContainerAndOffset = function(container, offset) {\n  const node = findNodeFromContainerAndOffset(container, offset)\n  return findClosestElementFromNode(node)\n}\n\nexport const findChildIndexOfNode = function(node) {\n  if (!node?.parentNode) {\n    return\n  }\n  let childIndex = 0\n  node = node.previousSibling\n  while (node) {\n    childIndex++\n    node = node.previousSibling\n  }\n  return childIndex\n}\n\nexport const removeNode = (node) => node?.parentNode?.removeChild(node)\n\nexport const walkTree = function(tree, { onlyNodesOfType, usingFilter, expandEntityReferences } = {}) {\n  const whatToShow = (() => {\n    switch (onlyNodesOfType) {\n      case \"element\":\n        return NodeFilter.SHOW_ELEMENT\n      case \"text\":\n        return NodeFilter.SHOW_TEXT\n      case \"comment\":\n        return NodeFilter.SHOW_COMMENT\n      default:\n        return NodeFilter.SHOW_ALL\n    }\n  })()\n\n  return document.createTreeWalker(\n    tree,\n    whatToShow,\n    usingFilter != null ? usingFilter : null,\n    expandEntityReferences === true\n  )\n}\n\nexport const tagName = (element) => element?.tagName?.toLowerCase()\n\nexport const makeElement = function(tag, options = {}) {\n  let key, value\n  if (typeof tag === \"object\") {\n    options = tag\n    tag = options.tagName\n  } else {\n    options = { attributes: options }\n  }\n\n  const element = document.createElement(tag)\n\n  if (options.editable != null) {\n    if (options.attributes == null) {\n      options.attributes = {}\n    }\n    options.attributes.contenteditable = options.editable\n  }\n\n  if (options.attributes) {\n    for (key in options.attributes) {\n      value = options.attributes[key]\n      element.setAttribute(key, value)\n    }\n  }\n\n  if (options.style) {\n    for (key in options.style) {\n      value = options.style[key]\n      element.style[key] = value\n    }\n  }\n\n  if (options.data) {\n    for (key in options.data) {\n      value = options.data[key]\n      element.dataset[key] = value\n    }\n  }\n\n  if (options.className) {\n    options.className.split(\" \").forEach((className) => {\n      element.classList.add(className)\n    })\n  }\n\n  if (options.textContent) {\n    element.textContent = options.textContent\n  }\n\n  if (options.childNodes) {\n    [].concat(options.childNodes).forEach((childNode) => {\n      element.appendChild(childNode)\n    })\n  }\n\n  return element\n}\n\nlet blockTagNames = undefined\n\nexport const getBlockTagNames = function() {\n  if (blockTagNames != null) {\n    return blockTagNames\n  }\n\n  blockTagNames = []\n  for (const key in config.blockAttributes) {\n    const attributes = config.blockAttributes[key]\n    if (attributes.tagName) {\n      blockTagNames.push(attributes.tagName)\n    }\n  }\n\n  return blockTagNames\n}\n\nexport const nodeIsBlockContainer = (node) => nodeIsBlockStartComment(node?.firstChild)\n\nexport const nodeProbablyIsBlockContainer = function(node) {\n  return getBlockTagNames().includes(tagName(node)) && !getBlockTagNames().includes(tagName(node.firstChild))\n}\n\nexport const nodeIsBlockStart = function(node, { strict } = { strict: true }) {\n  if (strict) {\n    return nodeIsBlockStartComment(node)\n  } else {\n    return (\n      nodeIsBlockStartComment(node) || !nodeIsBlockStartComment(node.firstChild) && nodeProbablyIsBlockContainer(node)\n    )\n  }\n}\n\nexport const nodeIsBlockStartComment = (node) => nodeIsCommentNode(node) && node?.data === \"block\"\n\nexport const nodeIsCommentNode = (node) => node?.nodeType === Node.COMMENT_NODE\n\nexport const nodeIsCursorTarget = function(node, { name } = {}) {\n  if (!node) {\n    return\n  }\n  if (nodeIsTextNode(node)) {\n    if (node.data === ZERO_WIDTH_SPACE) {\n      if (name) {\n        return node.parentNode.dataset.trixCursorTarget === name\n      } else {\n        return true\n      }\n    }\n  } else {\n    return nodeIsCursorTarget(node.firstChild)\n  }\n}\n\nexport const nodeIsAttachmentElement = (node) => elementMatchesSelector(node, attachmentSelector)\n\nexport const nodeIsEmptyTextNode = (node) => nodeIsTextNode(node) && node?.data === \"\"\n\nexport const nodeIsTextNode = (node) => node?.nodeType === Node.TEXT_NODE\n","import { makeElement } from \"trix/core/helpers/dom\"\n\n// https://github.com/mathiasbynens/unicode-2.1.8/blob/master/Bidi_Class/Right_To_Left/regex.js\nconst RTL_PATTERN =\n  /[\\u05BE\\u05C0\\u05C3\\u05D0-\\u05EA\\u05F0-\\u05F4\\u061B\\u061F\\u0621-\\u063A\\u0640-\\u064A\\u066D\\u0671-\\u06B7\\u06BA-\\u06BE\\u06C0-\\u06CE\\u06D0-\\u06D5\\u06E5\\u06E6\\u200F\\u202B\\u202E\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE72\\uFE74\\uFE76-\\uFEFC]/\n\nexport const getDirection = (function() {\n  const input = makeElement(\"input\", { dir: \"auto\", name: \"x\", dirName: \"x.dir\" })\n  const form = makeElement(\"form\")\n  form.appendChild(input)\n\n  const supportsDirName = (function() {\n    try {\n      return new FormData(form).has(input.dirName)\n    } catch (error) {\n      return false\n    }\n  })()\n\n  const supportsDirSelector = (function() {\n    try {\n      return input.matches(\":dir(ltr),:dir(rtl)\")\n    } catch (error) {\n      return false\n    }\n  })()\n\n  if (supportsDirName) {\n    return function(string) {\n      input.value = string\n      return new FormData(form).get(input.dirName)\n    }\n  } else if (supportsDirSelector) {\n    return function(string) {\n      input.value = string\n      if (input.matches(\":dir(rtl)\")) {\n        return \"rtl\"\n      } else {\n        return \"ltr\"\n      }\n    }\n  } else {\n    return function(string) {\n      const char = string.trim().charAt(0)\n      if (RTL_PATTERN.test(char)) {\n        return \"rtl\"\n      } else {\n        return \"ltr\"\n      }\n    }\n  }\n})()\n","import config from \"trix/config\"\n\nlet allAttributeNames = null\nlet blockAttributeNames = null\nlet textAttributeNames = null\nlet listAttributeNames = null\n\nexport const getAllAttributeNames = () => {\n  if (!allAttributeNames) {\n    allAttributeNames = getTextAttributeNames().concat(getBlockAttributeNames())\n  }\n  return allAttributeNames\n}\n\nexport const getBlockConfig = (attributeName) => config.blockAttributes[attributeName]\n\nexport const getBlockAttributeNames = () => {\n  if (!blockAttributeNames) {\n    blockAttributeNames = Object.keys(config.blockAttributes)\n  }\n  return blockAttributeNames\n}\n\nexport const getTextConfig = (attributeName) => config.textAttributes[attributeName]\n\nexport const getTextAttributeNames = () => {\n  if (!textAttributeNames) {\n    textAttributeNames = Object.keys(config.textAttributes)\n  }\n  return textAttributeNames\n}\n\nexport const getListAttributeNames = () => {\n  if (!listAttributeNames) {\n    listAttributeNames = []\n    for (const key in config.blockAttributes) {\n      const { listAttribute } = config.blockAttributes[key]\n      if (listAttribute != null) {\n        listAttributeNames.push(listAttribute)\n      }\n    }\n  }\n  return listAttributeNames\n}\n","/* eslint-disable\n*/\nexport const installDefaultCSSForTagName = function(tagName, defaultCSS) {\n  const styleElement = insertStyleElementForTagName(tagName)\n  styleElement.textContent = defaultCSS.replace(/%t/g, tagName)\n}\n\nconst insertStyleElementForTagName = function(tagName) {\n  const element = document.createElement(\"style\")\n  element.setAttribute(\"type\", \"text/css\")\n  element.setAttribute(\"data-tag-name\", tagName.toLowerCase())\n  const nonce = getCSPNonce()\n  if (nonce) {\n    element.setAttribute(\"nonce\", nonce)\n  }\n  document.head.insertBefore(element, document.head.firstChild)\n  return element\n}\n\nconst getCSPNonce = function() {\n  const element = getMetaElement(\"trix-csp-nonce\") || getMetaElement(\"csp-nonce\")\n  if (element) {\n    return element.getAttribute(\"content\")\n  }\n}\n\nconst getMetaElement = (name) => document.head.querySelector(`meta[name=${name}]`)\n","const testTransferData = { \"application/x-trix-feature-detection\": \"test\" }\n\nexport const dataTransferIsPlainText = function(dataTransfer) {\n  const text = dataTransfer.getData(\"text/plain\")\n  const html = dataTransfer.getData(\"text/html\")\n\n  if (text && html) {\n    const { body } = new DOMParser().parseFromString(html, \"text/html\")\n    if (body.textContent === text) {\n      return !body.querySelector(\"*\")\n    }\n  } else {\n    return text?.length\n  }\n}\n\nexport const dataTransferIsWritable = function(dataTransfer) {\n  if (!dataTransfer?.setData) return false\n\n  for (const key in testTransferData) {\n    const value = testTransferData[key]\n\n    try {\n      dataTransfer.setData(key, value)\n      if (!dataTransfer.getData(key) === value) return false\n    } catch (error) {\n      return false\n    }\n  }\n  return true\n}\n\nexport const keyEventIsKeyboardCommand = (function() {\n  if (/Mac|^iP/.test(navigator.platform)) {\n    return (event) => event.metaKey\n  } else {\n    return (event) => event.ctrlKey\n  }\n})()\n","export const defer = (fn) => setTimeout(fn, 1)\n","/* eslint-disable\n    id-length,\n*/\nexport const copyObject = function(object = {}) {\n  const result = {}\n  for (const key in object) {\n    const value = object[key]\n    result[key] = value\n  }\n  return result\n}\n\nexport const objectsAreEqual = function(a = {}, b = {}) {\n  if (Object.keys(a).length !== Object.keys(b).length) {\n    return false\n  }\n  for (const key in a) {\n    const value = a[key]\n    if (value !== b[key]) {\n      return false\n    }\n  }\n  return true\n}\n","import { copyObject, objectsAreEqual } from \"trix/core/helpers/objects\"\n\nexport const normalizeRange = function(range) {\n  if (range == null) return\n\n  if (!Array.isArray(range)) {\n    range = [ range, range ]\n  }\n  return [ copyValue(range[0]), copyValue(range[1] != null ? range[1] : range[0]) ]\n}\n\nexport const rangeIsCollapsed = function(range) {\n  if (range == null) return\n\n  const [ start, end ] = normalizeRange(range)\n  return rangeValuesAreEqual(start, end)\n}\n\nexport const rangesAreEqual = function(leftRange, rightRange) {\n  if (leftRange == null || rightRange == null) return\n\n  const [ leftStart, leftEnd ] = normalizeRange(leftRange)\n  const [ rightStart, rightEnd ] = normalizeRange(rightRange)\n  return rangeValuesAreEqual(leftStart, rightStart) && rangeValuesAreEqual(leftEnd, rightEnd)\n}\n\nconst copyValue = function(value) {\n  if (typeof value === \"number\") {\n    return value\n  } else {\n    return copyObject(value)\n  }\n}\n\nconst rangeValuesAreEqual = function(left, right) {\n  if (typeof left === \"number\") {\n    return left === right\n  } else {\n    return objectsAreEqual(left, right)\n  }\n}\n","/* eslint-disable\n    id-length,\n*/\nimport BasicObject from \"trix/core/basic_object\"\n\nexport default class SelectionChangeObserver extends BasicObject {\n  constructor() {\n    super(...arguments)\n    this.update = this.update.bind(this)\n    this.run = this.run.bind(this)\n    this.selectionManagers = []\n  }\n\n  start() {\n    if (!this.started) {\n      this.started = true\n      if (\"onselectionchange\" in document) {\n        return document.addEventListener(\"selectionchange\", this.update, true)\n      } else {\n        return this.run()\n      }\n    }\n  }\n\n  stop() {\n    if (this.started) {\n      this.started = false\n      return document.removeEventListener(\"selectionchange\", this.update, true)\n    }\n  }\n\n  registerSelectionManager(selectionManager) {\n    if (!this.selectionManagers.includes(selectionManager)) {\n      this.selectionManagers.push(selectionManager)\n      return this.start()\n    }\n  }\n\n  unregisterSelectionManager(selectionManager) {\n    this.selectionManagers = this.selectionManagers.filter((s) => s !== selectionManager)\n    if (this.selectionManagers.length === 0) {\n      return this.stop()\n    }\n  }\n\n  notifySelectionManagersOfSelectionChange() {\n    return this.selectionManagers.map((selectionManager) => selectionManager.selectionDidChange())\n  }\n\n  update() {\n    const domRange = getDOMRange()\n    if (!domRangesAreEqual(domRange, this.domRange)) {\n      this.domRange = domRange\n      return this.notifySelectionManagersOfSelectionChange()\n    }\n  }\n\n  reset() {\n    this.domRange = null\n    return this.update()\n  }\n\n  // Private\n\n  run() {\n    if (this.started) {\n      this.update()\n      return requestAnimationFrame(this.run)\n    }\n  }\n}\n\nconst domRangesAreEqual = (left, right) =>\n  left?.startContainer === right?.startContainer &&\n  left?.startOffset === right?.startOffset &&\n  left?.endContainer === right?.endContainer &&\n  left?.endOffset === right?.endOffset\n\nexport const selectionChangeObserver = new SelectionChangeObserver()\n\nexport const getDOMSelection = function() {\n  const selection = window.getSelection()\n  if (selection.rangeCount > 0) {\n    return selection\n  }\n}\n\nexport const getDOMRange = function() {\n  const domRange = getDOMSelection()?.getRangeAt(0)\n  if (domRange) {\n    if (!domRangeIsPrivate(domRange)) {\n      return domRange\n    }\n  }\n}\n\nexport const setDOMRange = function(domRange) {\n  const selection = window.getSelection()\n  selection.removeAllRanges()\n  selection.addRange(domRange)\n  return selectionChangeObserver.update()\n}\n\n// In Firefox, clicking certain <input> elements changes the selection to a\n// private element used to draw its UI. Attempting to access properties of those\n// elements throws an error.\n// https://bugzilla.mozilla.org/show_bug.cgi?id=208427\nconst domRangeIsPrivate = (domRange) => nodeIsPrivate(domRange.startContainer) || nodeIsPrivate(domRange.endContainer)\n\nconst nodeIsPrivate = (node) => !Object.getPrototypeOf(node)\n","/* eslint-disable\n    id-length,\n    no-useless-escape,\n*/\nimport { NON_BREAKING_SPACE, ZERO_WIDTH_SPACE } from \"trix/constants\"\nimport UTF16String from \"trix/core/utilities/utf16_string\"\n\nexport const normalizeSpaces = (string) =>\n  string.replace(new RegExp(`${ZERO_WIDTH_SPACE}`, \"g\"), \"\").replace(new RegExp(`${NON_BREAKING_SPACE}`, \"g\"), \" \")\n\nexport const normalizeNewlines = (string) => string.replace(/\\r\\n/g, \"\\n\")\n\nexport const breakableWhitespacePattern = new RegExp(`[^\\\\S${NON_BREAKING_SPACE}]`)\n\nexport const squishBreakableWhitespace = (string) =>\n  string\n    // Replace all breakable whitespace characters with a space\n    .replace(new RegExp(`${breakableWhitespacePattern.source}`, \"g\"), \" \")\n    // Replace two or more spaces with a single space\n    .replace(/\\ {2,}/g, \" \")\n\nexport const summarizeStringChange = function(oldString, newString) {\n  let added, removed\n  oldString = UTF16String.box(oldString)\n  newString = UTF16String.box(newString)\n\n  if (newString.length < oldString.length) {\n    [ removed, added ] = utf16StringDifferences(oldString, newString)\n  } else {\n    [ added, removed ] = utf16StringDifferences(newString, oldString)\n  }\n\n  return { added, removed }\n}\n\nconst utf16StringDifferences = function(a, b) {\n  if (a.isEqualTo(b)) {\n    return [ \"\", \"\" ]\n  }\n\n  const diffA = utf16StringDifference(a, b)\n  const { length } = diffA.utf16String\n\n  let diffB\n\n  if (length) {\n    const { offset } = diffA\n    const codepoints = a.codepoints.slice(0, offset).concat(a.codepoints.slice(offset + length))\n    diffB = utf16StringDifference(b, UTF16String.fromCodepoints(codepoints))\n  } else {\n    diffB = utf16StringDifference(b, a)\n  }\n\n  return [ diffA.utf16String.toString(), diffB.utf16String.toString() ]\n}\n\nconst utf16StringDifference = function(a, b) {\n  let leftIndex = 0\n  let rightIndexA = a.length\n  let rightIndexB = b.length\n\n  while (leftIndex < rightIndexA && a.charAt(leftIndex).isEqualTo(b.charAt(leftIndex))) {\n    leftIndex++\n  }\n\n  while (rightIndexA > leftIndex + 1 && a.charAt(rightIndexA - 1).isEqualTo(b.charAt(rightIndexB - 1))) {\n    rightIndexA--\n    rightIndexB--\n  }\n\n  return {\n    utf16String: a.slice(leftIndex, rightIndexA),\n    offset: leftIndex,\n  }\n}\n","import TrixObject from \"trix/core/object\" // Don't override window.Object\nimport { arraysAreEqual } from \"trix/core/helpers\"\n\nexport default class Hash extends TrixObject {\n  static fromCommonAttributesOfObjects(objects = []) {\n    if (!objects.length) {\n      return new this()\n    }\n    let hash = box(objects[0])\n    let keys = hash.getKeys()\n\n    objects.slice(1).forEach((object) => {\n      keys = hash.getKeysCommonToHash(box(object))\n      hash = hash.slice(keys)\n    })\n\n    return hash\n  }\n\n  static box(values) {\n    return box(values)\n  }\n\n  constructor(values = {}) {\n    super(...arguments)\n    this.values = copy(values)\n  }\n\n  add(key, value) {\n    return this.merge(object(key, value))\n  }\n\n  remove(key) {\n    return new Hash(copy(this.values, key))\n  }\n\n  get(key) {\n    return this.values[key]\n  }\n\n  has(key) {\n    return key in this.values\n  }\n\n  merge(values) {\n    return new Hash(merge(this.values, unbox(values)))\n  }\n\n  slice(keys) {\n    const values = {}\n\n    keys.forEach((key) => {\n      if (this.has(key)) {\n        values[key] = this.values[key]\n      }\n    })\n\n    return new Hash(values)\n  }\n\n  getKeys() {\n    return Object.keys(this.values)\n  }\n\n  getKeysCommonToHash(hash) {\n    hash = box(hash)\n    return this.getKeys().filter((key) => this.values[key] === hash.values[key])\n  }\n\n  isEqualTo(values) {\n    return arraysAreEqual(this.toArray(), box(values).toArray())\n  }\n\n  isEmpty() {\n    return this.getKeys().length === 0\n  }\n\n  toArray() {\n    if (!this.array) {\n      const result = []\n      for (const key in this.values) {\n        const value = this.values[key]\n        result.push(result.push(key, value))\n      }\n      this.array = result.slice(0)\n    }\n\n    return this.array\n  }\n\n  toObject() {\n    return copy(this.values)\n  }\n\n  toJSON() {\n    return this.toObject()\n  }\n\n  contentsForInspection() {\n    return { values: JSON.stringify(this.values) }\n  }\n}\n\nconst object = function(key, value) {\n  const result = {}\n  result[key] = value\n  return result\n}\n\nconst merge = function(object, values) {\n  const result = copy(object)\n  for (const key in values) {\n    const value = values[key]\n    result[key] = value\n  }\n  return result\n}\n\nconst copy = function(object, keyToRemove) {\n  const result = {}\n  const sortedKeys = Object.keys(object).sort()\n\n  sortedKeys.forEach((key) => {\n    if (key !== keyToRemove) {\n      result[key] = object[key]\n    }\n  })\n\n  return result\n}\n\nconst box = function(object) {\n  if (object instanceof Hash) {\n    return object\n  } else {\n    return new Hash(object)\n  }\n}\n\nconst unbox = function(object) {\n  if (object instanceof Hash) {\n    return object.values\n  } else {\n    return object\n  }\n}\n","export default class ObjectGroup {\n  static groupObjects(ungroupedObjects = [], { depth, asTree } = {}) {\n    let group\n    if (asTree) {\n      if (depth == null) {\n        depth = 0\n      }\n    }\n    const objects = []\n\n    Array.from(ungroupedObjects).forEach((object) => {\n      if (group) {\n        if (object.canBeGrouped?.(depth) && group[group.length - 1].canBeGroupedWith?.(object, depth)) {\n          group.push(object)\n          return\n        } else {\n          objects.push(new this(group, { depth, asTree }))\n          group = null\n        }\n      }\n\n      if (object.canBeGrouped?.(depth)) {\n        group = [ object ]\n      } else {\n        objects.push(object)\n      }\n    })\n\n    if (group) {\n      objects.push(new this(group, { depth, asTree }))\n    }\n    return objects\n  }\n\n  constructor(objects = [], { depth, asTree }) {\n    this.objects = objects\n    if (asTree) {\n      this.depth = depth\n      this.objects = this.constructor.groupObjects(this.objects, { asTree, depth: this.depth + 1 })\n    }\n  }\n\n  getObjects() {\n    return this.objects\n  }\n\n  getDepth() {\n    return this.depth\n  }\n\n  getCacheKey() {\n    const keys = [ \"objectGroup\" ]\n    Array.from(this.getObjects()).forEach((object) => {\n      keys.push(object.getCacheKey())\n    })\n    return keys.join(\"/\")\n  }\n}\n","import BasicObject from \"trix/core/basic_object\"\n\nexport default class ObjectMap extends BasicObject {\n  constructor(objects = []) {\n    super(...arguments)\n    this.objects = {}\n\n    Array.from(objects).forEach((object) => {\n      const hash = JSON.stringify(object)\n      if (this.objects[hash] == null) {\n        this.objects[hash] = object\n      }\n    })\n  }\n\n  find(object) {\n    const hash = JSON.stringify(object)\n    return this.objects[hash]\n  }\n}\n","export default class ElementStore {\n  constructor(elements) {\n    this.reset(elements)\n  }\n\n  add(element) {\n    const key = getKey(element)\n    this.elements[key] = element\n  }\n\n  remove(element) {\n    const key = getKey(element)\n    const value = this.elements[key]\n    if (value) {\n      delete this.elements[key]\n      return value\n    }\n  }\n\n  reset(elements = []) {\n    this.elements = {}\n    Array.from(elements).forEach((element) => {\n      this.add(element)\n    })\n    return elements\n  }\n}\n\nconst getKey = (element) => element.dataset.trixStoreKey\n","import BasicObject from \"trix/core/basic_object\"\n\nexport default class Operation extends BasicObject {\n  isPerforming() {\n    return this.performing === true\n  }\n\n  hasPerformed() {\n    return this.performed === true\n  }\n\n  hasSucceeded() {\n    return this.performed && this.succeeded\n  }\n\n  hasFailed() {\n    return this.performed && !this.succeeded\n  }\n\n  getPromise() {\n    if (!this.promise) {\n      this.promise = new Promise((resolve, reject) => {\n        this.performing = true\n        return this.perform((succeeded, result) => {\n          this.succeeded = succeeded\n          this.performing = false\n          this.performed = true\n\n          if (this.succeeded) {\n            resolve(result)\n          } else {\n            reject(result)\n          }\n        })\n      })\n    }\n\n    return this.promise\n  }\n\n  perform(callback) {\n    return callback(false)\n  }\n\n  release() {\n    this.promise?.cancel?.()\n    this.promise = null\n    this.performing = null\n    this.performed = null\n    this.succeeded = null\n  }\n}\n\nOperation.proxyMethod(\"getPromise().then\")\nOperation.proxyMethod(\"getPromise().catch\")\n","import BasicObject from \"trix/core/basic_object\"\nimport ObjectGroup from \"trix/core/collections/object_group\"\n\nexport default class ObjectView extends BasicObject {\n  constructor(object, options = {}) {\n    super(...arguments)\n    this.object = object\n    this.options = options\n    this.childViews = []\n    this.rootView = this\n  }\n\n  getNodes() {\n    if (!this.nodes) { this.nodes = this.createNodes() }\n    return this.nodes.map((node) => node.cloneNode(true))\n  }\n\n  invalidate() {\n    this.nodes = null\n    this.childViews = []\n    return this.parentView?.invalidate()\n  }\n\n  invalidateViewForObject(object) {\n    return this.findViewForObject(object)?.invalidate()\n  }\n\n  findOrCreateCachedChildView(viewClass, object, options) {\n    let view = this.getCachedViewForObject(object)\n    if (view) {\n      this.recordChildView(view)\n    } else {\n      view = this.createChildView(...arguments)\n      this.cacheViewForObject(view, object)\n    }\n    return view\n  }\n\n  createChildView(viewClass, object, options = {}) {\n    if (object instanceof ObjectGroup) {\n      options.viewClass = viewClass\n      viewClass = ObjectGroupView\n    }\n\n    const view = new viewClass(object, options)\n    return this.recordChildView(view)\n  }\n\n  recordChildView(view) {\n    view.parentView = this\n    view.rootView = this.rootView\n    this.childViews.push(view)\n    return view\n  }\n\n  getAllChildViews() {\n    let views = []\n\n    this.childViews.forEach((childView) => {\n      views.push(childView)\n      views = views.concat(childView.getAllChildViews())\n    })\n\n    return views\n  }\n\n  findElement() {\n    return this.findElementForObject(this.object)\n  }\n\n  findElementForObject(object) {\n    const id = object?.id\n    if (id) {\n      return this.rootView.element.querySelector(`[data-trix-id='${id}']`)\n    }\n  }\n\n  findViewForObject(object) {\n    for (const view of this.getAllChildViews()) {\n      if (view.object === object) {\n        return view\n      }\n    }\n  }\n\n  getViewCache() {\n    if (this.rootView === this) {\n      if (this.isViewCachingEnabled()) {\n        if (!this.viewCache) { this.viewCache = {} }\n        return this.viewCache\n      }\n    } else {\n      return this.rootView.getViewCache()\n    }\n  }\n\n  isViewCachingEnabled() {\n    return this.shouldCacheViews !== false\n  }\n\n  enableViewCaching() {\n    this.shouldCacheViews = true\n  }\n\n  disableViewCaching() {\n    this.shouldCacheViews = false\n  }\n\n  getCachedViewForObject(object) {\n    return this.getViewCache()?.[object.getCacheKey()]\n  }\n\n  cacheViewForObject(view, object) {\n    const cache = this.getViewCache()\n    if (cache) {\n      cache[object.getCacheKey()] = view\n    }\n  }\n\n  garbageCollectCachedViews() {\n    const cache = this.getViewCache()\n    if (cache) {\n      const views = this.getAllChildViews().concat(this)\n      const objectKeys = views.map((view) => view.object.getCacheKey())\n      for (const key in cache) {\n        if (!objectKeys.includes(key)) {\n          delete cache[key]\n        }\n      }\n    }\n  }\n}\n\nexport class ObjectGroupView extends ObjectView {\n  constructor() {\n    super(...arguments)\n    this.objectGroup = this.object\n    this.viewClass = this.options.viewClass\n    delete this.options.viewClass\n  }\n\n  getChildViews() {\n    if (!this.childViews.length) {\n      Array.from(this.objectGroup.getObjects()).forEach((object) => {\n        this.findOrCreateCachedChildView(this.viewClass, object, this.options)\n      })\n    }\n    return this.childViews\n  }\n\n  createNodes() {\n    const element = this.createContainerElement()\n\n    this.getChildViews().forEach((view) => {\n      Array.from(view.getNodes()).forEach((node) => {\n        element.appendChild(node)\n      })\n    })\n\n    return [ element ]\n  }\n\n  createContainerElement(depth = this.objectGroup.getDepth()) {\n    return this.getChildViews()[0].createContainerElement(depth)\n  }\n}\n","import config from \"trix/config\"\nimport { ZERO_WIDTH_SPACE } from \"trix/constants\"\nimport { copyObject, makeElement } from \"trix/core/helpers\"\nimport ObjectView from \"trix/views/object_view\"\n\nconst { css } = config\n\nexport default class AttachmentView extends ObjectView {\n  constructor() {\n    super(...arguments)\n    this.attachment = this.object\n    this.attachment.uploadProgressDelegate = this\n    this.attachmentPiece = this.options.piece\n  }\n\n  createContentNodes() {\n    return []\n  }\n\n  createNodes() {\n    let innerElement\n    const figure = innerElement = makeElement({\n      tagName: \"figure\",\n      className: this.getClassName(),\n      data: this.getData(),\n      editable: false,\n    })\n\n    const href = this.getHref()\n    if (href) {\n      innerElement = makeElement({ tagName: \"a\", editable: false, attributes: { href, tabindex: -1 } })\n      figure.appendChild(innerElement)\n    }\n\n    if (this.attachment.hasContent()) {\n      innerElement.innerHTML = this.attachment.getContent()\n    } else {\n      this.createContentNodes().forEach((node) => {\n        innerElement.appendChild(node)\n      })\n    }\n\n    innerElement.appendChild(this.createCaptionElement())\n\n    if (this.attachment.isPending()) {\n      this.progressElement = makeElement({\n        tagName: \"progress\",\n        attributes: {\n          class: css.attachmentProgress,\n          value: this.attachment.getUploadProgress(),\n          max: 100,\n        },\n        data: {\n          trixMutable: true,\n          trixStoreKey: [ \"progressElement\", this.attachment.id ].join(\"/\"),\n        },\n      })\n\n      figure.appendChild(this.progressElement)\n    }\n\n    return [ createCursorTarget(\"left\"), figure, createCursorTarget(\"right\") ]\n  }\n\n  createCaptionElement() {\n    const figcaption = makeElement({ tagName: \"figcaption\", className: css.attachmentCaption })\n    const caption = this.attachmentPiece.getCaption()\n    if (caption) {\n      figcaption.classList.add(`${css.attachmentCaption}--edited`)\n      figcaption.textContent = caption\n    } else {\n      let name, size\n      const captionConfig = this.getCaptionConfig()\n      if (captionConfig.name) {\n        name = this.attachment.getFilename()\n      }\n      if (captionConfig.size) {\n        size = this.attachment.getFormattedFilesize()\n      }\n\n      if (name) {\n        const nameElement = makeElement({ tagName: \"span\", className: css.attachmentName, textContent: name })\n        figcaption.appendChild(nameElement)\n      }\n\n      if (size) {\n        if (name) {\n          figcaption.appendChild(document.createTextNode(\" \"))\n        }\n        const sizeElement = makeElement({ tagName: \"span\", className: css.attachmentSize, textContent: size })\n        figcaption.appendChild(sizeElement)\n      }\n    }\n\n    return figcaption\n  }\n\n  getClassName() {\n    const names = [ css.attachment, `${css.attachment}--${this.attachment.getType()}` ]\n    const extension = this.attachment.getExtension()\n    if (extension) {\n      names.push(`${css.attachment}--${extension}`)\n    }\n    return names.join(\" \")\n  }\n\n  getData() {\n    const data = {\n      trixAttachment: JSON.stringify(this.attachment),\n      trixContentType: this.attachment.getContentType(),\n      trixId: this.attachment.id,\n    }\n\n    const { attributes } = this.attachmentPiece\n    if (!attributes.isEmpty()) {\n      data.trixAttributes = JSON.stringify(attributes)\n    }\n\n    if (this.attachment.isPending()) {\n      data.trixSerialize = false\n    }\n\n    return data\n  }\n\n  getHref() {\n    if (!htmlContainsTagName(this.attachment.getContent(), \"a\")) {\n      return this.attachment.getHref()\n    }\n  }\n\n  getCaptionConfig() {\n    const type = this.attachment.getType()\n    const captionConfig = copyObject(config.attachments[type]?.caption)\n    if (type === \"file\") {\n      captionConfig.name = true\n    }\n    return captionConfig\n  }\n\n  findProgressElement() {\n    return this.findElement()?.querySelector(\"progress\")\n  }\n\n  // Attachment delegate\n\n  attachmentDidChangeUploadProgress() {\n    const value = this.attachment.getUploadProgress()\n    const progressElement = this.findProgressElement()\n    if (progressElement) {\n      progressElement.value = value\n    }\n  }\n}\n\nconst createCursorTarget = (name) =>\n  makeElement({\n    tagName: \"span\",\n    textContent: ZERO_WIDTH_SPACE,\n    data: {\n      trixCursorTarget: name,\n      trixSerialize: false,\n    },\n  })\n\nconst htmlContainsTagName = function(html, tagName) {\n  const div = makeElement(\"div\")\n  div.innerHTML = html || \"\"\n  return div.querySelector(tagName)\n}\n","import config from \"trix/config\"\nimport { makeElement } from \"trix/core/helpers\"\n\nimport AttachmentView from \"trix/views/attachment_view\"\n\nexport default class PreviewableAttachmentView extends AttachmentView {\n  constructor() {\n    super(...arguments)\n    this.attachment.previewDelegate = this\n  }\n\n  createContentNodes() {\n    this.image = makeElement({\n      tagName: \"img\",\n      attributes: {\n        src: \"\",\n      },\n      data: {\n        trixMutable: true,\n      },\n    })\n\n    this.refresh(this.image)\n    return [ this.image ]\n  }\n\n  createCaptionElement() {\n    const figcaption = super.createCaptionElement(...arguments)\n    if (!figcaption.textContent) {\n      figcaption.setAttribute(\"data-trix-placeholder\", config.lang.captionPlaceholder)\n    }\n    return figcaption\n  }\n\n  refresh(image) {\n    if (!image) { image = this.findElement()?.querySelector(\"img\") }\n    if (image) {\n      return this.updateAttributesForImage(image)\n    }\n  }\n\n  updateAttributesForImage(image) {\n    const url = this.attachment.getURL()\n    const previewURL = this.attachment.getPreviewURL()\n    image.src = previewURL || url\n\n    if (previewURL === url) {\n      image.removeAttribute(\"data-trix-serialized-attributes\")\n    } else {\n      const serializedAttributes = JSON.stringify({ src: url })\n      image.setAttribute(\"data-trix-serialized-attributes\", serializedAttributes)\n    }\n\n    const width = this.attachment.getWidth()\n    const height = this.attachment.getHeight()\n\n    if (width != null) {\n      image.width = width\n    }\n    if (height != null) {\n      image.height = height\n    }\n\n    const storeKey = [ \"imageElement\", this.attachment.id, image.src, image.width, image.height ].join(\"/\")\n    image.dataset.trixStoreKey = storeKey\n  }\n\n  // Attachment delegate\n\n  attachmentDidChangeAttributes() {\n    this.refresh(this.image)\n    return this.refresh()\n  }\n}\n","/* eslint-disable\n    no-useless-escape,\n    no-var,\n*/\nimport { NON_BREAKING_SPACE } from \"trix/constants\"\n\nimport ObjectView from \"trix/views/object_view\"\nimport AttachmentView from \"trix/views/attachment_view\"\nimport PreviewableAttachmentView from \"trix/views/previewable_attachment_view\"\n\nimport { findInnerElement, getTextConfig, makeElement } from \"trix/core/helpers\"\n\nexport default class PieceView extends ObjectView {\n  constructor() {\n    super(...arguments)\n    this.piece = this.object\n    this.attributes = this.piece.getAttributes()\n    this.textConfig = this.options.textConfig\n    this.context = this.options.context\n\n    if (this.piece.attachment) {\n      this.attachment = this.piece.attachment\n    } else {\n      this.string = this.piece.toString()\n    }\n  }\n\n  createNodes() {\n    let nodes = this.attachment ? this.createAttachmentNodes() : this.createStringNodes()\n    const element = this.createElement()\n    if (element) {\n      const innerElement = findInnerElement(element)\n      Array.from(nodes).forEach((node) => {\n        innerElement.appendChild(node)\n      })\n      nodes = [ element ]\n    }\n    return nodes\n  }\n\n  createAttachmentNodes() {\n    const constructor = this.attachment.isPreviewable() ? PreviewableAttachmentView : AttachmentView\n\n    const view = this.createChildView(constructor, this.piece.attachment, { piece: this.piece })\n    return view.getNodes()\n  }\n\n  createStringNodes() {\n    if (this.textConfig?.plaintext) {\n      return [ document.createTextNode(this.string) ]\n    } else {\n      const nodes = []\n      const iterable = this.string.split(\"\\n\")\n      for (let index = 0; index < iterable.length; index++) {\n        const substring = iterable[index]\n        if (index > 0) {\n          const element = makeElement(\"br\")\n          nodes.push(element)\n        }\n\n        if (substring.length) {\n          const node = document.createTextNode(this.preserveSpaces(substring))\n          nodes.push(node)\n        }\n      }\n      return nodes\n    }\n  }\n\n  createElement() {\n    let element, key, value\n    const styles = {}\n\n    for (key in this.attributes) {\n      value = this.attributes[key]\n      const config = getTextConfig(key)\n      if (config) {\n        if (config.tagName) {\n          var innerElement\n          const pendingElement = makeElement(config.tagName)\n\n          if (innerElement) {\n            innerElement.appendChild(pendingElement)\n            innerElement = pendingElement\n          } else {\n            element = innerElement = pendingElement\n          }\n        }\n\n        if (config.styleProperty) {\n          styles[config.styleProperty] = value\n        }\n\n        if (config.style) {\n          for (key in config.style) {\n            value = config.style[key]\n            styles[key] = value\n          }\n        }\n      }\n    }\n\n    if (Object.keys(styles).length) {\n      if (!element) { element = makeElement(\"span\") }\n      for (key in styles) {\n        value = styles[key]\n        element.style[key] = value\n      }\n    }\n    return element\n  }\n\n  createContainerElement() {\n    for (const key in this.attributes) {\n      const value = this.attributes[key]\n      const config = getTextConfig(key)\n      if (config) {\n        if (config.groupTagName) {\n          const attributes = {}\n          attributes[key] = value\n          return makeElement(config.groupTagName, attributes)\n        }\n      }\n    }\n  }\n\n  preserveSpaces(string) {\n    if (this.context.isLast) {\n      string = string.replace(/\\ $/, NON_BREAKING_SPACE)\n    }\n\n    string = string\n      .replace(/(\\S)\\ {3}(\\S)/g, `$1 ${NON_BREAKING_SPACE} $2`)\n      .replace(/\\ {2}/g, `${NON_BREAKING_SPACE} `)\n      .replace(/\\ {2}/g, ` ${NON_BREAKING_SPACE}`)\n\n    if (this.context.isFirst || this.context.followsWhitespace) {\n      string = string.replace(/^\\ /, NON_BREAKING_SPACE)\n    }\n\n    return string\n  }\n}\n","/* eslint-disable\n    no-var,\n*/\nimport ObjectView from \"trix/views/object_view\"\nimport ObjectGroup from \"trix/core/collections/object_group\"\nimport PieceView from \"trix/views/piece_view\"\n\nexport default class TextView extends ObjectView {\n  constructor() {\n    super(...arguments)\n    this.text = this.object\n    this.textConfig = this.options.textConfig\n  }\n\n  createNodes() {\n    const nodes = []\n    const pieces = ObjectGroup.groupObjects(this.getPieces())\n    const lastIndex = pieces.length - 1\n\n    for (let index = 0; index < pieces.length; index++) {\n      const piece = pieces[index]\n      const context = {}\n      if (index === 0) {\n        context.isFirst = true\n      }\n      if (index === lastIndex) {\n        context.isLast = true\n      }\n      if (endsWithWhitespace(previousPiece)) {\n        context.followsWhitespace = true\n      }\n\n      const view = this.findOrCreateCachedChildView(PieceView, piece, { textConfig: this.textConfig, context })\n      nodes.push(...Array.from(view.getNodes() || []))\n\n      var previousPiece = piece\n    }\n    return nodes\n  }\n\n  getPieces() {\n    return Array.from(this.text.getPieces()).filter((piece) => !piece.hasAttribute(\"blockBreak\"))\n  }\n}\n\nconst endsWithWhitespace = (piece) => /\\s$/.test(piece?.toString())\n","import config from \"trix/config\"\nimport ObjectView from \"trix/views/object_view\"\nimport TextView from \"trix/views/text_view\"\n\nimport { getBlockConfig, makeElement } from \"trix/core/helpers\"\nconst { css } = config\n\nexport default class BlockView extends ObjectView {\n  constructor() {\n    super(...arguments)\n    this.block = this.object\n    this.attributes = this.block.getAttributes()\n  }\n\n  createNodes() {\n    const comment = document.createComment(\"block\")\n    const nodes = [ comment ]\n    if (this.block.isEmpty()) {\n      nodes.push(makeElement(\"br\"))\n    } else {\n      const textConfig = getBlockConfig(this.block.getLastAttribute())?.text\n      const textView = this.findOrCreateCachedChildView(TextView, this.block.text, { textConfig })\n      nodes.push(...Array.from(textView.getNodes() || []))\n      if (this.shouldAddExtraNewlineElement()) {\n        nodes.push(makeElement(\"br\"))\n      }\n    }\n\n    if (this.attributes.length) {\n      return nodes\n    } else {\n      let attributes\n      const { tagName } = config.blockAttributes.default\n      if (this.block.isRTL()) {\n        attributes = { dir: \"rtl\" }\n      }\n\n      const element = makeElement({ tagName, attributes })\n      nodes.forEach((node) => element.appendChild(node))\n      return [ element ]\n    }\n  }\n\n  createContainerElement(depth) {\n    let attributes, className\n    const attributeName = this.attributes[depth]\n\n    const { tagName } = getBlockConfig(attributeName)\n    if (depth === 0 && this.block.isRTL()) {\n      attributes = { dir: \"rtl\" }\n    }\n\n    if (attributeName === \"attachmentGallery\") {\n      const size = this.block.getBlockBreakPosition()\n      className = `${css.attachmentGallery} ${css.attachmentGallery}--${size}`\n    }\n\n    return makeElement({ tagName, className, attributes })\n  }\n\n  // A single <br> at the end of a block element has no visual representation\n  // so add an extra one.\n  shouldAddExtraNewlineElement() {\n    return /\\n\\n$/.test(this.block.toString())\n  }\n}\n","import { makeElement } from \"trix/core/helpers\"\n\nimport ElementStore from \"trix/core/collections/element_store\"\nimport ObjectGroup from \"trix/core/collections/object_group\"\nimport ObjectView from \"trix/views/object_view\"\nimport BlockView from \"trix/views/block_view\"\n\nimport { defer } from \"trix/core/helpers\"\n\nexport default class DocumentView extends ObjectView {\n  static render(document) {\n    const element = makeElement(\"div\")\n    const view = new this(document, { element })\n    view.render()\n    view.sync()\n    return element\n  }\n\n  constructor() {\n    super(...arguments)\n    this.element = this.options.element\n    this.elementStore = new ElementStore()\n    this.setDocument(this.object)\n  }\n\n  setDocument(document) {\n    if (!document.isEqualTo(this.document)) {\n      this.document = this.object = document\n    }\n  }\n\n  render() {\n    this.childViews = []\n\n    this.shadowElement = makeElement(\"div\")\n\n    if (!this.document.isEmpty()) {\n      const objects = ObjectGroup.groupObjects(this.document.getBlocks(), { asTree: true })\n\n      Array.from(objects).forEach((object) => {\n        const view = this.findOrCreateCachedChildView(BlockView, object)\n        Array.from(view.getNodes()).map((node) => this.shadowElement.appendChild(node))\n      })\n    }\n  }\n\n  isSynced() {\n    return elementsHaveEqualHTML(this.shadowElement, this.element)\n  }\n\n  sync() {\n    const fragment = this.createDocumentFragmentForSync()\n    while (this.element.lastChild) {\n      this.element.removeChild(this.element.lastChild)\n    }\n    this.element.appendChild(fragment)\n    return this.didSync()\n  }\n\n  // Private\n\n  didSync() {\n    this.elementStore.reset(findStoredElements(this.element))\n    return defer(() => this.garbageCollectCachedViews())\n  }\n\n  createDocumentFragmentForSync() {\n    const fragment = document.createDocumentFragment()\n\n    Array.from(this.shadowElement.childNodes).forEach((node) => {\n      fragment.appendChild(node.cloneNode(true))\n    })\n\n    Array.from(findStoredElements(fragment)).forEach((element) => {\n      const storedElement = this.elementStore.remove(element)\n      if (storedElement) {\n        element.parentNode.replaceChild(storedElement, element)\n      }\n    })\n\n    return fragment\n  }\n}\n\nconst findStoredElements = (element) => element.querySelectorAll(\"[data-trix-store-key]\")\n\nconst elementsHaveEqualHTML = (element, otherElement) =>\n  ignoreSpaces(element.innerHTML) === ignoreSpaces(otherElement.innerHTML)\n\nconst ignoreSpaces = (html) => html.replace(/&nbsp;/g, \" \")\n","/* eslint-disable\n    no-undef,\n*/\nimport TrixObject from \"trix/core/object\" // Don't override window.Object\nimport Hash from \"trix/core/collections/hash\"\n\nexport default class Piece extends TrixObject {\n  static types = {}\n\n  static registerType(type, constructor) {\n    constructor.type = type\n    this.types[type] = constructor\n  }\n\n  static fromJSON(pieceJSON) {\n    const constructor = this.types[pieceJSON.type]\n    if (constructor) {\n      return constructor.fromJSON(pieceJSON)\n    }\n  }\n\n  constructor(value, attributes = {}) {\n    super(...arguments)\n    this.attributes = Hash.box(attributes)\n  }\n\n  copyWithAttributes(attributes) {\n    return new this.constructor(this.getValue(), attributes)\n  }\n\n  copyWithAdditionalAttributes(attributes) {\n    return this.copyWithAttributes(this.attributes.merge(attributes))\n  }\n\n  copyWithoutAttribute(attribute) {\n    return this.copyWithAttributes(this.attributes.remove(attribute))\n  }\n\n  copy() {\n    return this.copyWithAttributes(this.attributes)\n  }\n\n  getAttribute(attribute) {\n    return this.attributes.get(attribute)\n  }\n\n  getAttributesHash() {\n    return this.attributes\n  }\n\n  getAttributes() {\n    return this.attributes.toObject()\n  }\n\n  getCommonAttributes() {\n    const piece = pieceList.getPieceAtIndex(0)\n    if (!piece) return {}\n\n    let { attributes } = piece\n    let keys = attributes.getKeys()\n\n    pieceList.eachPiece(function(piece) {\n      keys = attributes.getKeysCommonToHash(piece.attributes)\n      attributes = attributes.slice(keys)\n    })\n\n    return attributes.toObject()\n  }\n\n  hasAttribute(attribute) {\n    return this.attributes.has(attribute)\n  }\n\n  hasSameStringValueAsPiece(piece) {\n    return piece && this.toString() === piece.toString()\n  }\n\n  hasSameAttributesAsPiece(piece) {\n    return piece && (this.attributes === piece.attributes || this.attributes.isEqualTo(piece.attributes))\n  }\n\n  isBlockBreak() {\n    return false\n  }\n\n  isEqualTo(piece) {\n    return (\n      super.isEqualTo(...arguments) ||\n      this.hasSameConstructorAs(piece) &&\n        this.hasSameStringValueAsPiece(piece) &&\n        this.hasSameAttributesAsPiece(piece)\n    )\n  }\n\n  isEmpty() {\n    return this.length === 0\n  }\n\n  isSerializable() {\n    return true\n  }\n\n  toJSON() {\n    return {\n      type: this.constructor.type,\n      attributes: this.getAttributes(),\n    }\n  }\n\n  contentsForInspection() {\n    return {\n      type: this.constructor.type,\n      attributes: this.attributes.inspect(),\n    }\n  }\n\n  // Grouping\n\n  canBeGrouped() {\n    return this.hasAttribute(\"href\")\n  }\n\n  canBeGroupedWith(piece) {\n    return this.getAttribute(\"href\") === piece.getAttribute(\"href\")\n  }\n\n  // Splittable\n\n  getLength() {\n    return this.length\n  }\n\n  canBeConsolidatedWith(piece) {\n    return false\n  }\n}\n","import Operation from \"trix/core/utilities/operation\"\n\nexport default class ImagePreloadOperation extends Operation {\n  constructor(url) {\n    super(...arguments)\n    this.url = url\n  }\n\n  perform(callback) {\n    const image = new Image()\n\n    image.onload = () => {\n      image.width = this.width = image.naturalWidth\n      image.height = this.height = image.naturalHeight\n      return callback(true, image)\n    }\n\n    image.onerror = () => callback(false)\n\n    image.src = this.url\n  }\n}\n","import config from \"trix/config\"\nimport TrixObject from \"trix/core/object\" // Don't override window.Object\nimport Hash from \"trix/core/collections/hash\"\nimport ImagePreloadOperation from \"trix/operations/image_preload_operation\"\n\nexport default class Attachment extends TrixObject {\n  static previewablePattern = /^image(\\/(gif|png|jpe?g)|$)/\n\n  static attachmentForFile(file) {\n    const attributes = this.attributesForFile(file)\n    const attachment = new this(attributes)\n    attachment.setFile(file)\n    return attachment\n  }\n\n  static attributesForFile(file) {\n    return new Hash({\n      filename: file.name,\n      filesize: file.size,\n      contentType: file.type,\n    })\n  }\n\n  static fromJSON(attachmentJSON) {\n    return new this(attachmentJSON)\n  }\n\n  constructor(attributes = {}) {\n    super(attributes)\n    this.releaseFile = this.releaseFile.bind(this)\n    this.attributes = Hash.box(attributes)\n    this.didChangeAttributes()\n  }\n\n  getAttribute(attribute) {\n    return this.attributes.get(attribute)\n  }\n\n  hasAttribute(attribute) {\n    return this.attributes.has(attribute)\n  }\n\n  getAttributes() {\n    return this.attributes.toObject()\n  }\n\n  setAttributes(attributes = {}) {\n    const newAttributes = this.attributes.merge(attributes)\n    if (!this.attributes.isEqualTo(newAttributes)) {\n      this.attributes = newAttributes\n      this.didChangeAttributes()\n      this.previewDelegate?.attachmentDidChangeAttributes?.(this)\n      return this.delegate?.attachmentDidChangeAttributes?.(this)\n    }\n  }\n\n  didChangeAttributes() {\n    if (this.isPreviewable()) {\n      return this.preloadURL()\n    }\n  }\n\n  isPending() {\n    return this.file != null && !(this.getURL() || this.getHref())\n  }\n\n  isPreviewable() {\n    if (this.attributes.has(\"previewable\")) {\n      return this.attributes.get(\"previewable\")\n    } else {\n      return Attachment.previewablePattern.test(this.getContentType())\n    }\n  }\n\n  getType() {\n    if (this.hasContent()) {\n      return \"content\"\n    } else if (this.isPreviewable()) {\n      return \"preview\"\n    } else {\n      return \"file\"\n    }\n  }\n\n  getURL() {\n    return this.attributes.get(\"url\")\n  }\n\n  getHref() {\n    return this.attributes.get(\"href\")\n  }\n\n  getFilename() {\n    return this.attributes.get(\"filename\") || \"\"\n  }\n\n  getFilesize() {\n    return this.attributes.get(\"filesize\")\n  }\n\n  getFormattedFilesize() {\n    const filesize = this.attributes.get(\"filesize\")\n    if (typeof filesize === \"number\") {\n      return config.fileSize.formatter(filesize)\n    } else {\n      return \"\"\n    }\n  }\n\n  getExtension() {\n    return this.getFilename()\n      .match(/\\.(\\w+)$/)?.[1]\n      .toLowerCase()\n  }\n\n  getContentType() {\n    return this.attributes.get(\"contentType\")\n  }\n\n  hasContent() {\n    return this.attributes.has(\"content\")\n  }\n\n  getContent() {\n    return this.attributes.get(\"content\")\n  }\n\n  getWidth() {\n    return this.attributes.get(\"width\")\n  }\n\n  getHeight() {\n    return this.attributes.get(\"height\")\n  }\n\n  getFile() {\n    return this.file\n  }\n\n  setFile(file) {\n    this.file = file\n    if (this.isPreviewable()) {\n      return this.preloadFile()\n    }\n  }\n\n  releaseFile() {\n    this.releasePreloadedFile()\n    this.file = null\n  }\n\n  getUploadProgress() {\n    return this.uploadProgress != null ? this.uploadProgress : 0\n  }\n\n  setUploadProgress(value) {\n    if (this.uploadProgress !== value) {\n      this.uploadProgress = value\n      return this.uploadProgressDelegate?.attachmentDidChangeUploadProgress?.(this)\n    }\n  }\n\n  toJSON() {\n    return this.getAttributes()\n  }\n\n  getCacheKey() {\n    return [ super.getCacheKey(...arguments), this.attributes.getCacheKey(), this.getPreviewURL() ].join(\"/\")\n  }\n\n  // Previewable\n\n  getPreviewURL() {\n    return this.previewURL || this.preloadingURL\n  }\n\n  setPreviewURL(url) {\n    if (url !== this.getPreviewURL()) {\n      this.previewURL = url\n      this.previewDelegate?.attachmentDidChangeAttributes?.(this)\n      return this.delegate?.attachmentDidChangePreviewURL?.(this)\n    }\n  }\n\n  preloadURL() {\n    return this.preload(this.getURL(), this.releaseFile)\n  }\n\n  preloadFile() {\n    if (this.file) {\n      this.fileObjectURL = URL.createObjectURL(this.file)\n      return this.preload(this.fileObjectURL)\n    }\n  }\n\n  releasePreloadedFile() {\n    if (this.fileObjectURL) {\n      URL.revokeObjectURL(this.fileObjectURL)\n      this.fileObjectURL = null\n    }\n  }\n\n  preload(url, callback) {\n    if (url && url !== this.getPreviewURL()) {\n      this.preloadingURL = url\n      const operation = new ImagePreloadOperation(url)\n      return operation\n        .then(({ width, height }) => {\n          if (!this.getWidth() || !this.getHeight()) {\n            this.setAttributes({ width, height })\n          }\n          this.preloadingURL = null\n          this.setPreviewURL(url)\n          return callback?.()\n        })\n        .catch(() => {\n          this.preloadingURL = null\n          return callback?.()\n        })\n    }\n  }\n}\n","import { OBJECT_REPLACEMENT_CHARACTER } from \"trix/constants\"\n\nimport Attachment from \"trix/models/attachment\"\nimport Piece from \"trix/models/piece\"\n\nexport default class AttachmentPiece extends Piece {\n  static permittedAttributes = [ \"caption\", \"presentation\" ]\n\n  static fromJSON(pieceJSON) {\n    return new this(Attachment.fromJSON(pieceJSON.attachment), pieceJSON.attributes)\n  }\n\n  constructor(attachment) {\n    super(...arguments)\n    this.attachment = attachment\n    this.length = 1\n    this.ensureAttachmentExclusivelyHasAttribute(\"href\")\n    if (!this.attachment.hasContent()) {\n      this.removeProhibitedAttributes()\n    }\n  }\n\n  ensureAttachmentExclusivelyHasAttribute(attribute) {\n    if (this.hasAttribute(attribute)) {\n      if (!this.attachment.hasAttribute(attribute)) {\n        this.attachment.setAttributes(this.attributes.slice(attribute))\n      }\n      this.attributes = this.attributes.remove(attribute)\n    }\n  }\n\n  removeProhibitedAttributes() {\n    const attributes = this.attributes.slice(AttachmentPiece.permittedAttributes)\n    if (!attributes.isEqualTo(this.attributes)) {\n      this.attributes = attributes\n    }\n  }\n\n  getValue() {\n    return this.attachment\n  }\n\n  isSerializable() {\n    return !this.attachment.isPending()\n  }\n\n  getCaption() {\n    return this.attributes.get(\"caption\") || \"\"\n  }\n\n  isEqualTo(piece) {\n    return super.isEqualTo(piece) && this.attachment.id === piece?.attachment?.id\n  }\n\n  toString() {\n    return OBJECT_REPLACEMENT_CHARACTER\n  }\n\n  toJSON() {\n    const json = super.toJSON(...arguments)\n    json.attachment = this.attachment\n    return json\n  }\n\n  getCacheKey() {\n    return [ super.getCacheKey(...arguments), this.attachment.getCacheKey() ].join(\"/\")\n  }\n\n  toConsole() {\n    return JSON.stringify(this.toString())\n  }\n}\n\nPiece.registerType(\"attachment\", AttachmentPiece)\n","import Piece from \"trix/models/piece\"\n\nimport { normalizeNewlines } from \"trix/core/helpers\"\n\nexport default class StringPiece extends Piece {\n  static fromJSON(pieceJSON) {\n    return new this(pieceJSON.string, pieceJSON.attributes)\n  }\n\n  constructor(string) {\n    super(...arguments)\n    this.string = normalizeNewlines(string)\n    this.length = this.string.length\n  }\n\n  getValue() {\n    return this.string\n  }\n\n  toString() {\n    return this.string.toString()\n  }\n\n  isBlockBreak() {\n    return this.toString() === \"\\n\" && this.getAttribute(\"blockBreak\") === true\n  }\n\n  toJSON() {\n    const result = super.toJSON(...arguments)\n    result.string = this.string\n    return result\n  }\n\n  // Splittable\n\n  canBeConsolidatedWith(piece) {\n    return piece && this.hasSameConstructorAs(piece) && this.hasSameAttributesAsPiece(piece)\n  }\n\n  consolidateWith(piece) {\n    return new this.constructor(this.toString() + piece.toString(), this.attributes)\n  }\n\n  splitAtOffset(offset) {\n    let left, right\n    if (offset === 0) {\n      left = null\n      right = this\n    } else if (offset === this.length) {\n      left = this\n      right = null\n    } else {\n      left = new this.constructor(this.string.slice(0, offset), this.attributes)\n      right = new this.constructor(this.string.slice(offset), this.attributes)\n    }\n    return [ left, right ]\n  }\n\n  toConsole() {\n    let { string } = this\n    if (string.length > 15) {\n      string = string.slice(0, 14) + \"…\"\n    }\n    return JSON.stringify(string.toString())\n  }\n}\n\nPiece.registerType(\"string\", StringPiece)\n","/* eslint-disable\n    prefer-const,\n*/\nimport TrixObject from \"trix/core/object\" // Don't override window.Object\n\nimport { spliceArray } from \"trix/core/helpers\"\n\nexport default class SplittableList extends TrixObject {\n  static box(objects) {\n    if (objects instanceof this) {\n      return objects\n    } else {\n      return new this(objects)\n    }\n  }\n\n  constructor(objects = []) {\n    super(...arguments)\n    this.objects = objects.slice(0)\n    this.length = this.objects.length\n  }\n\n  indexOf(object) {\n    return this.objects.indexOf(object)\n  }\n\n  splice(...args) {\n    return new this.constructor(spliceArray(this.objects, ...args))\n  }\n\n  eachObject(callback) {\n    return this.objects.map((object, index) => callback(object, index))\n  }\n\n  insertObjectAtIndex(object, index) {\n    return this.splice(index, 0, object)\n  }\n\n  insertSplittableListAtIndex(splittableList, index) {\n    return this.splice(index, 0, ...splittableList.objects)\n  }\n\n  insertSplittableListAtPosition(splittableList, position) {\n    const [ objects, index ] = this.splitObjectAtPosition(position)\n    return new this.constructor(objects).insertSplittableListAtIndex(splittableList, index)\n  }\n\n  editObjectAtIndex(index, callback) {\n    return this.replaceObjectAtIndex(callback(this.objects[index]), index)\n  }\n\n  replaceObjectAtIndex(object, index) {\n    return this.splice(index, 1, object)\n  }\n\n  removeObjectAtIndex(index) {\n    return this.splice(index, 1)\n  }\n\n  getObjectAtIndex(index) {\n    return this.objects[index]\n  }\n\n  getSplittableListInRange(range) {\n    const [ objects, leftIndex, rightIndex ] = this.splitObjectsAtRange(range)\n    return new this.constructor(objects.slice(leftIndex, rightIndex + 1))\n  }\n\n  selectSplittableList(test) {\n    const objects = this.objects.filter((object) => test(object))\n    return new this.constructor(objects)\n  }\n\n  removeObjectsInRange(range) {\n    const [ objects, leftIndex, rightIndex ] = this.splitObjectsAtRange(range)\n    return new this.constructor(objects).splice(leftIndex, rightIndex - leftIndex + 1)\n  }\n\n  transformObjectsInRange(range, transform) {\n    const [ objects, leftIndex, rightIndex ] = this.splitObjectsAtRange(range)\n    const transformedObjects = objects.map((object, index) =>\n      leftIndex <= index && index <= rightIndex ? transform(object) : object\n    )\n    return new this.constructor(transformedObjects)\n  }\n\n  splitObjectsAtRange(range) {\n    let rightOuterIndex\n    let [ objects, leftInnerIndex, offset ] = this.splitObjectAtPosition(startOfRange(range))\n    ;[ objects, rightOuterIndex ] = new this.constructor(objects).splitObjectAtPosition(endOfRange(range) + offset)\n\n    return [ objects, leftInnerIndex, rightOuterIndex - 1 ]\n  }\n\n  getObjectAtPosition(position) {\n    const { index } = this.findIndexAndOffsetAtPosition(position)\n    return this.objects[index]\n  }\n\n  splitObjectAtPosition(position) {\n    let splitIndex, splitOffset\n    const { index, offset } = this.findIndexAndOffsetAtPosition(position)\n    const objects = this.objects.slice(0)\n    if (index != null) {\n      if (offset === 0) {\n        splitIndex = index\n        splitOffset = 0\n      } else {\n        const object = this.getObjectAtIndex(index)\n        const [ leftObject, rightObject ] = object.splitAtOffset(offset)\n        objects.splice(index, 1, leftObject, rightObject)\n        splitIndex = index + 1\n        splitOffset = leftObject.getLength() - offset\n      }\n    } else {\n      splitIndex = objects.length\n      splitOffset = 0\n    }\n\n    return [ objects, splitIndex, splitOffset ]\n  }\n\n  consolidate() {\n    const objects = []\n    let pendingObject = this.objects[0]\n\n    this.objects.slice(1).forEach((object) => {\n      if (pendingObject.canBeConsolidatedWith?.(object)) {\n        pendingObject = pendingObject.consolidateWith(object)\n      } else {\n        objects.push(pendingObject)\n        pendingObject = object\n      }\n    })\n\n    if (pendingObject) {\n      objects.push(pendingObject)\n    }\n\n    return new this.constructor(objects)\n  }\n\n  consolidateFromIndexToIndex(startIndex, endIndex) {\n    const objects = this.objects.slice(0)\n    const objectsInRange = objects.slice(startIndex, endIndex + 1)\n    const consolidatedInRange = new this.constructor(objectsInRange).consolidate().toArray()\n    return this.splice(startIndex, objectsInRange.length, ...consolidatedInRange)\n  }\n\n  findIndexAndOffsetAtPosition(position) {\n    let index\n    let currentPosition = 0\n    for (index = 0; index < this.objects.length; index++) {\n      const object = this.objects[index]\n      const nextPosition = currentPosition + object.getLength()\n      if (currentPosition <= position && position < nextPosition) {\n        return { index, offset: position - currentPosition }\n      }\n      currentPosition = nextPosition\n    }\n    return { index: null, offset: null }\n  }\n\n  findPositionAtIndexAndOffset(index, offset) {\n    let position = 0\n    for (let currentIndex = 0; currentIndex < this.objects.length; currentIndex++) {\n      const object = this.objects[currentIndex]\n      if (currentIndex < index) {\n        position += object.getLength()\n      } else if (currentIndex === index) {\n        position += offset\n        break\n      }\n    }\n    return position\n  }\n\n  getEndPosition() {\n    if (this.endPosition == null) {\n      this.endPosition = 0\n      this.objects.forEach((object) => this.endPosition += object.getLength())\n    }\n\n    return this.endPosition\n  }\n\n  toString() {\n    return this.objects.join(\"\")\n  }\n\n  toArray() {\n    return this.objects.slice(0)\n  }\n\n  toJSON() {\n    return this.toArray()\n  }\n\n  isEqualTo(splittableList) {\n    return super.isEqualTo(...arguments) || objectArraysAreEqual(this.objects, splittableList?.objects)\n  }\n\n  contentsForInspection() {\n    return {\n      objects: `[${this.objects.map((object) => object.inspect()).join(\", \")}]`,\n    }\n  }\n}\n\nconst objectArraysAreEqual = function(left, right = []) {\n  if (left.length !== right.length) {\n    return false\n  }\n  let result = true\n  for (let index = 0; index < left.length; index++) {\n    const object = left[index]\n    if (result && !object.isEqualTo(right[index])) {\n      result = false\n    }\n  }\n  return result\n}\n\nconst startOfRange = (range) => range[0]\n\nconst endOfRange = (range) => range[1]\n","import TrixObject from \"trix/core/object\" // Don't override window.Object\n\nimport { getDirection } from \"trix/core/helpers\"\n\nimport Piece from \"trix/models/piece\"\nimport AttachmentPiece from \"trix/models/attachment_piece\"\nimport StringPiece from \"trix/models/string_piece\"\nimport SplittableList from \"trix/models/splittable_list\"\n\nimport Hash from \"trix/core/collections/hash\"\n\nexport default class Text extends TrixObject {\n  static textForAttachmentWithAttributes(attachment, attributes) {\n    const piece = new AttachmentPiece(attachment, attributes)\n    return new this([ piece ])\n  }\n\n  static textForStringWithAttributes(string, attributes) {\n    const piece = new StringPiece(string, attributes)\n    return new this([ piece ])\n  }\n\n  static fromJSON(textJSON) {\n    const pieces = Array.from(textJSON).map((pieceJSON) => Piece.fromJSON(pieceJSON))\n    return new this(pieces)\n  }\n\n  constructor(pieces = []) {\n    super(...arguments)\n    const notEmpty = pieces.filter((piece) => !piece.isEmpty())\n    this.pieceList = new SplittableList(notEmpty)\n  }\n\n  copy() {\n    return this.copyWithPieceList(this.pieceList)\n  }\n\n  copyWithPieceList(pieceList) {\n    return new this.constructor(pieceList.consolidate().toArray())\n  }\n\n  copyUsingObjectMap(objectMap) {\n    const pieces = this.getPieces().map((piece) => objectMap.find(piece) || piece)\n    return new this.constructor(pieces)\n  }\n\n  appendText(text) {\n    return this.insertTextAtPosition(text, this.getLength())\n  }\n\n  insertTextAtPosition(text, position) {\n    return this.copyWithPieceList(this.pieceList.insertSplittableListAtPosition(text.pieceList, position))\n  }\n\n  removeTextAtRange(range) {\n    return this.copyWithPieceList(this.pieceList.removeObjectsInRange(range))\n  }\n\n  replaceTextAtRange(text, range) {\n    return this.removeTextAtRange(range).insertTextAtPosition(text, range[0])\n  }\n\n  moveTextFromRangeToPosition(range, position) {\n    if (range[0] <= position && position <= range[1]) {\n      return\n    }\n    const text = this.getTextAtRange(range)\n    const length = text.getLength()\n    if (range[0] < position) {\n      position -= length\n    }\n    return this.removeTextAtRange(range).insertTextAtPosition(text, position)\n  }\n\n  addAttributeAtRange(attribute, value, range) {\n    const attributes = {}\n    attributes[attribute] = value\n    return this.addAttributesAtRange(attributes, range)\n  }\n\n  addAttributesAtRange(attributes, range) {\n    return this.copyWithPieceList(\n      this.pieceList.transformObjectsInRange(range, (piece) => piece.copyWithAdditionalAttributes(attributes))\n    )\n  }\n\n  removeAttributeAtRange(attribute, range) {\n    return this.copyWithPieceList(\n      this.pieceList.transformObjectsInRange(range, (piece) => piece.copyWithoutAttribute(attribute))\n    )\n  }\n\n  setAttributesAtRange(attributes, range) {\n    return this.copyWithPieceList(\n      this.pieceList.transformObjectsInRange(range, (piece) => piece.copyWithAttributes(attributes))\n    )\n  }\n\n  getAttributesAtPosition(position) {\n    return this.pieceList.getObjectAtPosition(position)?.getAttributes() || {}\n  }\n\n  getCommonAttributes() {\n    const objects = Array.from(this.pieceList.toArray()).map((piece) => piece.getAttributes())\n    return Hash.fromCommonAttributesOfObjects(objects).toObject()\n  }\n\n  getCommonAttributesAtRange(range) {\n    return this.getTextAtRange(range).getCommonAttributes() || {}\n  }\n\n  getExpandedRangeForAttributeAtOffset(attributeName, offset) {\n    let right\n    let left = right = offset\n    const length = this.getLength()\n\n    while (left > 0 && this.getCommonAttributesAtRange([ left - 1, right ])[attributeName]) {\n      left--\n    }\n    while (right < length && this.getCommonAttributesAtRange([ offset, right + 1 ])[attributeName]) {\n      right++\n    }\n\n    return [ left, right ]\n  }\n\n  getTextAtRange(range) {\n    return this.copyWithPieceList(this.pieceList.getSplittableListInRange(range))\n  }\n\n  getStringAtRange(range) {\n    return this.pieceList.getSplittableListInRange(range).toString()\n  }\n\n  getStringAtPosition(position) {\n    return this.getStringAtRange([ position, position + 1 ])\n  }\n\n  startsWithString(string) {\n    return this.getStringAtRange([ 0, string.length ]) === string\n  }\n\n  endsWithString(string) {\n    const length = this.getLength()\n    return this.getStringAtRange([ length - string.length, length ]) === string\n  }\n\n  getAttachmentPieces() {\n    return this.pieceList.toArray().filter((piece) => !!piece.attachment)\n  }\n\n  getAttachments() {\n    return this.getAttachmentPieces().map((piece) => piece.attachment)\n  }\n\n  getAttachmentAndPositionById(attachmentId) {\n    let position = 0\n    for (const piece of this.pieceList.toArray()) {\n      if (piece.attachment?.id === attachmentId) {\n        return { attachment: piece.attachment, position }\n      }\n      position += piece.length\n    }\n    return { attachment: null, position: null }\n  }\n\n  getAttachmentById(attachmentId) {\n    const { attachment } = this.getAttachmentAndPositionById(attachmentId)\n    return attachment\n  }\n\n  getRangeOfAttachment(attachment) {\n    const attachmentAndPosition = this.getAttachmentAndPositionById(attachment.id)\n    const position = attachmentAndPosition.position\n    attachment = attachmentAndPosition.attachment\n    if (attachment) {\n      return [ position, position + 1 ]\n    }\n  }\n\n  updateAttributesForAttachment(attributes, attachment) {\n    const range = this.getRangeOfAttachment(attachment)\n    if (range) {\n      return this.addAttributesAtRange(attributes, range)\n    } else {\n      return this\n    }\n  }\n\n  getLength() {\n    return this.pieceList.getEndPosition()\n  }\n\n  isEmpty() {\n    return this.getLength() === 0\n  }\n\n  isEqualTo(text) {\n    return super.isEqualTo(text) || text?.pieceList?.isEqualTo(this.pieceList)\n  }\n\n  isBlockBreak() {\n    return this.getLength() === 1 && this.pieceList.getObjectAtIndex(0).isBlockBreak()\n  }\n\n  eachPiece(callback) {\n    return this.pieceList.eachObject(callback)\n  }\n\n  getPieces() {\n    return this.pieceList.toArray()\n  }\n\n  getPieceAtPosition(position) {\n    return this.pieceList.getObjectAtPosition(position)\n  }\n\n  contentsForInspection() {\n    return { pieceList: this.pieceList.inspect() }\n  }\n\n  toSerializableText() {\n    const pieceList = this.pieceList.selectSplittableList((piece) => piece.isSerializable())\n    return this.copyWithPieceList(pieceList)\n  }\n\n  toString() {\n    return this.pieceList.toString()\n  }\n\n  toJSON() {\n    return this.pieceList.toJSON()\n  }\n\n  toConsole() {\n    return JSON.stringify(this.pieceList.toArray().map((piece) => JSON.parse(piece.toConsole())))\n  }\n\n  // BIDI\n\n  getDirection() {\n    return getDirection(this.toString())\n  }\n\n  isRTL() {\n    return this.getDirection() === \"rtl\"\n  }\n}\n","import TrixObject from \"trix/core/object\" // Don't override window.Object\nimport Text from \"trix/models/text\"\n\nimport {\n  arraysAreEqual,\n  getBlockConfig,\n  getListAttributeNames,\n  spliceArray,\n} from \"trix/core/helpers\"\n\nexport default class Block extends TrixObject {\n  static fromJSON(blockJSON) {\n    const text = Text.fromJSON(blockJSON.text)\n    return new this(text, blockJSON.attributes)\n  }\n\n  constructor(text, attributes) {\n    super(...arguments)\n    this.text = applyBlockBreakToText(text || new Text())\n    this.attributes = attributes || []\n  }\n\n  isEmpty() {\n    return this.text.isBlockBreak()\n  }\n\n  isEqualTo(block) {\n    if (super.isEqualTo(block)) return true\n\n    return this.text.isEqualTo(block?.text) && arraysAreEqual(this.attributes, block?.attributes)\n  }\n\n  copyWithText(text) {\n    return new Block(text, this.attributes)\n  }\n\n  copyWithoutText() {\n    return this.copyWithText(null)\n  }\n\n  copyWithAttributes(attributes) {\n    return new Block(this.text, attributes)\n  }\n\n  copyWithoutAttributes() {\n    return this.copyWithAttributes(null)\n  }\n\n  copyUsingObjectMap(objectMap) {\n    const mappedText = objectMap.find(this.text)\n    if (mappedText) {\n      return this.copyWithText(mappedText)\n    } else {\n      return this.copyWithText(this.text.copyUsingObjectMap(objectMap))\n    }\n  }\n\n  addAttribute(attribute) {\n    const attributes = this.attributes.concat(expandAttribute(attribute))\n    return this.copyWithAttributes(attributes)\n  }\n\n  removeAttribute(attribute) {\n    const { listAttribute } = getBlockConfig(attribute)\n    const attributes = removeLastValue(removeLastValue(this.attributes, attribute), listAttribute)\n    return this.copyWithAttributes(attributes)\n  }\n\n  removeLastAttribute() {\n    return this.removeAttribute(this.getLastAttribute())\n  }\n\n  getLastAttribute() {\n    return getLastElement(this.attributes)\n  }\n\n  getAttributes() {\n    return this.attributes.slice(0)\n  }\n\n  getAttributeLevel() {\n    return this.attributes.length\n  }\n\n  getAttributeAtLevel(level) {\n    return this.attributes[level - 1]\n  }\n\n  hasAttribute(attributeName) {\n    return this.attributes.includes(attributeName)\n  }\n\n  hasAttributes() {\n    return this.getAttributeLevel() > 0\n  }\n\n  getLastNestableAttribute() {\n    return getLastElement(this.getNestableAttributes())\n  }\n\n  getNestableAttributes() {\n    return this.attributes.filter((attribute) => getBlockConfig(attribute).nestable)\n  }\n\n  getNestingLevel() {\n    return this.getNestableAttributes().length\n  }\n\n  decreaseNestingLevel() {\n    const attribute = this.getLastNestableAttribute()\n    if (attribute) {\n      return this.removeAttribute(attribute)\n    } else {\n      return this\n    }\n  }\n\n  increaseNestingLevel() {\n    const attribute = this.getLastNestableAttribute()\n    if (attribute) {\n      const index = this.attributes.lastIndexOf(attribute)\n      const attributes = spliceArray(this.attributes, index + 1, 0, ...expandAttribute(attribute))\n      return this.copyWithAttributes(attributes)\n    } else {\n      return this\n    }\n  }\n\n  getListItemAttributes() {\n    return this.attributes.filter((attribute) => getBlockConfig(attribute).listAttribute)\n  }\n\n  isListItem() {\n    return getBlockConfig(this.getLastAttribute())?.listAttribute\n  }\n\n  isTerminalBlock() {\n    return getBlockConfig(this.getLastAttribute())?.terminal\n  }\n\n  breaksOnReturn() {\n    return getBlockConfig(this.getLastAttribute())?.breakOnReturn\n  }\n\n  findLineBreakInDirectionFromPosition(direction, position) {\n    const string = this.toString()\n    let result\n    switch (direction) {\n      case \"forward\":\n        result = string.indexOf(\"\\n\", position)\n        break\n      case \"backward\":\n        result = string.slice(0, position).lastIndexOf(\"\\n\")\n    }\n\n    if (result !== -1) {\n      return result\n    }\n  }\n\n  contentsForInspection() {\n    return {\n      text: this.text.inspect(),\n      attributes: this.attributes,\n    }\n  }\n\n  toString() {\n    return this.text.toString()\n  }\n\n  toJSON() {\n    return {\n      text: this.text,\n      attributes: this.attributes,\n    }\n  }\n\n  // BIDI\n\n  getDirection() {\n    return this.text.getDirection()\n  }\n\n  isRTL() {\n    return this.text.isRTL()\n  }\n\n  // Splittable\n\n  getLength() {\n    return this.text.getLength()\n  }\n\n  canBeConsolidatedWith(block) {\n    return !this.hasAttributes() && !block.hasAttributes() && this.getDirection() === block.getDirection()\n  }\n\n  consolidateWith(block) {\n    const newlineText = Text.textForStringWithAttributes(\"\\n\")\n    const text = this.getTextWithoutBlockBreak().appendText(newlineText)\n    return this.copyWithText(text.appendText(block.text))\n  }\n\n  splitAtOffset(offset) {\n    let left, right\n    if (offset === 0) {\n      left = null\n      right = this\n    } else if (offset === this.getLength()) {\n      left = this\n      right = null\n    } else {\n      left = this.copyWithText(this.text.getTextAtRange([ 0, offset ]))\n      right = this.copyWithText(this.text.getTextAtRange([ offset, this.getLength() ]))\n    }\n    return [ left, right ]\n  }\n\n  getBlockBreakPosition() {\n    return this.text.getLength() - 1\n  }\n\n  getTextWithoutBlockBreak() {\n    if (textEndsInBlockBreak(this.text)) {\n      return this.text.getTextAtRange([ 0, this.getBlockBreakPosition() ])\n    } else {\n      return this.text.copy()\n    }\n  }\n\n  // Grouping\n\n  canBeGrouped(depth) {\n    return this.attributes[depth]\n  }\n\n  canBeGroupedWith(otherBlock, depth) {\n    const otherAttributes = otherBlock.getAttributes()\n    const otherAttribute = otherAttributes[depth]\n    const attribute = this.attributes[depth]\n\n    return (\n      attribute === otherAttribute &&\n      !(getBlockConfig(attribute).group === false && !getListAttributeNames().includes(otherAttributes[depth + 1])) &&\n      (this.getDirection() === otherBlock.getDirection() || otherBlock.isEmpty())\n    )\n  }\n}\n\n// Block breaks\n\nconst applyBlockBreakToText = function(text) {\n  text = unmarkExistingInnerBlockBreaksInText(text)\n  text = addBlockBreakToText(text)\n  return text\n}\n\nconst unmarkExistingInnerBlockBreaksInText = function(text) {\n  let modified = false\n  const pieces = text.getPieces()\n\n  let innerPieces = pieces.slice(0, pieces.length - 1)\n  const lastPiece = pieces[pieces.length - 1]\n\n  if (!lastPiece) return text\n\n  innerPieces = innerPieces.map((piece) => {\n    if (piece.isBlockBreak()) {\n      modified = true\n      return unmarkBlockBreakPiece(piece)\n    } else {\n      return piece\n    }\n  })\n\n  if (modified) {\n    return new Text([ ...innerPieces, lastPiece ])\n  } else {\n    return text\n  }\n}\n\nconst blockBreakText = Text.textForStringWithAttributes(\"\\n\", { blockBreak: true })\n\nconst addBlockBreakToText = function(text) {\n  if (textEndsInBlockBreak(text)) {\n    return text\n  } else {\n    return text.appendText(blockBreakText)\n  }\n}\n\nconst textEndsInBlockBreak = function(text) {\n  const length = text.getLength()\n  if (length === 0) {\n    return false\n  }\n  const endText = text.getTextAtRange([ length - 1, length ])\n  return endText.isBlockBreak()\n}\n\nconst unmarkBlockBreakPiece = (piece) => piece.copyWithoutAttribute(\"blockBreak\")\n\n// Attributes\n\nconst expandAttribute = function(attribute) {\n  const { listAttribute } = getBlockConfig(attribute)\n  if (listAttribute) {\n    return [ listAttribute, attribute ]\n  } else {\n    return [ attribute ]\n  }\n}\n\n// Array helpers\n\nconst getLastElement = (array) => array.slice(-1)[0]\n\nconst removeLastValue = function(array, value) {\n  const index = array.lastIndexOf(value)\n  if (index === -1) {\n    return array\n  } else {\n    return spliceArray(array, index, 1)\n  }\n}\n","import config from \"trix/config\"\nimport TrixObject from \"trix/core/object\" // Don't override window.Object\n\nimport Text from \"trix/models/text\"\nimport Block from \"trix/models/block\"\nimport SplittableList from \"trix/models/splittable_list\"\nimport Hash from \"trix/core/collections/hash\"\nimport ObjectMap from \"trix/core/collections/object_map\"\n\nimport { arraysAreEqual, getBlockConfig, normalizeRange, rangeIsCollapsed } from \"trix/core/helpers\"\n\nexport default class Document extends TrixObject {\n  static fromJSON(documentJSON) {\n    const blocks = Array.from(documentJSON).map((blockJSON) => Block.fromJSON(blockJSON))\n    return new this(blocks)\n  }\n\n  static fromString(string, textAttributes) {\n    const text = Text.textForStringWithAttributes(string, textAttributes)\n    return new this([ new Block(text) ])\n  }\n\n  constructor(blocks = []) {\n    super(...arguments)\n    if (blocks.length === 0) {\n      blocks = [ new Block() ]\n    }\n    this.blockList = SplittableList.box(blocks)\n  }\n\n  isEmpty() {\n    const block = this.getBlockAtIndex(0)\n    return this.blockList.length === 1 && block.isEmpty() && !block.hasAttributes()\n  }\n\n  copy(options = {}) {\n    const blocks = options.consolidateBlocks ? this.blockList.consolidate().toArray() : this.blockList.toArray()\n\n    return new this.constructor(blocks)\n  }\n\n  copyUsingObjectsFromDocument(sourceDocument) {\n    const objectMap = new ObjectMap(sourceDocument.getObjects())\n    return this.copyUsingObjectMap(objectMap)\n  }\n\n  copyUsingObjectMap(objectMap) {\n    const blocks = this.getBlocks().map((block) => {\n      const mappedBlock = objectMap.find(block)\n      return mappedBlock || block.copyUsingObjectMap(objectMap)\n    })\n    return new this.constructor(blocks)\n  }\n\n  copyWithBaseBlockAttributes(blockAttributes = []) {\n    const blocks = this.getBlocks().map((block) => {\n      const attributes = blockAttributes.concat(block.getAttributes())\n      return block.copyWithAttributes(attributes)\n    })\n\n    return new this.constructor(blocks)\n  }\n\n  replaceBlock(oldBlock, newBlock) {\n    const index = this.blockList.indexOf(oldBlock)\n    if (index === -1) {\n      return this\n    }\n    return new this.constructor(this.blockList.replaceObjectAtIndex(newBlock, index))\n  }\n\n  insertDocumentAtRange(document, range) {\n    const { blockList } = document\n    range = normalizeRange(range)\n    let [ position ] = range\n    const { index, offset } = this.locationFromPosition(position)\n\n    let result = this\n    const block = this.getBlockAtPosition(position)\n\n    if (rangeIsCollapsed(range) && block.isEmpty() && !block.hasAttributes()) {\n      result = new this.constructor(result.blockList.removeObjectAtIndex(index))\n    } else if (block.getBlockBreakPosition() === offset) {\n      position++\n    }\n\n    result = result.removeTextAtRange(range)\n    return new this.constructor(result.blockList.insertSplittableListAtPosition(blockList, position))\n  }\n\n  mergeDocumentAtRange(document, range) {\n    let formattedDocument, result\n    range = normalizeRange(range)\n    const [ startPosition ] = range\n    const startLocation = this.locationFromPosition(startPosition)\n    const blockAttributes = this.getBlockAtIndex(startLocation.index).getAttributes()\n    const baseBlockAttributes = document.getBaseBlockAttributes()\n    const trailingBlockAttributes = blockAttributes.slice(-baseBlockAttributes.length)\n\n    if (arraysAreEqual(baseBlockAttributes, trailingBlockAttributes)) {\n      const leadingBlockAttributes = blockAttributes.slice(0, -baseBlockAttributes.length)\n      formattedDocument = document.copyWithBaseBlockAttributes(leadingBlockAttributes)\n    } else {\n      formattedDocument = document.copy({ consolidateBlocks: true }).copyWithBaseBlockAttributes(blockAttributes)\n    }\n\n    const blockCount = formattedDocument.getBlockCount()\n    const firstBlock = formattedDocument.getBlockAtIndex(0)\n\n    if (arraysAreEqual(blockAttributes, firstBlock.getAttributes())) {\n      const firstText = firstBlock.getTextWithoutBlockBreak()\n      result = this.insertTextAtRange(firstText, range)\n\n      if (blockCount > 1) {\n        formattedDocument = new this.constructor(formattedDocument.getBlocks().slice(1))\n        const position = startPosition + firstText.getLength()\n        result = result.insertDocumentAtRange(formattedDocument, position)\n      }\n    } else {\n      result = this.insertDocumentAtRange(formattedDocument, range)\n    }\n\n    return result\n  }\n\n  insertTextAtRange(text, range) {\n    range = normalizeRange(range)\n    const [ startPosition ] = range\n    const { index, offset } = this.locationFromPosition(startPosition)\n\n    const document = this.removeTextAtRange(range)\n    return new this.constructor(\n      document.blockList.editObjectAtIndex(index, (block) =>\n        block.copyWithText(block.text.insertTextAtPosition(text, offset))\n      )\n    )\n  }\n\n  removeTextAtRange(range) {\n    let blocks\n    range = normalizeRange(range)\n    const [ leftPosition, rightPosition ] = range\n    if (rangeIsCollapsed(range)) {\n      return this\n    }\n    const [ leftLocation, rightLocation ] = Array.from(this.locationRangeFromRange(range))\n\n    const leftIndex = leftLocation.index\n    const leftOffset = leftLocation.offset\n    const leftBlock = this.getBlockAtIndex(leftIndex)\n\n    const rightIndex = rightLocation.index\n    const rightOffset = rightLocation.offset\n    const rightBlock = this.getBlockAtIndex(rightIndex)\n\n    const removeRightNewline =\n      rightPosition - leftPosition === 1 &&\n      leftBlock.getBlockBreakPosition() === leftOffset &&\n      rightBlock.getBlockBreakPosition() !== rightOffset &&\n      rightBlock.text.getStringAtPosition(rightOffset) === \"\\n\"\n\n    if (removeRightNewline) {\n      blocks = this.blockList.editObjectAtIndex(rightIndex, (block) =>\n        block.copyWithText(block.text.removeTextAtRange([ rightOffset, rightOffset + 1 ]))\n      )\n    } else {\n      let block\n      const leftText = leftBlock.text.getTextAtRange([ 0, leftOffset ])\n      const rightText = rightBlock.text.getTextAtRange([ rightOffset, rightBlock.getLength() ])\n      const text = leftText.appendText(rightText)\n\n      const removingLeftBlock = leftIndex !== rightIndex && leftOffset === 0\n      const useRightBlock = removingLeftBlock && leftBlock.getAttributeLevel() >= rightBlock.getAttributeLevel()\n\n      if (useRightBlock) {\n        block = rightBlock.copyWithText(text)\n      } else {\n        block = leftBlock.copyWithText(text)\n      }\n\n      const affectedBlockCount = rightIndex + 1 - leftIndex\n      blocks = this.blockList.splice(leftIndex, affectedBlockCount, block)\n    }\n\n    return new this.constructor(blocks)\n  }\n\n  moveTextFromRangeToPosition(range, position) {\n    let text\n    range = normalizeRange(range)\n    const [ startPosition, endPosition ] = range\n    if (startPosition <= position && position <= endPosition) {\n      return this\n    }\n\n    let document = this.getDocumentAtRange(range)\n    let result = this.removeTextAtRange(range)\n\n    const movingRightward = startPosition < position\n    if (movingRightward) {\n      position -= document.getLength()\n    }\n\n    const [ firstBlock, ...blocks ] = document.getBlocks()\n    if (blocks.length === 0) {\n      text = firstBlock.getTextWithoutBlockBreak()\n      if (movingRightward) {\n        position += 1\n      }\n    } else {\n      text = firstBlock.text\n    }\n\n    result = result.insertTextAtRange(text, position)\n    if (blocks.length === 0) {\n      return result\n    }\n\n    document = new this.constructor(blocks)\n    position += text.getLength()\n\n    return result.insertDocumentAtRange(document, position)\n  }\n\n  addAttributeAtRange(attribute, value, range) {\n    let { blockList } = this\n    this.eachBlockAtRange(\n      range,\n      (block, textRange, index) =>\n        blockList = blockList.editObjectAtIndex(index, function() {\n          if (getBlockConfig(attribute)) {\n            return block.addAttribute(attribute, value)\n          } else {\n            if (textRange[0] === textRange[1]) {\n              return block\n            } else {\n              return block.copyWithText(block.text.addAttributeAtRange(attribute, value, textRange))\n            }\n          }\n        })\n    )\n    return new this.constructor(blockList)\n  }\n\n  addAttribute(attribute, value) {\n    let { blockList } = this\n    this.eachBlock(\n      (block, index) => blockList = blockList.editObjectAtIndex(index, () => block.addAttribute(attribute, value))\n    )\n    return new this.constructor(blockList)\n  }\n\n  removeAttributeAtRange(attribute, range) {\n    let { blockList } = this\n    this.eachBlockAtRange(range, function(block, textRange, index) {\n      if (getBlockConfig(attribute)) {\n        blockList = blockList.editObjectAtIndex(index, () => block.removeAttribute(attribute))\n      } else if (textRange[0] !== textRange[1]) {\n        blockList = blockList.editObjectAtIndex(index, () =>\n          block.copyWithText(block.text.removeAttributeAtRange(attribute, textRange))\n        )\n      }\n    })\n    return new this.constructor(blockList)\n  }\n\n  updateAttributesForAttachment(attributes, attachment) {\n    const range = this.getRangeOfAttachment(attachment)\n    const [ startPosition ] = Array.from(range)\n    const { index } = this.locationFromPosition(startPosition)\n    const text = this.getTextAtIndex(index)\n\n    return new this.constructor(\n      this.blockList.editObjectAtIndex(index, (block) =>\n        block.copyWithText(text.updateAttributesForAttachment(attributes, attachment))\n      )\n    )\n  }\n\n  removeAttributeForAttachment(attribute, attachment) {\n    const range = this.getRangeOfAttachment(attachment)\n    return this.removeAttributeAtRange(attribute, range)\n  }\n\n  insertBlockBreakAtRange(range) {\n    let blocks\n    range = normalizeRange(range)\n    const [ startPosition ] = range\n    const { offset } = this.locationFromPosition(startPosition)\n\n    const document = this.removeTextAtRange(range)\n    if (offset === 0) {\n      blocks = [ new Block() ]\n    }\n    return new this.constructor(\n      document.blockList.insertSplittableListAtPosition(new SplittableList(blocks), startPosition)\n    )\n  }\n\n  applyBlockAttributeAtRange(attributeName, value, range) {\n    const expanded = this.expandRangeToLineBreaksAndSplitBlocks(range)\n    let document = expanded.document\n    range = expanded.range\n    const blockConfig = getBlockConfig(attributeName)\n\n    if (blockConfig.listAttribute) {\n      document = document.removeLastListAttributeAtRange(range, { exceptAttributeName: attributeName })\n      const converted = document.convertLineBreaksToBlockBreaksInRange(range)\n      document = converted.document\n      range = converted.range\n    } else if (blockConfig.exclusive) {\n      document = document.removeBlockAttributesAtRange(range)\n    } else if (blockConfig.terminal) {\n      document = document.removeLastTerminalAttributeAtRange(range)\n    } else {\n      document = document.consolidateBlocksAtRange(range)\n    }\n\n    return document.addAttributeAtRange(attributeName, value, range)\n  }\n\n  removeLastListAttributeAtRange(range, options = {}) {\n    let { blockList } = this\n    this.eachBlockAtRange(range, function(block, textRange, index) {\n      const lastAttributeName = block.getLastAttribute()\n      if (!lastAttributeName) {\n        return\n      }\n      if (!getBlockConfig(lastAttributeName).listAttribute) {\n        return\n      }\n      if (lastAttributeName === options.exceptAttributeName) {\n        return\n      }\n      blockList = blockList.editObjectAtIndex(index, () => block.removeAttribute(lastAttributeName))\n    })\n    return new this.constructor(blockList)\n  }\n\n  removeLastTerminalAttributeAtRange(range) {\n    let { blockList } = this\n    this.eachBlockAtRange(range, function(block, textRange, index) {\n      const lastAttributeName = block.getLastAttribute()\n      if (!lastAttributeName) {\n        return\n      }\n      if (!getBlockConfig(lastAttributeName).terminal) {\n        return\n      }\n      blockList = blockList.editObjectAtIndex(index, () => block.removeAttribute(lastAttributeName))\n    })\n    return new this.constructor(blockList)\n  }\n\n  removeBlockAttributesAtRange(range) {\n    let { blockList } = this\n    this.eachBlockAtRange(range, function(block, textRange, index) {\n      if (block.hasAttributes()) {\n        blockList = blockList.editObjectAtIndex(index, () => block.copyWithoutAttributes())\n      }\n    })\n    return new this.constructor(blockList)\n  }\n\n  expandRangeToLineBreaksAndSplitBlocks(range) {\n    let position\n    range = normalizeRange(range)\n    let [ startPosition, endPosition ] = range\n    const startLocation = this.locationFromPosition(startPosition)\n    const endLocation = this.locationFromPosition(endPosition)\n    let document = this\n\n    const startBlock = document.getBlockAtIndex(startLocation.index)\n    startLocation.offset = startBlock.findLineBreakInDirectionFromPosition(\"backward\", startLocation.offset)\n    if (startLocation.offset != null) {\n      position = document.positionFromLocation(startLocation)\n      document = document.insertBlockBreakAtRange([ position, position + 1 ])\n      endLocation.index += 1\n      endLocation.offset -= document.getBlockAtIndex(startLocation.index).getLength()\n      startLocation.index += 1\n    }\n    startLocation.offset = 0\n\n    if (endLocation.offset === 0 && endLocation.index > startLocation.index) {\n      endLocation.index -= 1\n      endLocation.offset = document.getBlockAtIndex(endLocation.index).getBlockBreakPosition()\n    } else {\n      const endBlock = document.getBlockAtIndex(endLocation.index)\n      if (endBlock.text.getStringAtRange([ endLocation.offset - 1, endLocation.offset ]) === \"\\n\") {\n        endLocation.offset -= 1\n      } else {\n        endLocation.offset = endBlock.findLineBreakInDirectionFromPosition(\"forward\", endLocation.offset)\n      }\n      if (endLocation.offset !== endBlock.getBlockBreakPosition()) {\n        position = document.positionFromLocation(endLocation)\n        document = document.insertBlockBreakAtRange([ position, position + 1 ])\n      }\n    }\n\n    startPosition = document.positionFromLocation(startLocation)\n    endPosition = document.positionFromLocation(endLocation)\n    range = normalizeRange([ startPosition, endPosition ])\n\n    return { document, range }\n  }\n\n  convertLineBreaksToBlockBreaksInRange(range) {\n    range = normalizeRange(range)\n    let [ position ] = range\n    const string = this.getStringAtRange(range).slice(0, -1)\n    let document = this\n\n    string.replace(/.*?\\n/g, function(match) {\n      position += match.length\n      document = document.insertBlockBreakAtRange([ position - 1, position ])\n    })\n\n    return { document, range }\n  }\n\n  consolidateBlocksAtRange(range) {\n    range = normalizeRange(range)\n    const [ startPosition, endPosition ] = range\n    const startIndex = this.locationFromPosition(startPosition).index\n    const endIndex = this.locationFromPosition(endPosition).index\n    return new this.constructor(this.blockList.consolidateFromIndexToIndex(startIndex, endIndex))\n  }\n\n  getDocumentAtRange(range) {\n    range = normalizeRange(range)\n    const blocks = this.blockList.getSplittableListInRange(range).toArray()\n    return new this.constructor(blocks)\n  }\n\n  getStringAtRange(range) {\n    let endIndex\n    const array = range = normalizeRange(range),\n      endPosition = array[array.length - 1]\n    if (endPosition !== this.getLength()) {\n      endIndex = -1\n    }\n    return this.getDocumentAtRange(range).toString().slice(0, endIndex)\n  }\n\n  getBlockAtIndex(index) {\n    return this.blockList.getObjectAtIndex(index)\n  }\n\n  getBlockAtPosition(position) {\n    const { index } = this.locationFromPosition(position)\n    return this.getBlockAtIndex(index)\n  }\n\n  getTextAtIndex(index) {\n    return this.getBlockAtIndex(index)?.text\n  }\n\n  getTextAtPosition(position) {\n    const { index } = this.locationFromPosition(position)\n    return this.getTextAtIndex(index)\n  }\n\n  getPieceAtPosition(position) {\n    const { index, offset } = this.locationFromPosition(position)\n    return this.getTextAtIndex(index).getPieceAtPosition(offset)\n  }\n\n  getCharacterAtPosition(position) {\n    const { index, offset } = this.locationFromPosition(position)\n    return this.getTextAtIndex(index).getStringAtRange([ offset, offset + 1 ])\n  }\n\n  getLength() {\n    return this.blockList.getEndPosition()\n  }\n\n  getBlocks() {\n    return this.blockList.toArray()\n  }\n\n  getBlockCount() {\n    return this.blockList.length\n  }\n\n  getEditCount() {\n    return this.editCount\n  }\n\n  eachBlock(callback) {\n    return this.blockList.eachObject(callback)\n  }\n\n  eachBlockAtRange(range, callback) {\n    let block, textRange\n    range = normalizeRange(range)\n    const [ startPosition, endPosition ] = range\n    const startLocation = this.locationFromPosition(startPosition)\n    const endLocation = this.locationFromPosition(endPosition)\n\n    if (startLocation.index === endLocation.index) {\n      block = this.getBlockAtIndex(startLocation.index)\n      textRange = [ startLocation.offset, endLocation.offset ]\n      return callback(block, textRange, startLocation.index)\n    } else {\n      for (let index = startLocation.index; index <= endLocation.index; index++) {\n        block = this.getBlockAtIndex(index)\n        if (block) {\n          switch (index) {\n            case startLocation.index:\n              textRange = [ startLocation.offset, block.text.getLength() ]\n              break\n            case endLocation.index:\n              textRange = [ 0, endLocation.offset ]\n              break\n            default:\n              textRange = [ 0, block.text.getLength() ]\n          }\n          callback(block, textRange, index)\n        }\n      }\n    }\n  }\n\n  getCommonAttributesAtRange(range) {\n    range = normalizeRange(range)\n    const [ startPosition ] = range\n    if (rangeIsCollapsed(range)) {\n      return this.getCommonAttributesAtPosition(startPosition)\n    } else {\n      const textAttributes = []\n      const blockAttributes = []\n\n      this.eachBlockAtRange(range, function(block, textRange) {\n        if (textRange[0] !== textRange[1]) {\n          textAttributes.push(block.text.getCommonAttributesAtRange(textRange))\n          return blockAttributes.push(attributesForBlock(block))\n        }\n      })\n\n      return Hash.fromCommonAttributesOfObjects(textAttributes)\n        .merge(Hash.fromCommonAttributesOfObjects(blockAttributes))\n        .toObject()\n    }\n  }\n\n  getCommonAttributesAtPosition(position) {\n    let key, value\n    const { index, offset } = this.locationFromPosition(position)\n    const block = this.getBlockAtIndex(index)\n    if (!block) {\n      return {}\n    }\n\n    const commonAttributes = attributesForBlock(block)\n    const attributes = block.text.getAttributesAtPosition(offset)\n    const attributesLeft = block.text.getAttributesAtPosition(offset - 1)\n    const inheritableAttributes = Object.keys(config.textAttributes).filter((key) => {\n      return config.textAttributes[key].inheritable\n    })\n\n    for (key in attributesLeft) {\n      value = attributesLeft[key]\n      if (value === attributes[key] || inheritableAttributes.includes(key)) {\n        commonAttributes[key] = value\n      }\n    }\n\n    return commonAttributes\n  }\n\n  getRangeOfCommonAttributeAtPosition(attributeName, position) {\n    const { index, offset } = this.locationFromPosition(position)\n    const text = this.getTextAtIndex(index)\n    const [ startOffset, endOffset ] = Array.from(text.getExpandedRangeForAttributeAtOffset(attributeName, offset))\n\n    const start = this.positionFromLocation({ index, offset: startOffset })\n    const end = this.positionFromLocation({ index, offset: endOffset })\n    return normalizeRange([ start, end ])\n  }\n\n  getBaseBlockAttributes() {\n    let baseBlockAttributes = this.getBlockAtIndex(0).getAttributes()\n\n    for (let blockIndex = 1; blockIndex < this.getBlockCount(); blockIndex++) {\n      const blockAttributes = this.getBlockAtIndex(blockIndex).getAttributes()\n      const lastAttributeIndex = Math.min(baseBlockAttributes.length, blockAttributes.length)\n\n      baseBlockAttributes = (() => {\n        const result = []\n        for (let index = 0; index < lastAttributeIndex; index++) {\n          if (blockAttributes[index] !== baseBlockAttributes[index]) {\n            break\n          }\n          result.push(blockAttributes[index])\n        }\n        return result\n      })()\n    }\n\n    return baseBlockAttributes\n  }\n\n  getAttachmentById(attachmentId) {\n    for (const attachment of this.getAttachments()) {\n      if (attachment.id === attachmentId) {\n        return attachment\n      }\n    }\n  }\n\n  getAttachmentPieces() {\n    let attachmentPieces = []\n    this.blockList.eachObject(({ text }) => attachmentPieces = attachmentPieces.concat(text.getAttachmentPieces()))\n    return attachmentPieces\n  }\n\n  getAttachments() {\n    return this.getAttachmentPieces().map((piece) => piece.attachment)\n  }\n\n  getRangeOfAttachment(attachment) {\n    let position = 0\n    const iterable = this.blockList.toArray()\n    for (let index = 0; index < iterable.length; index++) {\n      const { text } = iterable[index]\n      const textRange = text.getRangeOfAttachment(attachment)\n      if (textRange) {\n        return normalizeRange([ position + textRange[0], position + textRange[1] ])\n      }\n      position += text.getLength()\n    }\n  }\n\n  getLocationRangeOfAttachment(attachment) {\n    const range = this.getRangeOfAttachment(attachment)\n    return this.locationRangeFromRange(range)\n  }\n\n  getAttachmentPieceForAttachment(attachment) {\n    for (const piece of this.getAttachmentPieces()) {\n      if (piece.attachment === attachment) {\n        return piece\n      }\n    }\n  }\n\n  findRangesForBlockAttribute(attributeName) {\n    let position = 0\n    const ranges = []\n\n    this.getBlocks().forEach((block) => {\n      const length = block.getLength()\n      if (block.hasAttribute(attributeName)) {\n        ranges.push([ position, position + length ])\n      }\n      position += length\n    })\n\n    return ranges\n  }\n\n  findRangesForTextAttribute(attributeName, { withValue } = {}) {\n    let position = 0\n    let range = []\n    const ranges = []\n\n    const match = function(piece) {\n      if (withValue) {\n        return piece.getAttribute(attributeName) === withValue\n      } else {\n        return piece.hasAttribute(attributeName)\n      }\n    }\n\n    this.getPieces().forEach((piece) => {\n      const length = piece.getLength()\n      if (match(piece)) {\n        if (range[1] === position) {\n          range[1] = position + length\n        } else {\n          ranges.push(range = [ position, position + length ])\n        }\n      }\n      position += length\n    })\n\n    return ranges\n  }\n\n  locationFromPosition(position) {\n    const location = this.blockList.findIndexAndOffsetAtPosition(Math.max(0, position))\n    if (location.index != null) {\n      return location\n    } else {\n      const blocks = this.getBlocks()\n      return { index: blocks.length - 1, offset: blocks[blocks.length - 1].getLength() }\n    }\n  }\n\n  positionFromLocation(location) {\n    return this.blockList.findPositionAtIndexAndOffset(location.index, location.offset)\n  }\n\n  locationRangeFromPosition(position) {\n    return normalizeRange(this.locationFromPosition(position))\n  }\n\n  locationRangeFromRange(range) {\n    range = normalizeRange(range)\n    if (!range) return\n\n    const [ startPosition, endPosition ] = Array.from(range)\n    const startLocation = this.locationFromPosition(startPosition)\n    const endLocation = this.locationFromPosition(endPosition)\n    return normalizeRange([ startLocation, endLocation ])\n  }\n\n  rangeFromLocationRange(locationRange) {\n    let rightPosition\n    locationRange = normalizeRange(locationRange)\n    const leftPosition = this.positionFromLocation(locationRange[0])\n    if (!rangeIsCollapsed(locationRange)) {\n      rightPosition = this.positionFromLocation(locationRange[1])\n    }\n    return normalizeRange([ leftPosition, rightPosition ])\n  }\n\n  isEqualTo(document) {\n    return this.blockList.isEqualTo(document?.blockList)\n  }\n\n  getTexts() {\n    return this.getBlocks().map((block) => block.text)\n  }\n\n  getPieces() {\n    const pieces = []\n\n    Array.from(this.getTexts()).forEach((text) => {\n      pieces.push(...Array.from(text.getPieces() || []))\n    })\n\n    return pieces\n  }\n\n  getObjects() {\n    return this.getBlocks().concat(this.getTexts()).concat(this.getPieces())\n  }\n\n  toSerializableDocument() {\n    const blocks = []\n    this.blockList.eachObject((block) => blocks.push(block.copyWithText(block.text.toSerializableText())))\n    return new this.constructor(blocks)\n  }\n\n  toString() {\n    return this.blockList.toString()\n  }\n\n  toJSON() {\n    return this.blockList.toJSON()\n  }\n\n  toConsole() {\n    return JSON.stringify(this.blockList.toArray()).map((block) => JSON.parse(block.text.toConsole()))\n  }\n}\n\nconst attributesForBlock = function(block) {\n  const attributes = {}\n  const attributeName = block.getLastAttribute()\n  if (attributeName) {\n    attributes[attributeName] = true\n  }\n  return attributes\n}\n","/* eslint-disable\n    no-undef,\n*/\nimport BasicObject from \"trix/core/basic_object\"\n\nimport { nodeIsAttachmentElement, removeNode, tagName, walkTree } from \"trix/core/helpers\"\n\nconst DEFAULT_ALLOWED_ATTRIBUTES = \"style href src width height class\".split(\" \")\nconst DEFAULT_FORBIDDEN_PROTOCOLS = \"javascript:\".split(\" \")\nconst DEFAULT_FORBIDDEN_ELEMENTS = \"script iframe\".split(\" \")\n\nexport default class HTMLSanitizer extends BasicObject {\n  static sanitize(html, options) {\n    const sanitizer = new this(html, options)\n    sanitizer.sanitize()\n    return sanitizer\n  }\n\n  constructor(html, { allowedAttributes, forbiddenProtocols, forbiddenElements } = {}) {\n    super(...arguments)\n    this.allowedAttributes = allowedAttributes || DEFAULT_ALLOWED_ATTRIBUTES\n    this.forbiddenProtocols = forbiddenProtocols || DEFAULT_FORBIDDEN_PROTOCOLS\n    this.forbiddenElements = forbiddenElements || DEFAULT_FORBIDDEN_ELEMENTS\n    this.body = createBodyElementForHTML(html)\n  }\n\n  sanitize() {\n    this.sanitizeElements()\n    return this.normalizeListElementNesting()\n  }\n\n  getHTML() {\n    return this.body.innerHTML\n  }\n\n  getBody() {\n    return this.body\n  }\n\n  // Private\n\n  sanitizeElements() {\n    const walker = walkTree(this.body)\n    const nodesToRemove = []\n\n    while (walker.nextNode()) {\n      const node = walker.currentNode\n      switch (node.nodeType) {\n        case Node.ELEMENT_NODE:\n          if (this.elementIsRemovable(node)) {\n            nodesToRemove.push(node)\n          } else {\n            this.sanitizeElement(node)\n          }\n          break\n        case Node.COMMENT_NODE:\n          nodesToRemove.push(node)\n          break\n      }\n    }\n\n    nodesToRemove.forEach((node) => removeNode(node))\n\n    return this.body\n  }\n\n  sanitizeElement(element) {\n    if (element.hasAttribute(\"href\")) {\n      if (this.forbiddenProtocols.includes(element.protocol)) {\n        element.removeAttribute(\"href\")\n      }\n    }\n\n    Array.from(element.attributes).forEach(({ name }) => {\n      if (!this.allowedAttributes.includes(name) && name.indexOf(\"data-trix\") !== 0) {\n        element.removeAttribute(name)\n      }\n    })\n\n    return element\n  }\n\n  normalizeListElementNesting() {\n    Array.from(this.body.querySelectorAll(\"ul,ol\")).forEach((listElement) => {\n      const previousElement = listElement.previousElementSibling\n      if (previousElement) {\n        if (tagName(previousElement) === \"li\") {\n          previousElement.appendChild(listElement)\n        }\n      }\n    })\n\n    return this.body\n  }\n\n  elementIsRemovable(element) {\n    if (element?.nodeType !== Node.ELEMENT_NODE) {\n      return\n    }\n    return this.elementIsForbidden(element) || this.elementIsntSerializable(element)\n  }\n\n  elementIsForbidden(element) {\n    return this.forbiddenElements.includes(tagName(element))\n  }\n\n  elementIsntSerializable(element) {\n    return element.getAttribute(\"data-trix-serialize\") === \"false\" && !nodeIsAttachmentElement(element)\n  }\n}\n\nconst createBodyElementForHTML = function(html = \"\") {\n  // Remove everything after </html>\n  html = html.replace(/<\\/html[^>]*>[^]*$/i, \"</html>\")\n  const doc = document.implementation.createHTMLDocument(\"\")\n  doc.documentElement.innerHTML = html\n\n  Array.from(doc.head.querySelectorAll(\"style\")).forEach((element) => {\n    doc.body.appendChild(element)\n  })\n\n  return doc.body\n}\n","/* eslint-disable\n    no-case-declarations,\n    no-irregular-whitespace,\n*/\nimport config from \"trix/config\"\nimport BasicObject from \"trix/core/basic_object\"\nimport Document from \"trix/models/document\"\nimport HTMLSanitizer from \"trix/models/html_sanitizer\"\n\nimport {\n  arraysAreEqual,\n  breakableWhitespacePattern,\n  elementContainsNode,\n  findClosestElementFromNode,\n  getBlockTagNames,\n  makeElement,\n  nodeIsAttachmentElement,\n  normalizeSpaces,\n  removeNode,\n  squishBreakableWhitespace,\n  tagName,\n  walkTree,\n} from \"trix/core/helpers\"\n\nconst pieceForString = (string, attributes = {}) => {\n  const type = \"string\"\n  string = normalizeSpaces(string)\n  return { string, attributes, type }\n}\n\nconst pieceForAttachment = (attachment, attributes = {}) => {\n  const type = \"attachment\"\n  return { attachment, attributes, type }\n}\n\nconst blockForAttributes = (attributes = {}) => {\n  const text = []\n  return { text, attributes }\n}\n\nconst parseTrixDataAttribute = (element, name) => {\n  try {\n    return JSON.parse(element.getAttribute(`data-trix-${name}`))\n  } catch (error) {\n    return {}\n  }\n}\n\nconst getImageDimensions = (element) => {\n  const width = element.getAttribute(\"width\")\n  const height = element.getAttribute(\"height\")\n  const dimensions = {}\n  if (width) {\n    dimensions.width = parseInt(width, 10)\n  }\n  if (height) {\n    dimensions.height = parseInt(height, 10)\n  }\n  return dimensions\n}\n\nexport default class HTMLParser extends BasicObject {\n  static parse(html, options) {\n    const parser = new this(html, options)\n    parser.parse()\n    return parser\n  }\n\n  constructor(html, { referenceElement } = {}) {\n    super(...arguments)\n    this.html = html\n    this.referenceElement = referenceElement\n    this.blocks = []\n    this.blockElements = []\n    this.processedElements = []\n  }\n\n  getDocument() {\n    return Document.fromJSON(this.blocks)\n  }\n\n  // HTML parsing\n\n  parse() {\n    try {\n      this.createHiddenContainer()\n      const html = HTMLSanitizer.sanitize(this.html).getHTML()\n      this.containerElement.innerHTML = html\n      const walker = walkTree(this.containerElement, { usingFilter: nodeFilter })\n      while (walker.nextNode()) {\n        this.processNode(walker.currentNode)\n      }\n      return this.translateBlockElementMarginsToNewlines()\n    } finally {\n      this.removeHiddenContainer()\n    }\n  }\n\n  createHiddenContainer() {\n    if (this.referenceElement) {\n      this.containerElement = this.referenceElement.cloneNode(false)\n      this.containerElement.removeAttribute(\"id\")\n      this.containerElement.setAttribute(\"data-trix-internal\", \"\")\n      this.containerElement.style.display = \"none\"\n      return this.referenceElement.parentNode.insertBefore(this.containerElement, this.referenceElement.nextSibling)\n    } else {\n      this.containerElement = makeElement({ tagName: \"div\", style: { display: \"none\" } })\n      return document.body.appendChild(this.containerElement)\n    }\n  }\n\n  removeHiddenContainer() {\n    return removeNode(this.containerElement)\n  }\n\n  processNode(node) {\n    switch (node.nodeType) {\n      case Node.TEXT_NODE:\n        if (!this.isInsignificantTextNode(node)) {\n          this.appendBlockForTextNode(node)\n          return this.processTextNode(node)\n        }\n        break\n      case Node.ELEMENT_NODE:\n        this.appendBlockForElement(node)\n        return this.processElement(node)\n    }\n  }\n\n  appendBlockForTextNode(node) {\n    const element = node.parentNode\n    if (element === this.currentBlockElement && this.isBlockElement(node.previousSibling)) {\n      return this.appendStringWithAttributes(\"\\n\")\n    } else if (element === this.containerElement || this.isBlockElement(element)) {\n      const attributes = this.getBlockAttributes(element)\n      if (!arraysAreEqual(attributes, this.currentBlock?.attributes)) {\n        this.currentBlock = this.appendBlockForAttributesWithElement(attributes, element)\n        this.currentBlockElement = element\n      }\n    }\n  }\n\n  appendBlockForElement(element) {\n    const elementIsBlockElement = this.isBlockElement(element)\n    const currentBlockContainsElement = elementContainsNode(this.currentBlockElement, element)\n\n    if (elementIsBlockElement && !this.isBlockElement(element.firstChild)) {\n      if (!this.isInsignificantTextNode(element.firstChild) || !this.isBlockElement(element.firstElementChild)) {\n        const attributes = this.getBlockAttributes(element)\n        if (element.firstChild) {\n          if (!(currentBlockContainsElement && arraysAreEqual(attributes, this.currentBlock.attributes))) {\n            this.currentBlock = this.appendBlockForAttributesWithElement(attributes, element)\n            this.currentBlockElement = element\n          } else {\n            return this.appendStringWithAttributes(\"\\n\")\n          }\n        }\n      }\n    } else if (this.currentBlockElement && !currentBlockContainsElement && !elementIsBlockElement) {\n      const parentBlockElement = this.findParentBlockElement(element)\n      if (parentBlockElement) {\n        return this.appendBlockForElement(parentBlockElement)\n      } else {\n        this.currentBlock = this.appendEmptyBlock()\n        this.currentBlockElement = null\n      }\n    }\n  }\n\n  findParentBlockElement(element) {\n    let { parentElement } = element\n    while (parentElement && parentElement !== this.containerElement) {\n      if (this.isBlockElement(parentElement) && this.blockElements.includes(parentElement)) {\n        return parentElement\n      } else {\n        parentElement = parentElement.parentElement\n      }\n    }\n    return null\n  }\n\n  processTextNode(node) {\n    let string = node.data\n    if (!elementCanDisplayPreformattedText(node.parentNode)) {\n      string = squishBreakableWhitespace(string)\n      if (stringEndsWithWhitespace(node.previousSibling?.textContent)) {\n        string = leftTrimBreakableWhitespace(string)\n      }\n    }\n    return this.appendStringWithAttributes(string, this.getTextAttributes(node.parentNode))\n  }\n\n  processElement(element) {\n    let attributes\n    if (nodeIsAttachmentElement(element)) {\n      attributes = parseTrixDataAttribute(element, \"attachment\")\n      if (Object.keys(attributes).length) {\n        const textAttributes = this.getTextAttributes(element)\n        this.appendAttachmentWithAttributes(attributes, textAttributes)\n        // We have everything we need so avoid processing inner nodes\n        element.innerHTML = \"\"\n      }\n      return this.processedElements.push(element)\n    } else {\n      switch (tagName(element)) {\n        case \"br\":\n          if (!this.isExtraBR(element) && !this.isBlockElement(element.nextSibling)) {\n            this.appendStringWithAttributes(\"\\n\", this.getTextAttributes(element))\n          }\n          return this.processedElements.push(element)\n        case \"img\":\n          attributes = { url: element.getAttribute(\"src\"), contentType: \"image\" }\n          const object = getImageDimensions(element)\n          for (const key in object) {\n            const value = object[key]\n            attributes[key] = value\n          }\n          this.appendAttachmentWithAttributes(attributes, this.getTextAttributes(element))\n          return this.processedElements.push(element)\n        case \"tr\":\n          if (element.parentNode.firstChild !== element) {\n            return this.appendStringWithAttributes(\"\\n\")\n          }\n          break\n        case \"td\":\n          if (element.parentNode.firstChild !== element) {\n            return this.appendStringWithAttributes(\" | \")\n          }\n          break\n      }\n    }\n  }\n\n  // Document construction\n\n  appendBlockForAttributesWithElement(attributes, element) {\n    this.blockElements.push(element)\n    const block = blockForAttributes(attributes)\n    this.blocks.push(block)\n    return block\n  }\n\n  appendEmptyBlock() {\n    return this.appendBlockForAttributesWithElement([], null)\n  }\n\n  appendStringWithAttributes(string, attributes) {\n    return this.appendPiece(pieceForString(string, attributes))\n  }\n\n  appendAttachmentWithAttributes(attachment, attributes) {\n    return this.appendPiece(pieceForAttachment(attachment, attributes))\n  }\n\n  appendPiece(piece) {\n    if (this.blocks.length === 0) {\n      this.appendEmptyBlock()\n    }\n    return this.blocks[this.blocks.length - 1].text.push(piece)\n  }\n\n  appendStringToTextAtIndex(string, index) {\n    const { text } = this.blocks[index]\n    const piece = text[text.length - 1]\n\n    if (piece?.type === \"string\") {\n      piece.string += string\n    } else {\n      return text.push(pieceForString(string))\n    }\n  }\n\n  prependStringToTextAtIndex(string, index) {\n    const { text } = this.blocks[index]\n    const piece = text[0]\n\n    if (piece?.type === \"string\") {\n      piece.string = string + piece.string\n    } else {\n      return text.unshift(pieceForString(string))\n    }\n  }\n\n  // Attribute parsing\n\n  getTextAttributes(element) {\n    let value\n    const attributes = {}\n    for (const attribute in config.textAttributes) {\n      const configAttr = config.textAttributes[attribute]\n      if (\n        configAttr.tagName &&\n        findClosestElementFromNode(element, {\n          matchingSelector: configAttr.tagName,\n          untilNode: this.containerElement,\n        })\n      ) {\n        attributes[attribute] = true\n      } else if (configAttr.parser) {\n        value = configAttr.parser(element)\n        if (value) {\n          let attributeInheritedFromBlock = false\n          for (const blockElement of this.findBlockElementAncestors(element)) {\n            if (configAttr.parser(blockElement) === value) {\n              attributeInheritedFromBlock = true\n              break\n            }\n          }\n          if (!attributeInheritedFromBlock) {\n            attributes[attribute] = value\n          }\n        }\n      } else if (configAttr.styleProperty) {\n        value = element.style[configAttr.styleProperty]\n        if (value) {\n          attributes[attribute] = value\n        }\n      }\n    }\n\n    if (nodeIsAttachmentElement(element)) {\n      const object = parseTrixDataAttribute(element, \"attributes\")\n      for (const key in object) {\n        value = object[key]\n        attributes[key] = value\n      }\n    }\n\n    return attributes\n  }\n\n  getBlockAttributes(element) {\n    const attributes = []\n    while (element && element !== this.containerElement) {\n      for (const attribute in config.blockAttributes) {\n        const attrConfig = config.blockAttributes[attribute]\n        if (attrConfig.parse !== false) {\n          if (tagName(element) === attrConfig.tagName) {\n            if (attrConfig.test?.(element) || !attrConfig.test) {\n              attributes.push(attribute)\n              if (attrConfig.listAttribute) {\n                attributes.push(attrConfig.listAttribute)\n              }\n            }\n          }\n        }\n      }\n      element = element.parentNode\n    }\n    return attributes.reverse()\n  }\n\n  findBlockElementAncestors(element) {\n    const ancestors = []\n    while (element && element !== this.containerElement) {\n      const tag = tagName(element)\n      if (getBlockTagNames().includes(tag)) {\n        ancestors.push(element)\n      }\n      element = element.parentNode\n    }\n    return ancestors\n  }\n\n  // Element inspection\n\n  isBlockElement(element) {\n    if (element?.nodeType !== Node.ELEMENT_NODE) {\n      return\n    }\n    if (nodeIsAttachmentElement(element)) {\n      return\n    }\n    if (findClosestElementFromNode(element, { matchingSelector: \"td\", untilNode: this.containerElement })) {\n      return\n    }\n\n    return getBlockTagNames().includes(tagName(element)) ||\n      window.getComputedStyle(element).display === \"block\"\n  }\n\n  isInsignificantTextNode(node) {\n    if (node?.nodeType !== Node.TEXT_NODE) {\n      return\n    }\n    if (!stringIsAllBreakableWhitespace(node.data)) {\n      return\n    }\n    const { parentNode, previousSibling, nextSibling } = node\n    if (nodeEndsWithNonWhitespace(parentNode.previousSibling) && !this.isBlockElement(parentNode.previousSibling)) {\n      return\n    }\n    if (elementCanDisplayPreformattedText(parentNode)) {\n      return\n    }\n    return !previousSibling || this.isBlockElement(previousSibling) || !nextSibling || this.isBlockElement(nextSibling)\n  }\n\n  isExtraBR(element) {\n    return tagName(element) === \"br\" && this.isBlockElement(element.parentNode) && element.parentNode.lastChild === element\n  }\n\n  // Margin translation\n\n  translateBlockElementMarginsToNewlines() {\n    const defaultMargin = this.getMarginOfDefaultBlockElement()\n\n    for (let index = 0; index < this.blocks.length; index++) {\n      const margin = this.getMarginOfBlockElementAtIndex(index)\n      if (margin) {\n        if (margin.top > defaultMargin.top * 2) {\n          this.prependStringToTextAtIndex(\"\\n\", index)\n        }\n\n        if (margin.bottom > defaultMargin.bottom * 2) {\n          this.appendStringToTextAtIndex(\"\\n\", index)\n        }\n      }\n    }\n  }\n\n  getMarginOfBlockElementAtIndex(index) {\n    const element = this.blockElements[index]\n    if (element) {\n      if (element.textContent) {\n        if (!getBlockTagNames().includes(tagName(element)) && !this.processedElements.includes(element)) {\n          return getBlockElementMargin(element)\n        }\n      }\n    }\n  }\n\n  getMarginOfDefaultBlockElement() {\n    const element = makeElement(config.blockAttributes.default.tagName)\n    this.containerElement.appendChild(element)\n    return getBlockElementMargin(element)\n  }\n}\n\n// Helpers\n\nconst elementCanDisplayPreformattedText = function(element) {\n  const { whiteSpace } = window.getComputedStyle(element)\n  return [ \"pre\", \"pre-wrap\", \"pre-line\" ].includes(whiteSpace)\n}\n\nconst nodeEndsWithNonWhitespace = (node) => node && !stringEndsWithWhitespace(node.textContent)\n\nconst getBlockElementMargin = function(element) {\n  const style = window.getComputedStyle(element)\n  if (style.display === \"block\") {\n    return { top: parseInt(style.marginTop), bottom: parseInt(style.marginBottom) }\n  }\n}\n\nconst nodeFilter = function(node) {\n  if (tagName(node) === \"style\") {\n    return NodeFilter.FILTER_REJECT\n  } else {\n    return NodeFilter.FILTER_ACCEPT\n  }\n}\n\n// Whitespace\n\nconst leftTrimBreakableWhitespace = (string) => string.replace(new RegExp(`^${breakableWhitespacePattern.source}+`), \"\")\n\nconst stringIsAllBreakableWhitespace = (string) => new RegExp(`^${breakableWhitespacePattern.source}*$`).test(string)\n\nconst stringEndsWithWhitespace = (string) => /\\s$/.test(string)\n","/* eslint-disable\n    no-empty,\n*/\nimport { removeNode } from \"trix/core/helpers\"\n\nimport DocumentView from \"trix/views/document_view\"\nimport Document from \"trix/models/document\"\nimport HTMLParser from \"trix/models/html_parser\"\n\nconst unserializableElementSelector = \"[data-trix-serialize=false]\"\nconst unserializableAttributeNames = [\n  \"contenteditable\",\n  \"data-trix-id\",\n  \"data-trix-store-key\",\n  \"data-trix-mutable\",\n  \"data-trix-placeholder\",\n  \"tabindex\",\n]\nconst serializedAttributesAttribute = \"data-trix-serialized-attributes\"\nconst serializedAttributesSelector = `[${serializedAttributesAttribute}]`\n\nconst blockCommentPattern = new RegExp(\"<!--block-->\", \"g\")\n\nconst serializers = {\n  \"application/json\": function(serializable) {\n    let document\n    if (serializable instanceof Document) {\n      document = serializable\n    } else if (serializable instanceof HTMLElement) {\n      document = HTMLParser.parse(serializable.innerHTML).getDocument()\n    } else {\n      throw new Error(\"unserializable object\")\n    }\n\n    return document.toSerializableDocument().toJSONString()\n  },\n\n  \"text/html\": function(serializable) {\n    let element\n    if (serializable instanceof Document) {\n      element = DocumentView.render(serializable)\n    } else if (serializable instanceof HTMLElement) {\n      element = serializable.cloneNode(true)\n    } else {\n      throw new Error(\"unserializable object\")\n    }\n\n    // Remove unserializable elements\n    Array.from(element.querySelectorAll(unserializableElementSelector)).forEach((el) => {\n      removeNode(el)\n    })\n\n    // Remove unserializable attributes\n    unserializableAttributeNames.forEach((attribute) => {\n      Array.from(element.querySelectorAll(`[${attribute}]`)).forEach((el) => {\n        el.removeAttribute(attribute)\n      })\n    })\n\n    // Rewrite elements with serialized attribute overrides\n    Array.from(element.querySelectorAll(serializedAttributesSelector)).forEach((el) => {\n      try {\n        const attributes = JSON.parse(el.getAttribute(serializedAttributesAttribute))\n        el.removeAttribute(serializedAttributesAttribute)\n        for (const name in attributes) {\n          const value = attributes[name]\n          el.setAttribute(name, value)\n        }\n      } catch (error) {}\n    })\n\n    return element.innerHTML.replace(blockCommentPattern, \"\")\n  },\n}\n\nconst deserializers = {\n  \"application/json\": function(string) {\n    return Document.fromJSONString(string)\n  },\n\n  \"text/html\": function(string) {\n    return HTMLParser.parse(string).getDocument()\n  },\n}\n\nexport const serializeToContentType = function(serializable, contentType) {\n  const serializer = serializers[contentType]\n  if (serializer) {\n    return serializer(serializable)\n  } else {\n    throw new Error(`unknown content type: ${contentType}`)\n  }\n}\n\nexport const deserializeFromContentType = function(string, contentType) {\n  const deserializer = deserializers[contentType]\n  if (deserializer) {\n    return deserializer(string)\n  } else {\n    throw new Error(`unknown content type: ${contentType}`)\n  }\n}\n","import BasicObject from \"trix/core/basic_object\"\n\nimport {\n  findClosestElementFromNode,\n  nodeIsBlockStartComment,\n  nodeIsEmptyTextNode,\n  normalizeSpaces,\n  summarizeStringChange,\n  tagName,\n} from \"trix/core/helpers\"\n\nconst mutableAttributeName = \"data-trix-mutable\"\nconst mutableSelector = `[${mutableAttributeName}]`\n\nconst options = {\n  attributes: true,\n  childList: true,\n  characterData: true,\n  characterDataOldValue: true,\n  subtree: true,\n}\n\nexport default class MutationObserver extends BasicObject {\n  constructor(element) {\n    super(element)\n    this.didMutate = this.didMutate.bind(this)\n    this.element = element\n    this.observer = new window.MutationObserver(this.didMutate)\n    this.start()\n  }\n\n  start() {\n    this.reset()\n    return this.observer.observe(this.element, options)\n  }\n\n  stop() {\n    return this.observer.disconnect()\n  }\n\n  didMutate(mutations) {\n    this.mutations.push(...Array.from(this.findSignificantMutations(mutations) || []))\n\n    if (this.mutations.length) {\n      this.delegate?.elementDidMutate?.(this.getMutationSummary())\n      return this.reset()\n    }\n  }\n\n  // Private\n\n  reset() {\n    this.mutations = []\n  }\n\n  findSignificantMutations(mutations) {\n    return mutations.filter((mutation) => {\n      return this.mutationIsSignificant(mutation)\n    })\n  }\n\n  mutationIsSignificant(mutation) {\n    if (this.nodeIsMutable(mutation.target)) {\n      return false\n    }\n    for (const node of Array.from(this.nodesModifiedByMutation(mutation))) {\n      if (this.nodeIsSignificant(node)) return true\n    }\n    return false\n  }\n\n  nodeIsSignificant(node) {\n    return node !== this.element && !this.nodeIsMutable(node) && !nodeIsEmptyTextNode(node)\n  }\n\n  nodeIsMutable(node) {\n    return findClosestElementFromNode(node, { matchingSelector: mutableSelector })\n  }\n\n  nodesModifiedByMutation(mutation) {\n    const nodes = []\n    switch (mutation.type) {\n      case \"attributes\":\n        if (mutation.attributeName !== mutableAttributeName) {\n          nodes.push(mutation.target)\n        }\n        break\n      case \"characterData\":\n        // Changes to text nodes should consider the parent element\n        nodes.push(mutation.target.parentNode)\n        nodes.push(mutation.target)\n        break\n      case \"childList\":\n        // Consider each added or removed node\n        nodes.push(...Array.from(mutation.addedNodes || []))\n        nodes.push(...Array.from(mutation.removedNodes || []))\n        break\n    }\n    return nodes\n  }\n\n  getMutationSummary() {\n    return this.getTextMutationSummary()\n  }\n\n  getTextMutationSummary() {\n    const { additions, deletions } = this.getTextChangesFromCharacterData()\n    const textChanges = this.getTextChangesFromChildList()\n\n    Array.from(textChanges.additions).forEach((addition) => {\n      if (!Array.from(additions).includes(addition)) {\n        additions.push(addition)\n      }\n    })\n\n    deletions.push(...Array.from(textChanges.deletions || []))\n\n    const summary = {}\n\n    const added = additions.join(\"\")\n    if (added) {\n      summary.textAdded = added\n    }\n\n    const deleted = deletions.join(\"\")\n    if (deleted) {\n      summary.textDeleted = deleted\n    }\n\n    return summary\n  }\n\n  getMutationsByType(type) {\n    return Array.from(this.mutations).filter((mutation) => mutation.type === type)\n  }\n\n  getTextChangesFromChildList() {\n    let textAdded, textRemoved\n    const addedNodes = []\n    const removedNodes = []\n\n    Array.from(this.getMutationsByType(\"childList\")).forEach((mutation) => {\n      addedNodes.push(...Array.from(mutation.addedNodes || []))\n      removedNodes.push(...Array.from(mutation.removedNodes || []))\n    })\n\n    const singleBlockCommentRemoved =\n      addedNodes.length === 0 && removedNodes.length === 1 && nodeIsBlockStartComment(removedNodes[0])\n\n    if (singleBlockCommentRemoved) {\n      textAdded = []\n      textRemoved = [ \"\\n\" ]\n    } else {\n      textAdded = getTextForNodes(addedNodes)\n      textRemoved = getTextForNodes(removedNodes)\n    }\n\n    const additions = textAdded.filter((text, index) => text !== textRemoved[index]).map(normalizeSpaces)\n    const deletions = textRemoved.filter((text, index) => text !== textAdded[index]).map(normalizeSpaces)\n\n    return { additions, deletions }\n  }\n\n  getTextChangesFromCharacterData() {\n    let added, removed\n    const characterMutations = this.getMutationsByType(\"characterData\")\n\n    if (characterMutations.length) {\n      const startMutation = characterMutations[0],\n        endMutation = characterMutations[characterMutations.length - 1]\n\n      const oldString = normalizeSpaces(startMutation.oldValue)\n      const newString = normalizeSpaces(endMutation.target.data)\n      const summarized = summarizeStringChange(oldString, newString)\n      added = summarized.added\n      removed = summarized.removed\n    }\n\n    return {\n      additions: added ? [ added ] : [],\n      deletions: removed ? [ removed ] : [],\n    }\n  }\n}\n\nconst getTextForNodes = function(nodes = []) {\n  const text = []\n  for (const node of Array.from(nodes)) {\n    switch (node.nodeType) {\n      case Node.TEXT_NODE:\n        text.push(node.data)\n        break\n      case Node.ELEMENT_NODE:\n        if (tagName(node) === \"br\") {\n          text.push(\"\\n\")\n        } else {\n          text.push(...Array.from(getTextForNodes(node.childNodes) || []))\n        }\n        break\n    }\n  }\n  return text\n}\n","import \"trix/views/object_view\"\nimport BasicObject from \"trix/core/basic_object\"\n\nexport default class Controller extends BasicObject {}\n","/* eslint-disable\n    no-empty,\n*/\nimport Operation from \"trix/core/utilities/operation\"\n\nexport default class FileVerificationOperation extends Operation {\n  constructor(file) {\n    super(...arguments)\n    this.file = file\n  }\n\n  perform(callback) {\n    const reader = new FileReader()\n\n    reader.onerror = () => callback(false)\n\n    reader.onload = () => {\n      reader.onerror = null\n      try {\n        reader.abort()\n      } catch (error) {}\n      return callback(true, this.file)\n    }\n\n    return reader.readAsArrayBuffer(this.file)\n  }\n}\n","import BasicObject from \"trix/core/basic_object\"\nimport MutationObserver from \"trix/observers/mutation_observer\"\nimport FileVerificationOperation from \"trix/operations/file_verification_operation\"\n\nimport { handleEvent, innerElementIsActive } from \"trix/core/helpers\"\n\nexport default class InputController extends BasicObject {\n\n  static events = {}\n\n  constructor(element) {\n    super(...arguments)\n    this.element = element\n    this.mutationObserver = new MutationObserver(this.element)\n    this.mutationObserver.delegate = this\n    for (const eventName in this.constructor.events) {\n      handleEvent(eventName, { onElement: this.element, withCallback: this.handlerFor(eventName) })\n    }\n  }\n\n  elementDidMutate(mutationSummary) {}\n\n  editorWillSyncDocumentView() {\n    return this.mutationObserver.stop()\n  }\n\n  editorDidSyncDocumentView() {\n    return this.mutationObserver.start()\n  }\n\n  requestRender() {\n    return this.delegate?.inputControllerDidRequestRender?.()\n  }\n\n  requestReparse() {\n    this.delegate?.inputControllerDidRequestReparse?.()\n    return this.requestRender()\n  }\n\n  attachFiles(files) {\n    const operations = Array.from(files).map((file) => new FileVerificationOperation(file))\n    return Promise.all(operations).then((files) => {\n      this.handleInput(function() {\n        this.delegate?.inputControllerWillAttachFiles()\n        this.responder?.insertFiles(files)\n        return this.requestRender()\n      })\n    })\n  }\n\n  // Private\n\n  handlerFor(eventName) {\n    return (event) => {\n      if (!event.defaultPrevented) {\n        this.handleInput(() => {\n          if (!innerElementIsActive(this.element)) {\n            this.eventName = eventName\n            this.constructor.events[eventName].call(this, event)\n          }\n        })\n      }\n    }\n  }\n\n  handleInput(callback) {\n    try {\n      this.delegate?.inputControllerWillHandleInput()\n      callback.call(this)\n    } finally {\n      this.delegate?.inputControllerDidHandleInput()\n    }\n  }\n\n  createLinkHTML(href, text) {\n    const link = document.createElement(\"a\")\n    link.href = href\n    link.textContent = text ? text : href\n    return link.outerHTML\n  }\n}\n\n","import config from \"trix/config\"\nimport UTF16String from \"trix/core/utilities/utf16_string\"\nimport BasicObject from \"trix/core/basic_object\"\nimport InputController from \"trix/controllers/input_controller\"\nimport DocumentView from \"trix/views/document_view\"\nimport Document from \"trix/models/document\"\n\nimport {\n  dataTransferIsPlainText,\n  dataTransferIsWritable,\n  keyEventIsKeyboardCommand,\n  makeElement,\n  objectsAreEqual,\n  removeNode,\n  squishBreakableWhitespace,\n} from \"trix/core/helpers\"\n\nimport { selectionChangeObserver } from \"trix/observers/selection_change_observer\"\n\nconst { browser, keyNames } = config\nlet pastedFileCount = 0\n\nexport default class Level0InputController extends InputController {\n\n  static events = {\n    keydown(event) {\n      if (!this.isComposing()) {\n        this.resetInputSummary()\n      }\n      this.inputSummary.didInput = true\n\n      const keyName = keyNames[event.keyCode]\n      if (keyName) {\n        let context = this.keys\n\n        ;[ \"ctrl\", \"alt\", \"shift\", \"meta\" ].forEach((modifier) => {\n          if (event[`${modifier}Key`]) {\n            if (modifier === \"ctrl\") {\n              modifier = \"control\"\n            }\n            context = context?.[modifier]\n          }\n        })\n\n        if (context?.[keyName] != null) {\n          this.setInputSummary({ keyName })\n          selectionChangeObserver.reset()\n          context[keyName].call(this, event)\n        }\n      }\n\n      if (keyEventIsKeyboardCommand(event)) {\n        const character = String.fromCharCode(event.keyCode).toLowerCase()\n        if (character) {\n          const keys = [ \"alt\", \"shift\" ].map((modifier) => {\n            if (event[`${modifier}Key`]) {\n              return modifier\n            }\n          }).filter(key => key)\n          keys.push(character)\n          if (this.delegate?.inputControllerDidReceiveKeyboardCommand(keys)) {\n            event.preventDefault()\n          }\n        }\n      }\n    },\n\n    keypress(event) {\n      if (this.inputSummary.eventName != null) return\n      if (event.metaKey) return\n      if (event.ctrlKey && !event.altKey) return\n\n      const string = stringFromKeyEvent(event)\n      if (string) {\n        this.delegate?.inputControllerWillPerformTyping()\n        this.responder?.insertString(string)\n        return this.setInputSummary({ textAdded: string, didDelete: this.selectionIsExpanded() })\n      }\n    },\n\n    textInput(event) {\n      // Handle autocapitalization\n      const { data } = event\n      const { textAdded } = this.inputSummary\n      if (textAdded && textAdded !== data && textAdded.toUpperCase() === data) {\n        const range = this.getSelectedRange()\n        this.setSelectedRange([ range[0], range[1] + textAdded.length ])\n        this.responder?.insertString(data)\n        this.setInputSummary({ textAdded: data })\n        return this.setSelectedRange(range)\n      }\n    },\n\n    dragenter(event) {\n      event.preventDefault()\n    },\n\n    dragstart(event) {\n      this.serializeSelectionToDataTransfer(event.dataTransfer)\n      this.draggedRange = this.getSelectedRange()\n      return this.delegate?.inputControllerDidStartDrag?.()\n    },\n\n    dragover(event) {\n      if (this.draggedRange || this.canAcceptDataTransfer(event.dataTransfer)) {\n        event.preventDefault()\n        const draggingPoint = { x: event.clientX, y: event.clientY }\n        if (!objectsAreEqual(draggingPoint, this.draggingPoint)) {\n          this.draggingPoint = draggingPoint\n          return this.delegate?.inputControllerDidReceiveDragOverPoint?.(this.draggingPoint)\n        }\n      }\n    },\n\n    dragend(event) {\n      this.delegate?.inputControllerDidCancelDrag?.()\n      this.draggedRange = null\n      this.draggingPoint = null\n    },\n\n    drop(event) {\n      event.preventDefault()\n      const files = event.dataTransfer?.files\n      const documentJSON = event.dataTransfer.getData(\"application/x-trix-document\")\n\n      const point = { x: event.clientX, y: event.clientY }\n      this.responder?.setLocationRangeFromPointRange(point)\n\n      if (files?.length) {\n        this.attachFiles(files)\n      } else if (this.draggedRange) {\n        this.delegate?.inputControllerWillMoveText()\n        this.responder?.moveTextFromRange(this.draggedRange)\n        this.draggedRange = null\n        this.requestRender()\n      } else if (documentJSON) {\n        const document = Document.fromJSONString(documentJSON)\n        this.responder?.insertDocument(document)\n        this.requestRender()\n      }\n\n      this.draggedRange = null\n      this.draggingPoint = null\n    },\n\n    cut(event) {\n      if (this.responder?.selectionIsExpanded()) {\n        if (this.serializeSelectionToDataTransfer(event.clipboardData)) {\n          event.preventDefault()\n        }\n\n        this.delegate?.inputControllerWillCutText()\n        this.deleteInDirection(\"backward\")\n        if (event.defaultPrevented) {\n          return this.requestRender()\n        }\n      }\n    },\n\n    copy(event) {\n      if (this.responder?.selectionIsExpanded()) {\n        if (this.serializeSelectionToDataTransfer(event.clipboardData)) {\n          event.preventDefault()\n        }\n      }\n    },\n\n    paste(event) {\n      const clipboard = event.clipboardData || event.testClipboardData\n      const paste = { clipboard }\n\n      if (!clipboard || pasteEventIsCrippledSafariHTMLPaste(event)) {\n        this.getPastedHTMLUsingHiddenElement((html) => {\n          paste.type = \"text/html\"\n          paste.html = html\n          this.delegate?.inputControllerWillPaste(paste)\n          this.responder?.insertHTML(paste.html)\n          this.requestRender()\n          return this.delegate?.inputControllerDidPaste(paste)\n        })\n        return\n      }\n\n      const href = clipboard.getData(\"URL\")\n      const html = clipboard.getData(\"text/html\")\n      const name = clipboard.getData(\"public.url-name\")\n\n      if (href) {\n        let string\n        paste.type = \"text/html\"\n        if (name) {\n          string = squishBreakableWhitespace(name).trim()\n        } else {\n          string = href\n        }\n        paste.html = this.createLinkHTML(href, string)\n        this.delegate?.inputControllerWillPaste(paste)\n        this.setInputSummary({ textAdded: string, didDelete: this.selectionIsExpanded() })\n        this.responder?.insertHTML(paste.html)\n        this.requestRender()\n        this.delegate?.inputControllerDidPaste(paste)\n      } else if (dataTransferIsPlainText(clipboard)) {\n        paste.type = \"text/plain\"\n        paste.string = clipboard.getData(\"text/plain\")\n        this.delegate?.inputControllerWillPaste(paste)\n        this.setInputSummary({ textAdded: paste.string, didDelete: this.selectionIsExpanded() })\n        this.responder?.insertString(paste.string)\n        this.requestRender()\n        this.delegate?.inputControllerDidPaste(paste)\n      } else if (html) {\n        paste.type = \"text/html\"\n        paste.html = html\n        this.delegate?.inputControllerWillPaste(paste)\n        this.responder?.insertHTML(paste.html)\n        this.requestRender()\n        this.delegate?.inputControllerDidPaste(paste)\n      } else if (Array.from(clipboard.types).includes(\"Files\")) {\n        const file = clipboard.items?.[0]?.getAsFile?.()\n        if (file) {\n          const extension = extensionForFile(file)\n          if (!file.name && extension) {\n            file.name = `pasted-file-${++pastedFileCount}.${extension}`\n          }\n          paste.type = \"File\"\n          paste.file = file\n          this.delegate?.inputControllerWillAttachFiles()\n          this.responder?.insertFile(paste.file)\n          this.requestRender()\n          this.delegate?.inputControllerDidPaste(paste)\n        }\n      }\n\n      event.preventDefault()\n    },\n\n    compositionstart(event) {\n      return this.getCompositionInput().start(event.data)\n    },\n\n    compositionupdate(event) {\n      return this.getCompositionInput().update(event.data)\n    },\n\n    compositionend(event) {\n      return this.getCompositionInput().end(event.data)\n    },\n\n    beforeinput(event) {\n      this.inputSummary.didInput = true\n    },\n\n    input(event) {\n      this.inputSummary.didInput = true\n      return event.stopPropagation()\n    },\n  }\n\n  static keys = {\n    backspace(event) {\n      this.delegate?.inputControllerWillPerformTyping()\n      return this.deleteInDirection(\"backward\", event)\n    },\n\n    delete(event) {\n      this.delegate?.inputControllerWillPerformTyping()\n      return this.deleteInDirection(\"forward\", event)\n    },\n\n    return(event) {\n      this.setInputSummary({ preferDocument: true })\n      this.delegate?.inputControllerWillPerformTyping()\n      return this.responder?.insertLineBreak()\n    },\n\n    tab(event) {\n      if (this.responder?.canIncreaseNestingLevel()) {\n        this.responder?.increaseNestingLevel()\n        this.requestRender()\n        event.preventDefault()\n      }\n    },\n\n    left(event) {\n      if (this.selectionIsInCursorTarget()) {\n        event.preventDefault()\n        return this.responder?.moveCursorInDirection(\"backward\")\n      }\n    },\n\n    right(event) {\n      if (this.selectionIsInCursorTarget()) {\n        event.preventDefault()\n        return this.responder?.moveCursorInDirection(\"forward\")\n      }\n    },\n\n    control: {\n      d(event) {\n        this.delegate?.inputControllerWillPerformTyping()\n        return this.deleteInDirection(\"forward\", event)\n      },\n\n      h(event) {\n        this.delegate?.inputControllerWillPerformTyping()\n        return this.deleteInDirection(\"backward\", event)\n      },\n\n      o(event) {\n        event.preventDefault()\n        this.delegate?.inputControllerWillPerformTyping()\n        this.responder?.insertString(\"\\n\", { updatePosition: false })\n        return this.requestRender()\n      },\n    },\n\n    shift: {\n      return(event) {\n        this.delegate?.inputControllerWillPerformTyping()\n        this.responder?.insertString(\"\\n\")\n        this.requestRender()\n        event.preventDefault()\n      },\n\n      tab(event) {\n        if (this.responder?.canDecreaseNestingLevel()) {\n          this.responder?.decreaseNestingLevel()\n          this.requestRender()\n          event.preventDefault()\n        }\n      },\n\n      left(event) {\n        if (this.selectionIsInCursorTarget()) {\n          event.preventDefault()\n          return this.expandSelectionInDirection(\"backward\")\n        }\n      },\n\n      right(event) {\n        if (this.selectionIsInCursorTarget()) {\n          event.preventDefault()\n          return this.expandSelectionInDirection(\"forward\")\n        }\n      },\n    },\n\n    alt: {\n      backspace(event) {\n        this.setInputSummary({ preferDocument: false })\n        return this.delegate?.inputControllerWillPerformTyping()\n      },\n    },\n\n    meta: {\n      backspace(event) {\n        this.setInputSummary({ preferDocument: false })\n        return this.delegate?.inputControllerWillPerformTyping()\n      },\n    },\n  }\n\n  constructor() {\n    super(...arguments)\n    this.resetInputSummary()\n  }\n\n  setInputSummary(summary = {}) {\n    this.inputSummary.eventName = this.eventName\n    for (const key in summary) {\n      const value = summary[key]\n      this.inputSummary[key] = value\n    }\n    return this.inputSummary\n  }\n\n  resetInputSummary() {\n    this.inputSummary = {}\n  }\n\n  reset() {\n    this.resetInputSummary()\n    return selectionChangeObserver.reset()\n  }\n\n  // Mutation observer delegate\n\n  elementDidMutate(mutationSummary) {\n    if (this.isComposing()) {\n      return this.delegate?.inputControllerDidAllowUnhandledInput?.()\n    } else {\n      return this.handleInput(function() {\n        if (this.mutationIsSignificant(mutationSummary)) {\n          if (this.mutationIsExpected(mutationSummary)) {\n            this.requestRender()\n          } else {\n            this.requestReparse()\n          }\n        }\n        return this.reset()\n      })\n    }\n  }\n\n  mutationIsExpected({ textAdded, textDeleted }) {\n    if (this.inputSummary.preferDocument) {\n      return true\n    }\n\n    const mutationAdditionMatchesSummary =\n      textAdded != null ? textAdded === this.inputSummary.textAdded : !this.inputSummary.textAdded\n    const mutationDeletionMatchesSummary =\n      textDeleted != null ? this.inputSummary.didDelete : !this.inputSummary.didDelete\n\n    const unexpectedNewlineAddition = [ \"\\n\", \" \\n\" ].includes(textAdded) && !mutationAdditionMatchesSummary\n    const unexpectedNewlineDeletion = textDeleted === \"\\n\" && !mutationDeletionMatchesSummary\n    const singleUnexpectedNewline =\n      unexpectedNewlineAddition && !unexpectedNewlineDeletion ||\n      unexpectedNewlineDeletion && !unexpectedNewlineAddition\n\n    if (singleUnexpectedNewline) {\n      const range = this.getSelectedRange()\n      if (range) {\n        const offset = unexpectedNewlineAddition ? textAdded.replace(/\\n$/, \"\").length || -1 : textAdded?.length || 1\n        if (this.responder?.positionIsBlockBreak(range[1] + offset)) {\n          return true\n        }\n      }\n    }\n\n    return mutationAdditionMatchesSummary && mutationDeletionMatchesSummary\n  }\n\n  mutationIsSignificant(mutationSummary) {\n    const textChanged = Object.keys(mutationSummary).length > 0\n    const composedEmptyString = this.compositionInput?.getEndData() === \"\"\n    return textChanged || !composedEmptyString\n  }\n\n  // Private\n\n  getCompositionInput() {\n    if (this.isComposing()) {\n      return this.compositionInput\n    } else {\n      this.compositionInput = new CompositionInput(this)\n    }\n  }\n\n  isComposing() {\n    return this.compositionInput && !this.compositionInput.isEnded()\n  }\n\n  deleteInDirection(direction, event) {\n    if (this.responder?.deleteInDirection(direction) === false) {\n      if (event) {\n        event.preventDefault()\n        return this.requestRender()\n      }\n    } else {\n      return this.setInputSummary({ didDelete: true })\n    }\n  }\n\n  serializeSelectionToDataTransfer(dataTransfer) {\n    if (!dataTransferIsWritable(dataTransfer)) {\n      return\n    }\n    const document = this.responder?.getSelectedDocument().toSerializableDocument()\n\n    dataTransfer.setData(\"application/x-trix-document\", JSON.stringify(document))\n    dataTransfer.setData(\"text/html\", DocumentView.render(document).innerHTML)\n    dataTransfer.setData(\"text/plain\", document.toString().replace(/\\n$/, \"\"))\n    return true\n  }\n\n  canAcceptDataTransfer(dataTransfer) {\n    const types = {}\n    Array.from(dataTransfer?.types || []).forEach((type) => {\n      types[type] = true\n    })\n    return types.Files || types[\"application/x-trix-document\"] || types[\"text/html\"] || types[\"text/plain\"]\n  }\n\n  getPastedHTMLUsingHiddenElement(callback) {\n    const selectedRange = this.getSelectedRange()\n\n    const style = {\n      position: \"absolute\",\n      left: `${window.pageXOffset}px`,\n      top: `${window.pageYOffset}px`,\n      opacity: 0,\n    }\n\n    const element = makeElement({ style, tagName: \"div\", editable: true })\n    document.body.appendChild(element)\n    element.focus()\n\n    return requestAnimationFrame(() => {\n      const html = element.innerHTML\n      removeNode(element)\n      this.setSelectedRange(selectedRange)\n      return callback(html)\n    })\n  }\n}\n\nLevel0InputController.proxyMethod(\"responder?.getSelectedRange\")\nLevel0InputController.proxyMethod(\"responder?.setSelectedRange\")\nLevel0InputController.proxyMethod(\"responder?.expandSelectionInDirection\")\nLevel0InputController.proxyMethod(\"responder?.selectionIsInCursorTarget\")\nLevel0InputController.proxyMethod(\"responder?.selectionIsExpanded\")\n\nconst extensionForFile = (file) => file.type?.match(/\\/(\\w+)$/)?.[1]\n\nconst hasStringCodePointAt = !!\" \".codePointAt?.(0)\n\nconst stringFromKeyEvent = function(event) {\n  if (event.key && hasStringCodePointAt && event.key.codePointAt(0) === event.keyCode) {\n    return event.key\n  } else {\n    let code\n    if (event.which === null) {\n      code = event.keyCode\n    } else if (event.which !== 0 && event.charCode !== 0) {\n      code = event.charCode\n    }\n\n    if (code != null && keyNames[code] !== \"escape\") {\n      return UTF16String.fromCodepoints([ code ]).toString()\n    }\n  }\n}\n\nconst pasteEventIsCrippledSafariHTMLPaste = function(event) {\n  const paste = event.clipboardData\n  if (paste) {\n    if (paste.types.includes(\"text/html\")) {\n      // Answer is yes if there's any possibility of Paste and Match Style in Safari,\n      // which is nearly impossible to detect confidently: https://bugs.webkit.org/show_bug.cgi?id=174165\n      for (const type of paste.types) {\n        const hasPasteboardFlavor = /^CorePasteboardFlavorType/.test(type)\n        const hasReadableDynamicData = /^dyn\\./.test(type) && paste.getData(type)\n        const mightBePasteAndMatchStyle = hasPasteboardFlavor || hasReadableDynamicData\n        if (mightBePasteAndMatchStyle) {\n          return true\n        }\n      }\n      return false\n    } else {\n      const isExternalHTMLPaste = paste.types.includes(\"com.apple.webarchive\")\n      const isExternalRichTextPaste = paste.types.includes(\"com.apple.flat-rtfd\")\n      return isExternalHTMLPaste || isExternalRichTextPaste\n    }\n  }\n}\n\nclass CompositionInput extends BasicObject {\n  constructor(inputController) {\n    super(...arguments)\n    this.inputController = inputController\n    this.responder = this.inputController.responder\n    this.delegate = this.inputController.delegate\n    this.inputSummary = this.inputController.inputSummary\n    this.data = {}\n  }\n\n  start(data) {\n    this.data.start = data\n\n    if (this.isSignificant()) {\n      if (this.inputSummary.eventName === \"keypress\" && this.inputSummary.textAdded) {\n        this.responder?.deleteInDirection(\"left\")\n      }\n\n      if (!this.selectionIsExpanded()) {\n        this.insertPlaceholder()\n        this.requestRender()\n      }\n\n      this.range = this.responder?.getSelectedRange()\n    }\n  }\n\n  update(data) {\n    this.data.update = data\n\n    if (this.isSignificant()) {\n      const range = this.selectPlaceholder()\n      if (range) {\n        this.forgetPlaceholder()\n        this.range = range\n      }\n    }\n  }\n\n  end(data) {\n    this.data.end = data\n\n    if (this.isSignificant()) {\n      this.forgetPlaceholder()\n\n      if (this.canApplyToDocument()) {\n        this.setInputSummary({ preferDocument: true, didInput: false })\n        this.delegate?.inputControllerWillPerformTyping()\n        this.responder?.setSelectedRange(this.range)\n        this.responder?.insertString(this.data.end)\n        return this.responder?.setSelectedRange(this.range[0] + this.data.end.length)\n      } else if (this.data.start != null || this.data.update != null) {\n        this.requestReparse()\n        return this.inputController.reset()\n      }\n    } else {\n      return this.inputController.reset()\n    }\n  }\n\n  getEndData() {\n    return this.data.end\n  }\n\n  isEnded() {\n    return this.getEndData() != null\n  }\n\n  isSignificant() {\n    if (browser.composesExistingText) {\n      return this.inputSummary.didInput\n    } else {\n      return true\n    }\n  }\n\n  // Private\n\n  canApplyToDocument() {\n    return this.data.start?.length === 0 && this.data.end?.length > 0 && this.range\n  }\n}\n\nCompositionInput.proxyMethod(\"inputController.setInputSummary\")\nCompositionInput.proxyMethod(\"inputController.requestRender\")\nCompositionInput.proxyMethod(\"inputController.requestReparse\")\nCompositionInput.proxyMethod(\"responder?.selectionIsExpanded\")\nCompositionInput.proxyMethod(\"responder?.insertPlaceholder\")\nCompositionInput.proxyMethod(\"responder?.selectPlaceholder\")\nCompositionInput.proxyMethod(\"responder?.forgetPlaceholder\")\n","import { getAllAttributeNames, squishBreakableWhitespace } from \"trix/core/helpers\"\nimport InputController from \"trix/controllers/input_controller\"\n\nimport { dataTransferIsPlainText, keyEventIsKeyboardCommand, objectsAreEqual } from \"trix/core/helpers\"\n\nimport { selectionChangeObserver } from \"trix/observers/selection_change_observer\"\n\nexport default class Level2InputController extends InputController {\n  constructor(...args) {\n    super(...args)\n    this.render = this.render.bind(this)\n  }\n\n  static events = {\n    keydown(event) {\n      if (keyEventIsKeyboardCommand(event)) {\n        const command = keyboardCommandFromKeyEvent(event)\n        if (this.delegate?.inputControllerDidReceiveKeyboardCommand(command)) {\n          event.preventDefault()\n        }\n      } else {\n        let name = event.key\n        if (event.altKey) {\n          name += \"+Alt\"\n        }\n        if (event.shiftKey) {\n          name += \"+Shift\"\n        }\n        const handler = this.constructor.keys[name]\n        if (handler) {\n          return this.withEvent(event, handler)\n        }\n      }\n    },\n\n    // Handle paste event to work around beforeinput.insertFromPaste browser bugs.\n    // Safe to remove each condition once fixed upstream.\n    paste(event) {\n      // https://bugs.webkit.org/show_bug.cgi?id=194921\n      let paste\n      const href = event.clipboardData?.getData(\"URL\")\n      if (pasteEventHasFilesOnly(event)) {\n        event.preventDefault()\n        return this.attachFiles(event.clipboardData.files)\n\n        // https://bugs.chromium.org/p/chromium/issues/detail?id=934448\n      } else if (pasteEventHasPlainTextOnly(event)) {\n        event.preventDefault()\n        paste = {\n          type: \"text/plain\",\n          string: event.clipboardData.getData(\"text/plain\"),\n        }\n        this.delegate?.inputControllerWillPaste(paste)\n        this.responder?.insertString(paste.string)\n        this.render()\n        return this.delegate?.inputControllerDidPaste(paste)\n\n        // https://bugs.webkit.org/show_bug.cgi?id=196702\n      } else if (href) {\n        event.preventDefault()\n        paste = {\n          type: \"text/html\",\n          html: this.createLinkHTML(href),\n        }\n        this.delegate?.inputControllerWillPaste(paste)\n        this.responder?.insertHTML(paste.html)\n        this.render()\n        return this.delegate?.inputControllerDidPaste(paste)\n      }\n    },\n\n    beforeinput(event) {\n      const handler = this.constructor.inputTypes[event.inputType]\n      if (handler) {\n        this.withEvent(event, handler)\n        return this.scheduleRender()\n      }\n    },\n\n    input(event) {\n      return selectionChangeObserver.reset()\n    },\n\n    dragstart(event) {\n      if (this.responder?.selectionContainsAttachments()) {\n        event.dataTransfer.setData(\"application/x-trix-dragging\", true)\n\n        this.dragging = {\n          range: this.responder?.getSelectedRange(),\n          point: pointFromEvent(event),\n        }\n      }\n    },\n\n    dragenter(event) {\n      if (dragEventHasFiles(event)) {\n        event.preventDefault()\n      }\n    },\n\n    dragover(event) {\n      if (this.dragging) {\n        event.preventDefault()\n        const point = pointFromEvent(event)\n        if (!objectsAreEqual(point, this.dragging.point)) {\n          this.dragging.point = point\n          return this.responder?.setLocationRangeFromPointRange(point)\n        }\n      } else if (dragEventHasFiles(event)) {\n        event.preventDefault()\n      }\n    },\n\n    drop(event) {\n      if (this.dragging) {\n        event.preventDefault()\n        this.delegate?.inputControllerWillMoveText()\n        this.responder?.moveTextFromRange(this.dragging.range)\n        this.dragging = null\n        return this.scheduleRender()\n      } else if (dragEventHasFiles(event)) {\n        event.preventDefault()\n        const point = pointFromEvent(event)\n        this.responder?.setLocationRangeFromPointRange(point)\n        return this.attachFiles(event.dataTransfer.files)\n      }\n    },\n\n    dragend() {\n      if (this.dragging) {\n        this.responder?.setSelectedRange(this.dragging.range)\n        this.dragging = null\n      }\n    },\n\n    compositionend(event) {\n      if (this.composing) {\n        this.composing = false\n        return this.scheduleRender()\n      }\n    },\n  }\n\n  static keys = {\n    ArrowLeft() {\n      if (this.responder?.shouldManageMovingCursorInDirection(\"backward\")) {\n        this.event.preventDefault()\n        return this.responder?.moveCursorInDirection(\"backward\")\n      }\n    },\n\n    ArrowRight() {\n      if (this.responder?.shouldManageMovingCursorInDirection(\"forward\")) {\n        this.event.preventDefault()\n        return this.responder?.moveCursorInDirection(\"forward\")\n      }\n    },\n\n    Backspace() {\n      if (this.responder?.shouldManageDeletingInDirection(\"backward\")) {\n        this.event.preventDefault()\n        this.delegate?.inputControllerWillPerformTyping()\n        this.responder?.deleteInDirection(\"backward\")\n        return this.render()\n      }\n    },\n\n    Tab() {\n      if (this.responder?.canIncreaseNestingLevel()) {\n        this.event.preventDefault()\n        this.responder?.increaseNestingLevel()\n        return this.render()\n      }\n    },\n\n    \"Tab+Shift\"() {\n      if (this.responder?.canDecreaseNestingLevel()) {\n        this.event.preventDefault()\n        this.responder?.decreaseNestingLevel()\n        return this.render()\n      }\n    },\n  }\n\n  static inputTypes = {\n    deleteByComposition() {\n      return this.deleteInDirection(\"backward\", { recordUndoEntry: false })\n    },\n\n    deleteByCut() {\n      return this.deleteInDirection(\"backward\")\n    },\n\n    deleteByDrag() {\n      this.event.preventDefault()\n      return this.withTargetDOMRange(function() {\n        this.deleteByDragRange = this.responder?.getSelectedRange()\n      })\n    },\n\n    deleteCompositionText() {\n      return this.deleteInDirection(\"backward\", { recordUndoEntry: false })\n    },\n\n    deleteContent() {\n      return this.deleteInDirection(\"backward\")\n    },\n\n    deleteContentBackward() {\n      return this.deleteInDirection(\"backward\")\n    },\n\n    deleteContentForward() {\n      return this.deleteInDirection(\"forward\")\n    },\n\n    deleteEntireSoftLine() {\n      return this.deleteInDirection(\"forward\")\n    },\n\n    deleteHardLineBackward() {\n      return this.deleteInDirection(\"backward\")\n    },\n\n    deleteHardLineForward() {\n      return this.deleteInDirection(\"forward\")\n    },\n\n    deleteSoftLineBackward() {\n      return this.deleteInDirection(\"backward\")\n    },\n\n    deleteSoftLineForward() {\n      return this.deleteInDirection(\"forward\")\n    },\n\n    deleteWordBackward() {\n      return this.deleteInDirection(\"backward\")\n    },\n\n    deleteWordForward() {\n      return this.deleteInDirection(\"forward\")\n    },\n\n    formatBackColor() {\n      return this.activateAttributeIfSupported(\"backgroundColor\", this.event.data)\n    },\n\n    formatBold() {\n      return this.toggleAttributeIfSupported(\"bold\")\n    },\n\n    formatFontColor() {\n      return this.activateAttributeIfSupported(\"color\", this.event.data)\n    },\n\n    formatFontName() {\n      return this.activateAttributeIfSupported(\"font\", this.event.data)\n    },\n\n    formatIndent() {\n      if (this.responder?.canIncreaseNestingLevel()) {\n        return this.withTargetDOMRange(function() {\n          return this.responder?.increaseNestingLevel()\n        })\n      }\n    },\n\n    formatItalic() {\n      return this.toggleAttributeIfSupported(\"italic\")\n    },\n\n    formatJustifyCenter() {\n      return this.toggleAttributeIfSupported(\"justifyCenter\")\n    },\n\n    formatJustifyFull() {\n      return this.toggleAttributeIfSupported(\"justifyFull\")\n    },\n\n    formatJustifyLeft() {\n      return this.toggleAttributeIfSupported(\"justifyLeft\")\n    },\n\n    formatJustifyRight() {\n      return this.toggleAttributeIfSupported(\"justifyRight\")\n    },\n\n    formatOutdent() {\n      if (this.responder?.canDecreaseNestingLevel()) {\n        return this.withTargetDOMRange(function() {\n          return this.responder?.decreaseNestingLevel()\n        })\n      }\n    },\n\n    formatRemove() {\n      this.withTargetDOMRange(function() {\n        for (const attributeName in this.responder?.getCurrentAttributes()) {\n          this.responder?.removeCurrentAttribute(attributeName)\n        }\n      })\n    },\n\n    formatSetBlockTextDirection() {\n      return this.activateAttributeIfSupported(\"blockDir\", this.event.data)\n    },\n\n    formatSetInlineTextDirection() {\n      return this.activateAttributeIfSupported(\"textDir\", this.event.data)\n    },\n\n    formatStrikeThrough() {\n      return this.toggleAttributeIfSupported(\"strike\")\n    },\n\n    formatSubscript() {\n      return this.toggleAttributeIfSupported(\"sub\")\n    },\n\n    formatSuperscript() {\n      return this.toggleAttributeIfSupported(\"sup\")\n    },\n\n    formatUnderline() {\n      return this.toggleAttributeIfSupported(\"underline\")\n    },\n\n    historyRedo() {\n      return this.delegate?.inputControllerWillPerformRedo()\n    },\n\n    historyUndo() {\n      return this.delegate?.inputControllerWillPerformUndo()\n    },\n\n    insertCompositionText() {\n      this.composing = true\n      return this.insertString(this.event.data)\n    },\n\n    insertFromComposition() {\n      this.composing = false\n      return this.insertString(this.event.data)\n    },\n\n    insertFromDrop() {\n      const range = this.deleteByDragRange\n      if (range) {\n        this.deleteByDragRange = null\n        this.delegate?.inputControllerWillMoveText()\n        return this.withTargetDOMRange(function() {\n          return this.responder?.moveTextFromRange(range)\n        })\n      }\n    },\n\n    insertFromPaste() {\n      const { dataTransfer } = this.event\n      const paste = { dataTransfer }\n      const href = dataTransfer.getData(\"URL\")\n      const html = dataTransfer.getData(\"text/html\")\n\n      if (href) {\n        let string\n        this.event.preventDefault()\n        paste.type = \"text/html\"\n        const name = dataTransfer.getData(\"public.url-name\")\n        if (name) {\n          string = squishBreakableWhitespace(name).trim()\n        } else {\n          string = href\n        }\n        paste.html = this.createLinkHTML(href, string)\n        this.delegate?.inputControllerWillPaste(paste)\n        this.withTargetDOMRange(function() {\n          return this.responder?.insertHTML(paste.html)\n        })\n\n        this.afterRender = () => {\n          return this.delegate?.inputControllerDidPaste(paste)\n        }\n      } else if (dataTransferIsPlainText(dataTransfer)) {\n        paste.type = \"text/plain\"\n        paste.string = dataTransfer.getData(\"text/plain\")\n        this.delegate?.inputControllerWillPaste(paste)\n        this.withTargetDOMRange(function() {\n          return this.responder?.insertString(paste.string)\n        })\n\n        this.afterRender = () => {\n          return this.delegate?.inputControllerDidPaste(paste)\n        }\n      } else if (html) {\n        this.event.preventDefault()\n        paste.type = \"text/html\"\n        paste.html = html\n        this.delegate?.inputControllerWillPaste(paste)\n        this.withTargetDOMRange(function() {\n          return this.responder?.insertHTML(paste.html)\n        })\n\n        this.afterRender = () => {\n          return this.delegate?.inputControllerDidPaste(paste)\n        }\n      } else if (dataTransfer.files?.length) {\n        paste.type = \"File\"\n        paste.file = dataTransfer.files[0]\n        this.delegate?.inputControllerWillPaste(paste)\n        this.withTargetDOMRange(function() {\n          return this.responder?.insertFile(paste.file)\n        })\n\n        this.afterRender = () => {\n          return this.delegate?.inputControllerDidPaste(paste)\n        }\n      }\n    },\n\n    insertFromYank() {\n      return this.insertString(this.event.data)\n    },\n\n    insertLineBreak() {\n      return this.insertString(\"\\n\")\n    },\n\n    insertLink() {\n      return this.activateAttributeIfSupported(\"href\", this.event.data)\n    },\n\n    insertOrderedList() {\n      return this.toggleAttributeIfSupported(\"number\")\n    },\n\n    insertParagraph() {\n      this.delegate?.inputControllerWillPerformTyping()\n      return this.withTargetDOMRange(function() {\n        return this.responder?.insertLineBreak()\n      })\n    },\n\n    insertReplacementText() {\n      return this.insertString(this.event.dataTransfer.getData(\"text/plain\"), { updatePosition: false })\n    },\n\n    insertText() {\n      return this.insertString(this.event.data || this.event.dataTransfer?.getData(\"text/plain\"))\n    },\n\n    insertTranspose() {\n      return this.insertString(this.event.data)\n    },\n\n    insertUnorderedList() {\n      return this.toggleAttributeIfSupported(\"bullet\")\n    },\n  }\n\n  elementDidMutate() {\n    if (this.scheduledRender) {\n      if (this.composing) {\n        return this.delegate?.inputControllerDidAllowUnhandledInput?.()\n      }\n    } else {\n      return this.reparse()\n    }\n  }\n\n  scheduleRender() {\n    return this.scheduledRender ? this.scheduledRender : this.scheduledRender = requestAnimationFrame(this.render)\n  }\n\n  render() {\n    cancelAnimationFrame(this.scheduledRender)\n    this.scheduledRender = null\n    if (!this.composing) {\n      this.delegate?.render()\n    }\n    this.afterRender?.()\n    this.afterRender = null\n  }\n\n  reparse() {\n    return this.delegate?.reparse()\n  }\n\n  // Responder helpers\n\n  insertString(string = \"\", options) {\n    this.delegate?.inputControllerWillPerformTyping()\n    return this.withTargetDOMRange(function() {\n      return this.responder?.insertString(string, options)\n    })\n  }\n\n  toggleAttributeIfSupported(attributeName) {\n    if (getAllAttributeNames().includes(attributeName)) {\n      this.delegate?.inputControllerWillPerformFormatting(attributeName)\n      return this.withTargetDOMRange(function() {\n        return this.responder?.toggleCurrentAttribute(attributeName)\n      })\n    }\n  }\n\n  activateAttributeIfSupported(attributeName, value) {\n    if (getAllAttributeNames().includes(attributeName)) {\n      this.delegate?.inputControllerWillPerformFormatting(attributeName)\n      return this.withTargetDOMRange(function() {\n        return this.responder?.setCurrentAttribute(attributeName, value)\n      })\n    }\n  }\n\n  deleteInDirection(direction, { recordUndoEntry } = { recordUndoEntry: true }) {\n    if (recordUndoEntry) {\n      this.delegate?.inputControllerWillPerformTyping()\n    }\n    const perform = () => this.responder?.deleteInDirection(direction)\n    const domRange = this.getTargetDOMRange({ minLength: 2 })\n    if (domRange) {\n      return this.withTargetDOMRange(domRange, perform)\n    } else {\n      return perform()\n    }\n  }\n\n  // Selection helpers\n\n  withTargetDOMRange(domRange, fn) {\n    if (typeof domRange === \"function\") {\n      fn = domRange\n      domRange = this.getTargetDOMRange()\n    }\n    if (domRange) {\n      return this.responder?.withTargetDOMRange(domRange, fn.bind(this))\n    } else {\n      selectionChangeObserver.reset()\n      return fn.call(this)\n    }\n  }\n\n  getTargetDOMRange({ minLength } = { minLength: 0 }) {\n    const targetRanges = this.event.getTargetRanges?.()\n    if (targetRanges) {\n      if (targetRanges.length) {\n        const domRange = staticRangeToRange(targetRanges[0])\n        if (minLength === 0 || domRange.toString().length >= minLength) {\n          return domRange\n        }\n      }\n    }\n  }\n\n  withEvent(event, fn) {\n    let result\n    this.event = event\n    try {\n      result = fn.call(this)\n    } finally {\n      this.event = null\n    }\n    return result\n  }\n}\n\nconst staticRangeToRange = function(staticRange) {\n  const range = document.createRange()\n  range.setStart(staticRange.startContainer, staticRange.startOffset)\n  range.setEnd(staticRange.endContainer, staticRange.endOffset)\n  return range\n}\n\n// Event helpers\n\nconst dragEventHasFiles = (event) => Array.from(event.dataTransfer?.types || []).includes(\"Files\")\n\nconst pasteEventHasFilesOnly = function(event) {\n  const clipboard = event.clipboardData\n  if (clipboard) {\n    return clipboard.types.includes(\"Files\") && clipboard.types.length === 1 && clipboard.files.length >= 1\n  }\n}\n\nconst pasteEventHasPlainTextOnly = function(event) {\n  const clipboard = event.clipboardData\n  if (clipboard) {\n    return clipboard.types.includes(\"text/plain\") && clipboard.types.length === 1\n  }\n}\n\nconst keyboardCommandFromKeyEvent = function(event) {\n  const command = []\n  if (event.altKey) {\n    command.push(\"alt\")\n  }\n  if (event.shiftKey) {\n    command.push(\"shift\")\n  }\n  command.push(event.key)\n  return command\n}\n\nconst pointFromEvent = (event) => ({\n  x: event.clientX,\n  y: event.clientY,\n})\n","import { removeNode } from \"trix/core/helpers\"\n\nimport config from \"trix/config\"\nimport BasicObject from \"trix/core/basic_object\"\n\nimport { defer, handleEvent, makeElement, tagName } from \"trix/core/helpers\"\nconst { lang, css, keyNames } = config\n\nconst undoable = function(fn) {\n  return function() {\n    const commands = fn.apply(this, arguments)\n    commands.do()\n    if (!this.undos) {\n      this.undos = []\n    }\n    this.undos.push(commands.undo)\n  }\n}\n\nexport default class AttachmentEditorController extends BasicObject {\n  constructor(attachmentPiece, element, container, options = {}) {\n    super(...arguments)\n    this.didClickToolbar = this.didClickToolbar.bind(this)\n    this.didClickActionButton = this.didClickActionButton.bind(this)\n    this.didKeyDownCaption = this.didKeyDownCaption.bind(this)\n    this.didInputCaption = this.didInputCaption.bind(this)\n    this.didChangeCaption = this.didChangeCaption.bind(this)\n    this.didBlurCaption = this.didBlurCaption.bind(this)\n    this.attachmentPiece = attachmentPiece\n    this.element = element\n    this.container = container\n    this.options = options\n    this.attachment = this.attachmentPiece.attachment\n    if (tagName(this.element) === \"a\") {\n      this.element = this.element.firstChild\n    }\n    this.install()\n  }\n\n  install() {\n    this.makeElementMutable()\n    this.addToolbar()\n    if (this.attachment.isPreviewable()) {\n      this.installCaptionEditor()\n    }\n  }\n\n  uninstall() {\n    let undo = this.undos.pop()\n    this.savePendingCaption()\n    while (undo) {\n      undo()\n      undo = this.undos.pop()\n    }\n    this.delegate?.didUninstallAttachmentEditor(this)\n  }\n\n  // Private\n\n  savePendingCaption() {\n    if (this.pendingCaption) {\n      const caption = this.pendingCaption\n      this.pendingCaption = null\n      if (caption) {\n        this.delegate?.attachmentEditorDidRequestUpdatingAttributesForAttachment?.({ caption }, this.attachment)\n      } else {\n        this.delegate?.attachmentEditorDidRequestRemovingAttributeForAttachment?.(\"caption\", this.attachment)\n      }\n    }\n  }\n\n  // Installing and uninstalling\n\n  makeElementMutable = undoable(() => {\n    return {\n      do: () => {\n        this.element.dataset.trixMutable = true\n      },\n      undo: () => delete this.element.dataset.trixMutable,\n    }\n  })\n\n  addToolbar = undoable(() => {\n    // <div class=\"#{css.attachmentMetadataContainer}\" data-trix-mutable=\"true\">\n    //   <div class=\"trix-button-row\">\n    //     <span class=\"trix-button-group trix-button-group--actions\">\n    //       <button type=\"button\" class=\"trix-button trix-button--remove\" title=\"#{lang.remove}\" data-trix-action=\"remove\">#{lang.remove}</button>\n    //     </span>\n    //   </div>\n    // </div>\n    const element = makeElement({\n      tagName: \"div\",\n      className: css.attachmentToolbar,\n      data: { trixMutable: true },\n      childNodes: makeElement({\n        tagName: \"div\",\n        className: \"trix-button-row\",\n        childNodes: makeElement({\n          tagName: \"span\",\n          className: \"trix-button-group trix-button-group--actions\",\n          childNodes: makeElement({\n            tagName: \"button\",\n            className: \"trix-button trix-button--remove\",\n            textContent: lang.remove,\n            attributes: { title: lang.remove },\n            data: { trixAction: \"remove\" },\n          }),\n        }),\n      }),\n    })\n\n    if (this.attachment.isPreviewable()) {\n      // <div class=\"#{css.attachmentMetadataContainer}\">\n      //   <span class=\"#{css.attachmentMetadata}\">\n      //     <span class=\"#{css.attachmentName}\" title=\"#{name}\">#{name}</span>\n      //     <span class=\"#{css.attachmentSize}\">#{size}</span>\n      //   </span>\n      // </div>\n      element.appendChild(\n        makeElement({\n          tagName: \"div\",\n          className: css.attachmentMetadataContainer,\n          childNodes: makeElement({\n            tagName: \"span\",\n            className: css.attachmentMetadata,\n            childNodes: [\n              makeElement({\n                tagName: \"span\",\n                className: css.attachmentName,\n                textContent: this.attachment.getFilename(),\n                attributes: { title: this.attachment.getFilename() },\n              }),\n              makeElement({\n                tagName: \"span\",\n                className: css.attachmentSize,\n                textContent: this.attachment.getFormattedFilesize(),\n              }),\n            ],\n          }),\n        })\n      )\n    }\n\n    handleEvent(\"click\", { onElement: element, withCallback: this.didClickToolbar })\n    handleEvent(\"click\", {\n      onElement: element,\n      matchingSelector: \"[data-trix-action]\",\n      withCallback: this.didClickActionButton,\n    })\n\n    return {\n      do: () => this.element.appendChild(element),\n      undo: () => removeNode(element),\n    }\n  })\n\n  installCaptionEditor = undoable(() => {\n    const textarea = makeElement({\n      tagName: \"textarea\",\n      className: css.attachmentCaptionEditor,\n      attributes: { placeholder: lang.captionPlaceholder },\n      data: { trixMutable: true },\n    })\n    textarea.value = this.attachmentPiece.getCaption()\n\n    const textareaClone = textarea.cloneNode()\n    textareaClone.classList.add(\"trix-autoresize-clone\")\n    textareaClone.tabIndex = -1\n\n    const autoresize = function() {\n      textareaClone.value = textarea.value\n      textarea.style.height = textareaClone.scrollHeight + \"px\"\n    }\n\n    handleEvent(\"input\", { onElement: textarea, withCallback: autoresize })\n    handleEvent(\"input\", { onElement: textarea, withCallback: this.didInputCaption })\n    handleEvent(\"keydown\", { onElement: textarea, withCallback: this.didKeyDownCaption })\n    handleEvent(\"change\", { onElement: textarea, withCallback: this.didChangeCaption })\n    handleEvent(\"blur\", { onElement: textarea, withCallback: this.didBlurCaption })\n\n    const figcaption = this.element.querySelector(\"figcaption\")\n    const editingFigcaption = figcaption.cloneNode()\n\n    return {\n      do: () => {\n        figcaption.style.display = \"none\"\n        editingFigcaption.appendChild(textarea)\n        editingFigcaption.appendChild(textareaClone)\n        editingFigcaption.classList.add(`${css.attachmentCaption}--editing`)\n        figcaption.parentElement.insertBefore(editingFigcaption, figcaption)\n        autoresize()\n        if (this.options.editCaption) {\n          return defer(() => textarea.focus())\n        }\n      },\n      undo() {\n        removeNode(editingFigcaption)\n        figcaption.style.display = null\n      },\n    }\n  })\n\n  // Event handlers\n\n  didClickToolbar(event) {\n    event.preventDefault()\n    return event.stopPropagation()\n  }\n\n  didClickActionButton(event) {\n    const action = event.target.getAttribute(\"data-trix-action\")\n    switch (action) {\n      case \"remove\":\n        return this.delegate?.attachmentEditorDidRequestRemovalOfAttachment(this.attachment)\n    }\n  }\n\n  didKeyDownCaption(event) {\n    if (keyNames[event.keyCode] === \"return\") {\n      event.preventDefault()\n      this.savePendingCaption()\n      return this.delegate?.attachmentEditorDidRequestDeselectingAttachment?.(this.attachment)\n    }\n  }\n\n  didInputCaption(event) {\n    this.pendingCaption = event.target.value.replace(/\\s/g, \" \").trim()\n  }\n\n  didChangeCaption(event) {\n    return this.savePendingCaption()\n  }\n\n  didBlurCaption(event) {\n    return this.savePendingCaption()\n  }\n}\n","import BasicObject from \"trix/core/basic_object\"\nimport DocumentView from \"trix/views/document_view\"\nimport AttachmentEditorController from \"trix/controllers/attachment_editor_controller\"\n\nimport { defer, findClosestElementFromNode, handleEvent, innerElementIsActive } from \"trix/core/helpers\"\nimport { attachmentSelector } from \"trix/config/attachments\"\n\nexport default class CompositionController extends BasicObject {\n  constructor(element, composition) {\n    super(...arguments)\n    this.didFocus = this.didFocus.bind(this)\n    this.didBlur = this.didBlur.bind(this)\n    this.didClickAttachment = this.didClickAttachment.bind(this)\n\n    this.element = element\n    this.composition = composition\n    this.documentView = new DocumentView(this.composition.document, { element: this.element })\n\n    handleEvent(\"focus\", { onElement: this.element, withCallback: this.didFocus })\n    handleEvent(\"blur\", { onElement: this.element, withCallback: this.didBlur })\n    handleEvent(\"click\", {\n      onElement: this.element,\n      matchingSelector: \"a[contenteditable=false]\",\n      preventDefault: true,\n    })\n    handleEvent(\"mousedown\", {\n      onElement: this.element,\n      matchingSelector: attachmentSelector,\n      withCallback: this.didClickAttachment,\n    })\n    handleEvent(\"click\", { onElement: this.element, matchingSelector: `a${attachmentSelector}`, preventDefault: true })\n  }\n\n  didFocus(event) {\n    const perform = () => {\n      if (!this.focused) {\n        this.focused = true\n        return this.delegate?.compositionControllerDidFocus?.()\n      }\n    }\n\n    return this.blurPromise?.then(perform) || perform()\n  }\n\n  didBlur(event) {\n    this.blurPromise = new Promise((resolve) => {\n      return defer(() => {\n        if (!innerElementIsActive(this.element)) {\n          this.focused = null\n          this.delegate?.compositionControllerDidBlur?.()\n        }\n        this.blurPromise = null\n        return resolve()\n      })\n    })\n  }\n\n  didClickAttachment(event, target) {\n    const attachment = this.findAttachmentForElement(target)\n    const editCaption = !!findClosestElementFromNode(event.target, { matchingSelector: \"figcaption\" })\n    return this.delegate?.compositionControllerDidSelectAttachment?.(attachment, { editCaption })\n  }\n\n  getSerializableElement() {\n    if (this.isEditingAttachment()) {\n      return this.documentView.shadowElement\n    } else {\n      return this.element\n    }\n  }\n\n  render() {\n    if (this.revision !== this.composition.revision) {\n      this.documentView.setDocument(this.composition.document)\n      this.documentView.render()\n      this.revision = this.composition.revision\n    }\n\n    if (this.canSyncDocumentView() && !this.documentView.isSynced()) {\n      this.delegate?.compositionControllerWillSyncDocumentView?.()\n      this.documentView.sync()\n      this.delegate?.compositionControllerDidSyncDocumentView?.()\n    }\n\n    return this.delegate?.compositionControllerDidRender?.()\n  }\n\n  rerenderViewForObject(object) {\n    this.invalidateViewForObject(object)\n    return this.render()\n  }\n\n  invalidateViewForObject(object) {\n    return this.documentView.invalidateViewForObject(object)\n  }\n\n  isViewCachingEnabled() {\n    return this.documentView.isViewCachingEnabled()\n  }\n\n  enableViewCaching() {\n    return this.documentView.enableViewCaching()\n  }\n\n  disableViewCaching() {\n    return this.documentView.disableViewCaching()\n  }\n\n  refreshViewCache() {\n    return this.documentView.garbageCollectCachedViews()\n  }\n\n  // Attachment editor management\n\n  isEditingAttachment() {\n    return !!this.attachmentEditor\n  }\n\n  installAttachmentEditorForAttachment(attachment, options) {\n    if (this.attachmentEditor?.attachment === attachment) {\n      return\n    }\n    const element = this.documentView.findElementForObject(attachment)\n    if (!element) return\n\n    this.uninstallAttachmentEditor()\n    const attachmentPiece = this.composition.document.getAttachmentPieceForAttachment(attachment)\n    this.attachmentEditor = new AttachmentEditorController(attachmentPiece, element, this.element, options)\n    this.attachmentEditor.delegate = this\n  }\n\n  uninstallAttachmentEditor() {\n    return this.attachmentEditor?.uninstall()\n  }\n\n  // Attachment controller delegate\n\n  didUninstallAttachmentEditor() {\n    this.attachmentEditor = null\n    return this.render()\n  }\n\n  attachmentEditorDidRequestUpdatingAttributesForAttachment(attributes, attachment) {\n    this.delegate?.compositionControllerWillUpdateAttachment?.(attachment)\n    return this.composition.updateAttributesForAttachment(attributes, attachment)\n  }\n\n  attachmentEditorDidRequestRemovingAttributeForAttachment(attribute, attachment) {\n    this.delegate?.compositionControllerWillUpdateAttachment?.(attachment)\n    return this.composition.removeAttributeForAttachment(attribute, attachment)\n  }\n\n  attachmentEditorDidRequestRemovalOfAttachment(attachment) {\n    return this.delegate?.compositionControllerDidRequestRemovalOfAttachment?.(attachment)\n  }\n\n  attachmentEditorDidRequestDeselectingAttachment(attachment) {\n    return this.delegate?.compositionControllerDidRequestDeselectingAttachment?.(attachment)\n  }\n\n  // Private\n\n  canSyncDocumentView() {\n    return !this.isEditingAttachment()\n  }\n\n  findAttachmentForElement(element) {\n    return this.composition.document.getAttachmentById(parseInt(element.dataset.trixId, 10))\n  }\n}\n","import BasicObject from \"trix/core/basic_object\"\n\nimport { findClosestElementFromNode, handleEvent, triggerEvent } from \"trix/core/helpers\"\n\nconst attributeButtonSelector = \"[data-trix-attribute]\"\nconst actionButtonSelector = \"[data-trix-action]\"\nconst toolbarButtonSelector = `${attributeButtonSelector}, ${actionButtonSelector}`\nconst dialogSelector = \"[data-trix-dialog]\"\nconst activeDialogSelector = `${dialogSelector}[data-trix-active]`\nconst dialogButtonSelector = `${dialogSelector} [data-trix-method]`\nconst dialogInputSelector = `${dialogSelector} [data-trix-input]`\nconst getInputForDialog = (element, attributeName) => {\n  if (!attributeName) { attributeName = getAttributeName(element) }\n  return element.querySelector(`[data-trix-input][name='${attributeName}']`)\n}\nconst getActionName = (element) => element.getAttribute(\"data-trix-action\")\nconst getAttributeName = (element) => {\n  return element.getAttribute(\"data-trix-attribute\") || element.getAttribute(\"data-trix-dialog-attribute\")\n}\nconst getDialogName = (element) => element.getAttribute(\"data-trix-dialog\")\n\nexport default class ToolbarController extends BasicObject {\n  constructor(element) {\n    super(element)\n    this.didClickActionButton = this.didClickActionButton.bind(this)\n    this.didClickAttributeButton = this.didClickAttributeButton.bind(this)\n    this.didClickDialogButton = this.didClickDialogButton.bind(this)\n    this.didKeyDownDialogInput = this.didKeyDownDialogInput.bind(this)\n    this.element = element\n    this.attributes = {}\n    this.actions = {}\n    this.resetDialogInputs()\n\n    handleEvent(\"mousedown\", {\n      onElement: this.element,\n      matchingSelector: actionButtonSelector,\n      withCallback: this.didClickActionButton,\n    })\n    handleEvent(\"mousedown\", {\n      onElement: this.element,\n      matchingSelector: attributeButtonSelector,\n      withCallback: this.didClickAttributeButton,\n    })\n    handleEvent(\"click\", { onElement: this.element, matchingSelector: toolbarButtonSelector, preventDefault: true })\n    handleEvent(\"click\", {\n      onElement: this.element,\n      matchingSelector: dialogButtonSelector,\n      withCallback: this.didClickDialogButton,\n    })\n    handleEvent(\"keydown\", {\n      onElement: this.element,\n      matchingSelector: dialogInputSelector,\n      withCallback: this.didKeyDownDialogInput,\n    })\n  }\n\n  // Event handlers\n\n  didClickActionButton(event, element) {\n    this.delegate?.toolbarDidClickButton()\n    event.preventDefault()\n    const actionName = getActionName(element)\n\n    if (this.getDialog(actionName)) {\n      return this.toggleDialog(actionName)\n    } else {\n      return this.delegate?.toolbarDidInvokeAction(actionName)\n    }\n  }\n\n  didClickAttributeButton(event, element) {\n    this.delegate?.toolbarDidClickButton()\n    event.preventDefault()\n    const attributeName = getAttributeName(element)\n\n    if (this.getDialog(attributeName)) {\n      this.toggleDialog(attributeName)\n    } else {\n      this.delegate?.toolbarDidToggleAttribute(attributeName)\n    }\n\n    return this.refreshAttributeButtons()\n  }\n\n  didClickDialogButton(event, element) {\n    const dialogElement = findClosestElementFromNode(element, { matchingSelector: dialogSelector })\n    const method = element.getAttribute(\"data-trix-method\")\n    return this[method].call(this, dialogElement)\n  }\n\n  didKeyDownDialogInput(event, element) {\n    if (event.keyCode === 13) {\n      // Enter key\n      event.preventDefault()\n      const attribute = element.getAttribute(\"name\")\n      const dialog = this.getDialog(attribute)\n      this.setAttribute(dialog)\n    }\n    if (event.keyCode === 27) {\n      // Escape key\n      event.preventDefault()\n      return this.hideDialog()\n    }\n  }\n\n  // Action buttons\n\n  updateActions(actions) {\n    this.actions = actions\n    return this.refreshActionButtons()\n  }\n\n  refreshActionButtons() {\n    return this.eachActionButton((element, actionName) => {\n      element.disabled = this.actions[actionName] === false\n    })\n  }\n\n  eachActionButton(callback) {\n    return Array.from(this.element.querySelectorAll(actionButtonSelector)).map((element) =>\n      callback(element, getActionName(element))\n    )\n  }\n\n  // Attribute buttons\n\n  updateAttributes(attributes) {\n    this.attributes = attributes\n    return this.refreshAttributeButtons()\n  }\n\n  refreshAttributeButtons() {\n    return this.eachAttributeButton((element, attributeName) => {\n      element.disabled = this.attributes[attributeName] === false\n      if (this.attributes[attributeName] || this.dialogIsVisible(attributeName)) {\n        element.setAttribute(\"data-trix-active\", \"\")\n        return element.classList.add(\"trix-active\")\n      } else {\n        element.removeAttribute(\"data-trix-active\")\n        return element.classList.remove(\"trix-active\")\n      }\n    })\n  }\n\n  eachAttributeButton(callback) {\n    return Array.from(this.element.querySelectorAll(attributeButtonSelector)).map((element) =>\n      callback(element, getAttributeName(element))\n    )\n  }\n\n  applyKeyboardCommand(keys) {\n    const keyString = JSON.stringify(keys.sort())\n    for (const button of Array.from(this.element.querySelectorAll(\"[data-trix-key]\"))) {\n      const buttonKeys = button.getAttribute(\"data-trix-key\").split(\"+\")\n      const buttonKeyString = JSON.stringify(buttonKeys.sort())\n      if (buttonKeyString === keyString) {\n        triggerEvent(\"mousedown\", { onElement: button })\n        return true\n      }\n    }\n    return false\n  }\n\n  // Dialogs\n\n  dialogIsVisible(dialogName) {\n    const element = this.getDialog(dialogName)\n    if (element) {\n      return element.hasAttribute(\"data-trix-active\")\n    }\n  }\n\n  toggleDialog(dialogName) {\n    if (this.dialogIsVisible(dialogName)) {\n      return this.hideDialog()\n    } else {\n      return this.showDialog(dialogName)\n    }\n  }\n\n  showDialog(dialogName) {\n    this.hideDialog()\n    this.delegate?.toolbarWillShowDialog()\n\n    const element = this.getDialog(dialogName)\n    element.setAttribute(\"data-trix-active\", \"\")\n    element.classList.add(\"trix-active\")\n\n    Array.from(element.querySelectorAll(\"input[disabled]\")).forEach((disabledInput) => {\n      disabledInput.removeAttribute(\"disabled\")\n    })\n\n    const attributeName = getAttributeName(element)\n    if (attributeName) {\n      const input = getInputForDialog(element, dialogName)\n      if (input) {\n        input.value = this.attributes[attributeName] || \"\"\n        input.select()\n      }\n    }\n\n    return this.delegate?.toolbarDidShowDialog(dialogName)\n  }\n\n  setAttribute(dialogElement) {\n    const attributeName = getAttributeName(dialogElement)\n    const input = getInputForDialog(dialogElement, attributeName)\n    if (input.willValidate && !input.checkValidity()) {\n      input.setAttribute(\"data-trix-validate\", \"\")\n      input.classList.add(\"trix-validate\")\n      return input.focus()\n    } else {\n      this.delegate?.toolbarDidUpdateAttribute(attributeName, input.value)\n      return this.hideDialog()\n    }\n  }\n\n  removeAttribute(dialogElement) {\n    const attributeName = getAttributeName(dialogElement)\n    this.delegate?.toolbarDidRemoveAttribute(attributeName)\n    return this.hideDialog()\n  }\n\n  hideDialog() {\n    const element = this.element.querySelector(activeDialogSelector)\n    if (element) {\n      element.removeAttribute(\"data-trix-active\")\n      element.classList.remove(\"trix-active\")\n      this.resetDialogInputs()\n      return this.delegate?.toolbarDidHideDialog(getDialogName(element))\n    }\n  }\n\n  resetDialogInputs() {\n    Array.from(this.element.querySelectorAll(dialogInputSelector)).forEach((input) => {\n      input.setAttribute(\"disabled\", \"disabled\")\n      input.removeAttribute(\"data-trix-validate\")\n      input.classList.remove(\"trix-validate\")\n    })\n  }\n\n  getDialog(dialogName) {\n    return this.element.querySelector(`[data-trix-dialog=${dialogName}]`)\n  }\n}\n","export default class LineBreakInsertion {\n  constructor(composition) {\n    this.composition = composition\n    this.document = this.composition.document\n    const selectedRange = this.composition.getSelectedRange()\n    this.startPosition = selectedRange[0]\n    this.endPosition = selectedRange[1]\n\n    this.startLocation = this.document.locationFromPosition(this.startPosition)\n    this.endLocation = this.document.locationFromPosition(this.endPosition)\n\n    this.block = this.document.getBlockAtIndex(this.endLocation.index)\n    this.breaksOnReturn = this.block.breaksOnReturn()\n    this.previousCharacter = this.block.text.getStringAtPosition(this.endLocation.offset - 1)\n    this.nextCharacter = this.block.text.getStringAtPosition(this.endLocation.offset)\n  }\n\n  shouldInsertBlockBreak() {\n    if (this.block.hasAttributes() && this.block.isListItem() && !this.block.isEmpty()) {\n      return this.startLocation.offset !== 0\n    } else {\n      return this.breaksOnReturn && this.nextCharacter !== \"\\n\"\n    }\n  }\n\n  shouldBreakFormattedBlock() {\n    return (\n      this.block.hasAttributes() &&\n      !this.block.isListItem() &&\n      (this.breaksOnReturn && this.nextCharacter === \"\\n\" || this.previousCharacter === \"\\n\")\n    )\n  }\n\n  shouldDecreaseListLevel() {\n    return this.block.hasAttributes() && this.block.isListItem() && this.block.isEmpty()\n  }\n\n  shouldPrependListItem() {\n    return this.block.isListItem() && this.startLocation.offset === 0 && !this.block.isEmpty()\n  }\n\n  shouldRemoveLastBlockAttribute() {\n    return this.block.hasAttributes() && !this.block.isListItem() && this.block.isEmpty()\n  }\n}\n","import config from \"trix/config\"\nimport { OBJECT_REPLACEMENT_CHARACTER } from \"trix/constants\"\n\nimport BasicObject from \"trix/core/basic_object\"\nimport Text from \"trix/models/text\"\nimport Block from \"trix/models/block\"\nimport Attachment from \"trix/models/attachment\"\nimport Document from \"trix/models/document\"\nimport HTMLParser from \"trix/models/html_parser\"\nimport LineBreakInsertion from \"trix/models/line_break_insertion\"\n\nimport {\n  arrayStartsWith,\n  extend,\n  getAllAttributeNames,\n  getBlockConfig,\n  getTextConfig,\n  normalizeRange,\n  objectsAreEqual,\n  rangeIsCollapsed,\n  rangesAreEqual,\n  summarizeArrayChange,\n} from \"trix/core/helpers\"\n\nconst PLACEHOLDER = \" \"\n\nexport default class Composition extends BasicObject {\n  constructor() {\n    super(...arguments)\n    this.document = new Document()\n    this.attachments = []\n    this.currentAttributes = {}\n    this.revision = 0\n  }\n\n  setDocument(document) {\n    if (!document.isEqualTo(this.document)) {\n      this.document = document\n      this.refreshAttachments()\n      this.revision++\n      return this.delegate?.compositionDidChangeDocument?.(document)\n    }\n  }\n\n  // Snapshots\n\n  getSnapshot() {\n    return {\n      document: this.document,\n      selectedRange: this.getSelectedRange(),\n    }\n  }\n\n  loadSnapshot({ document, selectedRange }) {\n    this.delegate?.compositionWillLoadSnapshot?.()\n    this.setDocument(document != null ? document : new Document())\n    this.setSelection(selectedRange != null ? selectedRange : [ 0, 0 ])\n    return this.delegate?.compositionDidLoadSnapshot?.()\n  }\n\n  // Responder protocol\n\n  insertText(text, { updatePosition } = { updatePosition: true }) {\n    const selectedRange = this.getSelectedRange()\n    this.setDocument(this.document.insertTextAtRange(text, selectedRange))\n\n    const startPosition = selectedRange[0]\n    const endPosition = startPosition + text.getLength()\n\n    if (updatePosition) {\n      this.setSelection(endPosition)\n    }\n    return this.notifyDelegateOfInsertionAtRange([ startPosition, endPosition ])\n  }\n\n  insertBlock(block = new Block()) {\n    const document = new Document([ block ])\n    return this.insertDocument(document)\n  }\n\n  insertDocument(document = new Document()) {\n    const selectedRange = this.getSelectedRange()\n    this.setDocument(this.document.insertDocumentAtRange(document, selectedRange))\n\n    const startPosition = selectedRange[0]\n    const endPosition = startPosition + document.getLength()\n\n    this.setSelection(endPosition)\n    return this.notifyDelegateOfInsertionAtRange([ startPosition, endPosition ])\n  }\n\n  insertString(string, options) {\n    const attributes = this.getCurrentTextAttributes()\n    const text = Text.textForStringWithAttributes(string, attributes)\n    return this.insertText(text, options)\n  }\n\n  insertBlockBreak() {\n    const selectedRange = this.getSelectedRange()\n    this.setDocument(this.document.insertBlockBreakAtRange(selectedRange))\n\n    const startPosition = selectedRange[0]\n    const endPosition = startPosition + 1\n\n    this.setSelection(endPosition)\n    return this.notifyDelegateOfInsertionAtRange([ startPosition, endPosition ])\n  }\n\n  insertLineBreak() {\n    const insertion = new LineBreakInsertion(this)\n\n    if (insertion.shouldDecreaseListLevel()) {\n      this.decreaseListLevel()\n      return this.setSelection(insertion.startPosition)\n    } else if (insertion.shouldPrependListItem()) {\n      const document = new Document([ insertion.block.copyWithoutText() ])\n      return this.insertDocument(document)\n    } else if (insertion.shouldInsertBlockBreak()) {\n      return this.insertBlockBreak()\n    } else if (insertion.shouldRemoveLastBlockAttribute()) {\n      return this.removeLastBlockAttribute()\n    } else if (insertion.shouldBreakFormattedBlock()) {\n      return this.breakFormattedBlock(insertion)\n    } else {\n      return this.insertString(\"\\n\")\n    }\n  }\n\n  insertHTML(html) {\n    const document = HTMLParser.parse(html).getDocument()\n    const selectedRange = this.getSelectedRange()\n\n    this.setDocument(this.document.mergeDocumentAtRange(document, selectedRange))\n\n    const startPosition = selectedRange[0]\n    const endPosition = startPosition + document.getLength() - 1\n\n    this.setSelection(endPosition)\n    return this.notifyDelegateOfInsertionAtRange([ startPosition, endPosition ])\n  }\n\n  replaceHTML(html) {\n    const document = HTMLParser.parse(html).getDocument().copyUsingObjectsFromDocument(this.document)\n    const locationRange = this.getLocationRange({ strict: false })\n    const selectedRange = this.document.rangeFromLocationRange(locationRange)\n    this.setDocument(document)\n    return this.setSelection(selectedRange)\n  }\n\n  insertFile(file) {\n    return this.insertFiles([ file ])\n  }\n\n  insertFiles(files) {\n    const attachments = []\n\n    Array.from(files).forEach((file) => {\n      if (this.delegate?.compositionShouldAcceptFile(file)) {\n        const attachment = Attachment.attachmentForFile(file)\n        attachments.push(attachment)\n      }\n    })\n\n    return this.insertAttachments(attachments)\n  }\n\n  insertAttachment(attachment) {\n    return this.insertAttachments([ attachment ])\n  }\n\n  insertAttachments(attachments) {\n    let text = new Text()\n\n    Array.from(attachments).forEach((attachment) => {\n      const type = attachment.getType()\n      const presentation = config.attachments[type]?.presentation\n\n      const attributes = this.getCurrentTextAttributes()\n      if (presentation) {\n        attributes.presentation = presentation\n      }\n\n      const attachmentText = Text.textForAttachmentWithAttributes(attachment, attributes)\n      text = text.appendText(attachmentText)\n    })\n\n    return this.insertText(text)\n  }\n\n  shouldManageDeletingInDirection(direction) {\n    const locationRange = this.getLocationRange()\n    if (rangeIsCollapsed(locationRange)) {\n      if (direction === \"backward\" && locationRange[0].offset === 0) {\n        return true\n      }\n      if (this.shouldManageMovingCursorInDirection(direction)) {\n        return true\n      }\n    } else {\n      if (locationRange[0].index !== locationRange[1].index) {\n        return true\n      }\n    }\n    return false\n  }\n\n  deleteInDirection(direction, { length } = {}) {\n    let attachment, deletingIntoPreviousBlock, selectionSpansBlocks\n    const locationRange = this.getLocationRange()\n    let range = this.getSelectedRange()\n    const selectionIsCollapsed = rangeIsCollapsed(range)\n\n    if (selectionIsCollapsed) {\n      deletingIntoPreviousBlock = direction === \"backward\" && locationRange[0].offset === 0\n    } else {\n      selectionSpansBlocks = locationRange[0].index !== locationRange[1].index\n    }\n\n    if (deletingIntoPreviousBlock) {\n      if (this.canDecreaseBlockAttributeLevel()) {\n        const block = this.getBlock()\n\n        if (block.isListItem()) {\n          this.decreaseListLevel()\n        } else {\n          this.decreaseBlockAttributeLevel()\n        }\n\n        this.setSelection(range[0])\n        if (block.isEmpty()) {\n          return false\n        }\n      }\n    }\n\n    if (selectionIsCollapsed) {\n      range = this.getExpandedRangeInDirection(direction, { length })\n      if (direction === \"backward\") {\n        attachment = this.getAttachmentAtRange(range)\n      }\n    }\n\n    if (attachment) {\n      this.editAttachment(attachment)\n      return false\n    } else {\n      this.setDocument(this.document.removeTextAtRange(range))\n      this.setSelection(range[0])\n      if (deletingIntoPreviousBlock || selectionSpansBlocks) {\n        return false\n      }\n    }\n  }\n\n  moveTextFromRange(range) {\n    const [ position ] = Array.from(this.getSelectedRange())\n    this.setDocument(this.document.moveTextFromRangeToPosition(range, position))\n    return this.setSelection(position)\n  }\n\n  removeAttachment(attachment) {\n    const range = this.document.getRangeOfAttachment(attachment)\n    if (range) {\n      this.stopEditingAttachment()\n      this.setDocument(this.document.removeTextAtRange(range))\n      return this.setSelection(range[0])\n    }\n  }\n\n  removeLastBlockAttribute() {\n    const [ startPosition, endPosition ] = Array.from(this.getSelectedRange())\n    const block = this.document.getBlockAtPosition(endPosition)\n    this.removeCurrentAttribute(block.getLastAttribute())\n    return this.setSelection(startPosition)\n  }\n\n  insertPlaceholder() {\n    this.placeholderPosition = this.getPosition()\n    return this.insertString(PLACEHOLDER)\n  }\n\n  selectPlaceholder() {\n    if (this.placeholderPosition != null) {\n      this.setSelectedRange([ this.placeholderPosition, this.placeholderPosition + PLACEHOLDER.length ])\n      return this.getSelectedRange()\n    }\n  }\n\n  forgetPlaceholder() {\n    this.placeholderPosition = null\n  }\n\n  // Current attributes\n\n  hasCurrentAttribute(attributeName) {\n    const value = this.currentAttributes[attributeName]\n    return value != null && value !== false\n  }\n\n  toggleCurrentAttribute(attributeName) {\n    const value = !this.currentAttributes[attributeName]\n    if (value) {\n      return this.setCurrentAttribute(attributeName, value)\n    } else {\n      return this.removeCurrentAttribute(attributeName)\n    }\n  }\n\n  canSetCurrentAttribute(attributeName) {\n    if (getBlockConfig(attributeName)) {\n      return this.canSetCurrentBlockAttribute(attributeName)\n    } else {\n      return this.canSetCurrentTextAttribute(attributeName)\n    }\n  }\n\n  canSetCurrentTextAttribute(attributeName) {\n    const document = this.getSelectedDocument()\n    if (!document) return\n    for (const attachment of Array.from(document.getAttachments())) {\n      if (!attachment.hasContent()) {\n        return false\n      }\n    }\n    return true\n  }\n\n  canSetCurrentBlockAttribute(attributeName) {\n    const block = this.getBlock()\n    if (!block) return\n    return !block.isTerminalBlock()\n  }\n\n  setCurrentAttribute(attributeName, value) {\n    if (getBlockConfig(attributeName)) {\n      return this.setBlockAttribute(attributeName, value)\n    } else {\n      this.setTextAttribute(attributeName, value)\n      this.currentAttributes[attributeName] = value\n      return this.notifyDelegateOfCurrentAttributesChange()\n    }\n  }\n\n  setTextAttribute(attributeName, value) {\n    const selectedRange = this.getSelectedRange()\n    if (!selectedRange) return\n\n    const [ startPosition, endPosition ] = Array.from(selectedRange)\n    if (startPosition === endPosition) {\n      if (attributeName === \"href\") {\n        const text = Text.textForStringWithAttributes(value, { href: value })\n        return this.insertText(text)\n      }\n    } else {\n      return this.setDocument(this.document.addAttributeAtRange(attributeName, value, selectedRange))\n    }\n  }\n\n  setBlockAttribute(attributeName, value) {\n    const selectedRange = this.getSelectedRange()\n    if (this.canSetCurrentAttribute(attributeName)) {\n      this.setDocument(this.document.applyBlockAttributeAtRange(attributeName, value, selectedRange))\n      return this.setSelection(selectedRange)\n    }\n  }\n\n  removeCurrentAttribute(attributeName) {\n    if (getBlockConfig(attributeName)) {\n      this.removeBlockAttribute(attributeName)\n      return this.updateCurrentAttributes()\n    } else {\n      this.removeTextAttribute(attributeName)\n      delete this.currentAttributes[attributeName]\n      return this.notifyDelegateOfCurrentAttributesChange()\n    }\n  }\n\n  removeTextAttribute(attributeName) {\n    const selectedRange = this.getSelectedRange()\n    if (!selectedRange) return\n    return this.setDocument(this.document.removeAttributeAtRange(attributeName, selectedRange))\n  }\n\n  removeBlockAttribute(attributeName) {\n    const selectedRange = this.getSelectedRange()\n    if (!selectedRange) return\n    return this.setDocument(this.document.removeAttributeAtRange(attributeName, selectedRange))\n  }\n\n  canDecreaseNestingLevel() {\n    return this.getBlock()?.getNestingLevel() > 0\n  }\n\n  canIncreaseNestingLevel() {\n    const block = this.getBlock()\n    if (!block) return\n    if (getBlockConfig(block.getLastNestableAttribute())?.listAttribute) {\n      const previousBlock = this.getPreviousBlock()\n      if (previousBlock) {\n        return arrayStartsWith(previousBlock.getListItemAttributes(), block.getListItemAttributes())\n      }\n    } else {\n      return block.getNestingLevel() > 0\n    }\n  }\n\n  decreaseNestingLevel() {\n    const block = this.getBlock()\n    if (!block) return\n    return this.setDocument(this.document.replaceBlock(block, block.decreaseNestingLevel()))\n  }\n\n  increaseNestingLevel() {\n    const block = this.getBlock()\n    if (!block) return\n    return this.setDocument(this.document.replaceBlock(block, block.increaseNestingLevel()))\n  }\n\n  canDecreaseBlockAttributeLevel() {\n    return this.getBlock()?.getAttributeLevel() > 0\n  }\n\n  decreaseBlockAttributeLevel() {\n    const attribute = this.getBlock()?.getLastAttribute()\n    if (attribute) {\n      return this.removeCurrentAttribute(attribute)\n    }\n  }\n\n  decreaseListLevel() {\n    let [ startPosition ] = Array.from(this.getSelectedRange())\n    const { index } = this.document.locationFromPosition(startPosition)\n    let endIndex = index\n    const attributeLevel = this.getBlock().getAttributeLevel()\n\n    let block = this.document.getBlockAtIndex(endIndex + 1)\n    while (block) {\n      if (!block.isListItem() || block.getAttributeLevel() <= attributeLevel) {\n        break\n      }\n      endIndex++\n      block = this.document.getBlockAtIndex(endIndex + 1)\n    }\n\n    startPosition = this.document.positionFromLocation({ index, offset: 0 })\n    const endPosition = this.document.positionFromLocation({ index: endIndex, offset: 0 })\n    return this.setDocument(this.document.removeLastListAttributeAtRange([ startPosition, endPosition ]))\n  }\n\n  updateCurrentAttributes() {\n    const selectedRange = this.getSelectedRange({ ignoreLock: true })\n    if (selectedRange) {\n      const currentAttributes = this.document.getCommonAttributesAtRange(selectedRange)\n\n      Array.from(getAllAttributeNames()).forEach((attributeName) => {\n        if (!currentAttributes[attributeName]) {\n          if (!this.canSetCurrentAttribute(attributeName)) {\n            currentAttributes[attributeName] = false\n          }\n        }\n      })\n\n      if (!objectsAreEqual(currentAttributes, this.currentAttributes)) {\n        this.currentAttributes = currentAttributes\n        return this.notifyDelegateOfCurrentAttributesChange()\n      }\n    }\n  }\n\n  getCurrentAttributes() {\n    return extend.call({}, this.currentAttributes)\n  }\n\n  getCurrentTextAttributes() {\n    const attributes = {}\n    for (const key in this.currentAttributes) {\n      const value = this.currentAttributes[key]\n      if (value !== false) {\n        if (getTextConfig(key)) {\n          attributes[key] = value\n        }\n      }\n    }\n    return attributes\n  }\n\n  // Selection freezing\n\n  freezeSelection() {\n    return this.setCurrentAttribute(\"frozen\", true)\n  }\n\n  thawSelection() {\n    return this.removeCurrentAttribute(\"frozen\")\n  }\n\n  hasFrozenSelection() {\n    return this.hasCurrentAttribute(\"frozen\")\n  }\n\n  setSelection(selectedRange) {\n    const locationRange = this.document.locationRangeFromRange(selectedRange)\n    return this.delegate?.compositionDidRequestChangingSelectionToLocationRange(locationRange)\n  }\n\n  getSelectedRange() {\n    const locationRange = this.getLocationRange()\n    if (locationRange) {\n      return this.document.rangeFromLocationRange(locationRange)\n    }\n  }\n\n  setSelectedRange(selectedRange) {\n    const locationRange = this.document.locationRangeFromRange(selectedRange)\n    return this.getSelectionManager().setLocationRange(locationRange)\n  }\n\n  getPosition() {\n    const locationRange = this.getLocationRange()\n    if (locationRange) {\n      return this.document.positionFromLocation(locationRange[0])\n    }\n  }\n\n  getLocationRange(options) {\n    return (\n      (this.targetLocationRange != null\n        ? this.targetLocationRange\n        : this.getSelectionManager().getLocationRange(options)) || normalizeRange({ index: 0, offset: 0 })\n    )\n  }\n\n  withTargetLocationRange(locationRange, fn) {\n    let result\n    this.targetLocationRange = locationRange\n    try {\n      result = fn()\n    } finally {\n      this.targetLocationRange = null\n    }\n    return result\n  }\n\n  withTargetRange(range, fn) {\n    const locationRange = this.document.locationRangeFromRange(range)\n    return this.withTargetLocationRange(locationRange, fn)\n  }\n\n  withTargetDOMRange(domRange, fn) {\n    const locationRange = this.createLocationRangeFromDOMRange(domRange, { strict: false })\n    return this.withTargetLocationRange(locationRange, fn)\n  }\n\n  getExpandedRangeInDirection(direction, { length } = {}) {\n    let [ startPosition, endPosition ] = Array.from(this.getSelectedRange())\n    if (direction === \"backward\") {\n      if (length) {\n        startPosition -= length\n      } else {\n        startPosition = this.translateUTF16PositionFromOffset(startPosition, -1)\n      }\n    } else {\n      if (length) {\n        endPosition += length\n      } else {\n        endPosition = this.translateUTF16PositionFromOffset(endPosition, 1)\n      }\n    }\n    return normalizeRange([ startPosition, endPosition ])\n  }\n\n  shouldManageMovingCursorInDirection(direction) {\n    if (this.editingAttachment) {\n      return true\n    }\n    const range = this.getExpandedRangeInDirection(direction)\n    return this.getAttachmentAtRange(range) != null\n  }\n\n  moveCursorInDirection(direction) {\n    let canEditAttachment, range\n    if (this.editingAttachment) {\n      range = this.document.getRangeOfAttachment(this.editingAttachment)\n    } else {\n      const selectedRange = this.getSelectedRange()\n      range = this.getExpandedRangeInDirection(direction)\n      canEditAttachment = !rangesAreEqual(selectedRange, range)\n    }\n\n    if (direction === \"backward\") {\n      this.setSelectedRange(range[0])\n    } else {\n      this.setSelectedRange(range[1])\n    }\n\n    if (canEditAttachment) {\n      const attachment = this.getAttachmentAtRange(range)\n      if (attachment) {\n        return this.editAttachment(attachment)\n      }\n    }\n  }\n\n  expandSelectionInDirection(direction, { length } = {}) {\n    const range = this.getExpandedRangeInDirection(direction, { length })\n    return this.setSelectedRange(range)\n  }\n\n  expandSelectionForEditing() {\n    if (this.hasCurrentAttribute(\"href\")) {\n      return this.expandSelectionAroundCommonAttribute(\"href\")\n    }\n  }\n\n  expandSelectionAroundCommonAttribute(attributeName) {\n    const position = this.getPosition()\n    const range = this.document.getRangeOfCommonAttributeAtPosition(attributeName, position)\n    return this.setSelectedRange(range)\n  }\n\n  selectionContainsAttachments() {\n    return this.getSelectedAttachments()?.length > 0\n  }\n\n  selectionIsInCursorTarget() {\n    return this.editingAttachment || this.positionIsCursorTarget(this.getPosition())\n  }\n\n  positionIsCursorTarget(position) {\n    const location = this.document.locationFromPosition(position)\n    if (location) {\n      return this.locationIsCursorTarget(location)\n    }\n  }\n\n  positionIsBlockBreak(position) {\n    return this.document.getPieceAtPosition(position)?.isBlockBreak()\n  }\n\n  getSelectedDocument() {\n    const selectedRange = this.getSelectedRange()\n    if (selectedRange) {\n      return this.document.getDocumentAtRange(selectedRange)\n    }\n  }\n\n  getSelectedAttachments() {\n    return this.getSelectedDocument()?.getAttachments()\n  }\n\n  // Attachments\n\n  getAttachments() {\n    return this.attachments.slice(0)\n  }\n\n  refreshAttachments() {\n    const attachments = this.document.getAttachments()\n    const { added, removed } = summarizeArrayChange(this.attachments, attachments)\n    this.attachments = attachments\n\n    Array.from(removed).forEach((attachment) => {\n      attachment.delegate = null\n      this.delegate?.compositionDidRemoveAttachment?.(attachment)\n    })\n\n    return (() => {\n      const result = []\n\n      Array.from(added).forEach((attachment) => {\n        attachment.delegate = this\n        result.push(this.delegate?.compositionDidAddAttachment?.(attachment))\n      })\n\n      return result\n    })()\n  }\n\n  // Attachment delegate\n\n  attachmentDidChangeAttributes(attachment) {\n    this.revision++\n    return this.delegate?.compositionDidEditAttachment?.(attachment)\n  }\n\n  attachmentDidChangePreviewURL(attachment) {\n    this.revision++\n    return this.delegate?.compositionDidChangeAttachmentPreviewURL?.(attachment)\n  }\n\n  // Attachment editing\n\n  editAttachment(attachment, options) {\n    if (attachment === this.editingAttachment) {\n      return\n    }\n    this.stopEditingAttachment()\n    this.editingAttachment = attachment\n    return this.delegate?.compositionDidStartEditingAttachment?.(this.editingAttachment, options)\n  }\n\n  stopEditingAttachment() {\n    if (!this.editingAttachment) {\n      return\n    }\n    this.delegate?.compositionDidStopEditingAttachment?.(this.editingAttachment)\n    this.editingAttachment = null\n  }\n\n  updateAttributesForAttachment(attributes, attachment) {\n    return this.setDocument(this.document.updateAttributesForAttachment(attributes, attachment))\n  }\n\n  removeAttributeForAttachment(attribute, attachment) {\n    return this.setDocument(this.document.removeAttributeForAttachment(attribute, attachment))\n  }\n\n  // Private\n\n  breakFormattedBlock(insertion) {\n    let { document } = insertion\n    const { block } = insertion\n    let position = insertion.startPosition\n    let range = [ position - 1, position ]\n\n    if (block.getBlockBreakPosition() === insertion.startLocation.offset) {\n      if (block.breaksOnReturn() && insertion.nextCharacter === \"\\n\") {\n        position += 1\n      } else {\n        document = document.removeTextAtRange(range)\n      }\n      range = [ position, position ]\n    } else if (insertion.nextCharacter === \"\\n\") {\n      if (insertion.previousCharacter === \"\\n\") {\n        range = [ position - 1, position + 1 ]\n      } else {\n        range = [ position, position + 1 ]\n        position += 1\n      }\n    } else if (insertion.startLocation.offset - 1 !== 0) {\n      position += 1\n    }\n\n    const newDocument = new Document([ block.removeLastAttribute().copyWithoutText() ])\n    this.setDocument(document.insertDocumentAtRange(newDocument, range))\n    return this.setSelection(position)\n  }\n\n  getPreviousBlock() {\n    const locationRange = this.getLocationRange()\n    if (locationRange) {\n      const { index } = locationRange[0]\n      if (index > 0) {\n        return this.document.getBlockAtIndex(index - 1)\n      }\n    }\n  }\n\n  getBlock() {\n    const locationRange = this.getLocationRange()\n    if (locationRange) {\n      return this.document.getBlockAtIndex(locationRange[0].index)\n    }\n  }\n\n  getAttachmentAtRange(range) {\n    const document = this.document.getDocumentAtRange(range)\n    if (document.toString() === `${OBJECT_REPLACEMENT_CHARACTER}\\n`) {\n      return document.getAttachments()[0]\n    }\n  }\n\n  notifyDelegateOfCurrentAttributesChange() {\n    return this.delegate?.compositionDidChangeCurrentAttributes?.(this.currentAttributes)\n  }\n\n  notifyDelegateOfInsertionAtRange(range) {\n    return this.delegate?.compositionDidPerformInsertionAtRange?.(range)\n  }\n\n  translateUTF16PositionFromOffset(position, offset) {\n    const utf16string = this.document.toUTF16String()\n    const utf16position = utf16string.offsetFromUCS2Offset(position)\n    return utf16string.offsetToUCS2Offset(utf16position + offset)\n  }\n}\n\nComposition.proxyMethod(\"getSelectionManager().getPointRange\")\nComposition.proxyMethod(\"getSelectionManager().setLocationRangeFromPointRange\")\nComposition.proxyMethod(\"getSelectionManager().createLocationRangeFromDOMRange\")\nComposition.proxyMethod(\"getSelectionManager().locationIsCursorTarget\")\nComposition.proxyMethod(\"getSelectionManager().selectionIsExpanded\")\nComposition.proxyMethod(\"delegate?.getSelectionManager\")\n","import BasicObject from \"trix/core/basic_object\"\n\nexport default class UndoManager extends BasicObject {\n  constructor(composition) {\n    super(...arguments)\n    this.composition = composition\n    this.undoEntries = []\n    this.redoEntries = []\n  }\n\n  recordUndoEntry(description, { context, consolidatable } = {}) {\n    const previousEntry = this.undoEntries.slice(-1)[0]\n\n    if (!consolidatable || !entryHasDescriptionAndContext(previousEntry, description, context)) {\n      const undoEntry = this.createEntry({ description, context })\n      this.undoEntries.push(undoEntry)\n      this.redoEntries = []\n    }\n  }\n\n  undo() {\n    const undoEntry = this.undoEntries.pop()\n    if (undoEntry) {\n      const redoEntry = this.createEntry(undoEntry)\n      this.redoEntries.push(redoEntry)\n      return this.composition.loadSnapshot(undoEntry.snapshot)\n    }\n  }\n\n  redo() {\n    const redoEntry = this.redoEntries.pop()\n    if (redoEntry) {\n      const undoEntry = this.createEntry(redoEntry)\n      this.undoEntries.push(undoEntry)\n      return this.composition.loadSnapshot(redoEntry.snapshot)\n    }\n  }\n\n  canUndo() {\n    return this.undoEntries.length > 0\n  }\n\n  canRedo() {\n    return this.redoEntries.length > 0\n  }\n\n  // Private\n\n  createEntry({ description, context } = {}) {\n    return {\n      description: description?.toString(),\n      context: JSON.stringify(context),\n      snapshot: this.composition.getSnapshot(),\n    }\n  }\n}\n\nconst entryHasDescriptionAndContext = (entry, description, context) =>\n  entry?.description === description?.toString() && entry?.context === JSON.stringify(context)\n","export const attachmentGalleryFilter = function(snapshot) {\n  const filter = new Filter(snapshot)\n  filter.perform()\n  return filter.getSnapshot()\n}\n\nconst BLOCK_ATTRIBUTE_NAME = \"attachmentGallery\"\nconst TEXT_ATTRIBUTE_NAME = \"presentation\"\nconst TEXT_ATTRIBUTE_VALUE = \"gallery\"\n\nclass Filter {\n  constructor(snapshot) {\n    this.document = snapshot.document\n    this.selectedRange = snapshot.selectedRange\n  }\n\n  perform() {\n    this.removeBlockAttribute()\n    return this.applyBlockAttribute()\n  }\n\n  getSnapshot() {\n    return { document: this.document, selectedRange: this.selectedRange }\n  }\n\n  // Private\n\n  removeBlockAttribute() {\n    return this.findRangesOfBlocks().map((range) => this.document = this.document.removeAttributeAtRange(BLOCK_ATTRIBUTE_NAME, range))\n  }\n\n  applyBlockAttribute() {\n    let offset = 0\n\n    this.findRangesOfPieces().forEach((range) => {\n      if (range[1] - range[0] > 1) {\n        range[0] += offset\n        range[1] += offset\n\n        if (this.document.getCharacterAtPosition(range[1]) !== \"\\n\") {\n          this.document = this.document.insertBlockBreakAtRange(range[1])\n          if (range[1] < this.selectedRange[1]) {\n            this.moveSelectedRangeForward()\n          }\n          range[1]++\n          offset++\n        }\n\n        if (range[0] !== 0) {\n          if (this.document.getCharacterAtPosition(range[0] - 1) !== \"\\n\") {\n            this.document = this.document.insertBlockBreakAtRange(range[0])\n            if (range[0] < this.selectedRange[0]) {\n              this.moveSelectedRangeForward()\n            }\n            range[0]++\n            offset++\n          }\n        }\n\n        this.document = this.document.applyBlockAttributeAtRange(BLOCK_ATTRIBUTE_NAME, true, range)\n      }\n    })\n  }\n\n  findRangesOfBlocks() {\n    return this.document.findRangesForBlockAttribute(BLOCK_ATTRIBUTE_NAME)\n  }\n\n  findRangesOfPieces() {\n    return this.document.findRangesForTextAttribute(TEXT_ATTRIBUTE_NAME, { withValue: TEXT_ATTRIBUTE_VALUE })\n  }\n\n  moveSelectedRangeForward() {\n    this.selectedRange[0] += 1\n    this.selectedRange[1] += 1\n  }\n}\n","import Document from \"trix/models/document\"\nimport HTMLParser from \"trix/models/html_parser\"\n\nimport UndoManager from \"trix/models/undo_manager\"\nimport { attachmentGalleryFilter } from \"trix/filters/attachment_gallery_filter\"\nconst DEFAULT_FILTERS = [ attachmentGalleryFilter ]\n\nexport default class Editor {\n  constructor(composition, selectionManager, element) {\n    this.insertFiles = this.insertFiles.bind(this)\n    this.composition = composition\n    this.selectionManager = selectionManager\n    this.element = element\n    this.undoManager = new UndoManager(this.composition)\n    this.filters = DEFAULT_FILTERS.slice(0)\n  }\n\n  loadDocument(document) {\n    return this.loadSnapshot({ document, selectedRange: [ 0, 0 ] })\n  }\n\n  loadHTML(html = \"\") {\n    const document = HTMLParser.parse(html, { referenceElement: this.element }).getDocument()\n    return this.loadDocument(document)\n  }\n\n  loadJSON({ document, selectedRange }) {\n    document = Document.fromJSON(document)\n    return this.loadSnapshot({ document, selectedRange })\n  }\n\n  loadSnapshot(snapshot) {\n    this.undoManager = new UndoManager(this.composition)\n    return this.composition.loadSnapshot(snapshot)\n  }\n\n  getDocument() {\n    return this.composition.document\n  }\n\n  getSelectedDocument() {\n    return this.composition.getSelectedDocument()\n  }\n\n  getSnapshot() {\n    return this.composition.getSnapshot()\n  }\n\n  toJSON() {\n    return this.getSnapshot()\n  }\n\n  // Document manipulation\n\n  deleteInDirection(direction) {\n    return this.composition.deleteInDirection(direction)\n  }\n\n  insertAttachment(attachment) {\n    return this.composition.insertAttachment(attachment)\n  }\n\n  insertAttachments(attachments) {\n    return this.composition.insertAttachments(attachments)\n  }\n\n  insertDocument(document) {\n    return this.composition.insertDocument(document)\n  }\n\n  insertFile(file) {\n    return this.composition.insertFile(file)\n  }\n\n  insertFiles(files) {\n    return this.composition.insertFiles(files)\n  }\n\n  insertHTML(html) {\n    return this.composition.insertHTML(html)\n  }\n\n  insertString(string) {\n    return this.composition.insertString(string)\n  }\n\n  insertText(text) {\n    return this.composition.insertText(text)\n  }\n\n  insertLineBreak() {\n    return this.composition.insertLineBreak()\n  }\n\n  // Selection\n\n  getSelectedRange() {\n    return this.composition.getSelectedRange()\n  }\n\n  getPosition() {\n    return this.composition.getPosition()\n  }\n\n  getClientRectAtPosition(position) {\n    const locationRange = this.getDocument().locationRangeFromRange([ position, position + 1 ])\n    return this.selectionManager.getClientRectAtLocationRange(locationRange)\n  }\n\n  expandSelectionInDirection(direction) {\n    return this.composition.expandSelectionInDirection(direction)\n  }\n\n  moveCursorInDirection(direction) {\n    return this.composition.moveCursorInDirection(direction)\n  }\n\n  setSelectedRange(selectedRange) {\n    return this.composition.setSelectedRange(selectedRange)\n  }\n\n  // Attributes\n\n  activateAttribute(name, value = true) {\n    return this.composition.setCurrentAttribute(name, value)\n  }\n\n  attributeIsActive(name) {\n    return this.composition.hasCurrentAttribute(name)\n  }\n\n  canActivateAttribute(name) {\n    return this.composition.canSetCurrentAttribute(name)\n  }\n\n  deactivateAttribute(name) {\n    return this.composition.removeCurrentAttribute(name)\n  }\n\n  // Nesting level\n\n  canDecreaseNestingLevel() {\n    return this.composition.canDecreaseNestingLevel()\n  }\n\n  canIncreaseNestingLevel() {\n    return this.composition.canIncreaseNestingLevel()\n  }\n\n  decreaseNestingLevel() {\n    if (this.canDecreaseNestingLevel()) {\n      return this.composition.decreaseNestingLevel()\n    }\n  }\n\n  increaseNestingLevel() {\n    if (this.canIncreaseNestingLevel()) {\n      return this.composition.increaseNestingLevel()\n    }\n  }\n\n  // Undo/redo\n\n  canRedo() {\n    return this.undoManager.canRedo()\n  }\n\n  canUndo() {\n    return this.undoManager.canUndo()\n  }\n\n  recordUndoEntry(description, { context, consolidatable } = {}) {\n    return this.undoManager.recordUndoEntry(description, { context, consolidatable })\n  }\n\n  redo() {\n    if (this.canRedo()) {\n      return this.undoManager.redo()\n    }\n  }\n\n  undo() {\n    if (this.canUndo()) {\n      return this.undoManager.undo()\n    }\n  }\n}\n","import \"trix/models/attachment\"\nimport BasicObject from \"trix/core/basic_object\"\n\nexport default class ManagedAttachment extends BasicObject {\n  constructor(attachmentManager, attachment) {\n    super(...arguments)\n    this.attachmentManager = attachmentManager\n    this.attachment = attachment\n    this.id = this.attachment.id\n    this.file = this.attachment.file\n  }\n\n  remove() {\n    return this.attachmentManager.requestRemovalOfAttachment(this.attachment)\n  }\n}\n\nManagedAttachment.proxyMethod(\"attachment.getAttribute\")\nManagedAttachment.proxyMethod(\"attachment.hasAttribute\")\nManagedAttachment.proxyMethod(\"attachment.setAttribute\")\nManagedAttachment.proxyMethod(\"attachment.getAttributes\")\nManagedAttachment.proxyMethod(\"attachment.setAttributes\")\nManagedAttachment.proxyMethod(\"attachment.isPending\")\nManagedAttachment.proxyMethod(\"attachment.isPreviewable\")\nManagedAttachment.proxyMethod(\"attachment.getURL\")\nManagedAttachment.proxyMethod(\"attachment.getHref\")\nManagedAttachment.proxyMethod(\"attachment.getFilename\")\nManagedAttachment.proxyMethod(\"attachment.getFilesize\")\nManagedAttachment.proxyMethod(\"attachment.getFormattedFilesize\")\nManagedAttachment.proxyMethod(\"attachment.getExtension\")\nManagedAttachment.proxyMethod(\"attachment.getContentType\")\nManagedAttachment.proxyMethod(\"attachment.getFile\")\nManagedAttachment.proxyMethod(\"attachment.setFile\")\nManagedAttachment.proxyMethod(\"attachment.releaseFile\")\nManagedAttachment.proxyMethod(\"attachment.getUploadProgress\")\nManagedAttachment.proxyMethod(\"attachment.setUploadProgress\")\n\n","import ManagedAttachment from \"trix/models/managed_attachment\"\nimport BasicObject from \"trix/core/basic_object\"\n\nexport default class AttachmentManager extends BasicObject {\n  constructor(attachments = []) {\n    super(...arguments)\n    this.managedAttachments = {}\n    Array.from(attachments).forEach((attachment) => {\n      this.manageAttachment(attachment)\n    })\n  }\n\n  getAttachments() {\n    const result = []\n    for (const id in this.managedAttachments) {\n      const attachment = this.managedAttachments[id]\n      result.push(attachment)\n    }\n    return result\n  }\n\n  manageAttachment(attachment) {\n    if (!this.managedAttachments[attachment.id]) {\n      this.managedAttachments[attachment.id] = new ManagedAttachment(this, attachment)\n    }\n    return this.managedAttachments[attachment.id]\n  }\n\n  attachmentIsManaged(attachment) {\n    return attachment.id in this.managedAttachments\n  }\n\n  requestRemovalOfAttachment(attachment) {\n    if (this.attachmentIsManaged(attachment)) {\n      return this.delegate?.attachmentManagerDidRequestRemovalOfAttachment?.(attachment)\n    }\n  }\n\n  unmanageAttachment(attachment) {\n    const managedAttachment = this.managedAttachments[attachment.id]\n    delete this.managedAttachments[attachment.id]\n    return managedAttachment\n  }\n}\n","/* eslint-disable\n    no-var,\n    prefer-const,\n*/\nimport {\n  elementContainsNode,\n  findChildIndexOfNode,\n  nodeIsAttachmentElement,\n  nodeIsBlockContainer,\n  nodeIsBlockStart,\n  nodeIsBlockStartComment,\n  nodeIsCursorTarget,\n  nodeIsEmptyTextNode,\n  nodeIsTextNode,\n  tagName,\n  walkTree,\n} from \"trix/core/helpers\"\n\nexport default class LocationMapper {\n  constructor(element) {\n    this.element = element\n  }\n\n  findLocationFromContainerAndOffset(container, offset, { strict } = { strict: true }) {\n    let childIndex = 0\n    let foundBlock = false\n    const location = { index: 0, offset: 0 }\n    const attachmentElement = this.findAttachmentElementParentForNode(container)\n\n    if (attachmentElement) {\n      container = attachmentElement.parentNode\n      offset = findChildIndexOfNode(attachmentElement)\n    }\n\n    const walker = walkTree(this.element, { usingFilter: rejectAttachmentContents })\n\n    while (walker.nextNode()) {\n      const node = walker.currentNode\n\n      if (node === container && nodeIsTextNode(container)) {\n        if (!nodeIsCursorTarget(node)) {\n          location.offset += offset\n        }\n        break\n      } else {\n        if (node.parentNode === container) {\n          if (childIndex++ === offset) {\n            break\n          }\n        } else if (!elementContainsNode(container, node)) {\n          if (childIndex > 0) {\n            break\n          }\n        }\n\n        if (nodeIsBlockStart(node, { strict })) {\n          if (foundBlock) {\n            location.index++\n          }\n          location.offset = 0\n          foundBlock = true\n        } else {\n          location.offset += nodeLength(node)\n        }\n      }\n    }\n\n    return location\n  }\n\n  findContainerAndOffsetFromLocation(location) {\n    let container, offset\n    if (location.index === 0 && location.offset === 0) {\n      container = this.element\n      offset = 0\n\n      while (container.firstChild) {\n        container = container.firstChild\n        if (nodeIsBlockContainer(container)) {\n          offset = 1\n          break\n        }\n      }\n\n      return [ container, offset ]\n    }\n\n    let [ node, nodeOffset ] = this.findNodeAndOffsetFromLocation(location)\n    if (!node) {\n      return\n    }\n\n    if (nodeIsTextNode(node)) {\n      if (nodeLength(node) === 0) {\n        container = node.parentNode.parentNode\n        offset = findChildIndexOfNode(node.parentNode)\n        if (nodeIsCursorTarget(node, { name: \"right\" })) {\n          offset++\n        }\n      } else {\n        container = node\n        offset = location.offset - nodeOffset\n      }\n    } else {\n      container = node.parentNode\n\n      if (!nodeIsBlockStart(node.previousSibling)) {\n        if (!nodeIsBlockContainer(container)) {\n          while (node === container.lastChild) {\n            node = container\n            container = container.parentNode\n            if (nodeIsBlockContainer(container)) {\n              break\n            }\n          }\n        }\n      }\n\n      offset = findChildIndexOfNode(node)\n      if (location.offset !== 0) {\n        offset++\n      }\n    }\n\n    return [ container, offset ]\n  }\n\n  findNodeAndOffsetFromLocation(location) {\n    let node, nodeOffset\n    let offset = 0\n\n    for (const currentNode of this.getSignificantNodesForIndex(location.index)) {\n      const length = nodeLength(currentNode)\n\n      if (location.offset <= offset + length) {\n        if (nodeIsTextNode(currentNode)) {\n          node = currentNode\n          nodeOffset = offset\n          if (location.offset === nodeOffset && nodeIsCursorTarget(node)) {\n            break\n          }\n        } else if (!node) {\n          node = currentNode\n          nodeOffset = offset\n        }\n      }\n\n      offset += length\n      if (offset > location.offset) {\n        break\n      }\n    }\n\n    return [ node, nodeOffset ]\n  }\n\n  // Private\n\n  findAttachmentElementParentForNode(node) {\n    while (node && node !== this.element) {\n      if (nodeIsAttachmentElement(node)) {\n        return node\n      }\n      node = node.parentNode\n    }\n  }\n\n  getSignificantNodesForIndex(index) {\n    const nodes = []\n    const walker = walkTree(this.element, { usingFilter: acceptSignificantNodes })\n    let recordingNodes = false\n\n    while (walker.nextNode()) {\n      const node = walker.currentNode\n      if (nodeIsBlockStartComment(node)) {\n        var blockIndex\n        if (blockIndex != null) {\n          blockIndex++\n        } else {\n          blockIndex = 0\n        }\n\n        if (blockIndex === index) {\n          recordingNodes = true\n        } else if (recordingNodes) {\n          break\n        }\n      } else if (recordingNodes) {\n        nodes.push(node)\n      }\n    }\n\n    return nodes\n  }\n}\n\nconst nodeLength = function(node) {\n  if (node.nodeType === Node.TEXT_NODE) {\n    if (nodeIsCursorTarget(node)) {\n      return 0\n    } else {\n      const string = node.textContent\n      return string.length\n    }\n  } else if (tagName(node) === \"br\" || nodeIsAttachmentElement(node)) {\n    return 1\n  } else {\n    return 0\n  }\n}\n\nconst acceptSignificantNodes = function(node) {\n  if (rejectEmptyTextNodes(node) === NodeFilter.FILTER_ACCEPT) {\n    return rejectAttachmentContents(node)\n  } else {\n    return NodeFilter.FILTER_REJECT\n  }\n}\n\nconst rejectEmptyTextNodes = function(node) {\n  if (nodeIsEmptyTextNode(node)) {\n    return NodeFilter.FILTER_REJECT\n  } else {\n    return NodeFilter.FILTER_ACCEPT\n  }\n}\n\nconst rejectAttachmentContents = function(node) {\n  if (nodeIsAttachmentElement(node.parentNode)) {\n    return NodeFilter.FILTER_REJECT\n  } else {\n    return NodeFilter.FILTER_ACCEPT\n  }\n}\n","/* eslint-disable\n    id-length,\n    no-empty,\n*/\nimport { getDOMRange, setDOMRange } from \"trix/core/helpers\"\n\nexport default class PointMapper {\n  createDOMRangeFromPoint({ x, y }) {\n    let domRange\n    if (document.caretPositionFromPoint) {\n      const { offsetNode, offset } = document.caretPositionFromPoint(x, y)\n      domRange = document.createRange()\n      domRange.setStart(offsetNode, offset)\n      return domRange\n    } else if (document.caretRangeFromPoint) {\n      return document.caretRangeFromPoint(x, y)\n    } else if (document.body.createTextRange) {\n      const originalDOMRange = getDOMRange()\n      try {\n        // IE 11 throws \"Unspecified error\" when using moveToPoint\n        // during a drag-and-drop operation.\n        const textRange = document.body.createTextRange()\n        textRange.moveToPoint(x, y)\n        textRange.select()\n      } catch (error) {}\n      domRange = getDOMRange()\n      setDOMRange(originalDOMRange)\n      return domRange\n    }\n  }\n\n  getClientRectsForDOMRange(domRange) {\n    const array = Array.from(domRange.getClientRects())\n    const start = array[0]\n    const end = array[array.length - 1]\n\n    return [ start, end ]\n  }\n}\n","/* eslint-disable\n*/\nimport BasicObject from \"trix/core/basic_object\"\n\nimport LocationMapper from \"trix/models/location_mapper\"\nimport PointMapper from \"trix/models/point_mapper\"\n\nimport {\n  elementContainsNode,\n  getDOMRange,\n  getDOMSelection,\n  handleEvent,\n  innerElementIsActive,\n  nodeIsCursorTarget,\n  normalizeRange,\n  rangeIsCollapsed,\n  rangesAreEqual,\n  setDOMRange,\n} from \"trix/core/helpers\"\n\nexport default class SelectionManager extends BasicObject {\n  constructor(element) {\n    super(...arguments)\n    this.didMouseDown = this.didMouseDown.bind(this)\n    this.selectionDidChange = this.selectionDidChange.bind(this)\n    this.element = element\n    this.locationMapper = new LocationMapper(this.element)\n    this.pointMapper = new PointMapper()\n    this.lockCount = 0\n    handleEvent(\"mousedown\", { onElement: this.element, withCallback: this.didMouseDown })\n  }\n  getLocationRange(options = {}) {\n    if (options.strict === false) {\n      return this.createLocationRangeFromDOMRange(getDOMRange())\n    } else if (options.ignoreLock) {\n      return this.currentLocationRange\n    } else if (this.lockedLocationRange) {\n      return this.lockedLocationRange\n    } else {\n      return this.currentLocationRange\n    }\n  }\n\n  setLocationRange(locationRange) {\n    if (this.lockedLocationRange) {\n      return\n    }\n    locationRange = normalizeRange(locationRange)\n\n    const domRange = this.createDOMRangeFromLocationRange(locationRange)\n    if (domRange) {\n      setDOMRange(domRange)\n      this.updateCurrentLocationRange(locationRange)\n    }\n  }\n\n  setLocationRangeFromPointRange(pointRange) {\n    pointRange = normalizeRange(pointRange)\n    const startLocation = this.getLocationAtPoint(pointRange[0])\n    const endLocation = this.getLocationAtPoint(pointRange[1])\n    this.setLocationRange([ startLocation, endLocation ])\n  }\n\n  getClientRectAtLocationRange(locationRange) {\n    const domRange = this.createDOMRangeFromLocationRange(locationRange)\n    if (domRange) {\n      return this.getClientRectsForDOMRange(domRange)[1]\n    }\n  }\n\n  locationIsCursorTarget(location) {\n    const node = Array.from(this.findNodeAndOffsetFromLocation(location))[0]\n    return nodeIsCursorTarget(node)\n  }\n\n  lock() {\n    if (this.lockCount++ === 0) {\n      this.updateCurrentLocationRange()\n      this.lockedLocationRange = this.getLocationRange()\n    }\n  }\n\n  unlock() {\n    if (--this.lockCount === 0) {\n      const { lockedLocationRange } = this\n      this.lockedLocationRange = null\n      if (lockedLocationRange != null) {\n        return this.setLocationRange(lockedLocationRange)\n      }\n    }\n  }\n\n  clearSelection() {\n    return getDOMSelection()?.removeAllRanges()\n  }\n\n  selectionIsCollapsed() {\n    return getDOMRange()?.collapsed === true\n  }\n\n  selectionIsExpanded() {\n    return !this.selectionIsCollapsed()\n  }\n\n  createLocationRangeFromDOMRange(domRange, options) {\n    if (domRange == null || !this.domRangeWithinElement(domRange)) return\n\n    const start = this.findLocationFromContainerAndOffset(domRange.startContainer, domRange.startOffset, options)\n    if (!start) return\n\n    const end = domRange.collapsed\n      ? undefined\n      : this.findLocationFromContainerAndOffset(domRange.endContainer, domRange.endOffset, options)\n\n    return normalizeRange([ start, end ])\n  }\n\n  didMouseDown() {\n    return this.pauseTemporarily()\n  }\n\n  pauseTemporarily() {\n    let resumeHandlers\n    this.paused = true\n\n    const resume = () => {\n      this.paused = false\n      clearTimeout(resumeTimeout)\n\n      Array.from(resumeHandlers).forEach((handler) => {\n        handler.destroy()\n      })\n\n      if (elementContainsNode(document, this.element)) {\n        return this.selectionDidChange()\n      }\n    }\n\n    const resumeTimeout = setTimeout(resume, 200)\n\n    resumeHandlers = [ \"mousemove\", \"keydown\" ].map((eventName) =>\n      handleEvent(eventName, { onElement: document, withCallback: resume })\n    )\n  }\n\n  selectionDidChange() {\n    if (!this.paused && !innerElementIsActive(this.element)) {\n      return this.updateCurrentLocationRange()\n    }\n  }\n\n  updateCurrentLocationRange(locationRange) {\n    if (locationRange != null ? locationRange : locationRange = this.createLocationRangeFromDOMRange(getDOMRange())) {\n      if (!rangesAreEqual(locationRange, this.currentLocationRange)) {\n        this.currentLocationRange = locationRange\n        return this.delegate?.locationRangeDidChange?.(this.currentLocationRange.slice(0))\n      }\n    }\n  }\n\n  createDOMRangeFromLocationRange(locationRange) {\n    const rangeStart = this.findContainerAndOffsetFromLocation(locationRange[0])\n    const rangeEnd = rangeIsCollapsed(locationRange)\n      ? rangeStart\n      : this.findContainerAndOffsetFromLocation(locationRange[1]) || rangeStart\n\n    if (rangeStart != null && rangeEnd != null) {\n      const domRange = document.createRange()\n      domRange.setStart(...Array.from(rangeStart || []))\n      domRange.setEnd(...Array.from(rangeEnd || []))\n      return domRange\n    }\n  }\n\n  getLocationAtPoint(point) {\n    const domRange = this.createDOMRangeFromPoint(point)\n    if (domRange) {\n      return this.createLocationRangeFromDOMRange(domRange)?.[0]\n    }\n  }\n\n  domRangeWithinElement(domRange) {\n    if (domRange.collapsed) {\n      return elementContainsNode(this.element, domRange.startContainer)\n    } else {\n      return (\n        elementContainsNode(this.element, domRange.startContainer) &&\n        elementContainsNode(this.element, domRange.endContainer)\n      )\n    }\n  }\n}\n\nSelectionManager.proxyMethod(\"locationMapper.findLocationFromContainerAndOffset\")\nSelectionManager.proxyMethod(\"locationMapper.findContainerAndOffsetFromLocation\")\nSelectionManager.proxyMethod(\"locationMapper.findNodeAndOffsetFromLocation\")\nSelectionManager.proxyMethod(\"pointMapper.createDOMRangeFromPoint\")\nSelectionManager.proxyMethod(\"pointMapper.getClientRectsForDOMRange\")\n\n","/* eslint-disable\n    id-length,\n*/\nimport config from \"trix/config\"\n\nimport { serializeToContentType } from \"trix/core/serialization\"\n\nimport Controller from \"trix/controllers/controller\"\nimport Level0InputController from \"trix/controllers/level_0_input_controller\"\nimport Level2InputController from \"trix/controllers/level_2_input_controller\"\nimport CompositionController from \"trix/controllers/composition_controller\"\nimport ToolbarController from \"trix/controllers/toolbar_controller\"\nimport Composition from \"trix/models/composition\"\nimport Editor from \"trix/models/editor\"\nimport AttachmentManager from \"trix/models/attachment_manager\"\nimport SelectionManager from \"trix/models/selection_manager\"\n\nimport { getBlockConfig, objectsAreEqual, rangeIsCollapsed, rangesAreEqual } from \"trix/core/helpers\"\nimport { selectionChangeObserver } from \"trix/observers/selection_change_observer\"\n\nconst snapshotsAreEqual = (a, b) => rangesAreEqual(a.selectedRange, b.selectedRange) && a.document.isEqualTo(b.document)\n\nexport default class EditorController extends Controller {\n  static actions = {\n    undo: {\n      test() {\n        return this.editor.canUndo()\n      },\n      perform() {\n        return this.editor.undo()\n      },\n    },\n    redo: {\n      test() {\n        return this.editor.canRedo()\n      },\n      perform() {\n        return this.editor.redo()\n      },\n    },\n    link: {\n      test() {\n        return this.editor.canActivateAttribute(\"href\")\n      },\n    },\n    increaseNestingLevel: {\n      test() {\n        return this.editor.canIncreaseNestingLevel()\n      },\n      perform() {\n        return this.editor.increaseNestingLevel() && this.render()\n      },\n    },\n    decreaseNestingLevel: {\n      test() {\n        return this.editor.canDecreaseNestingLevel()\n      },\n      perform() {\n        return this.editor.decreaseNestingLevel() && this.render()\n      },\n    },\n    attachFiles: {\n      test() {\n        return true\n      },\n      perform() {\n        return config.input.pickFiles(this.editor.insertFiles)\n      },\n    },\n  }\n\n  constructor({ editorElement, document, html }) {\n    super(...arguments)\n    this.editorElement = editorElement\n    this.selectionManager = new SelectionManager(this.editorElement)\n    this.selectionManager.delegate = this\n\n    this.composition = new Composition()\n    this.composition.delegate = this\n\n    this.attachmentManager = new AttachmentManager(this.composition.getAttachments())\n    this.attachmentManager.delegate = this\n\n    this.inputController =\n      config.input.getLevel() === 2\n        ? new Level2InputController(this.editorElement)\n        : new Level0InputController(this.editorElement)\n\n    this.inputController.delegate = this\n    this.inputController.responder = this.composition\n\n    this.compositionController = new CompositionController(this.editorElement, this.composition)\n    this.compositionController.delegate = this\n\n    this.toolbarController = new ToolbarController(this.editorElement.toolbarElement)\n    this.toolbarController.delegate = this\n\n    this.editor = new Editor(this.composition, this.selectionManager, this.editorElement)\n    if (document) {\n      this.editor.loadDocument(document)\n    } else {\n      this.editor.loadHTML(html)\n    }\n  }\n\n  registerSelectionManager() {\n    return selectionChangeObserver.registerSelectionManager(this.selectionManager)\n  }\n\n  unregisterSelectionManager() {\n    return selectionChangeObserver.unregisterSelectionManager(this.selectionManager)\n  }\n\n  render() {\n    return this.compositionController.render()\n  }\n\n  reparse() {\n    return this.composition.replaceHTML(this.editorElement.innerHTML)\n  }\n\n  // Composition delegate\n\n  compositionDidChangeDocument(document) {\n    this.notifyEditorElement(\"document-change\")\n    if (!this.handlingInput) {\n      return this.render()\n    }\n  }\n\n  compositionDidChangeCurrentAttributes(currentAttributes) {\n    this.currentAttributes = currentAttributes\n    this.toolbarController.updateAttributes(this.currentAttributes)\n    this.updateCurrentActions()\n    return this.notifyEditorElement(\"attributes-change\", { attributes: this.currentAttributes })\n  }\n\n  compositionDidPerformInsertionAtRange(range) {\n    if (this.pasting) {\n      this.pastedRange = range\n    }\n  }\n\n  compositionShouldAcceptFile(file) {\n    return this.notifyEditorElement(\"file-accept\", { file })\n  }\n\n  compositionDidAddAttachment(attachment) {\n    const managedAttachment = this.attachmentManager.manageAttachment(attachment)\n    return this.notifyEditorElement(\"attachment-add\", { attachment: managedAttachment })\n  }\n\n  compositionDidEditAttachment(attachment) {\n    this.compositionController.rerenderViewForObject(attachment)\n    const managedAttachment = this.attachmentManager.manageAttachment(attachment)\n    this.notifyEditorElement(\"attachment-edit\", { attachment: managedAttachment })\n    return this.notifyEditorElement(\"change\")\n  }\n\n  compositionDidChangeAttachmentPreviewURL(attachment) {\n    this.compositionController.invalidateViewForObject(attachment)\n    return this.notifyEditorElement(\"change\")\n  }\n\n  compositionDidRemoveAttachment(attachment) {\n    const managedAttachment = this.attachmentManager.unmanageAttachment(attachment)\n    return this.notifyEditorElement(\"attachment-remove\", { attachment: managedAttachment })\n  }\n\n  compositionDidStartEditingAttachment(attachment, options) {\n    this.attachmentLocationRange = this.composition.document.getLocationRangeOfAttachment(attachment)\n    this.compositionController.installAttachmentEditorForAttachment(attachment, options)\n    return this.selectionManager.setLocationRange(this.attachmentLocationRange)\n  }\n\n  compositionDidStopEditingAttachment(attachment) {\n    this.compositionController.uninstallAttachmentEditor()\n    this.attachmentLocationRange = null\n  }\n\n  compositionDidRequestChangingSelectionToLocationRange(locationRange) {\n    if (this.loadingSnapshot && !this.isFocused()) {\n      return\n    }\n    this.requestedLocationRange = locationRange\n    this.compositionRevisionWhenLocationRangeRequested = this.composition.revision\n    if (!this.handlingInput) {\n      return this.render()\n    }\n  }\n\n  compositionWillLoadSnapshot() {\n    this.loadingSnapshot = true\n  }\n\n  compositionDidLoadSnapshot() {\n    this.compositionController.refreshViewCache()\n    this.render()\n    this.loadingSnapshot = false\n  }\n\n  getSelectionManager() {\n    return this.selectionManager\n  }\n\n  // Attachment manager delegate\n\n  attachmentManagerDidRequestRemovalOfAttachment(attachment) {\n    return this.removeAttachment(attachment)\n  }\n\n  // Document controller delegate\n\n  compositionControllerWillSyncDocumentView() {\n    this.inputController.editorWillSyncDocumentView()\n    this.selectionManager.lock()\n    return this.selectionManager.clearSelection()\n  }\n\n  compositionControllerDidSyncDocumentView() {\n    this.inputController.editorDidSyncDocumentView()\n    this.selectionManager.unlock()\n    this.updateCurrentActions()\n    return this.notifyEditorElement(\"sync\")\n  }\n\n  compositionControllerDidRender() {\n    if (this.requestedLocationRange) {\n      if (this.compositionRevisionWhenLocationRangeRequested === this.composition.revision) {\n        this.selectionManager.setLocationRange(this.requestedLocationRange)\n      }\n      this.requestedLocationRange = null\n      this.compositionRevisionWhenLocationRangeRequested = null\n    }\n\n    if (this.renderedCompositionRevision !== this.composition.revision) {\n      this.runEditorFilters()\n      this.composition.updateCurrentAttributes()\n      this.notifyEditorElement(\"render\")\n    }\n\n    this.renderedCompositionRevision = this.composition.revision\n  }\n\n  compositionControllerDidFocus() {\n    if (this.isFocusedInvisibly()) {\n      this.setLocationRange({ index: 0, offset: 0 })\n    }\n    this.toolbarController.hideDialog()\n    return this.notifyEditorElement(\"focus\")\n  }\n\n  compositionControllerDidBlur() {\n    return this.notifyEditorElement(\"blur\")\n  }\n\n  compositionControllerDidSelectAttachment(attachment, options) {\n    this.toolbarController.hideDialog()\n    return this.composition.editAttachment(attachment, options)\n  }\n\n  compositionControllerDidRequestDeselectingAttachment(attachment) {\n    const locationRange = this.attachmentLocationRange || this.composition.document.getLocationRangeOfAttachment(attachment)\n    return this.selectionManager.setLocationRange(locationRange[1])\n  }\n\n  compositionControllerWillUpdateAttachment(attachment) {\n    return this.editor.recordUndoEntry(\"Edit Attachment\", { context: attachment.id, consolidatable: true })\n  }\n\n  compositionControllerDidRequestRemovalOfAttachment(attachment) {\n    return this.removeAttachment(attachment)\n  }\n\n  // Input controller delegate\n\n  inputControllerWillHandleInput() {\n    this.handlingInput = true\n    this.requestedRender = false\n  }\n\n  inputControllerDidRequestRender() {\n    this.requestedRender = true\n  }\n\n  inputControllerDidHandleInput() {\n    this.handlingInput = false\n    if (this.requestedRender) {\n      this.requestedRender = false\n      return this.render()\n    }\n  }\n\n  inputControllerDidAllowUnhandledInput() {\n    return this.notifyEditorElement(\"change\")\n  }\n\n  inputControllerDidRequestReparse() {\n    return this.reparse()\n  }\n\n  inputControllerWillPerformTyping() {\n    return this.recordTypingUndoEntry()\n  }\n\n  inputControllerWillPerformFormatting(attributeName) {\n    return this.recordFormattingUndoEntry(attributeName)\n  }\n\n  inputControllerWillCutText() {\n    return this.editor.recordUndoEntry(\"Cut\")\n  }\n\n  inputControllerWillPaste(paste) {\n    this.editor.recordUndoEntry(\"Paste\")\n    this.pasting = true\n    return this.notifyEditorElement(\"before-paste\", { paste })\n  }\n\n  inputControllerDidPaste(paste) {\n    paste.range = this.pastedRange\n    this.pastedRange = null\n    this.pasting = null\n    return this.notifyEditorElement(\"paste\", { paste })\n  }\n\n  inputControllerWillMoveText() {\n    return this.editor.recordUndoEntry(\"Move\")\n  }\n\n  inputControllerWillAttachFiles() {\n    return this.editor.recordUndoEntry(\"Drop Files\")\n  }\n\n  inputControllerWillPerformUndo() {\n    return this.editor.undo()\n  }\n\n  inputControllerWillPerformRedo() {\n    return this.editor.redo()\n  }\n\n  inputControllerDidReceiveKeyboardCommand(keys) {\n    return this.toolbarController.applyKeyboardCommand(keys)\n  }\n\n  inputControllerDidStartDrag() {\n    this.locationRangeBeforeDrag = this.selectionManager.getLocationRange()\n  }\n\n  inputControllerDidReceiveDragOverPoint(point) {\n    return this.selectionManager.setLocationRangeFromPointRange(point)\n  }\n\n  inputControllerDidCancelDrag() {\n    this.selectionManager.setLocationRange(this.locationRangeBeforeDrag)\n    this.locationRangeBeforeDrag = null\n  }\n\n  // Selection manager delegate\n\n  locationRangeDidChange(locationRange) {\n    this.composition.updateCurrentAttributes()\n    this.updateCurrentActions()\n    if (this.attachmentLocationRange && !rangesAreEqual(this.attachmentLocationRange, locationRange)) {\n      this.composition.stopEditingAttachment()\n    }\n    return this.notifyEditorElement(\"selection-change\")\n  }\n\n  // Toolbar controller delegate\n\n  toolbarDidClickButton() {\n    if (!this.getLocationRange()) {\n      return this.setLocationRange({ index: 0, offset: 0 })\n    }\n  }\n\n  toolbarDidInvokeAction(actionName) {\n    return this.invokeAction(actionName)\n  }\n\n  toolbarDidToggleAttribute(attributeName) {\n    this.recordFormattingUndoEntry(attributeName)\n    this.composition.toggleCurrentAttribute(attributeName)\n    this.render()\n    if (!this.selectionFrozen) {\n      return this.editorElement.focus()\n    }\n  }\n\n  toolbarDidUpdateAttribute(attributeName, value) {\n    this.recordFormattingUndoEntry(attributeName)\n    this.composition.setCurrentAttribute(attributeName, value)\n    this.render()\n    if (!this.selectionFrozen) {\n      return this.editorElement.focus()\n    }\n  }\n\n  toolbarDidRemoveAttribute(attributeName) {\n    this.recordFormattingUndoEntry(attributeName)\n    this.composition.removeCurrentAttribute(attributeName)\n    this.render()\n    if (!this.selectionFrozen) {\n      return this.editorElement.focus()\n    }\n  }\n\n  toolbarWillShowDialog(dialogElement) {\n    this.composition.expandSelectionForEditing()\n    return this.freezeSelection()\n  }\n\n  toolbarDidShowDialog(dialogName) {\n    return this.notifyEditorElement(\"toolbar-dialog-show\", { dialogName })\n  }\n\n  toolbarDidHideDialog(dialogName) {\n    this.thawSelection()\n    this.editorElement.focus()\n    return this.notifyEditorElement(\"toolbar-dialog-hide\", { dialogName })\n  }\n\n  // Selection\n\n  freezeSelection() {\n    if (!this.selectionFrozen) {\n      this.selectionManager.lock()\n      this.composition.freezeSelection()\n      this.selectionFrozen = true\n      return this.render()\n    }\n  }\n\n  thawSelection() {\n    if (this.selectionFrozen) {\n      this.composition.thawSelection()\n      this.selectionManager.unlock()\n      this.selectionFrozen = false\n      return this.render()\n    }\n  }\n\n  canInvokeAction(actionName) {\n    if (this.actionIsExternal(actionName)) {\n      return true\n    } else {\n      return !!this.actions[actionName]?.test?.call(this)\n    }\n  }\n\n  invokeAction(actionName) {\n    if (this.actionIsExternal(actionName)) {\n      return this.notifyEditorElement(\"action-invoke\", { actionName })\n    } else {\n      return this.actions[actionName]?.perform?.call(this)\n    }\n  }\n\n  actionIsExternal(actionName) {\n    return /^x-./.test(actionName)\n  }\n\n  getCurrentActions() {\n    const result = {}\n    for (const actionName in this.actions) {\n      result[actionName] = this.canInvokeAction(actionName)\n    }\n    return result\n  }\n\n  updateCurrentActions() {\n    const currentActions = this.getCurrentActions()\n    if (!objectsAreEqual(currentActions, this.currentActions)) {\n      this.currentActions = currentActions\n      this.toolbarController.updateActions(this.currentActions)\n      return this.notifyEditorElement(\"actions-change\", { actions: this.currentActions })\n    }\n  }\n\n  // Editor filters\n\n  runEditorFilters() {\n    let snapshot = this.composition.getSnapshot()\n\n    Array.from(this.editor.filters).forEach((filter) => {\n      const { document, selectedRange } = snapshot\n      snapshot = filter.call(this.editor, snapshot) || {}\n      if (!snapshot.document) {\n        snapshot.document = document\n      }\n      if (!snapshot.selectedRange) {\n        snapshot.selectedRange = selectedRange\n      }\n    })\n\n    if (!snapshotsAreEqual(snapshot, this.composition.getSnapshot())) {\n      return this.composition.loadSnapshot(snapshot)\n    }\n  }\n\n  // Private\n\n  updateInputElement() {\n    const element = this.compositionController.getSerializableElement()\n    const value = serializeToContentType(element, \"text/html\")\n    return this.editorElement.setInputElementValue(value)\n  }\n\n  notifyEditorElement(message, data) {\n    switch (message) {\n      case \"document-change\":\n        this.documentChangedSinceLastRender = true\n        break\n      case \"render\":\n        if (this.documentChangedSinceLastRender) {\n          this.documentChangedSinceLastRender = false\n          this.notifyEditorElement(\"change\")\n        }\n        break\n      case \"change\":\n      case \"attachment-add\":\n      case \"attachment-edit\":\n      case \"attachment-remove\":\n        this.updateInputElement()\n        break\n    }\n\n    return this.editorElement.notify(message, data)\n  }\n\n  removeAttachment(attachment) {\n    this.editor.recordUndoEntry(\"Delete Attachment\")\n    this.composition.removeAttachment(attachment)\n    return this.render()\n  }\n\n  recordFormattingUndoEntry(attributeName) {\n    const blockConfig = getBlockConfig(attributeName)\n    const locationRange = this.selectionManager.getLocationRange()\n    if (blockConfig || !rangeIsCollapsed(locationRange)) {\n      return this.editor.recordUndoEntry(\"Formatting\", { context: this.getUndoContext(), consolidatable: true })\n    }\n  }\n\n  recordTypingUndoEntry() {\n    return this.editor.recordUndoEntry(\"Typing\", {\n      context: this.getUndoContext(this.currentAttributes),\n      consolidatable: true,\n    })\n  }\n\n  getUndoContext(...context) {\n    return [ this.getLocationContext(), this.getTimeContext(), ...Array.from(context) ]\n  }\n\n  getLocationContext() {\n    const locationRange = this.selectionManager.getLocationRange()\n    if (rangeIsCollapsed(locationRange)) {\n      return locationRange[0].index\n    } else {\n      return locationRange\n    }\n  }\n\n  getTimeContext() {\n    if (config.undoInterval > 0) {\n      return Math.floor(new Date().getTime() / config.undoInterval)\n    } else {\n      return 0\n    }\n  }\n\n  isFocused() {\n    return this.editorElement === this.editorElement.ownerDocument?.activeElement\n  }\n\n  // Detect \"Cursor disappears sporadically\" Firefox bug.\n  // - https://bugzilla.mozilla.org/show_bug.cgi?id=226301\n  isFocusedInvisibly() {\n    return this.isFocused() && !this.getLocationRange()\n  }\n\n  get actions() {\n    return this.constructor.actions\n  }\n}\n\nEditorController.proxyMethod(\"getSelectionManager().setLocationRange\")\nEditorController.proxyMethod(\"getSelectionManager().getLocationRange\")\n","import config from \"trix/config\"\n\nimport { installDefaultCSSForTagName } from \"trix/core/helpers\"\n\ninstallDefaultCSSForTagName(\"trix-toolbar\", `\\\n%t {\n  display: block;\n}\n\n%t {\n  white-space: nowrap;\n}\n\n%t [data-trix-dialog] {\n  display: none;\n}\n\n%t [data-trix-dialog][data-trix-active] {\n  display: block;\n}\n\n%t [data-trix-dialog] [data-trix-validate]:invalid {\n  background-color: #ffdddd;\n}\\\n`)\n\nexport default class TrixToolbarElement extends HTMLElement {\n\n  // Element lifecycle\n\n  connectedCallback() {\n    if (this.innerHTML === \"\") {\n      this.innerHTML = config.toolbar.getDefaultHTML()\n    }\n  }\n}\n\nwindow.customElements.define(\"trix-toolbar\", TrixToolbarElement)\n","import config from \"trix/config\"\n\nimport {\n  findClosestElementFromNode,\n  handleEvent,\n  handleEventOnce,\n  installDefaultCSSForTagName,\n  makeElement,\n  triggerEvent,\n} from \"trix/core/helpers\"\n\nimport { attachmentSelector } from \"trix/config/attachments\"\nimport EditorController from \"trix/controllers/editor_controller\"\nimport \"trix/elements/trix_toolbar_element\"\n\nlet id = 0\n\n// Contenteditable support helpers\n\nconst autofocus = function(element) {\n  if (!document.querySelector(\":focus\")) {\n    if (element.hasAttribute(\"autofocus\") && document.querySelector(\"[autofocus]\") === element) {\n      return element.focus()\n    }\n  }\n}\n\nconst makeEditable = function(element) {\n  if (element.hasAttribute(\"contenteditable\")) {\n    return\n  }\n  element.setAttribute(\"contenteditable\", \"\")\n  return handleEventOnce(\"focus\", {\n    onElement: element,\n    withCallback() {\n      return configureContentEditable(element)\n    },\n  })\n}\n\nconst configureContentEditable = function(element) {\n  disableObjectResizing(element)\n  return setDefaultParagraphSeparator(element)\n}\n\nconst disableObjectResizing = function(element) {\n  if (document.queryCommandSupported?.(\"enableObjectResizing\")) {\n    document.execCommand(\"enableObjectResizing\", false, false)\n    return handleEvent(\"mscontrolselect\", { onElement: element, preventDefault: true })\n  }\n}\n\nconst setDefaultParagraphSeparator = function(element) {\n  if (document.queryCommandSupported?.(\"DefaultParagraphSeparator\")) {\n    const { tagName } = config.blockAttributes.default\n    if ([ \"div\", \"p\" ].includes(tagName)) {\n      return document.execCommand(\"DefaultParagraphSeparator\", false, tagName)\n    }\n  }\n}\n\n// Accessibility helpers\n\nconst addAccessibilityRole = function(element) {\n  if (element.hasAttribute(\"role\")) {\n    return\n  }\n  return element.setAttribute(\"role\", \"textbox\")\n}\n\nconst ensureAriaLabel = function(element) {\n  if (element.hasAttribute(\"aria-label\") || element.hasAttribute(\"aria-labelledby\")) {\n    return\n  }\n\n  const update = function() {\n    const texts = Array.from(element.labels).map((label) => {\n      if (!label.contains(element)) return label.textContent\n    }).filter(text => text)\n\n    const text = texts.join(\" \")\n    if (text) {\n      return element.setAttribute(\"aria-label\", text)\n    } else {\n      return element.removeAttribute(\"aria-label\")\n    }\n  }\n  update()\n  return handleEvent(\"focus\", { onElement: element, withCallback: update })\n}\n\n// Style\n\nconst cursorTargetStyles = (function() {\n  if (config.browser.forcesObjectResizing) {\n    return {\n      display: \"inline\",\n      width: \"auto\",\n    }\n  } else {\n    return {\n      display: \"inline-block\",\n      width: \"1px\",\n    }\n  }\n})()\n\ninstallDefaultCSSForTagName(\"trix-editor\", `\\\n%t {\n    display: block;\n}\n\n%t:empty:not(:focus)::before {\n    content: attr(placeholder);\n    color: graytext;\n    cursor: text;\n    pointer-events: none;\n}\n\n%t a[contenteditable=false] {\n    cursor: text;\n}\n\n%t img {\n    max-width: 100%;\n    height: auto;\n}\n\n%t ${attachmentSelector} figcaption textarea {\n    resize: none;\n}\n\n%t ${attachmentSelector} figcaption textarea.trix-autoresize-clone {\n    position: absolute;\n    left: -9999px;\n    max-height: 0px;\n}\n\n%t ${attachmentSelector} figcaption[data-trix-placeholder]:empty::before {\n    content: attr(data-trix-placeholder);\n    color: graytext;\n}\n\n%t [data-trix-cursor-target] {\n    display: ${cursorTargetStyles.display} !important;\n    width: ${cursorTargetStyles.width} !important;\n    padding: 0 !important;\n    margin: 0 !important;\n    border: none !important;\n}\n\n%t [data-trix-cursor-target=left] {\n    vertical-align: top !important;\n    margin-left: -1px !important;\n}\n\n%t [data-trix-cursor-target=right] {\n    vertical-align: bottom !important;\n    margin-right: -1px !important;\n}\\\n`)\n\nexport default class TrixEditorElement extends HTMLElement {\n\n  // Properties\n\n  get trixId() {\n    if (this.hasAttribute(\"trix-id\")) {\n      return this.getAttribute(\"trix-id\")\n    } else {\n      this.setAttribute(\"trix-id\", ++id)\n      return this.trixId\n    }\n  }\n\n  get labels() {\n    const labels = []\n    if (this.id && this.ownerDocument) {\n      labels.push(...Array.from(this.ownerDocument.querySelectorAll(`label[for='${this.id}']`) || []))\n    }\n\n    const label = findClosestElementFromNode(this, { matchingSelector: \"label\" })\n    if (label) {\n      if ([ this, null ].includes(label.control)) {\n        labels.push(label)\n      }\n    }\n\n    return labels\n  }\n\n  get toolbarElement() {\n    if (this.hasAttribute(\"toolbar\")) {\n      return this.ownerDocument?.getElementById(this.getAttribute(\"toolbar\"))\n    } else if (this.parentNode) {\n      const toolbarId = `trix-toolbar-${this.trixId}`\n      this.setAttribute(\"toolbar\", toolbarId)\n      const element = makeElement(\"trix-toolbar\", { id: toolbarId })\n      this.parentNode.insertBefore(element, this)\n      return element\n    } else {\n      return undefined\n    }\n  }\n\n  get form() {\n    return this.inputElement?.form\n  }\n\n  get inputElement() {\n    if (this.hasAttribute(\"input\")) {\n      return this.ownerDocument?.getElementById(this.getAttribute(\"input\"))\n    } else if (this.parentNode) {\n      const inputId = `trix-input-${this.trixId}`\n      this.setAttribute(\"input\", inputId)\n      const element = makeElement(\"input\", { type: \"hidden\", id: inputId })\n      this.parentNode.insertBefore(element, this.nextElementSibling)\n      return element\n    } else {\n      return undefined\n    }\n  }\n\n  get editor() {\n    return this.editorController?.editor\n  }\n\n  get name() {\n    return this.inputElement?.name\n  }\n\n  get value() {\n    return this.inputElement?.value\n  }\n\n  set value(defaultValue) {\n    this.defaultValue = defaultValue\n    this.editor?.loadHTML(this.defaultValue)\n  }\n\n  // Controller delegate methods\n\n  notify(message, data) {\n    if (this.editorController) {\n      return triggerEvent(`trix-${message}`, { onElement: this, attributes: data })\n    }\n  }\n\n  setInputElementValue(value) {\n    if (this.inputElement) {\n      this.inputElement.value = value\n    }\n  }\n\n  // Element lifecycle\n\n  connectedCallback() {\n    if (!this.hasAttribute(\"data-trix-internal\")) {\n      makeEditable(this)\n      addAccessibilityRole(this)\n      ensureAriaLabel(this)\n\n      if (!this.editorController) {\n        triggerEvent(\"trix-before-initialize\", { onElement: this })\n        this.editorController = new EditorController({\n          editorElement: this,\n          html: this.defaultValue = this.value,\n        })\n        requestAnimationFrame(() => triggerEvent(\"trix-initialize\", { onElement: this }))\n      }\n      this.editorController.registerSelectionManager()\n      this.registerResetListener()\n      this.registerClickListener()\n      autofocus(this)\n    }\n  }\n\n  disconnectedCallback() {\n    this.editorController?.unregisterSelectionManager()\n    this.unregisterResetListener()\n    return this.unregisterClickListener()\n  }\n\n  // Form support\n\n  registerResetListener() {\n    this.resetListener = this.resetBubbled.bind(this)\n    return window.addEventListener(\"reset\", this.resetListener, false)\n  }\n\n  unregisterResetListener() {\n    return window.removeEventListener(\"reset\", this.resetListener, false)\n  }\n\n  registerClickListener() {\n    this.clickListener = this.clickBubbled.bind(this)\n    return window.addEventListener(\"click\", this.clickListener, false)\n  }\n\n  unregisterClickListener() {\n    return window.removeEventListener(\"click\", this.clickListener, false)\n  }\n\n  resetBubbled(event) {\n    if (event.defaultPrevented) {\n      return\n    }\n    if (event.target !== this.form) {\n      return\n    }\n    return this.reset()\n  }\n\n  clickBubbled(event) {\n    if (event.defaultPrevented) return\n    if (this.contains(event.target)) return\n\n    const label = findClosestElementFromNode(event.target, { matchingSelector: \"label\" })\n    if (!label) return\n\n    if (!Array.from(this.labels).includes(label)) return\n\n    return this.focus()\n  }\n\n  reset() {\n    this.value = this.defaultValue\n  }\n}\n\nwindow.customElements.define(\"trix-editor\", TrixEditorElement)\n","// Explicitly require this file (not included in the main\n// Trix bundle) to install the following global helpers.\n\nthis.getEditorElement = () => document.querySelector(\"trix-editor\")\n\nthis.getToolbarElement = () => getEditorElement().toolbarElement\n\nthis.getEditorController = () => getEditorElement().editorController\n\nthis.getEditor = () => getEditorController().editor\n\nthis.getComposition = () => getEditorController().composition\n\nthis.getDocument = () => getComposition().document\n\nthis.getSelectionManager = () => getEditorController().selectionManager\n","export const createEvent = function (type, properties = {}) {\n  const event = document.createEvent(\"Events\")\n  event.initEvent(type, true, true)\n  for (const key in properties) {\n    const value = properties[key]\n    event[key] = value\n  }\n  return event\n}\n\nexport const triggerEvent = (element, type, properties) => element.dispatchEvent(createEvent(type, properties))\n","import DocumentView from \"trix/views/document_view\"\nimport { normalizeRange } from \"trix/core/helpers\"\n\nconst { assert } = QUnit\n\nassert.locationRange = function (start, end) {\n  const expectedLocationRange = normalizeRange([ start, end ])\n  const actualLocationRange = getEditorController().getLocationRange()\n  this.deepEqual(actualLocationRange, expectedLocationRange)\n}\n\nassert.selectedRange = function (range) {\n  const expectedRange = normalizeRange(range)\n  const actualRange = getEditor().getSelectedRange()\n  this.deepEqual(actualRange, expectedRange)\n}\n\nassert.textAttributes = function (range, attributes) {\n  const document = window.getDocument().getDocumentAtRange(range)\n  const blocks = document.getBlocks()\n  if (blocks.length !== 1) {\n    throw `range ${JSON.stringify(range)} spans more than one block`\n  }\n\n  const locationRange = window.getDocument().locationRangeFromRange(range)\n  const textIndex = locationRange[0].index\n  const textRange = [ locationRange[0].offset, locationRange[1].offset ]\n  const text = window.getDocument().getTextAtIndex(textIndex).getTextAtRange(textRange)\n  const pieces = text.getPieces()\n  if (pieces.length !== 1) {\n    throw `range ${JSON.stringify(range)} must only span one piece`\n  }\n\n  const piece = pieces[0]\n  this.deepEqual(piece.getAttributes(), attributes)\n}\n\nassert.blockAttributes = function (range, attributes) {\n  const document = window.getDocument().getDocumentAtRange(range)\n  const blocks = document.getBlocks()\n  if (blocks.length !== 1) {\n    throw `range ${JSON.stringify(range)} spans more than one block`\n  }\n\n  const block = blocks[0]\n  this.deepEqual(block.getAttributes(), attributes)\n}\n\nassert.documentHTMLEqual = function (trixDocument, html) {\n  this.equal(getHTML(trixDocument), html)\n}\n\nconst getHTML = (trixDocument) => DocumentView.render(trixDocument).innerHTML\n\nexport { assert, getHTML }\n","export default () => `\\\n<trix-editor id=\"editor-without-labels\"></trix-editor>\n\n<label for=\"editor-with-aria-label\"><span>Label text</span></label>\n<trix-editor id=\"editor-with-aria-label\" aria-label=\"ARIA Label text\"></trix-editor>\n\n<span id=\"aria-labelledby-id\">ARIA Labelledby</span>\n<label for=\"editor-with-aria-labelledby\"><span>Label text</span></label>\n<trix-editor id=\"editor-with-aria-labelledby\" aria-labelledby=\"aria-labelledby-id\"></trix-editor>\n\n<label for=\"editor-with-labels\"><span>Label 1</span></label>\n<label for=\"editor-with-labels\"><span>Label 2</span></label>\n<label for=\"editor-with-labels\"><span>Label 3</span></label>\n<label>\n  <span>Label 4</span>\n  <trix-editor id=\"editor-with-labels\"></trix-editor>\n</label>\n\n<label id=\"modified-label\" for=\"editor-with-modified-label\">Original Value</label>\n<trix-editor id=\"editor-with-modified-label\"></trix-editor>\\\n`\n","export default () => \"<trix-editor autofocus placeholder=\\\"Say hello...\\\"></trix-editor>\"\n","export default () => `\\\n<input id=\"my_input\" type=\"hidden\" value=\"&lt;div&gt;Hello world&lt;/div&gt;\">\n<trix-editor input=\"my_input\" autofocus placeholder=\"Say hello...\"></trix-editor>\\`\\\n`\n","export default () => `\\\n<table>\n  <tr>\n    <td>\n      <trix-editor></trix-editor>\n    </td>\n  </tr>\n</table>\\\n`\n","export default () => `\\\n<style type=\"text/css\">\n  blockquote { font-style: italic; }\n  li { font-weight: bold; }\n</style>\n\n<trix-editor class=\"trix-content\"></trix-editor>\\\n`\n","export default () => `\\\n<style type=\"text/css\">\n  strong { font-weight: 500; }\n  span { font-weight: 600; }\n  article { font-weight: bold; }\n</style>\n\n<trix-editor class=\"trix-content\"></trix-editor>\\\n`\n","export const TEST_IMAGE_URL = \"data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACwAAAAAAQABAAACAkQBADs=\"\n","import { TEST_IMAGE_URL } from \"./test_image_url\"\n\nexport default () => `\\\n<trix-editor input=\"my_input\" autofocus placeholder=\"Say hello...\"></trix-editor>\n<input id=\"my_input\" type=\"hidden\" value=\"ab&lt;img src=&quot;${TEST_IMAGE_URL}&quot; width=&quot;10&quot; height=&quot;10&quot;&gt;\">\\\n`\n","export default () => `\\\n<label id=\"label-1\" for=\"editor\"><span>Label 1</span></label>\n<label id=\"label-2\">\n  Label 2\n  <trix-editor id=\"editor\"></trix-editor>\n</label>\n<label id=\"label-3\" for=\"editor\">Label 3</label>\\\n`\n","export default () => `\\\n<style type=\"text/css\">\n  .trix-content figure.attachment {\n    display: inline-block;\n  }\n</style>\n\n<trix-editor class=\"trix-content\"></trix-editor>\\\n`\n","export default () => `\\\n<ul id=\"my_editor\">\n  <li><trix-toolbar id=\"my_toolbar\"></trix-toolbar></li>\n  <li><trix-editor toolbar=\"my_toolbar\" input=\"my_input\" autofocus placeholder=\"Say hello...\"></trix-editor></li>\n  <li><input id=\"my_input\" type=\"hidden\" value=\"&lt;div&gt;Hello world&lt;/div&gt;\"></li>\n</ul>\\\n`\n","export default () => `\\\n<form id=\"ancestor-form\">\n  <trix-editor id=\"editor-with-ancestor-form\"></trix-editor>\n</form>\n\n<form id=\"input-form\">\n  <input type=\"hidden\" id=\"hidden-input\">\n</form>\n<trix-editor id=\"editor-with-input-form\" input=\"hidden-input\"></trix-editor>\n\n<trix-editor id=\"editor-with-no-form\"></trix-editor>\\\n`\n","import config from \"trix/config\"\nimport { ZERO_WIDTH_SPACE } from \"trix/constants\"\nimport { makeElement } from \"trix/core/helpers\"\n\nimport Text from \"trix/models/text\"\nimport Block from \"trix/models/block\"\nimport Attachment from \"trix/models/attachment\"\nimport Document from \"trix/models/document\"\nimport StringPiece from \"trix/models/string_piece\"\n\nimport editorDefaultAriaLabel from \"./editor_default_aria_label\"\nimport editorEmpty from \"./editor_empty\"\nimport editorHtml from \"./editor_html\"\nimport editorInTable from \"./editor_in_table\"\nimport editorWithBlockStyles from \"./editor_with_block_styles\"\nimport editorWithBoldStyles from \"./editor_with_bold_styles\"\nimport editorWithImage from \"./editor_with_image\"\nimport editorWithLabels from \"./editor_with_labels\"\nimport editorWithStyledContent from \"./editor_with_styled_content\"\nimport editorWithToolbarAndInput from \"./editor_with_toolbar_and_input\"\nimport editorsWithForms from \"./editors_with_forms\"\nimport { TEST_IMAGE_URL } from \"./test_image_url\"\n\nexport const fixtureTemplates = {\n  \"editor_default_aria_label\": editorDefaultAriaLabel,\n  \"editor_empty\": editorEmpty,\n  \"editor_html\": editorHtml,\n  \"editor_in_table\": editorInTable,\n  \"editor_with_block_styles\": editorWithBlockStyles,\n  \"editor_with_bold_styles\": editorWithBoldStyles,\n  \"editor_with_image\": editorWithImage,\n  \"editor_with_labels\": editorWithLabels,\n  \"editor_with_styled_content\": editorWithStyledContent,\n  \"editor_with_toolbar_and_input\": editorWithToolbarAndInput,\n  \"editors_with_forms\": editorsWithForms,\n}\n\nexport { TEST_IMAGE_URL }\n\nconst { css } = config\n\nconst createDocument = function (...parts) {\n  const blocks = (() => {\n    const result = []\n\n    Array.from(parts).forEach((part) => {\n      const [ string, textAttributes, blockAttributes ] = Array.from(part)\n      const text = Text.textForStringWithAttributes(string, textAttributes)\n      result.push(new Block(text, blockAttributes))\n    })\n\n    return result\n  })()\n  return new Document(blocks)\n}\n\nexport const createCursorTarget = (name) =>\n  makeElement({\n    tagName: \"span\",\n    textContent: ZERO_WIDTH_SPACE,\n    data: {\n      trixCursorTarget: name,\n      trixSerialize: false,\n    },\n  })\n\nconst cursorTargetLeft = createCursorTarget(\"left\").outerHTML\nconst cursorTargetRight = createCursorTarget(\"right\").outerHTML\n\nconst blockComment = \"<!--block-->\"\n\nconst removeWhitespace = (string) => string.replace(/\\s/g, \"\")\n\nexport const fixtures = {\n  \"bold text\": {\n    document: createDocument([ \"abc\", { bold: true } ]),\n    html: `<div>${blockComment}<strong>abc</strong></div>`,\n    serializedHTML: \"<div><strong>abc</strong></div>\",\n  },\n\n  \"bold, italic text\": {\n    document: createDocument([ \"abc\", { bold: true, italic: true } ]),\n    html: `<div>${blockComment}<strong><em>abc</em></strong></div>`,\n  },\n\n  \"text with newline\": {\n    document: createDocument([ \"ab\\nc\" ]),\n    html: `<div>${blockComment}ab<br>c</div>`,\n  },\n\n  \"text with link\": {\n    document: createDocument([ \"abc\", { href: \"http://example.com\" } ]),\n    html: `<div>${blockComment}<a href=\"http://example.com\">abc</a></div>`,\n  },\n\n  \"text with link and formatting\": {\n    document: createDocument([ \"abc\", { italic: true, href: \"http://example.com\" } ]),\n    html: `<div>${blockComment}<a href=\"http://example.com\"><em>abc</em></a></div>`,\n  },\n\n  \"partially formatted link\": {\n    document: new Document([\n      new Block(\n        new Text([\n          new StringPiece(\"ab\", { href: \"http://example.com\" }),\n          new StringPiece(\"c\", { href: \"http://example.com\", italic: true }),\n        ])\n      ),\n    ]),\n    html: `<div>${blockComment}<a href=\"http://example.com\">ab<em>c</em></a></div>`,\n  },\n\n  \"spaces 1\": {\n    document: createDocument([ \" a\" ]),\n    html: `<div>${blockComment}&nbsp;a</div>`,\n  },\n\n  \"spaces 2\": {\n    document: createDocument([ \"  a\" ]),\n    html: `<div>${blockComment}&nbsp; a</div>`,\n  },\n\n  \"spaces 3\": {\n    document: createDocument([ \"   a\" ]),\n    html: `<div>${blockComment}&nbsp; &nbsp;a</div>`,\n  },\n\n  \"spaces 4\": {\n    document: createDocument([ \" a \" ]),\n    html: `<div>${blockComment}&nbsp;a&nbsp;</div>`,\n  },\n\n  \"spaces 5\": {\n    document: createDocument([ \"a  b\" ]),\n    html: `<div>${blockComment}a&nbsp; b</div>`,\n  },\n\n  \"spaces 6\": {\n    document: createDocument([ \"a   b\" ]),\n    html: `<div>${blockComment}a &nbsp; b</div>`,\n  },\n\n  \"spaces 7\": {\n    document: createDocument([ \"a    b\" ]),\n    html: `<div>${blockComment}a&nbsp; &nbsp; b</div>`,\n  },\n\n  \"spaces 8\": {\n    document: createDocument([ \"a b \" ]),\n    html: `<div>${blockComment}a b&nbsp;</div>`,\n  },\n\n  \"spaces 9\": {\n    document: createDocument([ \"a b c\" ]),\n    html: `<div>${blockComment}a b c</div>`,\n  },\n\n  \"spaces 10\": {\n    document: createDocument([ \"a \" ]),\n    html: `<div>${blockComment}a&nbsp;</div>`,\n  },\n\n  \"spaces 11\": {\n    document: createDocument([ \"a  \" ]),\n    html: `<div>${blockComment}a &nbsp;</div>`,\n  },\n\n  \"spaces and formatting\": {\n    document: new Document([\n      new Block(\n        new Text([\n          new StringPiece(\" a \"),\n          new StringPiece(\"b\", { href: \"http://b.com\" }),\n          new StringPiece(\" \"),\n          new StringPiece(\"c\", { bold: true }),\n          new StringPiece(\" d\"),\n          new StringPiece(\" e \", { italic: true }),\n          new StringPiece(\" f  \"),\n        ])\n      ),\n    ]),\n    html: `<div>${blockComment}&nbsp;a <a href=\"http://b.com\">b</a> <strong>c</strong> d<em> e </em>&nbsp;f &nbsp;</div>`,\n  },\n\n  \"quote formatted block\": {\n    document: createDocument([ \"abc\", {}, [ \"quote\" ] ]),\n    html: `<blockquote>${blockComment}abc</blockquote>`,\n  },\n\n  \"code formatted block\": {\n    document: createDocument([ \"123\", {}, [ \"code\" ] ]),\n    html: `<pre>${blockComment}123</pre>`,\n  },\n\n  \"code with newline\": {\n    document: createDocument([ \"12\\n3\", {}, [ \"code\" ] ]),\n    html: `<pre>${blockComment}12\\n3</pre>`,\n  },\n\n  \"multiple blocks with block comments in their text\": {\n    document: createDocument([ `a${blockComment}b`, {}, [ \"quote\" ] ], [ `${blockComment}c`, {}, [ \"code\" ] ]),\n    html: `<blockquote>${blockComment}a&lt;!--block--&gt;b</blockquote><pre>${blockComment}&lt;!--block--&gt;c</pre>`,\n    serializedHTML: \"<blockquote>a&lt;!--block--&gt;b</blockquote><pre>&lt;!--block--&gt;c</pre>\",\n  },\n\n  \"unordered list with one item\": {\n    document: createDocument([ \"a\", {}, [ \"bulletList\", \"bullet\" ] ]),\n    html: `<ul><li>${blockComment}a</li></ul>`,\n  },\n\n  \"unordered list with bold text\": {\n    document: createDocument([ \"a\", { bold: true }, [ \"bulletList\", \"bullet\" ] ]),\n    html: `<ul><li>${blockComment}<strong>a</strong></li></ul>`,\n  },\n\n  \"unordered list with partially formatted text\": {\n    document: new Document([\n      new Block(new Text([ new StringPiece(\"a\"), new StringPiece(\"b\", { italic: true }) ]), [ \"bulletList\", \"bullet\" ]),\n    ]),\n    html: `<ul><li>${blockComment}a<em>b</em></li></ul>`,\n  },\n\n  \"unordered list with two items\": {\n    document: createDocument([ \"a\", {}, [ \"bulletList\", \"bullet\" ] ], [ \"b\", {}, [ \"bulletList\", \"bullet\" ] ]),\n    html: `<ul><li>${blockComment}a</li><li>${blockComment}b</li></ul>`,\n  },\n\n  \"unordered list surrounded by unformatted blocks\": {\n    document: createDocument([ \"a\" ], [ \"b\", {}, [ \"bulletList\", \"bullet\" ] ], [ \"c\" ]),\n    html: `<div>${blockComment}a</div><ul><li>${blockComment}b</li></ul><div>${blockComment}c</div>`,\n  },\n\n  \"ordered list\": {\n    document: createDocument([ \"a\", {}, [ \"numberList\", \"number\" ] ]),\n    html: `<ol><li>${blockComment}a</li></ol>`,\n  },\n\n  \"ordered list and an unordered list\": {\n    document: createDocument([ \"a\", {}, [ \"bulletList\", \"bullet\" ] ], [ \"b\", {}, [ \"numberList\", \"number\" ] ]),\n    html: `<ul><li>${blockComment}a</li></ul><ol><li>${blockComment}b</li></ol>`,\n  },\n\n  \"empty block with attributes\": {\n    document: createDocument([ \"\", {}, [ \"quote\" ] ]),\n    html: `<blockquote>${blockComment}<br></blockquote>`,\n  },\n\n  \"image attachment\": (() => {\n    const attrs = {\n      url: TEST_IMAGE_URL,\n      filename: \"example.png\",\n      filesize: 98203,\n      contentType: \"image/png\",\n      width: 1,\n      height: 1,\n    }\n    const attachment = new Attachment(attrs)\n    const text = Text.textForAttachmentWithAttributes(attachment)\n\n    const image = makeElement(\"img\", { src: attrs.url, \"data-trix-mutable\": true, width: 1, height: 1 })\n    image.dataset.trixStoreKey = [ \"imageElement\", attachment.id, image.src, image.width, image.height ].join(\"/\")\n\n    const caption = makeElement({ tagName: \"figcaption\", className: css.attachmentCaption })\n    caption.innerHTML = `<span class=\"${css.attachmentName}\">${attrs.filename}</span> <span class=\"${css.attachmentSize}\">95.9 KB</span>`\n\n    const figure = makeElement({\n      tagName: \"figure\",\n      className: \"attachment attachment--preview attachment--png\",\n      editable: false,\n      data: {\n        trixAttachment: JSON.stringify(attachment),\n        trixContentType: \"image/png\",\n        trixId: attachment.id,\n      },\n    })\n\n    figure.setAttribute(\"contenteditable\", false)\n    figure.appendChild(image)\n    figure.appendChild(caption)\n\n    const serializedFigure = figure.cloneNode(true)\n\n    ;[ \"data-trix-id\", \"data-trix-mutable\", \"data-trix-store-key\", \"contenteditable\" ].forEach((attribute) => {\n      serializedFigure.removeAttribute(attribute)\n\n      Array.from(serializedFigure.querySelectorAll(`[${attribute}]`)).forEach((element) => {\n        element.removeAttribute(attribute)\n      })\n    })\n\n    return {\n      html: `<div>${blockComment}${cursorTargetLeft}${figure.outerHTML}${cursorTargetRight}</div>`,\n      serializedHTML: `<div>${serializedFigure.outerHTML}</div>`,\n      document: new Document([ new Block(text) ]),\n    }\n  })(),\n\n  \"text with newlines and image attachment\": (() => {\n    const stringText = Text.textForStringWithAttributes(\"a\\nb\")\n\n    const attrs = {\n      url: TEST_IMAGE_URL,\n      filename: \"example.png\",\n      filesize: 98203,\n      contentType: \"image/png\",\n      width: 1,\n      height: 1,\n    }\n    const attachment = new Attachment(attrs)\n    const attachmentText = Text.textForAttachmentWithAttributes(attachment)\n\n    const image = makeElement(\"img\", { src: attrs.url, \"data-trix-mutable\": true, width: 1, height: 1 })\n    image.dataset.trixStoreKey = [ \"imageElement\", attachment.id, image.src, image.width, image.height ].join(\"/\")\n\n    const caption = makeElement({ tagName: \"figcaption\", className: css.attachmentCaption })\n    caption.innerHTML = `<span class=\"${css.attachmentName}\">${attrs.filename}</span> <span class=\"${css.attachmentSize}\">95.9 KB</span>`\n\n    const figure = makeElement({\n      tagName: \"figure\",\n      className: \"attachment attachment--preview attachment--png\",\n      editable: false,\n      data: {\n        trixAttachment: JSON.stringify(attachment),\n        trixContentType: \"image/png\",\n        trixId: attachment.id,\n      },\n    })\n\n    figure.appendChild(image)\n    figure.appendChild(caption)\n\n    const serializedFigure = figure.cloneNode(true)\n\n    ;[ \"data-trix-id\", \"data-trix-mutable\", \"data-trix-store-key\", \"contenteditable\" ].forEach((attribute) => {\n      serializedFigure.removeAttribute(attribute)\n\n      Array.from(serializedFigure.querySelectorAll(`[${attribute}]`)).forEach((element) => {\n        element.removeAttribute(attribute)\n      })\n    })\n\n    const text = stringText.appendText(attachmentText)\n\n    return {\n      html: `<div>${blockComment}a<br>b${cursorTargetLeft}${figure.outerHTML}${cursorTargetRight}</div>`,\n      serializedHTML: `<div>a<br>b${serializedFigure.outerHTML}</div>`,\n      document: new Document([ new Block(text) ]),\n    }\n  })(),\n\n  \"image attachment with edited caption\": (() => {\n    const attrs = {\n      url: TEST_IMAGE_URL,\n      filename: \"example.png\",\n      filesize: 123,\n      contentType: \"image/png\",\n      width: 1,\n      height: 1,\n    }\n    const attachment = new Attachment(attrs)\n    const textAttrs = { caption: \"Example\" }\n    const text = Text.textForAttachmentWithAttributes(attachment, textAttrs)\n\n    const image = makeElement(\"img\", { src: attrs.url, \"data-trix-mutable\": true, width: 1, height: 1 })\n    image.dataset.trixStoreKey = [ \"imageElement\", attachment.id, image.src, image.width, image.height ].join(\"/\")\n\n    const caption = makeElement({\n      tagName: \"figcaption\",\n      className: `${css.attachmentCaption} ${css.attachmentCaption}--edited`,\n      textContent: \"Example\",\n    })\n\n    const figure = makeElement({\n      tagName: \"figure\",\n      className: \"attachment attachment--preview attachment--png\",\n      editable: false,\n      data: {\n        trixAttachment: JSON.stringify(attachment),\n        trixContentType: \"image/png\",\n        trixId: attachment.id,\n        trixAttributes: JSON.stringify(textAttrs),\n      },\n    })\n\n    figure.appendChild(image)\n    figure.appendChild(caption)\n\n    return {\n      html: `<div>${blockComment}${cursorTargetLeft}${figure.outerHTML}${cursorTargetRight}</div>`,\n      document: new Document([ new Block(text) ]),\n    }\n  })(),\n\n  \"file attachment\": (() => {\n    const attrs = {\n      href: \"http://example.com/example.pdf\",\n      filename: \"example.pdf\",\n      filesize: 34038769,\n      contentType: \"application/pdf\",\n    }\n    const attachment = new Attachment(attrs)\n    const text = Text.textForAttachmentWithAttributes(attachment)\n\n    const figure = makeElement({\n      tagName: \"figure\",\n      className: \"attachment attachment--file attachment--pdf\",\n      editable: false,\n      data: {\n        trixAttachment: JSON.stringify(attachment),\n        trixContentType: \"application/pdf\",\n        trixId: attachment.id,\n      },\n    })\n\n    const caption = `<figcaption class=\"${css.attachmentCaption}\"><span class=\"${css.attachmentName}\">${attrs.filename}</span> <span class=\"${css.attachmentSize}\">32.46 MB</span></figcaption>`\n    figure.innerHTML = caption\n\n    const link = makeElement({ tagName: \"a\", editable: false, attributes: { href: attrs.href, tabindex: -1 } })\n    Array.from(figure.childNodes).forEach((node) => {\n      link.appendChild(node)\n    })\n    figure.appendChild(link)\n\n    return {\n      html: `<div>${blockComment}${cursorTargetLeft}${figure.outerHTML}${cursorTargetRight}</div>`,\n      document: new Document([ new Block(text) ]),\n    }\n  })(),\n\n  \"pending file attachment\": (() => {\n    const attrs = { filename: \"example.pdf\", filesize: 34038769, contentType: \"application/pdf\" }\n    const attachment = new Attachment(attrs)\n    attachment.file = {}\n    const text = Text.textForAttachmentWithAttributes(attachment)\n\n    const figure = makeElement({\n      tagName: \"figure\",\n      className: \"attachment attachment--file attachment--pdf\",\n      editable: false,\n      data: {\n        trixAttachment: JSON.stringify(attachment),\n        trixContentType: \"application/pdf\",\n        trixId: attachment.id,\n        trixSerialize: false,\n      },\n    })\n\n    const progress = makeElement({\n      tagName: \"progress\",\n      attributes: {\n        class: \"attachment__progress\",\n        value: 0,\n        max: 100,\n      },\n      data: {\n        trixMutable: true,\n        trixStoreKey: [ \"progressElement\", attachment.id ].join(\"/\"),\n      },\n    })\n\n    const caption = `<figcaption class=\"${css.attachmentCaption}\"><span class=\"${css.attachmentName}\">${attrs.filename}</span> <span class=\"${css.attachmentSize}\">32.46 MB</span></figcaption>`\n    figure.innerHTML = caption + progress.outerHTML\n\n    return {\n      html: `<div>${blockComment}${cursorTargetLeft}${figure.outerHTML}${cursorTargetRight}</div>`,\n      document: new Document([ new Block(text) ]),\n    }\n  })(),\n\n  \"content attachment\": (() => {\n    const content =\n      \"<blockquote class=\\\"twitter-tweet\\\" data-cards=\\\"hidden\\\"><p>ruby-build 20150413 is out, with definitions for 2.2.2, 2.1.6, and 2.0.0-p645 to address recent security issues: <a href=\\\"https://t.co/YEwV6NtRD8\\\">https://t.co/YEwV6NtRD8</a></p>&mdash; Sam Stephenson (@sstephenson) <a href=\\\"https://twitter.com/sstephenson/status/587715996783218688\\\">April 13, 2015</a></blockquote>\"\n    const href = \"https://twitter.com/sstephenson/status/587715996783218688\"\n    const contentType = \"embed/twitter\"\n\n    const attachment = new Attachment({ content, contentType, href })\n    const text = Text.textForAttachmentWithAttributes(attachment)\n\n    const figure = makeElement({\n      tagName: \"figure\",\n      className: \"attachment attachment--content\",\n      editable: false,\n      data: {\n        trixAttachment: JSON.stringify(attachment),\n        trixContentType: contentType,\n        trixId: attachment.id,\n      },\n    })\n\n    figure.innerHTML = content\n\n    const caption = makeElement({ tagName: \"figcaption\", className: css.attachmentCaption })\n    figure.appendChild(caption)\n\n    return {\n      html: `<div>${blockComment}${cursorTargetLeft}${figure.outerHTML}${cursorTargetRight}</div>`,\n      document: new Document([ new Block(text) ]),\n    }\n  })(),\n\n  \"nested quote and code formatted block\": {\n    document: createDocument([ \"ab3\", {}, [ \"quote\", \"code\" ] ]),\n    html: `<blockquote><pre>${blockComment}ab3</pre></blockquote>`,\n  },\n\n  \"nested code and quote formatted block\": {\n    document: createDocument([ \"ab3\", {}, [ \"code\", \"quote\" ] ]),\n    html: `<pre><blockquote>${blockComment}ab3</blockquote></pre>`,\n  },\n\n  \"nested code blocks in quote\": {\n    document: createDocument(\n      [ \"a\\n\", {}, [ \"quote\" ] ],\n      [ \"b\", {}, [ \"quote\", \"code\" ] ],\n      [ \"\\nc\\n\", {}, [ \"quote\" ] ],\n      [ \"d\", {}, [ \"quote\", \"code\" ] ]\n    ),\n    html: removeWhitespace(`\\\n<blockquote>\n  ${blockComment}\n  a\n  <br>\n  <br>\n  <pre>\n    ${blockComment}\n    b\n  </pre>\n  ${blockComment}\n  <br>\n  c\n  <br>\n  <br>\n  <pre>\n    ${blockComment}\n    d\n  </pre>\n</blockquote>\\\n`),\n    serializedHTML: removeWhitespace(`\\\n<blockquote>\n  a\n  <br>\n  <br>\n  <pre>\n    b\n  </pre>\n  <br>\n  c\n  <br>\n  <br>\n  <pre>\n    d\n  </pre>\n</blockquote>\\\n`),\n  },\n\n  \"nested code, quote, and list in quote\": {\n    document: createDocument(\n      [ \"a\\n\", {}, [ \"quote\" ] ],\n      [ \"b\", {}, [ \"quote\", \"code\" ] ],\n      [ \"\\nc\\n\", {}, [ \"quote\" ] ],\n      [ \"d\", {}, [ \"quote\", \"quote\" ] ],\n      [ \"\\ne\\n\", {}, [ \"quote\" ] ],\n      [ \"f\", {}, [ \"quote\", \"bulletList\", \"bullet\" ] ]\n    ),\n    html: removeWhitespace(`\\\n <blockquote>\n  ${blockComment}\n  a\n  <br>\n  <br>\n  <pre>\n    ${blockComment}\n    b\n  </pre>\n  ${blockComment}\n  <br>\n  c\n  <br>\n  <br>\n  <blockquote>\n    ${blockComment}\n    d\n  </blockquote>\n  ${blockComment}\n  <br>\n  e\n  <br>\n  <br>\n  <ul>\n    <li>\n      ${blockComment}\n      f\n    </li>\n  </ul>\n</blockquote>\\\n`),\n    serializedHTML: removeWhitespace(`\\\n<blockquote>\n  a\n  <br>\n  <br>\n  <pre>\n    b\n  </pre>\n  <br>\n  c\n  <br>\n  <br>\n  <blockquote>\n    d\n  </blockquote>\n  <br>\n  e\n  <br>\n  <br>\n  <ul>\n    <li>\n      f\n    </li>\n  </ul>\n</blockquote>\\\n`),\n  },\n\n  \"nested quotes at different nesting levels\": {\n    document: createDocument(\n      [ \"a\", {}, [ \"quote\", \"quote\", \"quote\" ] ],\n      [ \"b\", {}, [ \"quote\", \"quote\" ] ],\n      [ \"c\", {}, [ \"quote\" ] ],\n      [ \"d\", {}, [ \"quote\", \"quote\" ] ]\n    ),\n    html: removeWhitespace(`\\\n<blockquote>\n  <blockquote>\n    <blockquote>\n      ${blockComment}\n      a\n    </blockquote>\n    ${blockComment}\n    b\n  </blockquote>\n  ${blockComment}\n  c\n  <blockquote>\n    ${blockComment}\n    d\n  </blockquote>\n</blockquote>\\\n`),\n    serializedHTML: removeWhitespace(`\\\n<blockquote>\n  <blockquote>\n    <blockquote>\n      a\n    </blockquote>\n    b\n  </blockquote>\n  c\n  <blockquote>\n    d\n  </blockquote>\n</blockquote>\\\n`),\n  },\n\n  \"nested quote and list\": {\n    document: createDocument([ \"ab3\", {}, [ \"quote\", \"bulletList\", \"bullet\" ] ]),\n    html: `<blockquote><ul><li>${blockComment}ab3</li></ul></blockquote>`,\n  },\n\n  \"nested list and quote\": {\n    document: createDocument([ \"ab3\", {}, [ \"bulletList\", \"bullet\", \"quote\" ] ]),\n    html: `<ul><li><blockquote>${blockComment}ab3</blockquote></li></ul>`,\n  },\n\n  \"nested lists and quotes\": {\n    document: createDocument(\n      [ \"a\", {}, [ \"bulletList\", \"bullet\", \"quote\" ] ],\n      [ \"b\", {}, [ \"bulletList\", \"bullet\", \"quote\" ] ]\n    ),\n    html: `<ul><li><blockquote>${blockComment}a</blockquote></li><li><blockquote>${blockComment}b</blockquote></li></ul>`,\n  },\n\n  \"nested quote and list with two items\": {\n    document: createDocument(\n      [ \"a\", {}, [ \"quote\", \"bulletList\", \"bullet\" ] ],\n      [ \"b\", {}, [ \"quote\", \"bulletList\", \"bullet\" ] ]\n    ),\n    html: `<blockquote><ul><li>${blockComment}a</li><li>${blockComment}b</li></ul></blockquote>`,\n  },\n\n  \"nested unordered lists\": {\n    document: createDocument(\n      [ \"a\", {}, [ \"bulletList\", \"bullet\" ] ],\n      [ \"b\", {}, [ \"bulletList\", \"bullet\", \"bulletList\", \"bullet\" ] ],\n      [ \"c\", {}, [ \"bulletList\", \"bullet\", \"bulletList\", \"bullet\" ] ]\n    ),\n    html: `<ul><li>${blockComment}a<ul><li>${blockComment}b</li><li>${blockComment}c</li></ul></li></ul>`,\n  },\n\n  \"nested lists\": {\n    document: createDocument(\n      [ \"a\", {}, [ \"numberList\", \"number\" ] ],\n      [ \"b\", {}, [ \"numberList\", \"number\", \"bulletList\", \"bullet\" ] ],\n      [ \"c\", {}, [ \"numberList\", \"number\", \"bulletList\", \"bullet\" ] ]\n    ),\n    html: `<ol><li>${blockComment}a<ul><li>${blockComment}b</li><li>${blockComment}c</li></ul></li></ol>`,\n  },\n\n  \"blocks beginning with newlines\": {\n    document: createDocument([ \"\\na\", {}, [ \"quote\" ] ], [ \"\\nb\", {}, [] ], [ \"\\nc\", {}, [ \"quote\" ] ]),\n    html: `<blockquote>${blockComment}<br>a</blockquote><div>${blockComment}<br>b</div><blockquote>${blockComment}<br>c</blockquote>`,\n  },\n\n  \"blocks beginning with formatted text\": {\n    document: createDocument(\n      [ \"a\", { bold: true }, [ \"quote\" ] ],\n      [ \"b\", { italic: true }, [] ],\n      [ \"c\", { bold: true }, [ \"quote\" ] ]\n    ),\n    html: `<blockquote>${blockComment}<strong>a</strong></blockquote><div>${blockComment}<em>b</em></div><blockquote>${blockComment}<strong>c</strong></blockquote>`,\n  },\n\n  \"text with newlines before block\": {\n    document: createDocument([ \"a\\nb\" ], [ \"c\", {}, [ \"quote\" ] ]),\n    html: `<div>${blockComment}a<br>b</div><blockquote>${blockComment}c</blockquote>`,\n  },\n\n  \"empty heading block\": {\n    document: createDocument([ \"\", {}, [ \"heading1\" ] ]),\n    html: `<h1>${blockComment}<br></h1>`,\n  },\n\n  \"two adjacent headings\": {\n    document: createDocument([ \"a\", {}, [ \"heading1\" ] ], [ \"b\", {}, [ \"heading1\" ] ]),\n    html: `<h1>${blockComment}a</h1><h1>${blockComment}b</h1>`,\n  },\n\n  \"heading in ordered list\": {\n    document: createDocument([ \"a\", {}, [ \"numberList\", \"number\", \"heading1\" ] ]),\n    html: `<ol><li><h1>${blockComment}a</h1></li></ol>`,\n  },\n\n  \"headings with formatted text\": {\n    document: createDocument([ \"a\", { bold: true }, [ \"heading1\" ] ], [ \"b\", { italic: true, bold: true }, [ \"heading1\" ] ]),\n    html: `<h1>${blockComment}<strong>a</strong></h1><h1>${blockComment}<strong><em>b</em></strong></h1>`,\n  },\n\n  \"bidrectional text\": {\n    document: createDocument(\n      [ \"a\" ],\n      [ \"ل\", {}, [ \"quote\" ] ],\n      [ \"b\", {}, [ \"bulletList\", \"bullet\" ] ],\n      [ \"ל\", {}, [ \"bulletList\", \"bullet\" ] ],\n      [ \"\", {}, [ \"bulletList\", \"bullet\" ] ],\n      [ \"cید\" ],\n      [ \"\\n گ\" ]\n    ),\n    html: `\\\n<div>${blockComment}a</div>\\\n<blockquote dir=\"rtl\">${blockComment}ل</blockquote>\\\n<ul><li>${blockComment}b</li></ul>\\\n<ul dir=\"rtl\"><li>${blockComment}ל</li><li>${blockComment}<br></li></ul>\\\n<div>${blockComment}cید</div>\\\n<div dir=\"rtl\">${blockComment}<br>&nbsp;گ</div>\\\n`,\n    serializedHTML:\n      \"\\\n<div>a</div>\\\n<blockquote dir=\\\"rtl\\\">ل</blockquote>\\\n<ul><li>b</li></ul>\\\n<ul dir=\\\"rtl\\\"><li>ל</li><li><br></li></ul>\\\n<div>cید</div>\\\n<div dir=\\\"rtl\\\"><br>&nbsp;گ</div>\\\n\",\n  },\n}\n\nexport const eachFixture = (callback) => {\n  for (const name in fixtures) {\n    const details = fixtures[name]\n    callback(name, details)\n  }\n}\n","import { fixtureTemplates } from \"test/test_helpers/fixtures/fixtures\"\nimport { removeNode } from \"trix/core/helpers\"\n\nconst setFixtureHTML = function (html, container = \"form\") {\n  let element = document.getElementById(\"trix-container\")\n  if (element != null) {\n    removeNode(element)\n  }\n\n  element = document.createElement(container)\n  element.id = \"trix-container\"\n  element.innerHTML = html\n\n  return document.body.insertAdjacentElement(\"afterbegin\", element)\n}\n\nlet ready = null\n\nexport const testGroup = function (name, options, callback) {\n  let container, setup, teardown, template\n  if (callback != null) {\n    ({ container, template, setup, teardown } = options)\n  } else {\n    callback = options\n  }\n\n  const beforeEach = () => {\n    // Ensure window is active on CI so focus and blur events are natively dispatched\n    window.focus()\n\n    ready = function (callback) {\n      if (template != null) {\n        let handler\n        addEventListener(\n          \"trix-initialize\",\n          handler = function ({ target }) {\n            removeEventListener(\"trix-initialize\", handler)\n            if (target.hasAttribute(\"autofocus\")) {\n              target.editor.setSelectedRange(0)\n            }\n            callback(target)\n          }\n        )\n\n        return setFixtureHTML(fixtureTemplates[template](), container)\n      } else {\n        callback()\n      }\n    }\n    if (setup) setup()\n  }\n\n  const afterEach = () => {\n    if (template != null) {\n      setFixtureHTML(\"\")\n    }\n    return teardown?.()\n  }\n\n  if (callback != null) {\n    return QUnit.module(name, function (hooks) {\n      hooks.beforeEach(beforeEach)\n      hooks.afterEach(afterEach)\n      callback()\n    })\n  } else {\n    return QUnit.module(name, { beforeEach, afterEach })\n  }\n}\n\nexport const test = (name, callback) =>\n  QUnit.test(name, function (assert) {\n    const doneAsync = assert.async()\n\n    return ready(function (element) {\n      const done = function (expectedDocumentValue) {\n        if (element != null) {\n          if (expectedDocumentValue) {\n            assert.equal(element.editor.getDocument().toString(), expectedDocumentValue)\n          }\n          requestAnimationFrame(doneAsync)\n        } else {\n          return doneAsync()\n        }\n      }\n\n      if (callback.length === 0) {\n        callback()\n        return done()\n      } else {\n        callback(done)\n      }\n    })\n  })\n\nexport const testIf = function (condition, ...args) {\n  if (condition) {\n    test(...Array.from(args || []))\n  } else {\n    skip(...Array.from(args || []))\n  }\n}\n\nexport const { skip } = QUnit\n","import { normalizeRange, rangeIsCollapsed } from \"trix/core/helpers\"\n\nexport class TestCompositionDelegate {\n  compositionDidRequestChangingSelectionToLocationRange() {\n    return this.getSelectionManager().setLocationRange(...arguments)\n  }\n\n  getSelectionManager() {\n    if (!this.selectionManager) this.selectionManager = new TestSelectionManager()\n    return this.selectionManager\n  }\n}\n\nexport class TestSelectionManager {\n  constructor() {\n    this.setLocationRange({ index: 0, offset: 0 })\n  }\n\n  getLocationRange() {\n    return this.locationRange\n  }\n\n  setLocationRange(locationRange) {\n    this.locationRange = normalizeRange(locationRange)\n  }\n\n  preserveSelection(block) {\n    const locationRange = this.getLocationRange()\n    block()\n    this.locationRange = locationRange\n  }\n\n  setLocationRangeFromPoint(point) {}\n\n  locationIsCursorTarget() {\n    return false\n  }\n\n  selectionIsExpanded() {\n    return !rangeIsCollapsed(this.getLocationRange())\n  }\n}\n","export const extend = function (properties) {\n  for (const key in properties) {\n    const value = properties[key]\n    this[key] = value\n  }\n  return this\n}\n\nexport const after = (delay, callback) => setTimeout(callback, delay)\n","/**\r\n * Rangy, a cross-browser JavaScript range and selection library\r\n * https://github.com/timdown/rangy\r\n *\r\n * Copyright 2015, Tim Down\r\n * Licensed under the MIT license.\r\n * Version: 1.3.0\r\n * Build date: 10 May 2015\r\n */\r\n\r\n(function(factory, root) {\r\n    if (typeof define == \"function\" && define.amd) {\r\n        // AMD. Register as an anonymous module.\r\n        define(factory);\r\n    } else if (typeof module != \"undefined\" && typeof exports == \"object\") {\r\n        // Node/CommonJS style\r\n        module.exports = factory();\r\n    } else {\r\n        // No AMD or CommonJS support so we place Rangy in (probably) the global variable\r\n        root.rangy = factory();\r\n    }\r\n})(function() {\r\n\r\n    var OBJECT = \"object\", FUNCTION = \"function\", UNDEFINED = \"undefined\";\r\n\r\n    // Minimal set of properties required for DOM Level 2 Range compliance. Comparison constants such as START_TO_START\r\n    // are omitted because ranges in KHTML do not have them but otherwise work perfectly well. See issue 113.\r\n    var domRangeProperties = [\"startContainer\", \"startOffset\", \"endContainer\", \"endOffset\", \"collapsed\",\r\n        \"commonAncestorContainer\"];\r\n\r\n    // Minimal set of methods required for DOM Level 2 Range compliance\r\n    var domRangeMethods = [\"setStart\", \"setStartBefore\", \"setStartAfter\", \"setEnd\", \"setEndBefore\",\r\n        \"setEndAfter\", \"collapse\", \"selectNode\", \"selectNodeContents\", \"compareBoundaryPoints\", \"deleteContents\",\r\n        \"extractContents\", \"cloneContents\", \"insertNode\", \"surroundContents\", \"cloneRange\", \"toString\", \"detach\"];\r\n\r\n    var textRangeProperties = [\"boundingHeight\", \"boundingLeft\", \"boundingTop\", \"boundingWidth\", \"htmlText\", \"text\"];\r\n\r\n    // Subset of TextRange's full set of methods that we're interested in\r\n    var textRangeMethods = [\"collapse\", \"compareEndPoints\", \"duplicate\", \"moveToElementText\", \"parentElement\", \"select\",\r\n        \"setEndPoint\", \"getBoundingClientRect\"];\r\n\r\n    /*----------------------------------------------------------------------------------------------------------------*/\r\n\r\n    // Trio of functions taken from Peter Michaux's article:\r\n    // http://peter.michaux.ca/articles/feature-detection-state-of-the-art-browser-scripting\r\n    function isHostMethod(o, p) {\r\n        var t = typeof o[p];\r\n        return t == FUNCTION || (!!(t == OBJECT && o[p])) || t == \"unknown\";\r\n    }\r\n\r\n    function isHostObject(o, p) {\r\n        return !!(typeof o[p] == OBJECT && o[p]);\r\n    }\r\n\r\n    function isHostProperty(o, p) {\r\n        return typeof o[p] != UNDEFINED;\r\n    }\r\n\r\n    // Creates a convenience function to save verbose repeated calls to tests functions\r\n    function createMultiplePropertyTest(testFunc) {\r\n        return function(o, props) {\r\n            var i = props.length;\r\n            while (i--) {\r\n                if (!testFunc(o, props[i])) {\r\n                    return false;\r\n                }\r\n            }\r\n            return true;\r\n        };\r\n    }\r\n\r\n    // Next trio of functions are a convenience to save verbose repeated calls to previous two functions\r\n    var areHostMethods = createMultiplePropertyTest(isHostMethod);\r\n    var areHostObjects = createMultiplePropertyTest(isHostObject);\r\n    var areHostProperties = createMultiplePropertyTest(isHostProperty);\r\n\r\n    function isTextRange(range) {\r\n        return range && areHostMethods(range, textRangeMethods) && areHostProperties(range, textRangeProperties);\r\n    }\r\n\r\n    function getBody(doc) {\r\n        return isHostObject(doc, \"body\") ? doc.body : doc.getElementsByTagName(\"body\")[0];\r\n    }\r\n\r\n    var forEach = [].forEach ?\r\n        function(arr, func) {\r\n            arr.forEach(func);\r\n        } :\r\n        function(arr, func) {\r\n            for (var i = 0, len = arr.length; i < len; ++i) {\r\n                func(arr[i], i);\r\n            }\r\n        };\r\n\r\n    var modules = {};\r\n\r\n    var isBrowser = (typeof window != UNDEFINED && typeof document != UNDEFINED);\r\n\r\n    var util = {\r\n        isHostMethod: isHostMethod,\r\n        isHostObject: isHostObject,\r\n        isHostProperty: isHostProperty,\r\n        areHostMethods: areHostMethods,\r\n        areHostObjects: areHostObjects,\r\n        areHostProperties: areHostProperties,\r\n        isTextRange: isTextRange,\r\n        getBody: getBody,\r\n        forEach: forEach\r\n    };\r\n\r\n    var api = {\r\n        version: \"1.3.0\",\r\n        initialized: false,\r\n        isBrowser: isBrowser,\r\n        supported: true,\r\n        util: util,\r\n        features: {},\r\n        modules: modules,\r\n        config: {\r\n            alertOnFail: false,\r\n            alertOnWarn: false,\r\n            preferTextRange: false,\r\n            autoInitialize: (typeof rangyAutoInitialize == UNDEFINED) ? true : rangyAutoInitialize\r\n        }\r\n    };\r\n\r\n    function consoleLog(msg) {\r\n        if (typeof console != UNDEFINED && isHostMethod(console, \"log\")) {\r\n            console.log(msg);\r\n        }\r\n    }\r\n\r\n    function alertOrLog(msg, shouldAlert) {\r\n        if (isBrowser && shouldAlert) {\r\n            alert(msg);\r\n        } else  {\r\n            consoleLog(msg);\r\n        }\r\n    }\r\n\r\n    function fail(reason) {\r\n        api.initialized = true;\r\n        api.supported = false;\r\n        alertOrLog(\"Rangy is not supported in this environment. Reason: \" + reason, api.config.alertOnFail);\r\n    }\r\n\r\n    api.fail = fail;\r\n\r\n    function warn(msg) {\r\n        alertOrLog(\"Rangy warning: \" + msg, api.config.alertOnWarn);\r\n    }\r\n\r\n    api.warn = warn;\r\n\r\n    // Add utility extend() method\r\n    var extend;\r\n    if ({}.hasOwnProperty) {\r\n        util.extend = extend = function(obj, props, deep) {\r\n            var o, p;\r\n            for (var i in props) {\r\n                if (props.hasOwnProperty(i)) {\r\n                    o = obj[i];\r\n                    p = props[i];\r\n                    if (deep && o !== null && typeof o == \"object\" && p !== null && typeof p == \"object\") {\r\n                        extend(o, p, true);\r\n                    }\r\n                    obj[i] = p;\r\n                }\r\n            }\r\n            // Special case for toString, which does not show up in for...in loops in IE <= 8\r\n            if (props.hasOwnProperty(\"toString\")) {\r\n                obj.toString = props.toString;\r\n            }\r\n            return obj;\r\n        };\r\n\r\n        util.createOptions = function(optionsParam, defaults) {\r\n            var options = {};\r\n            extend(options, defaults);\r\n            if (optionsParam) {\r\n                extend(options, optionsParam);\r\n            }\r\n            return options;\r\n        };\r\n    } else {\r\n        fail(\"hasOwnProperty not supported\");\r\n    }\r\n\r\n    // Test whether we're in a browser and bail out if not\r\n    if (!isBrowser) {\r\n        fail(\"Rangy can only run in a browser\");\r\n    }\r\n\r\n    // Test whether Array.prototype.slice can be relied on for NodeLists and use an alternative toArray() if not\r\n    (function() {\r\n        var toArray;\r\n\r\n        if (isBrowser) {\r\n            var el = document.createElement(\"div\");\r\n            el.appendChild(document.createElement(\"span\"));\r\n            var slice = [].slice;\r\n            try {\r\n                if (slice.call(el.childNodes, 0)[0].nodeType == 1) {\r\n                    toArray = function(arrayLike) {\r\n                        return slice.call(arrayLike, 0);\r\n                    };\r\n                }\r\n            } catch (e) {}\r\n        }\r\n\r\n        if (!toArray) {\r\n            toArray = function(arrayLike) {\r\n                var arr = [];\r\n                for (var i = 0, len = arrayLike.length; i < len; ++i) {\r\n                    arr[i] = arrayLike[i];\r\n                }\r\n                return arr;\r\n            };\r\n        }\r\n\r\n        util.toArray = toArray;\r\n    })();\r\n\r\n    // Very simple event handler wrapper function that doesn't attempt to solve issues such as \"this\" handling or\r\n    // normalization of event properties\r\n    var addListener;\r\n    if (isBrowser) {\r\n        if (isHostMethod(document, \"addEventListener\")) {\r\n            addListener = function(obj, eventType, listener) {\r\n                obj.addEventListener(eventType, listener, false);\r\n            };\r\n        } else if (isHostMethod(document, \"attachEvent\")) {\r\n            addListener = function(obj, eventType, listener) {\r\n                obj.attachEvent(\"on\" + eventType, listener);\r\n            };\r\n        } else {\r\n            fail(\"Document does not have required addEventListener or attachEvent method\");\r\n        }\r\n\r\n        util.addListener = addListener;\r\n    }\r\n\r\n    var initListeners = [];\r\n\r\n    function getErrorDesc(ex) {\r\n        return ex.message || ex.description || String(ex);\r\n    }\r\n\r\n    // Initialization\r\n    function init() {\r\n        if (!isBrowser || api.initialized) {\r\n            return;\r\n        }\r\n        var testRange;\r\n        var implementsDomRange = false, implementsTextRange = false;\r\n\r\n        // First, perform basic feature tests\r\n\r\n        if (isHostMethod(document, \"createRange\")) {\r\n            testRange = document.createRange();\r\n            if (areHostMethods(testRange, domRangeMethods) && areHostProperties(testRange, domRangeProperties)) {\r\n                implementsDomRange = true;\r\n            }\r\n        }\r\n\r\n        var body = getBody(document);\r\n        if (!body || body.nodeName.toLowerCase() != \"body\") {\r\n            fail(\"No body element found\");\r\n            return;\r\n        }\r\n\r\n        if (body && isHostMethod(body, \"createTextRange\")) {\r\n            testRange = body.createTextRange();\r\n            if (isTextRange(testRange)) {\r\n                implementsTextRange = true;\r\n            }\r\n        }\r\n\r\n        if (!implementsDomRange && !implementsTextRange) {\r\n            fail(\"Neither Range nor TextRange are available\");\r\n            return;\r\n        }\r\n\r\n        api.initialized = true;\r\n        api.features = {\r\n            implementsDomRange: implementsDomRange,\r\n            implementsTextRange: implementsTextRange\r\n        };\r\n\r\n        // Initialize modules\r\n        var module, errorMessage;\r\n        for (var moduleName in modules) {\r\n            if ( (module = modules[moduleName]) instanceof Module ) {\r\n                module.init(module, api);\r\n            }\r\n        }\r\n\r\n        // Call init listeners\r\n        for (var i = 0, len = initListeners.length; i < len; ++i) {\r\n            try {\r\n                initListeners[i](api);\r\n            } catch (ex) {\r\n                errorMessage = \"Rangy init listener threw an exception. Continuing. Detail: \" + getErrorDesc(ex);\r\n                consoleLog(errorMessage);\r\n            }\r\n        }\r\n    }\r\n\r\n    function deprecationNotice(deprecated, replacement, module) {\r\n        if (module) {\r\n            deprecated += \" in module \" + module.name;\r\n        }\r\n        api.warn(\"DEPRECATED: \" + deprecated + \" is deprecated. Please use \" +\r\n        replacement + \" instead.\");\r\n    }\r\n\r\n    function createAliasForDeprecatedMethod(owner, deprecated, replacement, module) {\r\n        owner[deprecated] = function() {\r\n            deprecationNotice(deprecated, replacement, module);\r\n            return owner[replacement].apply(owner, util.toArray(arguments));\r\n        };\r\n    }\r\n\r\n    util.deprecationNotice = deprecationNotice;\r\n    util.createAliasForDeprecatedMethod = createAliasForDeprecatedMethod;\r\n\r\n    // Allow external scripts to initialize this library in case it's loaded after the document has loaded\r\n    api.init = init;\r\n\r\n    // Execute listener immediately if already initialized\r\n    api.addInitListener = function(listener) {\r\n        if (api.initialized) {\r\n            listener(api);\r\n        } else {\r\n            initListeners.push(listener);\r\n        }\r\n    };\r\n\r\n    var shimListeners = [];\r\n\r\n    api.addShimListener = function(listener) {\r\n        shimListeners.push(listener);\r\n    };\r\n\r\n    function shim(win) {\r\n        win = win || window;\r\n        init();\r\n\r\n        // Notify listeners\r\n        for (var i = 0, len = shimListeners.length; i < len; ++i) {\r\n            shimListeners[i](win);\r\n        }\r\n    }\r\n\r\n    if (isBrowser) {\r\n        api.shim = api.createMissingNativeApi = shim;\r\n        createAliasForDeprecatedMethod(api, \"createMissingNativeApi\", \"shim\");\r\n    }\r\n\r\n    function Module(name, dependencies, initializer) {\r\n        this.name = name;\r\n        this.dependencies = dependencies;\r\n        this.initialized = false;\r\n        this.supported = false;\r\n        this.initializer = initializer;\r\n    }\r\n\r\n    Module.prototype = {\r\n        init: function() {\r\n            var requiredModuleNames = this.dependencies || [];\r\n            for (var i = 0, len = requiredModuleNames.length, requiredModule, moduleName; i < len; ++i) {\r\n                moduleName = requiredModuleNames[i];\r\n\r\n                requiredModule = modules[moduleName];\r\n                if (!requiredModule || !(requiredModule instanceof Module)) {\r\n                    throw new Error(\"required module '\" + moduleName + \"' not found\");\r\n                }\r\n\r\n                requiredModule.init();\r\n\r\n                if (!requiredModule.supported) {\r\n                    throw new Error(\"required module '\" + moduleName + \"' not supported\");\r\n                }\r\n            }\r\n\r\n            // Now run initializer\r\n            this.initializer(this);\r\n        },\r\n\r\n        fail: function(reason) {\r\n            this.initialized = true;\r\n            this.supported = false;\r\n            throw new Error(reason);\r\n        },\r\n\r\n        warn: function(msg) {\r\n            api.warn(\"Module \" + this.name + \": \" + msg);\r\n        },\r\n\r\n        deprecationNotice: function(deprecated, replacement) {\r\n            api.warn(\"DEPRECATED: \" + deprecated + \" in module \" + this.name + \" is deprecated. Please use \" +\r\n                replacement + \" instead\");\r\n        },\r\n\r\n        createError: function(msg) {\r\n            return new Error(\"Error in Rangy \" + this.name + \" module: \" + msg);\r\n        }\r\n    };\r\n\r\n    function createModule(name, dependencies, initFunc) {\r\n        var newModule = new Module(name, dependencies, function(module) {\r\n            if (!module.initialized) {\r\n                module.initialized = true;\r\n                try {\r\n                    initFunc(api, module);\r\n                    module.supported = true;\r\n                } catch (ex) {\r\n                    var errorMessage = \"Module '\" + name + \"' failed to load: \" + getErrorDesc(ex);\r\n                    consoleLog(errorMessage);\r\n                    if (ex.stack) {\r\n                        consoleLog(ex.stack);\r\n                    }\r\n                }\r\n            }\r\n        });\r\n        modules[name] = newModule;\r\n        return newModule;\r\n    }\r\n\r\n    api.createModule = function(name) {\r\n        // Allow 2 or 3 arguments (second argument is an optional array of dependencies)\r\n        var initFunc, dependencies;\r\n        if (arguments.length == 2) {\r\n            initFunc = arguments[1];\r\n            dependencies = [];\r\n        } else {\r\n            initFunc = arguments[2];\r\n            dependencies = arguments[1];\r\n        }\r\n\r\n        var module = createModule(name, dependencies, initFunc);\r\n\r\n        // Initialize the module immediately if the core is already initialized\r\n        if (api.initialized && api.supported) {\r\n            module.init();\r\n        }\r\n    };\r\n\r\n    api.createCoreModule = function(name, dependencies, initFunc) {\r\n        createModule(name, dependencies, initFunc);\r\n    };\r\n\r\n    /*----------------------------------------------------------------------------------------------------------------*/\r\n\r\n    // Ensure rangy.rangePrototype and rangy.selectionPrototype are available immediately\r\n\r\n    function RangePrototype() {}\r\n    api.RangePrototype = RangePrototype;\r\n    api.rangePrototype = new RangePrototype();\r\n\r\n    function SelectionPrototype() {}\r\n    api.selectionPrototype = new SelectionPrototype();\r\n\r\n    /*----------------------------------------------------------------------------------------------------------------*/\r\n\r\n    // DOM utility methods used by Rangy\n    api.createCoreModule(\"DomUtil\", [], function(api, module) {\n        var UNDEF = \"undefined\";\n        var util = api.util;\n        var getBody = util.getBody;\n\n        // Perform feature tests\n        if (!util.areHostMethods(document, [\"createDocumentFragment\", \"createElement\", \"createTextNode\"])) {\n            module.fail(\"document missing a Node creation method\");\n        }\n\n        if (!util.isHostMethod(document, \"getElementsByTagName\")) {\n            module.fail(\"document missing getElementsByTagName method\");\n        }\n\n        var el = document.createElement(\"div\");\n        if (!util.areHostMethods(el, [\"insertBefore\", \"appendChild\", \"cloneNode\"] ||\n                !util.areHostObjects(el, [\"previousSibling\", \"nextSibling\", \"childNodes\", \"parentNode\"]))) {\n            module.fail(\"Incomplete Element implementation\");\n        }\n\n        // innerHTML is required for Range's createContextualFragment method\n        if (!util.isHostProperty(el, \"innerHTML\")) {\n            module.fail(\"Element is missing innerHTML property\");\n        }\n\n        var textNode = document.createTextNode(\"test\");\n        if (!util.areHostMethods(textNode, [\"splitText\", \"deleteData\", \"insertData\", \"appendData\", \"cloneNode\"] ||\n                !util.areHostObjects(el, [\"previousSibling\", \"nextSibling\", \"childNodes\", \"parentNode\"]) ||\n                !util.areHostProperties(textNode, [\"data\"]))) {\n            module.fail(\"Incomplete Text Node implementation\");\n        }\n\n        /*----------------------------------------------------------------------------------------------------------------*/\n\n        // Removed use of indexOf because of a bizarre bug in Opera that is thrown in one of the Acid3 tests. I haven't been\n        // able to replicate it outside of the test. The bug is that indexOf returns -1 when called on an Array that\n        // contains just the document as a single element and the value searched for is the document.\n        var arrayContains = /*Array.prototype.indexOf ?\n            function(arr, val) {\n                return arr.indexOf(val) > -1;\n            }:*/\n\n            function(arr, val) {\n                var i = arr.length;\n                while (i--) {\n                    if (arr[i] === val) {\n                        return true;\n                    }\n                }\n                return false;\n            };\n\n        // Opera 11 puts HTML elements in the null namespace, it seems, and IE 7 has undefined namespaceURI\n        function isHtmlNamespace(node) {\n            var ns;\n            return typeof node.namespaceURI == UNDEF || ((ns = node.namespaceURI) === null || ns == \"http://www.w3.org/1999/xhtml\");\n        }\n\n        function parentElement(node) {\n            var parent = node.parentNode;\n            return (parent.nodeType == 1) ? parent : null;\n        }\n\n        function getNodeIndex(node) {\n            var i = 0;\n            while( (node = node.previousSibling) ) {\n                ++i;\n            }\n            return i;\n        }\n\n        function getNodeLength(node) {\n            switch (node.nodeType) {\n                case 7:\n                case 10:\n                    return 0;\n                case 3:\n                case 8:\n                    return node.length;\n                default:\n                    return node.childNodes.length;\n            }\n        }\n\n        function getCommonAncestor(node1, node2) {\n            var ancestors = [], n;\n            for (n = node1; n; n = n.parentNode) {\n                ancestors.push(n);\n            }\n\n            for (n = node2; n; n = n.parentNode) {\n                if (arrayContains(ancestors, n)) {\n                    return n;\n                }\n            }\n\n            return null;\n        }\n\n        function isAncestorOf(ancestor, descendant, selfIsAncestor) {\n            var n = selfIsAncestor ? descendant : descendant.parentNode;\n            while (n) {\n                if (n === ancestor) {\n                    return true;\n                } else {\n                    n = n.parentNode;\n                }\n            }\n            return false;\n        }\n\n        function isOrIsAncestorOf(ancestor, descendant) {\n            return isAncestorOf(ancestor, descendant, true);\n        }\n\n        function getClosestAncestorIn(node, ancestor, selfIsAncestor) {\n            var p, n = selfIsAncestor ? node : node.parentNode;\n            while (n) {\n                p = n.parentNode;\n                if (p === ancestor) {\n                    return n;\n                }\n                n = p;\n            }\n            return null;\n        }\n\n        function isCharacterDataNode(node) {\n            var t = node.nodeType;\n            return t == 3 || t == 4 || t == 8 ; // Text, CDataSection or Comment\n        }\n\n        function isTextOrCommentNode(node) {\n            if (!node) {\n                return false;\n            }\n            var t = node.nodeType;\n            return t == 3 || t == 8 ; // Text or Comment\n        }\n\n        function insertAfter(node, precedingNode) {\n            var nextNode = precedingNode.nextSibling, parent = precedingNode.parentNode;\n            if (nextNode) {\n                parent.insertBefore(node, nextNode);\n            } else {\n                parent.appendChild(node);\n            }\n            return node;\n        }\n\n        // Note that we cannot use splitText() because it is bugridden in IE 9.\n        function splitDataNode(node, index, positionsToPreserve) {\n            var newNode = node.cloneNode(false);\n            newNode.deleteData(0, index);\n            node.deleteData(index, node.length - index);\n            insertAfter(newNode, node);\n\n            // Preserve positions\n            if (positionsToPreserve) {\n                for (var i = 0, position; position = positionsToPreserve[i++]; ) {\n                    // Handle case where position was inside the portion of node after the split point\n                    if (position.node == node && position.offset > index) {\n                        position.node = newNode;\n                        position.offset -= index;\n                    }\n                    // Handle the case where the position is a node offset within node's parent\n                    else if (position.node == node.parentNode && position.offset > getNodeIndex(node)) {\n                        ++position.offset;\n                    }\n                }\n            }\n            return newNode;\n        }\n\n        function getDocument(node) {\n            if (node.nodeType == 9) {\n                return node;\n            } else if (typeof node.ownerDocument != UNDEF) {\n                return node.ownerDocument;\n            } else if (typeof node.document != UNDEF) {\n                return node.document;\n            } else if (node.parentNode) {\n                return getDocument(node.parentNode);\n            } else {\n                throw module.createError(\"getDocument: no document found for node\");\n            }\n        }\n\n        function getWindow(node) {\n            var doc = getDocument(node);\n            if (typeof doc.defaultView != UNDEF) {\n                return doc.defaultView;\n            } else if (typeof doc.parentWindow != UNDEF) {\n                return doc.parentWindow;\n            } else {\n                throw module.createError(\"Cannot get a window object for node\");\n            }\n        }\n\n        function getIframeDocument(iframeEl) {\n            if (typeof iframeEl.contentDocument != UNDEF) {\n                return iframeEl.contentDocument;\n            } else if (typeof iframeEl.contentWindow != UNDEF) {\n                return iframeEl.contentWindow.document;\n            } else {\n                throw module.createError(\"getIframeDocument: No Document object found for iframe element\");\n            }\n        }\n\n        function getIframeWindow(iframeEl) {\n            if (typeof iframeEl.contentWindow != UNDEF) {\n                return iframeEl.contentWindow;\n            } else if (typeof iframeEl.contentDocument != UNDEF) {\n                return iframeEl.contentDocument.defaultView;\n            } else {\n                throw module.createError(\"getIframeWindow: No Window object found for iframe element\");\n            }\n        }\n\n        // This looks bad. Is it worth it?\n        function isWindow(obj) {\n            return obj && util.isHostMethod(obj, \"setTimeout\") && util.isHostObject(obj, \"document\");\n        }\n\n        function getContentDocument(obj, module, methodName) {\n            var doc;\n\n            if (!obj) {\n                doc = document;\n            }\n\n            // Test if a DOM node has been passed and obtain a document object for it if so\n            else if (util.isHostProperty(obj, \"nodeType\")) {\n                doc = (obj.nodeType == 1 && obj.tagName.toLowerCase() == \"iframe\") ?\n                    getIframeDocument(obj) : getDocument(obj);\n            }\n\n            // Test if the doc parameter appears to be a Window object\n            else if (isWindow(obj)) {\n                doc = obj.document;\n            }\n\n            if (!doc) {\n                throw module.createError(methodName + \"(): Parameter must be a Window object or DOM node\");\n            }\n\n            return doc;\n        }\n\n        function getRootContainer(node) {\n            var parent;\n            while ( (parent = node.parentNode) ) {\n                node = parent;\n            }\n            return node;\n        }\n\n        function comparePoints(nodeA, offsetA, nodeB, offsetB) {\n            // See http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#Level-2-Range-Comparing\n            var nodeC, root, childA, childB, n;\n            if (nodeA == nodeB) {\n                // Case 1: nodes are the same\n                return offsetA === offsetB ? 0 : (offsetA < offsetB) ? -1 : 1;\n            } else if ( (nodeC = getClosestAncestorIn(nodeB, nodeA, true)) ) {\n                // Case 2: node C (container B or an ancestor) is a child node of A\n                return offsetA <= getNodeIndex(nodeC) ? -1 : 1;\n            } else if ( (nodeC = getClosestAncestorIn(nodeA, nodeB, true)) ) {\n                // Case 3: node C (container A or an ancestor) is a child node of B\n                return getNodeIndex(nodeC) < offsetB  ? -1 : 1;\n            } else {\n                root = getCommonAncestor(nodeA, nodeB);\n                if (!root) {\n                    throw new Error(\"comparePoints error: nodes have no common ancestor\");\n                }\n\n                // Case 4: containers are siblings or descendants of siblings\n                childA = (nodeA === root) ? root : getClosestAncestorIn(nodeA, root, true);\n                childB = (nodeB === root) ? root : getClosestAncestorIn(nodeB, root, true);\n\n                if (childA === childB) {\n                    // This shouldn't be possible\n                    throw module.createError(\"comparePoints got to case 4 and childA and childB are the same!\");\n                } else {\n                    n = root.firstChild;\n                    while (n) {\n                        if (n === childA) {\n                            return -1;\n                        } else if (n === childB) {\n                            return 1;\n                        }\n                        n = n.nextSibling;\n                    }\n                }\n            }\n        }\n\n        /*----------------------------------------------------------------------------------------------------------------*/\n\n        // Test for IE's crash (IE 6/7) or exception (IE >= 8) when a reference to garbage-collected text node is queried\n        var crashyTextNodes = false;\n\n        function isBrokenNode(node) {\n            var n;\n            try {\n                n = node.parentNode;\n                return false;\n            } catch (e) {\n                return true;\n            }\n        }\n\n        (function() {\n            var el = document.createElement(\"b\");\n            el.innerHTML = \"1\";\n            var textNode = el.firstChild;\n            el.innerHTML = \"<br />\";\n            crashyTextNodes = isBrokenNode(textNode);\n\n            api.features.crashyTextNodes = crashyTextNodes;\n        })();\n\n        /*----------------------------------------------------------------------------------------------------------------*/\n\n        function inspectNode(node) {\n            if (!node) {\n                return \"[No node]\";\n            }\n            if (crashyTextNodes && isBrokenNode(node)) {\n                return \"[Broken node]\";\n            }\n            if (isCharacterDataNode(node)) {\n                return '\"' + node.data + '\"';\n            }\n            if (node.nodeType == 1) {\n                var idAttr = node.id ? ' id=\"' + node.id + '\"' : \"\";\n                return \"<\" + node.nodeName + idAttr + \">[index:\" + getNodeIndex(node) + \",length:\" + node.childNodes.length + \"][\" + (node.innerHTML || \"[innerHTML not supported]\").slice(0, 25) + \"]\";\n            }\n            return node.nodeName;\n        }\n\n        function fragmentFromNodeChildren(node) {\n            var fragment = getDocument(node).createDocumentFragment(), child;\n            while ( (child = node.firstChild) ) {\n                fragment.appendChild(child);\n            }\n            return fragment;\n        }\n\n        var getComputedStyleProperty;\n        if (typeof window.getComputedStyle != UNDEF) {\n            getComputedStyleProperty = function(el, propName) {\n                return getWindow(el).getComputedStyle(el, null)[propName];\n            };\n        } else if (typeof document.documentElement.currentStyle != UNDEF) {\n            getComputedStyleProperty = function(el, propName) {\n                return el.currentStyle ? el.currentStyle[propName] : \"\";\n            };\n        } else {\n            module.fail(\"No means of obtaining computed style properties found\");\n        }\n\n        function createTestElement(doc, html, contentEditable) {\n            var body = getBody(doc);\n            var el = doc.createElement(\"div\");\n            el.contentEditable = \"\" + !!contentEditable;\n            if (html) {\n                el.innerHTML = html;\n            }\n\n            // Insert the test element at the start of the body to prevent scrolling to the bottom in iOS (issue #292)\n            var bodyFirstChild = body.firstChild;\n            if (bodyFirstChild) {\n                body.insertBefore(el, bodyFirstChild);\n            } else {\n                body.appendChild(el);\n            }\n\n            return el;\n        }\n\n        function removeNode(node) {\n            return node.parentNode.removeChild(node);\n        }\n\n        function NodeIterator(root) {\n            this.root = root;\n            this._next = root;\n        }\n\n        NodeIterator.prototype = {\n            _current: null,\n\n            hasNext: function() {\n                return !!this._next;\n            },\n\n            next: function() {\n                var n = this._current = this._next;\n                var child, next;\n                if (this._current) {\n                    child = n.firstChild;\n                    if (child) {\n                        this._next = child;\n                    } else {\n                        next = null;\n                        while ((n !== this.root) && !(next = n.nextSibling)) {\n                            n = n.parentNode;\n                        }\n                        this._next = next;\n                    }\n                }\n                return this._current;\n            },\n\n            detach: function() {\n                this._current = this._next = this.root = null;\n            }\n        };\n\n        function createIterator(root) {\n            return new NodeIterator(root);\n        }\n\n        function DomPosition(node, offset) {\n            this.node = node;\n            this.offset = offset;\n        }\n\n        DomPosition.prototype = {\n            equals: function(pos) {\n                return !!pos && this.node === pos.node && this.offset == pos.offset;\n            },\n\n            inspect: function() {\n                return \"[DomPosition(\" + inspectNode(this.node) + \":\" + this.offset + \")]\";\n            },\n\n            toString: function() {\n                return this.inspect();\n            }\n        };\n\n        function DOMException(codeName) {\n            this.code = this[codeName];\n            this.codeName = codeName;\n            this.message = \"DOMException: \" + this.codeName;\n        }\n\n        DOMException.prototype = {\n            INDEX_SIZE_ERR: 1,\n            HIERARCHY_REQUEST_ERR: 3,\n            WRONG_DOCUMENT_ERR: 4,\n            NO_MODIFICATION_ALLOWED_ERR: 7,\n            NOT_FOUND_ERR: 8,\n            NOT_SUPPORTED_ERR: 9,\n            INVALID_STATE_ERR: 11,\n            INVALID_NODE_TYPE_ERR: 24\n        };\n\n        DOMException.prototype.toString = function() {\n            return this.message;\n        };\n\n        api.dom = {\n            arrayContains: arrayContains,\n            isHtmlNamespace: isHtmlNamespace,\n            parentElement: parentElement,\n            getNodeIndex: getNodeIndex,\n            getNodeLength: getNodeLength,\n            getCommonAncestor: getCommonAncestor,\n            isAncestorOf: isAncestorOf,\n            isOrIsAncestorOf: isOrIsAncestorOf,\n            getClosestAncestorIn: getClosestAncestorIn,\n            isCharacterDataNode: isCharacterDataNode,\n            isTextOrCommentNode: isTextOrCommentNode,\n            insertAfter: insertAfter,\n            splitDataNode: splitDataNode,\n            getDocument: getDocument,\n            getWindow: getWindow,\n            getIframeWindow: getIframeWindow,\n            getIframeDocument: getIframeDocument,\n            getBody: getBody,\n            isWindow: isWindow,\n            getContentDocument: getContentDocument,\n            getRootContainer: getRootContainer,\n            comparePoints: comparePoints,\n            isBrokenNode: isBrokenNode,\n            inspectNode: inspectNode,\n            getComputedStyleProperty: getComputedStyleProperty,\n            createTestElement: createTestElement,\n            removeNode: removeNode,\n            fragmentFromNodeChildren: fragmentFromNodeChildren,\n            createIterator: createIterator,\n            DomPosition: DomPosition\n        };\n\n        api.DOMException = DOMException;\n    });\r\n\r\n    /*----------------------------------------------------------------------------------------------------------------*/\r\n\r\n    // Pure JavaScript implementation of DOM Range\n    api.createCoreModule(\"DomRange\", [\"DomUtil\"], function(api, module) {\n        var dom = api.dom;\n        var util = api.util;\n        var DomPosition = dom.DomPosition;\n        var DOMException = api.DOMException;\n\n        var isCharacterDataNode = dom.isCharacterDataNode;\n        var getNodeIndex = dom.getNodeIndex;\n        var isOrIsAncestorOf = dom.isOrIsAncestorOf;\n        var getDocument = dom.getDocument;\n        var comparePoints = dom.comparePoints;\n        var splitDataNode = dom.splitDataNode;\n        var getClosestAncestorIn = dom.getClosestAncestorIn;\n        var getNodeLength = dom.getNodeLength;\n        var arrayContains = dom.arrayContains;\n        var getRootContainer = dom.getRootContainer;\n        var crashyTextNodes = api.features.crashyTextNodes;\n\n        var removeNode = dom.removeNode;\n\n        /*----------------------------------------------------------------------------------------------------------------*/\n\n        // Utility functions\n\n        function isNonTextPartiallySelected(node, range) {\n            return (node.nodeType != 3) &&\n                   (isOrIsAncestorOf(node, range.startContainer) || isOrIsAncestorOf(node, range.endContainer));\n        }\n\n        function getRangeDocument(range) {\n            return range.document || getDocument(range.startContainer);\n        }\n\n        function getRangeRoot(range) {\n            return getRootContainer(range.startContainer);\n        }\n\n        function getBoundaryBeforeNode(node) {\n            return new DomPosition(node.parentNode, getNodeIndex(node));\n        }\n\n        function getBoundaryAfterNode(node) {\n            return new DomPosition(node.parentNode, getNodeIndex(node) + 1);\n        }\n\n        function insertNodeAtPosition(node, n, o) {\n            var firstNodeInserted = node.nodeType == 11 ? node.firstChild : node;\n            if (isCharacterDataNode(n)) {\n                if (o == n.length) {\n                    dom.insertAfter(node, n);\n                } else {\n                    n.parentNode.insertBefore(node, o == 0 ? n : splitDataNode(n, o));\n                }\n            } else if (o >= n.childNodes.length) {\n                n.appendChild(node);\n            } else {\n                n.insertBefore(node, n.childNodes[o]);\n            }\n            return firstNodeInserted;\n        }\n\n        function rangesIntersect(rangeA, rangeB, touchingIsIntersecting) {\n            assertRangeValid(rangeA);\n            assertRangeValid(rangeB);\n\n            if (getRangeDocument(rangeB) != getRangeDocument(rangeA)) {\n                throw new DOMException(\"WRONG_DOCUMENT_ERR\");\n            }\n\n            var startComparison = comparePoints(rangeA.startContainer, rangeA.startOffset, rangeB.endContainer, rangeB.endOffset),\n                endComparison = comparePoints(rangeA.endContainer, rangeA.endOffset, rangeB.startContainer, rangeB.startOffset);\n\n            return touchingIsIntersecting ? startComparison <= 0 && endComparison >= 0 : startComparison < 0 && endComparison > 0;\n        }\n\n        function cloneSubtree(iterator) {\n            var partiallySelected;\n            for (var node, frag = getRangeDocument(iterator.range).createDocumentFragment(), subIterator; node = iterator.next(); ) {\n                partiallySelected = iterator.isPartiallySelectedSubtree();\n                node = node.cloneNode(!partiallySelected);\n                if (partiallySelected) {\n                    subIterator = iterator.getSubtreeIterator();\n                    node.appendChild(cloneSubtree(subIterator));\n                    subIterator.detach();\n                }\n\n                if (node.nodeType == 10) { // DocumentType\n                    throw new DOMException(\"HIERARCHY_REQUEST_ERR\");\n                }\n                frag.appendChild(node);\n            }\n            return frag;\n        }\n\n        function iterateSubtree(rangeIterator, func, iteratorState) {\n            var it, n;\n            iteratorState = iteratorState || { stop: false };\n            for (var node, subRangeIterator; node = rangeIterator.next(); ) {\n                if (rangeIterator.isPartiallySelectedSubtree()) {\n                    if (func(node) === false) {\n                        iteratorState.stop = true;\n                        return;\n                    } else {\n                        // The node is partially selected by the Range, so we can use a new RangeIterator on the portion of\n                        // the node selected by the Range.\n                        subRangeIterator = rangeIterator.getSubtreeIterator();\n                        iterateSubtree(subRangeIterator, func, iteratorState);\n                        subRangeIterator.detach();\n                        if (iteratorState.stop) {\n                            return;\n                        }\n                    }\n                } else {\n                    // The whole node is selected, so we can use efficient DOM iteration to iterate over the node and its\n                    // descendants\n                    it = dom.createIterator(node);\n                    while ( (n = it.next()) ) {\n                        if (func(n) === false) {\n                            iteratorState.stop = true;\n                            return;\n                        }\n                    }\n                }\n            }\n        }\n\n        function deleteSubtree(iterator) {\n            var subIterator;\n            while (iterator.next()) {\n                if (iterator.isPartiallySelectedSubtree()) {\n                    subIterator = iterator.getSubtreeIterator();\n                    deleteSubtree(subIterator);\n                    subIterator.detach();\n                } else {\n                    iterator.remove();\n                }\n            }\n        }\n\n        function extractSubtree(iterator) {\n            for (var node, frag = getRangeDocument(iterator.range).createDocumentFragment(), subIterator; node = iterator.next(); ) {\n\n                if (iterator.isPartiallySelectedSubtree()) {\n                    node = node.cloneNode(false);\n                    subIterator = iterator.getSubtreeIterator();\n                    node.appendChild(extractSubtree(subIterator));\n                    subIterator.detach();\n                } else {\n                    iterator.remove();\n                }\n                if (node.nodeType == 10) { // DocumentType\n                    throw new DOMException(\"HIERARCHY_REQUEST_ERR\");\n                }\n                frag.appendChild(node);\n            }\n            return frag;\n        }\n\n        function getNodesInRange(range, nodeTypes, filter) {\n            var filterNodeTypes = !!(nodeTypes && nodeTypes.length), regex;\n            var filterExists = !!filter;\n            if (filterNodeTypes) {\n                regex = new RegExp(\"^(\" + nodeTypes.join(\"|\") + \")$\");\n            }\n\n            var nodes = [];\n            iterateSubtree(new RangeIterator(range, false), function(node) {\n                if (filterNodeTypes && !regex.test(node.nodeType)) {\n                    return;\n                }\n                if (filterExists && !filter(node)) {\n                    return;\n                }\n                // Don't include a boundary container if it is a character data node and the range does not contain any\n                // of its character data. See issue 190.\n                var sc = range.startContainer;\n                if (node == sc && isCharacterDataNode(sc) && range.startOffset == sc.length) {\n                    return;\n                }\n\n                var ec = range.endContainer;\n                if (node == ec && isCharacterDataNode(ec) && range.endOffset == 0) {\n                    return;\n                }\n\n                nodes.push(node);\n            });\n            return nodes;\n        }\n\n        function inspect(range) {\n            var name = (typeof range.getName == \"undefined\") ? \"Range\" : range.getName();\n            return \"[\" + name + \"(\" + dom.inspectNode(range.startContainer) + \":\" + range.startOffset + \", \" +\n                    dom.inspectNode(range.endContainer) + \":\" + range.endOffset + \")]\";\n        }\n\n        /*----------------------------------------------------------------------------------------------------------------*/\n\n        // RangeIterator code partially borrows from IERange by Tim Ryan (http://github.com/timcameronryan/IERange)\n\n        function RangeIterator(range, clonePartiallySelectedTextNodes) {\n            this.range = range;\n            this.clonePartiallySelectedTextNodes = clonePartiallySelectedTextNodes;\n\n\n            if (!range.collapsed) {\n                this.sc = range.startContainer;\n                this.so = range.startOffset;\n                this.ec = range.endContainer;\n                this.eo = range.endOffset;\n                var root = range.commonAncestorContainer;\n\n                if (this.sc === this.ec && isCharacterDataNode(this.sc)) {\n                    this.isSingleCharacterDataNode = true;\n                    this._first = this._last = this._next = this.sc;\n                } else {\n                    this._first = this._next = (this.sc === root && !isCharacterDataNode(this.sc)) ?\n                        this.sc.childNodes[this.so] : getClosestAncestorIn(this.sc, root, true);\n                    this._last = (this.ec === root && !isCharacterDataNode(this.ec)) ?\n                        this.ec.childNodes[this.eo - 1] : getClosestAncestorIn(this.ec, root, true);\n                }\n            }\n        }\n\n        RangeIterator.prototype = {\n            _current: null,\n            _next: null,\n            _first: null,\n            _last: null,\n            isSingleCharacterDataNode: false,\n\n            reset: function() {\n                this._current = null;\n                this._next = this._first;\n            },\n\n            hasNext: function() {\n                return !!this._next;\n            },\n\n            next: function() {\n                // Move to next node\n                var current = this._current = this._next;\n                if (current) {\n                    this._next = (current !== this._last) ? current.nextSibling : null;\n\n                    // Check for partially selected text nodes\n                    if (isCharacterDataNode(current) && this.clonePartiallySelectedTextNodes) {\n                        if (current === this.ec) {\n                            (current = current.cloneNode(true)).deleteData(this.eo, current.length - this.eo);\n                        }\n                        if (this._current === this.sc) {\n                            (current = current.cloneNode(true)).deleteData(0, this.so);\n                        }\n                    }\n                }\n\n                return current;\n            },\n\n            remove: function() {\n                var current = this._current, start, end;\n\n                if (isCharacterDataNode(current) && (current === this.sc || current === this.ec)) {\n                    start = (current === this.sc) ? this.so : 0;\n                    end = (current === this.ec) ? this.eo : current.length;\n                    if (start != end) {\n                        current.deleteData(start, end - start);\n                    }\n                } else {\n                    if (current.parentNode) {\n                        removeNode(current);\n                    } else {\n                    }\n                }\n            },\n\n            // Checks if the current node is partially selected\n            isPartiallySelectedSubtree: function() {\n                var current = this._current;\n                return isNonTextPartiallySelected(current, this.range);\n            },\n\n            getSubtreeIterator: function() {\n                var subRange;\n                if (this.isSingleCharacterDataNode) {\n                    subRange = this.range.cloneRange();\n                    subRange.collapse(false);\n                } else {\n                    subRange = new Range(getRangeDocument(this.range));\n                    var current = this._current;\n                    var startContainer = current, startOffset = 0, endContainer = current, endOffset = getNodeLength(current);\n\n                    if (isOrIsAncestorOf(current, this.sc)) {\n                        startContainer = this.sc;\n                        startOffset = this.so;\n                    }\n                    if (isOrIsAncestorOf(current, this.ec)) {\n                        endContainer = this.ec;\n                        endOffset = this.eo;\n                    }\n\n                    updateBoundaries(subRange, startContainer, startOffset, endContainer, endOffset);\n                }\n                return new RangeIterator(subRange, this.clonePartiallySelectedTextNodes);\n            },\n\n            detach: function() {\n                this.range = this._current = this._next = this._first = this._last = this.sc = this.so = this.ec = this.eo = null;\n            }\n        };\n\n        /*----------------------------------------------------------------------------------------------------------------*/\n\n        var beforeAfterNodeTypes = [1, 3, 4, 5, 7, 8, 10];\n        var rootContainerNodeTypes = [2, 9, 11];\n        var readonlyNodeTypes = [5, 6, 10, 12];\n        var insertableNodeTypes = [1, 3, 4, 5, 7, 8, 10, 11];\n        var surroundNodeTypes = [1, 3, 4, 5, 7, 8];\n\n        function createAncestorFinder(nodeTypes) {\n            return function(node, selfIsAncestor) {\n                var t, n = selfIsAncestor ? node : node.parentNode;\n                while (n) {\n                    t = n.nodeType;\n                    if (arrayContains(nodeTypes, t)) {\n                        return n;\n                    }\n                    n = n.parentNode;\n                }\n                return null;\n            };\n        }\n\n        var getDocumentOrFragmentContainer = createAncestorFinder( [9, 11] );\n        var getReadonlyAncestor = createAncestorFinder(readonlyNodeTypes);\n        var getDocTypeNotationEntityAncestor = createAncestorFinder( [6, 10, 12] );\n\n        function assertNoDocTypeNotationEntityAncestor(node, allowSelf) {\n            if (getDocTypeNotationEntityAncestor(node, allowSelf)) {\n                throw new DOMException(\"INVALID_NODE_TYPE_ERR\");\n            }\n        }\n\n        function assertValidNodeType(node, invalidTypes) {\n            if (!arrayContains(invalidTypes, node.nodeType)) {\n                throw new DOMException(\"INVALID_NODE_TYPE_ERR\");\n            }\n        }\n\n        function assertValidOffset(node, offset) {\n            if (offset < 0 || offset > (isCharacterDataNode(node) ? node.length : node.childNodes.length)) {\n                throw new DOMException(\"INDEX_SIZE_ERR\");\n            }\n        }\n\n        function assertSameDocumentOrFragment(node1, node2) {\n            if (getDocumentOrFragmentContainer(node1, true) !== getDocumentOrFragmentContainer(node2, true)) {\n                throw new DOMException(\"WRONG_DOCUMENT_ERR\");\n            }\n        }\n\n        function assertNodeNotReadOnly(node) {\n            if (getReadonlyAncestor(node, true)) {\n                throw new DOMException(\"NO_MODIFICATION_ALLOWED_ERR\");\n            }\n        }\n\n        function assertNode(node, codeName) {\n            if (!node) {\n                throw new DOMException(codeName);\n            }\n        }\n\n        function isValidOffset(node, offset) {\n            return offset <= (isCharacterDataNode(node) ? node.length : node.childNodes.length);\n        }\n\n        function isRangeValid(range) {\n            return (!!range.startContainer && !!range.endContainer &&\n                    !(crashyTextNodes && (dom.isBrokenNode(range.startContainer) || dom.isBrokenNode(range.endContainer))) &&\n                    getRootContainer(range.startContainer) == getRootContainer(range.endContainer) &&\n                    isValidOffset(range.startContainer, range.startOffset) &&\n                    isValidOffset(range.endContainer, range.endOffset));\n        }\n\n        function assertRangeValid(range) {\n            if (!isRangeValid(range)) {\n                throw new Error(\"Range error: Range is not valid. This usually happens after DOM mutation. Range: (\" + range.inspect() + \")\");\n            }\n        }\n\n        /*----------------------------------------------------------------------------------------------------------------*/\n\n        // Test the browser's innerHTML support to decide how to implement createContextualFragment\n        var styleEl = document.createElement(\"style\");\n        var htmlParsingConforms = false;\n        try {\n            styleEl.innerHTML = \"<b>x</b>\";\n            htmlParsingConforms = (styleEl.firstChild.nodeType == 3); // Opera incorrectly creates an element node\n        } catch (e) {\n            // IE 6 and 7 throw\n        }\n\n        api.features.htmlParsingConforms = htmlParsingConforms;\n\n        var createContextualFragment = htmlParsingConforms ?\n\n            // Implementation as per HTML parsing spec, trusting in the browser's implementation of innerHTML. See\n            // discussion and base code for this implementation at issue 67.\n            // Spec: http://html5.org/specs/dom-parsing.html#extensions-to-the-range-interface\n            // Thanks to Aleks Williams.\n            function(fragmentStr) {\n                // \"Let node the context object's start's node.\"\n                var node = this.startContainer;\n                var doc = getDocument(node);\n\n                // \"If the context object's start's node is null, raise an INVALID_STATE_ERR\n                // exception and abort these steps.\"\n                if (!node) {\n                    throw new DOMException(\"INVALID_STATE_ERR\");\n                }\n\n                // \"Let element be as follows, depending on node's interface:\"\n                // Document, Document Fragment: null\n                var el = null;\n\n                // \"Element: node\"\n                if (node.nodeType == 1) {\n                    el = node;\n\n                // \"Text, Comment: node's parentElement\"\n                } else if (isCharacterDataNode(node)) {\n                    el = dom.parentElement(node);\n                }\n\n                // \"If either element is null or element's ownerDocument is an HTML document\n                // and element's local name is \"html\" and element's namespace is the HTML\n                // namespace\"\n                if (el === null || (\n                    el.nodeName == \"HTML\" &&\n                    dom.isHtmlNamespace(getDocument(el).documentElement) &&\n                    dom.isHtmlNamespace(el)\n                )) {\n\n                // \"let element be a new Element with \"body\" as its local name and the HTML\n                // namespace as its namespace.\"\"\n                    el = doc.createElement(\"body\");\n                } else {\n                    el = el.cloneNode(false);\n                }\n\n                // \"If the node's document is an HTML document: Invoke the HTML fragment parsing algorithm.\"\n                // \"If the node's document is an XML document: Invoke the XML fragment parsing algorithm.\"\n                // \"In either case, the algorithm must be invoked with fragment as the input\n                // and element as the context element.\"\n                el.innerHTML = fragmentStr;\n\n                // \"If this raises an exception, then abort these steps. Otherwise, let new\n                // children be the nodes returned.\"\n\n                // \"Let fragment be a new DocumentFragment.\"\n                // \"Append all new children to fragment.\"\n                // \"Return fragment.\"\n                return dom.fragmentFromNodeChildren(el);\n            } :\n\n            // In this case, innerHTML cannot be trusted, so fall back to a simpler, non-conformant implementation that\n            // previous versions of Rangy used (with the exception of using a body element rather than a div)\n            function(fragmentStr) {\n                var doc = getRangeDocument(this);\n                var el = doc.createElement(\"body\");\n                el.innerHTML = fragmentStr;\n\n                return dom.fragmentFromNodeChildren(el);\n            };\n\n        function splitRangeBoundaries(range, positionsToPreserve) {\n            assertRangeValid(range);\n\n            var sc = range.startContainer, so = range.startOffset, ec = range.endContainer, eo = range.endOffset;\n            var startEndSame = (sc === ec);\n\n            if (isCharacterDataNode(ec) && eo > 0 && eo < ec.length) {\n                splitDataNode(ec, eo, positionsToPreserve);\n            }\n\n            if (isCharacterDataNode(sc) && so > 0 && so < sc.length) {\n                sc = splitDataNode(sc, so, positionsToPreserve);\n                if (startEndSame) {\n                    eo -= so;\n                    ec = sc;\n                } else if (ec == sc.parentNode && eo >= getNodeIndex(sc)) {\n                    eo++;\n                }\n                so = 0;\n            }\n            range.setStartAndEnd(sc, so, ec, eo);\n        }\n\n        function rangeToHtml(range) {\n            assertRangeValid(range);\n            var container = range.commonAncestorContainer.parentNode.cloneNode(false);\n            container.appendChild( range.cloneContents() );\n            return container.innerHTML;\n        }\n\n        /*----------------------------------------------------------------------------------------------------------------*/\n\n        var rangeProperties = [\"startContainer\", \"startOffset\", \"endContainer\", \"endOffset\", \"collapsed\",\n            \"commonAncestorContainer\"];\n\n        var s2s = 0, s2e = 1, e2e = 2, e2s = 3;\n        var n_b = 0, n_a = 1, n_b_a = 2, n_i = 3;\n\n        util.extend(api.rangePrototype, {\n            compareBoundaryPoints: function(how, range) {\n                assertRangeValid(this);\n                assertSameDocumentOrFragment(this.startContainer, range.startContainer);\n\n                var nodeA, offsetA, nodeB, offsetB;\n                var prefixA = (how == e2s || how == s2s) ? \"start\" : \"end\";\n                var prefixB = (how == s2e || how == s2s) ? \"start\" : \"end\";\n                nodeA = this[prefixA + \"Container\"];\n                offsetA = this[prefixA + \"Offset\"];\n                nodeB = range[prefixB + \"Container\"];\n                offsetB = range[prefixB + \"Offset\"];\n                return comparePoints(nodeA, offsetA, nodeB, offsetB);\n            },\n\n            insertNode: function(node) {\n                assertRangeValid(this);\n                assertValidNodeType(node, insertableNodeTypes);\n                assertNodeNotReadOnly(this.startContainer);\n\n                if (isOrIsAncestorOf(node, this.startContainer)) {\n                    throw new DOMException(\"HIERARCHY_REQUEST_ERR\");\n                }\n\n                // No check for whether the container of the start of the Range is of a type that does not allow\n                // children of the type of node: the browser's DOM implementation should do this for us when we attempt\n                // to add the node\n\n                var firstNodeInserted = insertNodeAtPosition(node, this.startContainer, this.startOffset);\n                this.setStartBefore(firstNodeInserted);\n            },\n\n            cloneContents: function() {\n                assertRangeValid(this);\n\n                var clone, frag;\n                if (this.collapsed) {\n                    return getRangeDocument(this).createDocumentFragment();\n                } else {\n                    if (this.startContainer === this.endContainer && isCharacterDataNode(this.startContainer)) {\n                        clone = this.startContainer.cloneNode(true);\n                        clone.data = clone.data.slice(this.startOffset, this.endOffset);\n                        frag = getRangeDocument(this).createDocumentFragment();\n                        frag.appendChild(clone);\n                        return frag;\n                    } else {\n                        var iterator = new RangeIterator(this, true);\n                        clone = cloneSubtree(iterator);\n                        iterator.detach();\n                    }\n                    return clone;\n                }\n            },\n\n            canSurroundContents: function() {\n                assertRangeValid(this);\n                assertNodeNotReadOnly(this.startContainer);\n                assertNodeNotReadOnly(this.endContainer);\n\n                // Check if the contents can be surrounded. Specifically, this means whether the range partially selects\n                // no non-text nodes.\n                var iterator = new RangeIterator(this, true);\n                var boundariesInvalid = (iterator._first && (isNonTextPartiallySelected(iterator._first, this)) ||\n                        (iterator._last && isNonTextPartiallySelected(iterator._last, this)));\n                iterator.detach();\n                return !boundariesInvalid;\n            },\n\n            surroundContents: function(node) {\n                assertValidNodeType(node, surroundNodeTypes);\n\n                if (!this.canSurroundContents()) {\n                    throw new DOMException(\"INVALID_STATE_ERR\");\n                }\n\n                // Extract the contents\n                var content = this.extractContents();\n\n                // Clear the children of the node\n                if (node.hasChildNodes()) {\n                    while (node.lastChild) {\n                        node.removeChild(node.lastChild);\n                    }\n                }\n\n                // Insert the new node and add the extracted contents\n                insertNodeAtPosition(node, this.startContainer, this.startOffset);\n                node.appendChild(content);\n\n                this.selectNode(node);\n            },\n\n            cloneRange: function() {\n                assertRangeValid(this);\n                var range = new Range(getRangeDocument(this));\n                var i = rangeProperties.length, prop;\n                while (i--) {\n                    prop = rangeProperties[i];\n                    range[prop] = this[prop];\n                }\n                return range;\n            },\n\n            toString: function() {\n                assertRangeValid(this);\n                var sc = this.startContainer;\n                if (sc === this.endContainer && isCharacterDataNode(sc)) {\n                    return (sc.nodeType == 3 || sc.nodeType == 4) ? sc.data.slice(this.startOffset, this.endOffset) : \"\";\n                } else {\n                    var textParts = [], iterator = new RangeIterator(this, true);\n                    iterateSubtree(iterator, function(node) {\n                        // Accept only text or CDATA nodes, not comments\n                        if (node.nodeType == 3 || node.nodeType == 4) {\n                            textParts.push(node.data);\n                        }\n                    });\n                    iterator.detach();\n                    return textParts.join(\"\");\n                }\n            },\n\n            // The methods below are all non-standard. The following batch were introduced by Mozilla but have since\n            // been removed from Mozilla.\n\n            compareNode: function(node) {\n                assertRangeValid(this);\n\n                var parent = node.parentNode;\n                var nodeIndex = getNodeIndex(node);\n\n                if (!parent) {\n                    throw new DOMException(\"NOT_FOUND_ERR\");\n                }\n\n                var startComparison = this.comparePoint(parent, nodeIndex),\n                    endComparison = this.comparePoint(parent, nodeIndex + 1);\n\n                if (startComparison < 0) { // Node starts before\n                    return (endComparison > 0) ? n_b_a : n_b;\n                } else {\n                    return (endComparison > 0) ? n_a : n_i;\n                }\n            },\n\n            comparePoint: function(node, offset) {\n                assertRangeValid(this);\n                assertNode(node, \"HIERARCHY_REQUEST_ERR\");\n                assertSameDocumentOrFragment(node, this.startContainer);\n\n                if (comparePoints(node, offset, this.startContainer, this.startOffset) < 0) {\n                    return -1;\n                } else if (comparePoints(node, offset, this.endContainer, this.endOffset) > 0) {\n                    return 1;\n                }\n                return 0;\n            },\n\n            createContextualFragment: createContextualFragment,\n\n            toHtml: function() {\n                return rangeToHtml(this);\n            },\n\n            // touchingIsIntersecting determines whether this method considers a node that borders a range intersects\n            // with it (as in WebKit) or not (as in Gecko pre-1.9, and the default)\n            intersectsNode: function(node, touchingIsIntersecting) {\n                assertRangeValid(this);\n                if (getRootContainer(node) != getRangeRoot(this)) {\n                    return false;\n                }\n\n                var parent = node.parentNode, offset = getNodeIndex(node);\n                if (!parent) {\n                    return true;\n                }\n\n                var startComparison = comparePoints(parent, offset, this.endContainer, this.endOffset),\n                    endComparison = comparePoints(parent, offset + 1, this.startContainer, this.startOffset);\n\n                return touchingIsIntersecting ? startComparison <= 0 && endComparison >= 0 : startComparison < 0 && endComparison > 0;\n            },\n\n            isPointInRange: function(node, offset) {\n                assertRangeValid(this);\n                assertNode(node, \"HIERARCHY_REQUEST_ERR\");\n                assertSameDocumentOrFragment(node, this.startContainer);\n\n                return (comparePoints(node, offset, this.startContainer, this.startOffset) >= 0) &&\n                       (comparePoints(node, offset, this.endContainer, this.endOffset) <= 0);\n            },\n\n            // The methods below are non-standard and invented by me.\n\n            // Sharing a boundary start-to-end or end-to-start does not count as intersection.\n            intersectsRange: function(range) {\n                return rangesIntersect(this, range, false);\n            },\n\n            // Sharing a boundary start-to-end or end-to-start does count as intersection.\n            intersectsOrTouchesRange: function(range) {\n                return rangesIntersect(this, range, true);\n            },\n\n            intersection: function(range) {\n                if (this.intersectsRange(range)) {\n                    var startComparison = comparePoints(this.startContainer, this.startOffset, range.startContainer, range.startOffset),\n                        endComparison = comparePoints(this.endContainer, this.endOffset, range.endContainer, range.endOffset);\n\n                    var intersectionRange = this.cloneRange();\n                    if (startComparison == -1) {\n                        intersectionRange.setStart(range.startContainer, range.startOffset);\n                    }\n                    if (endComparison == 1) {\n                        intersectionRange.setEnd(range.endContainer, range.endOffset);\n                    }\n                    return intersectionRange;\n                }\n                return null;\n            },\n\n            union: function(range) {\n                if (this.intersectsOrTouchesRange(range)) {\n                    var unionRange = this.cloneRange();\n                    if (comparePoints(range.startContainer, range.startOffset, this.startContainer, this.startOffset) == -1) {\n                        unionRange.setStart(range.startContainer, range.startOffset);\n                    }\n                    if (comparePoints(range.endContainer, range.endOffset, this.endContainer, this.endOffset) == 1) {\n                        unionRange.setEnd(range.endContainer, range.endOffset);\n                    }\n                    return unionRange;\n                } else {\n                    throw new DOMException(\"Ranges do not intersect\");\n                }\n            },\n\n            containsNode: function(node, allowPartial) {\n                if (allowPartial) {\n                    return this.intersectsNode(node, false);\n                } else {\n                    return this.compareNode(node) == n_i;\n                }\n            },\n\n            containsNodeContents: function(node) {\n                return this.comparePoint(node, 0) >= 0 && this.comparePoint(node, getNodeLength(node)) <= 0;\n            },\n\n            containsRange: function(range) {\n                var intersection = this.intersection(range);\n                return intersection !== null && range.equals(intersection);\n            },\n\n            containsNodeText: function(node) {\n                var nodeRange = this.cloneRange();\n                nodeRange.selectNode(node);\n                var textNodes = nodeRange.getNodes([3]);\n                if (textNodes.length > 0) {\n                    nodeRange.setStart(textNodes[0], 0);\n                    var lastTextNode = textNodes.pop();\n                    nodeRange.setEnd(lastTextNode, lastTextNode.length);\n                    return this.containsRange(nodeRange);\n                } else {\n                    return this.containsNodeContents(node);\n                }\n            },\n\n            getNodes: function(nodeTypes, filter) {\n                assertRangeValid(this);\n                return getNodesInRange(this, nodeTypes, filter);\n            },\n\n            getDocument: function() {\n                return getRangeDocument(this);\n            },\n\n            collapseBefore: function(node) {\n                this.setEndBefore(node);\n                this.collapse(false);\n            },\n\n            collapseAfter: function(node) {\n                this.setStartAfter(node);\n                this.collapse(true);\n            },\n\n            getBookmark: function(containerNode) {\n                var doc = getRangeDocument(this);\n                var preSelectionRange = api.createRange(doc);\n                containerNode = containerNode || dom.getBody(doc);\n                preSelectionRange.selectNodeContents(containerNode);\n                var range = this.intersection(preSelectionRange);\n                var start = 0, end = 0;\n                if (range) {\n                    preSelectionRange.setEnd(range.startContainer, range.startOffset);\n                    start = preSelectionRange.toString().length;\n                    end = start + range.toString().length;\n                }\n\n                return {\n                    start: start,\n                    end: end,\n                    containerNode: containerNode\n                };\n            },\n\n            moveToBookmark: function(bookmark) {\n                var containerNode = bookmark.containerNode;\n                var charIndex = 0;\n                this.setStart(containerNode, 0);\n                this.collapse(true);\n                var nodeStack = [containerNode], node, foundStart = false, stop = false;\n                var nextCharIndex, i, childNodes;\n\n                while (!stop && (node = nodeStack.pop())) {\n                    if (node.nodeType == 3) {\n                        nextCharIndex = charIndex + node.length;\n                        if (!foundStart && bookmark.start >= charIndex && bookmark.start <= nextCharIndex) {\n                            this.setStart(node, bookmark.start - charIndex);\n                            foundStart = true;\n                        }\n                        if (foundStart && bookmark.end >= charIndex && bookmark.end <= nextCharIndex) {\n                            this.setEnd(node, bookmark.end - charIndex);\n                            stop = true;\n                        }\n                        charIndex = nextCharIndex;\n                    } else {\n                        childNodes = node.childNodes;\n                        i = childNodes.length;\n                        while (i--) {\n                            nodeStack.push(childNodes[i]);\n                        }\n                    }\n                }\n            },\n\n            getName: function() {\n                return \"DomRange\";\n            },\n\n            equals: function(range) {\n                return Range.rangesEqual(this, range);\n            },\n\n            isValid: function() {\n                return isRangeValid(this);\n            },\n\n            inspect: function() {\n                return inspect(this);\n            },\n\n            detach: function() {\n                // In DOM4, detach() is now a no-op.\n            }\n        });\n\n        function copyComparisonConstantsToObject(obj) {\n            obj.START_TO_START = s2s;\n            obj.START_TO_END = s2e;\n            obj.END_TO_END = e2e;\n            obj.END_TO_START = e2s;\n\n            obj.NODE_BEFORE = n_b;\n            obj.NODE_AFTER = n_a;\n            obj.NODE_BEFORE_AND_AFTER = n_b_a;\n            obj.NODE_INSIDE = n_i;\n        }\n\n        function copyComparisonConstants(constructor) {\n            copyComparisonConstantsToObject(constructor);\n            copyComparisonConstantsToObject(constructor.prototype);\n        }\n\n        function createRangeContentRemover(remover, boundaryUpdater) {\n            return function() {\n                assertRangeValid(this);\n\n                var sc = this.startContainer, so = this.startOffset, root = this.commonAncestorContainer;\n\n                var iterator = new RangeIterator(this, true);\n\n                // Work out where to position the range after content removal\n                var node, boundary;\n                if (sc !== root) {\n                    node = getClosestAncestorIn(sc, root, true);\n                    boundary = getBoundaryAfterNode(node);\n                    sc = boundary.node;\n                    so = boundary.offset;\n                }\n\n                // Check none of the range is read-only\n                iterateSubtree(iterator, assertNodeNotReadOnly);\n\n                iterator.reset();\n\n                // Remove the content\n                var returnValue = remover(iterator);\n                iterator.detach();\n\n                // Move to the new position\n                boundaryUpdater(this, sc, so, sc, so);\n\n                return returnValue;\n            };\n        }\n\n        function createPrototypeRange(constructor, boundaryUpdater) {\n            function createBeforeAfterNodeSetter(isBefore, isStart) {\n                return function(node) {\n                    assertValidNodeType(node, beforeAfterNodeTypes);\n                    assertValidNodeType(getRootContainer(node), rootContainerNodeTypes);\n\n                    var boundary = (isBefore ? getBoundaryBeforeNode : getBoundaryAfterNode)(node);\n                    (isStart ? setRangeStart : setRangeEnd)(this, boundary.node, boundary.offset);\n                };\n            }\n\n            function setRangeStart(range, node, offset) {\n                var ec = range.endContainer, eo = range.endOffset;\n                if (node !== range.startContainer || offset !== range.startOffset) {\n                    // Check the root containers of the range and the new boundary, and also check whether the new boundary\n                    // is after the current end. In either case, collapse the range to the new position\n                    if (getRootContainer(node) != getRootContainer(ec) || comparePoints(node, offset, ec, eo) == 1) {\n                        ec = node;\n                        eo = offset;\n                    }\n                    boundaryUpdater(range, node, offset, ec, eo);\n                }\n            }\n\n            function setRangeEnd(range, node, offset) {\n                var sc = range.startContainer, so = range.startOffset;\n                if (node !== range.endContainer || offset !== range.endOffset) {\n                    // Check the root containers of the range and the new boundary, and also check whether the new boundary\n                    // is after the current end. In either case, collapse the range to the new position\n                    if (getRootContainer(node) != getRootContainer(sc) || comparePoints(node, offset, sc, so) == -1) {\n                        sc = node;\n                        so = offset;\n                    }\n                    boundaryUpdater(range, sc, so, node, offset);\n                }\n            }\n\n            // Set up inheritance\n            var F = function() {};\n            F.prototype = api.rangePrototype;\n            constructor.prototype = new F();\n\n            util.extend(constructor.prototype, {\n                setStart: function(node, offset) {\n                    assertNoDocTypeNotationEntityAncestor(node, true);\n                    assertValidOffset(node, offset);\n\n                    setRangeStart(this, node, offset);\n                },\n\n                setEnd: function(node, offset) {\n                    assertNoDocTypeNotationEntityAncestor(node, true);\n                    assertValidOffset(node, offset);\n\n                    setRangeEnd(this, node, offset);\n                },\n\n                /**\n                 * Convenience method to set a range's start and end boundaries. Overloaded as follows:\n                 * - Two parameters (node, offset) creates a collapsed range at that position\n                 * - Three parameters (node, startOffset, endOffset) creates a range contained with node starting at\n                 *   startOffset and ending at endOffset\n                 * - Four parameters (startNode, startOffset, endNode, endOffset) creates a range starting at startOffset in\n                 *   startNode and ending at endOffset in endNode\n                 */\n                setStartAndEnd: function() {\n                    var args = arguments;\n                    var sc = args[0], so = args[1], ec = sc, eo = so;\n\n                    switch (args.length) {\n                        case 3:\n                            eo = args[2];\n                            break;\n                        case 4:\n                            ec = args[2];\n                            eo = args[3];\n                            break;\n                    }\n\n                    boundaryUpdater(this, sc, so, ec, eo);\n                },\n\n                setBoundary: function(node, offset, isStart) {\n                    this[\"set\" + (isStart ? \"Start\" : \"End\")](node, offset);\n                },\n\n                setStartBefore: createBeforeAfterNodeSetter(true, true),\n                setStartAfter: createBeforeAfterNodeSetter(false, true),\n                setEndBefore: createBeforeAfterNodeSetter(true, false),\n                setEndAfter: createBeforeAfterNodeSetter(false, false),\n\n                collapse: function(isStart) {\n                    assertRangeValid(this);\n                    if (isStart) {\n                        boundaryUpdater(this, this.startContainer, this.startOffset, this.startContainer, this.startOffset);\n                    } else {\n                        boundaryUpdater(this, this.endContainer, this.endOffset, this.endContainer, this.endOffset);\n                    }\n                },\n\n                selectNodeContents: function(node) {\n                    assertNoDocTypeNotationEntityAncestor(node, true);\n\n                    boundaryUpdater(this, node, 0, node, getNodeLength(node));\n                },\n\n                selectNode: function(node) {\n                    assertNoDocTypeNotationEntityAncestor(node, false);\n                    assertValidNodeType(node, beforeAfterNodeTypes);\n\n                    var start = getBoundaryBeforeNode(node), end = getBoundaryAfterNode(node);\n                    boundaryUpdater(this, start.node, start.offset, end.node, end.offset);\n                },\n\n                extractContents: createRangeContentRemover(extractSubtree, boundaryUpdater),\n\n                deleteContents: createRangeContentRemover(deleteSubtree, boundaryUpdater),\n\n                canSurroundContents: function() {\n                    assertRangeValid(this);\n                    assertNodeNotReadOnly(this.startContainer);\n                    assertNodeNotReadOnly(this.endContainer);\n\n                    // Check if the contents can be surrounded. Specifically, this means whether the range partially selects\n                    // no non-text nodes.\n                    var iterator = new RangeIterator(this, true);\n                    var boundariesInvalid = (iterator._first && isNonTextPartiallySelected(iterator._first, this) ||\n                            (iterator._last && isNonTextPartiallySelected(iterator._last, this)));\n                    iterator.detach();\n                    return !boundariesInvalid;\n                },\n\n                splitBoundaries: function() {\n                    splitRangeBoundaries(this);\n                },\n\n                splitBoundariesPreservingPositions: function(positionsToPreserve) {\n                    splitRangeBoundaries(this, positionsToPreserve);\n                },\n\n                normalizeBoundaries: function() {\n                    assertRangeValid(this);\n\n                    var sc = this.startContainer, so = this.startOffset, ec = this.endContainer, eo = this.endOffset;\n\n                    var mergeForward = function(node) {\n                        var sibling = node.nextSibling;\n                        if (sibling && sibling.nodeType == node.nodeType) {\n                            ec = node;\n                            eo = node.length;\n                            node.appendData(sibling.data);\n                            removeNode(sibling);\n                        }\n                    };\n\n                    var mergeBackward = function(node) {\n                        var sibling = node.previousSibling;\n                        if (sibling && sibling.nodeType == node.nodeType) {\n                            sc = node;\n                            var nodeLength = node.length;\n                            so = sibling.length;\n                            node.insertData(0, sibling.data);\n                            removeNode(sibling);\n                            if (sc == ec) {\n                                eo += so;\n                                ec = sc;\n                            } else if (ec == node.parentNode) {\n                                var nodeIndex = getNodeIndex(node);\n                                if (eo == nodeIndex) {\n                                    ec = node;\n                                    eo = nodeLength;\n                                } else if (eo > nodeIndex) {\n                                    eo--;\n                                }\n                            }\n                        }\n                    };\n\n                    var normalizeStart = true;\n                    var sibling;\n\n                    if (isCharacterDataNode(ec)) {\n                        if (eo == ec.length) {\n                            mergeForward(ec);\n                        } else if (eo == 0) {\n                            sibling = ec.previousSibling;\n                            if (sibling && sibling.nodeType == ec.nodeType) {\n                                eo = sibling.length;\n                                if (sc == ec) {\n                                    normalizeStart = false;\n                                }\n                                sibling.appendData(ec.data);\n                                removeNode(ec);\n                                ec = sibling;\n                            }\n                        }\n                    } else {\n                        if (eo > 0) {\n                            var endNode = ec.childNodes[eo - 1];\n                            if (endNode && isCharacterDataNode(endNode)) {\n                                mergeForward(endNode);\n                            }\n                        }\n                        normalizeStart = !this.collapsed;\n                    }\n\n                    if (normalizeStart) {\n                        if (isCharacterDataNode(sc)) {\n                            if (so == 0) {\n                                mergeBackward(sc);\n                            } else if (so == sc.length) {\n                                sibling = sc.nextSibling;\n                                if (sibling && sibling.nodeType == sc.nodeType) {\n                                    if (ec == sibling) {\n                                        ec = sc;\n                                        eo += sc.length;\n                                    }\n                                    sc.appendData(sibling.data);\n                                    removeNode(sibling);\n                                }\n                            }\n                        } else {\n                            if (so < sc.childNodes.length) {\n                                var startNode = sc.childNodes[so];\n                                if (startNode && isCharacterDataNode(startNode)) {\n                                    mergeBackward(startNode);\n                                }\n                            }\n                        }\n                    } else {\n                        sc = ec;\n                        so = eo;\n                    }\n\n                    boundaryUpdater(this, sc, so, ec, eo);\n                },\n\n                collapseToPoint: function(node, offset) {\n                    assertNoDocTypeNotationEntityAncestor(node, true);\n                    assertValidOffset(node, offset);\n                    this.setStartAndEnd(node, offset);\n                }\n            });\n\n            copyComparisonConstants(constructor);\n        }\n\n        /*----------------------------------------------------------------------------------------------------------------*/\n\n        // Updates commonAncestorContainer and collapsed after boundary change\n        function updateCollapsedAndCommonAncestor(range) {\n            range.collapsed = (range.startContainer === range.endContainer && range.startOffset === range.endOffset);\n            range.commonAncestorContainer = range.collapsed ?\n                range.startContainer : dom.getCommonAncestor(range.startContainer, range.endContainer);\n        }\n\n        function updateBoundaries(range, startContainer, startOffset, endContainer, endOffset) {\n            range.startContainer = startContainer;\n            range.startOffset = startOffset;\n            range.endContainer = endContainer;\n            range.endOffset = endOffset;\n            range.document = dom.getDocument(startContainer);\n\n            updateCollapsedAndCommonAncestor(range);\n        }\n\n        function Range(doc) {\n            this.startContainer = doc;\n            this.startOffset = 0;\n            this.endContainer = doc;\n            this.endOffset = 0;\n            this.document = doc;\n            updateCollapsedAndCommonAncestor(this);\n        }\n\n        createPrototypeRange(Range, updateBoundaries);\n\n        util.extend(Range, {\n            rangeProperties: rangeProperties,\n            RangeIterator: RangeIterator,\n            copyComparisonConstants: copyComparisonConstants,\n            createPrototypeRange: createPrototypeRange,\n            inspect: inspect,\n            toHtml: rangeToHtml,\n            getRangeDocument: getRangeDocument,\n            rangesEqual: function(r1, r2) {\n                return r1.startContainer === r2.startContainer &&\n                    r1.startOffset === r2.startOffset &&\n                    r1.endContainer === r2.endContainer &&\n                    r1.endOffset === r2.endOffset;\n            }\n        });\n\n        api.DomRange = Range;\n    });\r\n\r\n    /*----------------------------------------------------------------------------------------------------------------*/\r\n\r\n    // Wrappers for the browser's native DOM Range and/or TextRange implementation\n    api.createCoreModule(\"WrappedRange\", [\"DomRange\"], function(api, module) {\n        var WrappedRange, WrappedTextRange;\n        var dom = api.dom;\n        var util = api.util;\n        var DomPosition = dom.DomPosition;\n        var DomRange = api.DomRange;\n        var getBody = dom.getBody;\n        var getContentDocument = dom.getContentDocument;\n        var isCharacterDataNode = dom.isCharacterDataNode;\n\n\n        /*----------------------------------------------------------------------------------------------------------------*/\n\n        if (api.features.implementsDomRange) {\n            // This is a wrapper around the browser's native DOM Range. It has two aims:\n            // - Provide workarounds for specific browser bugs\n            // - provide convenient extensions, which are inherited from Rangy's DomRange\n\n            (function() {\n                var rangeProto;\n                var rangeProperties = DomRange.rangeProperties;\n\n                function updateRangeProperties(range) {\n                    var i = rangeProperties.length, prop;\n                    while (i--) {\n                        prop = rangeProperties[i];\n                        range[prop] = range.nativeRange[prop];\n                    }\n                    // Fix for broken collapsed property in IE 9.\n                    range.collapsed = (range.startContainer === range.endContainer && range.startOffset === range.endOffset);\n                }\n\n                function updateNativeRange(range, startContainer, startOffset, endContainer, endOffset) {\n                    var startMoved = (range.startContainer !== startContainer || range.startOffset != startOffset);\n                    var endMoved = (range.endContainer !== endContainer || range.endOffset != endOffset);\n                    var nativeRangeDifferent = !range.equals(range.nativeRange);\n\n                    // Always set both boundaries for the benefit of IE9 (see issue 35)\n                    if (startMoved || endMoved || nativeRangeDifferent) {\n                        range.setEnd(endContainer, endOffset);\n                        range.setStart(startContainer, startOffset);\n                    }\n                }\n\n                var createBeforeAfterNodeSetter;\n\n                WrappedRange = function(range) {\n                    if (!range) {\n                        throw module.createError(\"WrappedRange: Range must be specified\");\n                    }\n                    this.nativeRange = range;\n                    updateRangeProperties(this);\n                };\n\n                DomRange.createPrototypeRange(WrappedRange, updateNativeRange);\n\n                rangeProto = WrappedRange.prototype;\n\n                rangeProto.selectNode = function(node) {\n                    this.nativeRange.selectNode(node);\n                    updateRangeProperties(this);\n                };\n\n                rangeProto.cloneContents = function() {\n                    return this.nativeRange.cloneContents();\n                };\n\n                // Due to a long-standing Firefox bug that I have not been able to find a reliable way to detect,\n                // insertNode() is never delegated to the native range.\n\n                rangeProto.surroundContents = function(node) {\n                    this.nativeRange.surroundContents(node);\n                    updateRangeProperties(this);\n                };\n\n                rangeProto.collapse = function(isStart) {\n                    this.nativeRange.collapse(isStart);\n                    updateRangeProperties(this);\n                };\n\n                rangeProto.cloneRange = function() {\n                    return new WrappedRange(this.nativeRange.cloneRange());\n                };\n\n                rangeProto.refresh = function() {\n                    updateRangeProperties(this);\n                };\n\n                rangeProto.toString = function() {\n                    return this.nativeRange.toString();\n                };\n\n                // Create test range and node for feature detection\n\n                var testTextNode = document.createTextNode(\"test\");\n                getBody(document).appendChild(testTextNode);\n                var range = document.createRange();\n\n                /*--------------------------------------------------------------------------------------------------------*/\n\n                // Test for Firefox 2 bug that prevents moving the start of a Range to a point after its current end and\n                // correct for it\n\n                range.setStart(testTextNode, 0);\n                range.setEnd(testTextNode, 0);\n\n                try {\n                    range.setStart(testTextNode, 1);\n\n                    rangeProto.setStart = function(node, offset) {\n                        this.nativeRange.setStart(node, offset);\n                        updateRangeProperties(this);\n                    };\n\n                    rangeProto.setEnd = function(node, offset) {\n                        this.nativeRange.setEnd(node, offset);\n                        updateRangeProperties(this);\n                    };\n\n                    createBeforeAfterNodeSetter = function(name) {\n                        return function(node) {\n                            this.nativeRange[name](node);\n                            updateRangeProperties(this);\n                        };\n                    };\n\n                } catch(ex) {\n\n                    rangeProto.setStart = function(node, offset) {\n                        try {\n                            this.nativeRange.setStart(node, offset);\n                        } catch (ex) {\n                            this.nativeRange.setEnd(node, offset);\n                            this.nativeRange.setStart(node, offset);\n                        }\n                        updateRangeProperties(this);\n                    };\n\n                    rangeProto.setEnd = function(node, offset) {\n                        try {\n                            this.nativeRange.setEnd(node, offset);\n                        } catch (ex) {\n                            this.nativeRange.setStart(node, offset);\n                            this.nativeRange.setEnd(node, offset);\n                        }\n                        updateRangeProperties(this);\n                    };\n\n                    createBeforeAfterNodeSetter = function(name, oppositeName) {\n                        return function(node) {\n                            try {\n                                this.nativeRange[name](node);\n                            } catch (ex) {\n                                this.nativeRange[oppositeName](node);\n                                this.nativeRange[name](node);\n                            }\n                            updateRangeProperties(this);\n                        };\n                    };\n                }\n\n                rangeProto.setStartBefore = createBeforeAfterNodeSetter(\"setStartBefore\", \"setEndBefore\");\n                rangeProto.setStartAfter = createBeforeAfterNodeSetter(\"setStartAfter\", \"setEndAfter\");\n                rangeProto.setEndBefore = createBeforeAfterNodeSetter(\"setEndBefore\", \"setStartBefore\");\n                rangeProto.setEndAfter = createBeforeAfterNodeSetter(\"setEndAfter\", \"setStartAfter\");\n\n                /*--------------------------------------------------------------------------------------------------------*/\n\n                // Always use DOM4-compliant selectNodeContents implementation: it's simpler and less code than testing\n                // whether the native implementation can be trusted\n                rangeProto.selectNodeContents = function(node) {\n                    this.setStartAndEnd(node, 0, dom.getNodeLength(node));\n                };\n\n                /*--------------------------------------------------------------------------------------------------------*/\n\n                // Test for and correct WebKit bug that has the behaviour of compareBoundaryPoints round the wrong way for\n                // constants START_TO_END and END_TO_START: https://bugs.webkit.org/show_bug.cgi?id=20738\n\n                range.selectNodeContents(testTextNode);\n                range.setEnd(testTextNode, 3);\n\n                var range2 = document.createRange();\n                range2.selectNodeContents(testTextNode);\n                range2.setEnd(testTextNode, 4);\n                range2.setStart(testTextNode, 2);\n\n                if (range.compareBoundaryPoints(range.START_TO_END, range2) == -1 &&\n                        range.compareBoundaryPoints(range.END_TO_START, range2) == 1) {\n                    // This is the wrong way round, so correct for it\n\n                    rangeProto.compareBoundaryPoints = function(type, range) {\n                        range = range.nativeRange || range;\n                        if (type == range.START_TO_END) {\n                            type = range.END_TO_START;\n                        } else if (type == range.END_TO_START) {\n                            type = range.START_TO_END;\n                        }\n                        return this.nativeRange.compareBoundaryPoints(type, range);\n                    };\n                } else {\n                    rangeProto.compareBoundaryPoints = function(type, range) {\n                        return this.nativeRange.compareBoundaryPoints(type, range.nativeRange || range);\n                    };\n                }\n\n                /*--------------------------------------------------------------------------------------------------------*/\n\n                // Test for IE deleteContents() and extractContents() bug and correct it. See issue 107.\n\n                var el = document.createElement(\"div\");\n                el.innerHTML = \"123\";\n                var textNode = el.firstChild;\n                var body = getBody(document);\n                body.appendChild(el);\n\n                range.setStart(textNode, 1);\n                range.setEnd(textNode, 2);\n                range.deleteContents();\n\n                if (textNode.data == \"13\") {\n                    // Behaviour is correct per DOM4 Range so wrap the browser's implementation of deleteContents() and\n                    // extractContents()\n                    rangeProto.deleteContents = function() {\n                        this.nativeRange.deleteContents();\n                        updateRangeProperties(this);\n                    };\n\n                    rangeProto.extractContents = function() {\n                        var frag = this.nativeRange.extractContents();\n                        updateRangeProperties(this);\n                        return frag;\n                    };\n                } else {\n                }\n\n                body.removeChild(el);\n                body = null;\n\n                /*--------------------------------------------------------------------------------------------------------*/\n\n                // Test for existence of createContextualFragment and delegate to it if it exists\n                if (util.isHostMethod(range, \"createContextualFragment\")) {\n                    rangeProto.createContextualFragment = function(fragmentStr) {\n                        return this.nativeRange.createContextualFragment(fragmentStr);\n                    };\n                }\n\n                /*--------------------------------------------------------------------------------------------------------*/\n\n                // Clean up\n                getBody(document).removeChild(testTextNode);\n\n                rangeProto.getName = function() {\n                    return \"WrappedRange\";\n                };\n\n                api.WrappedRange = WrappedRange;\n\n                api.createNativeRange = function(doc) {\n                    doc = getContentDocument(doc, module, \"createNativeRange\");\n                    return doc.createRange();\n                };\n            })();\n        }\n\n        if (api.features.implementsTextRange) {\n            /*\n            This is a workaround for a bug where IE returns the wrong container element from the TextRange's parentElement()\n            method. For example, in the following (where pipes denote the selection boundaries):\n\n            <ul id=\"ul\"><li id=\"a\">| a </li><li id=\"b\"> b |</li></ul>\n\n            var range = document.selection.createRange();\n            alert(range.parentElement().id); // Should alert \"ul\" but alerts \"b\"\n\n            This method returns the common ancestor node of the following:\n            - the parentElement() of the textRange\n            - the parentElement() of the textRange after calling collapse(true)\n            - the parentElement() of the textRange after calling collapse(false)\n            */\n            var getTextRangeContainerElement = function(textRange) {\n                var parentEl = textRange.parentElement();\n                var range = textRange.duplicate();\n                range.collapse(true);\n                var startEl = range.parentElement();\n                range = textRange.duplicate();\n                range.collapse(false);\n                var endEl = range.parentElement();\n                var startEndContainer = (startEl == endEl) ? startEl : dom.getCommonAncestor(startEl, endEl);\n\n                return startEndContainer == parentEl ? startEndContainer : dom.getCommonAncestor(parentEl, startEndContainer);\n            };\n\n            var textRangeIsCollapsed = function(textRange) {\n                return textRange.compareEndPoints(\"StartToEnd\", textRange) == 0;\n            };\n\n            // Gets the boundary of a TextRange expressed as a node and an offset within that node. This function started\n            // out as an improved version of code found in Tim Cameron Ryan's IERange (http://code.google.com/p/ierange/)\n            // but has grown, fixing problems with line breaks in preformatted text, adding workaround for IE TextRange\n            // bugs, handling for inputs and images, plus optimizations.\n            var getTextRangeBoundaryPosition = function(textRange, wholeRangeContainerElement, isStart, isCollapsed, startInfo) {\n                var workingRange = textRange.duplicate();\n                workingRange.collapse(isStart);\n                var containerElement = workingRange.parentElement();\n\n                // Sometimes collapsing a TextRange that's at the start of a text node can move it into the previous node, so\n                // check for that\n                if (!dom.isOrIsAncestorOf(wholeRangeContainerElement, containerElement)) {\n                    containerElement = wholeRangeContainerElement;\n                }\n\n\n                // Deal with nodes that cannot \"contain rich HTML markup\". In practice, this means form inputs, images and\n                // similar. See http://msdn.microsoft.com/en-us/library/aa703950%28VS.85%29.aspx\n                if (!containerElement.canHaveHTML) {\n                    var pos = new DomPosition(containerElement.parentNode, dom.getNodeIndex(containerElement));\n                    return {\n                        boundaryPosition: pos,\n                        nodeInfo: {\n                            nodeIndex: pos.offset,\n                            containerElement: pos.node\n                        }\n                    };\n                }\n\n                var workingNode = dom.getDocument(containerElement).createElement(\"span\");\n\n                // Workaround for HTML5 Shiv's insane violation of document.createElement(). See Rangy issue 104 and HTML5\n                // Shiv issue 64: https://github.com/aFarkas/html5shiv/issues/64\n                if (workingNode.parentNode) {\n                    dom.removeNode(workingNode);\n                }\n\n                var comparison, workingComparisonType = isStart ? \"StartToStart\" : \"StartToEnd\";\n                var previousNode, nextNode, boundaryPosition, boundaryNode;\n                var start = (startInfo && startInfo.containerElement == containerElement) ? startInfo.nodeIndex : 0;\n                var childNodeCount = containerElement.childNodes.length;\n                var end = childNodeCount;\n\n                // Check end first. Code within the loop assumes that the endth child node of the container is definitely\n                // after the range boundary.\n                var nodeIndex = end;\n\n                while (true) {\n                    if (nodeIndex == childNodeCount) {\n                        containerElement.appendChild(workingNode);\n                    } else {\n                        containerElement.insertBefore(workingNode, containerElement.childNodes[nodeIndex]);\n                    }\n                    workingRange.moveToElementText(workingNode);\n                    comparison = workingRange.compareEndPoints(workingComparisonType, textRange);\n                    if (comparison == 0 || start == end) {\n                        break;\n                    } else if (comparison == -1) {\n                        if (end == start + 1) {\n                            // We know the endth child node is after the range boundary, so we must be done.\n                            break;\n                        } else {\n                            start = nodeIndex;\n                        }\n                    } else {\n                        end = (end == start + 1) ? start : nodeIndex;\n                    }\n                    nodeIndex = Math.floor((start + end) / 2);\n                    containerElement.removeChild(workingNode);\n                }\n\n\n                // We've now reached or gone past the boundary of the text range we're interested in\n                // so have identified the node we want\n                boundaryNode = workingNode.nextSibling;\n\n                if (comparison == -1 && boundaryNode && isCharacterDataNode(boundaryNode)) {\n                    // This is a character data node (text, comment, cdata). The working range is collapsed at the start of\n                    // the node containing the text range's boundary, so we move the end of the working range to the\n                    // boundary point and measure the length of its text to get the boundary's offset within the node.\n                    workingRange.setEndPoint(isStart ? \"EndToStart\" : \"EndToEnd\", textRange);\n\n                    var offset;\n\n                    if (/[\\r\\n]/.test(boundaryNode.data)) {\n                        /*\n                        For the particular case of a boundary within a text node containing rendered line breaks (within a\n                        <pre> element, for example), we need a slightly complicated approach to get the boundary's offset in\n                        IE. The facts:\n\n                        - Each line break is represented as \\r in the text node's data/nodeValue properties\n                        - Each line break is represented as \\r\\n in the TextRange's 'text' property\n                        - The 'text' property of the TextRange does not contain trailing line breaks\n\n                        To get round the problem presented by the final fact above, we can use the fact that TextRange's\n                        moveStart() and moveEnd() methods return the actual number of characters moved, which is not\n                        necessarily the same as the number of characters it was instructed to move. The simplest approach is\n                        to use this to store the characters moved when moving both the start and end of the range to the\n                        start of the document body and subtracting the start offset from the end offset (the\n                        \"move-negative-gazillion\" method). However, this is extremely slow when the document is large and\n                        the range is near the end of it. Clearly doing the mirror image (i.e. moving the range boundaries to\n                        the end of the document) has the same problem.\n\n                        Another approach that works is to use moveStart() to move the start boundary of the range up to the\n                        end boundary one character at a time and incrementing a counter with the value returned by the\n                        moveStart() call. However, the check for whether the start boundary has reached the end boundary is\n                        expensive, so this method is slow (although unlike \"move-negative-gazillion\" is largely unaffected\n                        by the location of the range within the document).\n\n                        The approach used below is a hybrid of the two methods above. It uses the fact that a string\n                        containing the TextRange's 'text' property with each \\r\\n converted to a single \\r character cannot\n                        be longer than the text of the TextRange, so the start of the range is moved that length initially\n                        and then a character at a time to make up for any trailing line breaks not contained in the 'text'\n                        property. This has good performance in most situations compared to the previous two methods.\n                        */\n                        var tempRange = workingRange.duplicate();\n                        var rangeLength = tempRange.text.replace(/\\r\\n/g, \"\\r\").length;\n\n                        offset = tempRange.moveStart(\"character\", rangeLength);\n                        while ( (comparison = tempRange.compareEndPoints(\"StartToEnd\", tempRange)) == -1) {\n                            offset++;\n                            tempRange.moveStart(\"character\", 1);\n                        }\n                    } else {\n                        offset = workingRange.text.length;\n                    }\n                    boundaryPosition = new DomPosition(boundaryNode, offset);\n                } else {\n\n                    // If the boundary immediately follows a character data node and this is the end boundary, we should favour\n                    // a position within that, and likewise for a start boundary preceding a character data node\n                    previousNode = (isCollapsed || !isStart) && workingNode.previousSibling;\n                    nextNode = (isCollapsed || isStart) && workingNode.nextSibling;\n                    if (nextNode && isCharacterDataNode(nextNode)) {\n                        boundaryPosition = new DomPosition(nextNode, 0);\n                    } else if (previousNode && isCharacterDataNode(previousNode)) {\n                        boundaryPosition = new DomPosition(previousNode, previousNode.data.length);\n                    } else {\n                        boundaryPosition = new DomPosition(containerElement, dom.getNodeIndex(workingNode));\n                    }\n                }\n\n                // Clean up\n                dom.removeNode(workingNode);\n\n                return {\n                    boundaryPosition: boundaryPosition,\n                    nodeInfo: {\n                        nodeIndex: nodeIndex,\n                        containerElement: containerElement\n                    }\n                };\n            };\n\n            // Returns a TextRange representing the boundary of a TextRange expressed as a node and an offset within that\n            // node. This function started out as an optimized version of code found in Tim Cameron Ryan's IERange\n            // (http://code.google.com/p/ierange/)\n            var createBoundaryTextRange = function(boundaryPosition, isStart) {\n                var boundaryNode, boundaryParent, boundaryOffset = boundaryPosition.offset;\n                var doc = dom.getDocument(boundaryPosition.node);\n                var workingNode, childNodes, workingRange = getBody(doc).createTextRange();\n                var nodeIsDataNode = isCharacterDataNode(boundaryPosition.node);\n\n                if (nodeIsDataNode) {\n                    boundaryNode = boundaryPosition.node;\n                    boundaryParent = boundaryNode.parentNode;\n                } else {\n                    childNodes = boundaryPosition.node.childNodes;\n                    boundaryNode = (boundaryOffset < childNodes.length) ? childNodes[boundaryOffset] : null;\n                    boundaryParent = boundaryPosition.node;\n                }\n\n                // Position the range immediately before the node containing the boundary\n                workingNode = doc.createElement(\"span\");\n\n                // Making the working element non-empty element persuades IE to consider the TextRange boundary to be within\n                // the element rather than immediately before or after it\n                workingNode.innerHTML = \"&#feff;\";\n\n                // insertBefore is supposed to work like appendChild if the second parameter is null. However, a bug report\n                // for IERange suggests that it can crash the browser: http://code.google.com/p/ierange/issues/detail?id=12\n                if (boundaryNode) {\n                    boundaryParent.insertBefore(workingNode, boundaryNode);\n                } else {\n                    boundaryParent.appendChild(workingNode);\n                }\n\n                workingRange.moveToElementText(workingNode);\n                workingRange.collapse(!isStart);\n\n                // Clean up\n                boundaryParent.removeChild(workingNode);\n\n                // Move the working range to the text offset, if required\n                if (nodeIsDataNode) {\n                    workingRange[isStart ? \"moveStart\" : \"moveEnd\"](\"character\", boundaryOffset);\n                }\n\n                return workingRange;\n            };\n\n            /*------------------------------------------------------------------------------------------------------------*/\n\n            // This is a wrapper around a TextRange, providing full DOM Range functionality using rangy's DomRange as a\n            // prototype\n\n            WrappedTextRange = function(textRange) {\n                this.textRange = textRange;\n                this.refresh();\n            };\n\n            WrappedTextRange.prototype = new DomRange(document);\n\n            WrappedTextRange.prototype.refresh = function() {\n                var start, end, startBoundary;\n\n                // TextRange's parentElement() method cannot be trusted. getTextRangeContainerElement() works around that.\n                var rangeContainerElement = getTextRangeContainerElement(this.textRange);\n\n                if (textRangeIsCollapsed(this.textRange)) {\n                    end = start = getTextRangeBoundaryPosition(this.textRange, rangeContainerElement, true,\n                        true).boundaryPosition;\n                } else {\n                    startBoundary = getTextRangeBoundaryPosition(this.textRange, rangeContainerElement, true, false);\n                    start = startBoundary.boundaryPosition;\n\n                    // An optimization used here is that if the start and end boundaries have the same parent element, the\n                    // search scope for the end boundary can be limited to exclude the portion of the element that precedes\n                    // the start boundary\n                    end = getTextRangeBoundaryPosition(this.textRange, rangeContainerElement, false, false,\n                        startBoundary.nodeInfo).boundaryPosition;\n                }\n\n                this.setStart(start.node, start.offset);\n                this.setEnd(end.node, end.offset);\n            };\n\n            WrappedTextRange.prototype.getName = function() {\n                return \"WrappedTextRange\";\n            };\n\n            DomRange.copyComparisonConstants(WrappedTextRange);\n\n            var rangeToTextRange = function(range) {\n                if (range.collapsed) {\n                    return createBoundaryTextRange(new DomPosition(range.startContainer, range.startOffset), true);\n                } else {\n                    var startRange = createBoundaryTextRange(new DomPosition(range.startContainer, range.startOffset), true);\n                    var endRange = createBoundaryTextRange(new DomPosition(range.endContainer, range.endOffset), false);\n                    var textRange = getBody( DomRange.getRangeDocument(range) ).createTextRange();\n                    textRange.setEndPoint(\"StartToStart\", startRange);\n                    textRange.setEndPoint(\"EndToEnd\", endRange);\n                    return textRange;\n                }\n            };\n\n            WrappedTextRange.rangeToTextRange = rangeToTextRange;\n\n            WrappedTextRange.prototype.toTextRange = function() {\n                return rangeToTextRange(this);\n            };\n\n            api.WrappedTextRange = WrappedTextRange;\n\n            // IE 9 and above have both implementations and Rangy makes both available. The next few lines sets which\n            // implementation to use by default.\n            if (!api.features.implementsDomRange || api.config.preferTextRange) {\n                // Add WrappedTextRange as the Range property of the global object to allow expression like Range.END_TO_END to work\n                var globalObj = (function(f) { return f(\"return this;\")(); })(Function);\n                if (typeof globalObj.Range == \"undefined\") {\n                    globalObj.Range = WrappedTextRange;\n                }\n\n                api.createNativeRange = function(doc) {\n                    doc = getContentDocument(doc, module, \"createNativeRange\");\n                    return getBody(doc).createTextRange();\n                };\n\n                api.WrappedRange = WrappedTextRange;\n            }\n        }\n\n        api.createRange = function(doc) {\n            doc = getContentDocument(doc, module, \"createRange\");\n            return new api.WrappedRange(api.createNativeRange(doc));\n        };\n\n        api.createRangyRange = function(doc) {\n            doc = getContentDocument(doc, module, \"createRangyRange\");\n            return new DomRange(doc);\n        };\n\n        util.createAliasForDeprecatedMethod(api, \"createIframeRange\", \"createRange\");\n        util.createAliasForDeprecatedMethod(api, \"createIframeRangyRange\", \"createRangyRange\");\n\n        api.addShimListener(function(win) {\n            var doc = win.document;\n            if (typeof doc.createRange == \"undefined\") {\n                doc.createRange = function() {\n                    return api.createRange(doc);\n                };\n            }\n            doc = win = null;\n        });\n    });\r\n\r\n    /*----------------------------------------------------------------------------------------------------------------*/\r\n\r\n    // This module creates a selection object wrapper that conforms as closely as possible to the Selection specification\n    // in the HTML Editing spec (http://dvcs.w3.org/hg/editing/raw-file/tip/editing.html#selections)\n    api.createCoreModule(\"WrappedSelection\", [\"DomRange\", \"WrappedRange\"], function(api, module) {\n        api.config.checkSelectionRanges = true;\n\n        var BOOLEAN = \"boolean\";\n        var NUMBER = \"number\";\n        var dom = api.dom;\n        var util = api.util;\n        var isHostMethod = util.isHostMethod;\n        var DomRange = api.DomRange;\n        var WrappedRange = api.WrappedRange;\n        var DOMException = api.DOMException;\n        var DomPosition = dom.DomPosition;\n        var getNativeSelection;\n        var selectionIsCollapsed;\n        var features = api.features;\n        var CONTROL = \"Control\";\n        var getDocument = dom.getDocument;\n        var getBody = dom.getBody;\n        var rangesEqual = DomRange.rangesEqual;\n\n\n        // Utility function to support direction parameters in the API that may be a string (\"backward\", \"backwards\",\n        // \"forward\" or \"forwards\") or a Boolean (true for backwards).\n        function isDirectionBackward(dir) {\n            return (typeof dir == \"string\") ? /^backward(s)?$/i.test(dir) : !!dir;\n        }\n\n        function getWindow(win, methodName) {\n            if (!win) {\n                return window;\n            } else if (dom.isWindow(win)) {\n                return win;\n            } else if (win instanceof WrappedSelection) {\n                return win.win;\n            } else {\n                var doc = dom.getContentDocument(win, module, methodName);\n                return dom.getWindow(doc);\n            }\n        }\n\n        function getWinSelection(winParam) {\n            return getWindow(winParam, \"getWinSelection\").getSelection();\n        }\n\n        function getDocSelection(winParam) {\n            return getWindow(winParam, \"getDocSelection\").document.selection;\n        }\n\n        function winSelectionIsBackward(sel) {\n            var backward = false;\n            if (sel.anchorNode) {\n                backward = (dom.comparePoints(sel.anchorNode, sel.anchorOffset, sel.focusNode, sel.focusOffset) == 1);\n            }\n            return backward;\n        }\n\n        // Test for the Range/TextRange and Selection features required\n        // Test for ability to retrieve selection\n        var implementsWinGetSelection = isHostMethod(window, \"getSelection\"),\n            implementsDocSelection = util.isHostObject(document, \"selection\");\n\n        features.implementsWinGetSelection = implementsWinGetSelection;\n        features.implementsDocSelection = implementsDocSelection;\n\n        var useDocumentSelection = implementsDocSelection && (!implementsWinGetSelection || api.config.preferTextRange);\n\n        if (useDocumentSelection) {\n            getNativeSelection = getDocSelection;\n            api.isSelectionValid = function(winParam) {\n                var doc = getWindow(winParam, \"isSelectionValid\").document, nativeSel = doc.selection;\n\n                // Check whether the selection TextRange is actually contained within the correct document\n                return (nativeSel.type != \"None\" || getDocument(nativeSel.createRange().parentElement()) == doc);\n            };\n        } else if (implementsWinGetSelection) {\n            getNativeSelection = getWinSelection;\n            api.isSelectionValid = function() {\n                return true;\n            };\n        } else {\n            module.fail(\"Neither document.selection or window.getSelection() detected.\");\n            return false;\n        }\n\n        api.getNativeSelection = getNativeSelection;\n\n        var testSelection = getNativeSelection();\n\n        // In Firefox, the selection is null in an iframe with display: none. See issue #138.\n        if (!testSelection) {\n            module.fail(\"Native selection was null (possibly issue 138?)\");\n            return false;\n        }\n\n        var testRange = api.createNativeRange(document);\n        var body = getBody(document);\n\n        // Obtaining a range from a selection\n        var selectionHasAnchorAndFocus = util.areHostProperties(testSelection,\n            [\"anchorNode\", \"focusNode\", \"anchorOffset\", \"focusOffset\"]);\n\n        features.selectionHasAnchorAndFocus = selectionHasAnchorAndFocus;\n\n        // Test for existence of native selection extend() method\n        var selectionHasExtend = isHostMethod(testSelection, \"extend\");\n        features.selectionHasExtend = selectionHasExtend;\n\n        // Test if rangeCount exists\n        var selectionHasRangeCount = (typeof testSelection.rangeCount == NUMBER);\n        features.selectionHasRangeCount = selectionHasRangeCount;\n\n        var selectionSupportsMultipleRanges = false;\n        var collapsedNonEditableSelectionsSupported = true;\n\n        var addRangeBackwardToNative = selectionHasExtend ?\n            function(nativeSelection, range) {\n                var doc = DomRange.getRangeDocument(range);\n                var endRange = api.createRange(doc);\n                endRange.collapseToPoint(range.endContainer, range.endOffset);\n                nativeSelection.addRange(getNativeRange(endRange));\n                nativeSelection.extend(range.startContainer, range.startOffset);\n            } : null;\n\n        if (util.areHostMethods(testSelection, [\"addRange\", \"getRangeAt\", \"removeAllRanges\"]) &&\n                typeof testSelection.rangeCount == NUMBER && features.implementsDomRange) {\n\n            (function() {\n                // Previously an iframe was used but this caused problems in some circumstances in IE, so tests are\n                // performed on the current document's selection. See issue 109.\n\n                // Note also that if a selection previously existed, it is wiped and later restored by these tests. This\n                // will result in the selection direction begin reversed if the original selection was backwards and the\n                // browser does not support setting backwards selections (Internet Explorer, I'm looking at you).\n                var sel = window.getSelection();\n                if (sel) {\n                    // Store the current selection\n                    var originalSelectionRangeCount = sel.rangeCount;\n                    var selectionHasMultipleRanges = (originalSelectionRangeCount > 1);\n                    var originalSelectionRanges = [];\n                    var originalSelectionBackward = winSelectionIsBackward(sel);\n                    for (var i = 0; i < originalSelectionRangeCount; ++i) {\n                        originalSelectionRanges[i] = sel.getRangeAt(i);\n                    }\n\n                    // Create some test elements\n                    var testEl = dom.createTestElement(document, \"\", false);\n                    var textNode = testEl.appendChild( document.createTextNode(\"\\u00a0\\u00a0\\u00a0\") );\n\n                    // Test whether the native selection will allow a collapsed selection within a non-editable element\n                    var r1 = document.createRange();\n\n                    r1.setStart(textNode, 1);\n                    r1.collapse(true);\n                    sel.removeAllRanges();\n                    sel.addRange(r1);\n                    collapsedNonEditableSelectionsSupported = (sel.rangeCount == 1);\n                    sel.removeAllRanges();\n\n                    // Test whether the native selection is capable of supporting multiple ranges.\n                    if (!selectionHasMultipleRanges) {\n                        // Doing the original feature test here in Chrome 36 (and presumably later versions) prints a\n                        // console error of \"Discontiguous selection is not supported.\" that cannot be suppressed. There's\n                        // nothing we can do about this while retaining the feature test so we have to resort to a browser\n                        // sniff. I'm not happy about it. See\n                        // https://code.google.com/p/chromium/issues/detail?id=399791\n                        var chromeMatch = window.navigator.appVersion.match(/Chrome\\/(.*?) /);\n                        if (chromeMatch && parseInt(chromeMatch[1]) >= 36) {\n                            selectionSupportsMultipleRanges = false;\n                        } else {\n                            var r2 = r1.cloneRange();\n                            r1.setStart(textNode, 0);\n                            r2.setEnd(textNode, 3);\n                            r2.setStart(textNode, 2);\n                            sel.addRange(r1);\n                            sel.addRange(r2);\n                            selectionSupportsMultipleRanges = (sel.rangeCount == 2);\n                        }\n                    }\n\n                    // Clean up\n                    dom.removeNode(testEl);\n                    sel.removeAllRanges();\n\n                    for (i = 0; i < originalSelectionRangeCount; ++i) {\n                        if (i == 0 && originalSelectionBackward) {\n                            if (addRangeBackwardToNative) {\n                                addRangeBackwardToNative(sel, originalSelectionRanges[i]);\n                            } else {\n                                api.warn(\"Rangy initialization: original selection was backwards but selection has been restored forwards because the browser does not support Selection.extend\");\n                                sel.addRange(originalSelectionRanges[i]);\n                            }\n                        } else {\n                            sel.addRange(originalSelectionRanges[i]);\n                        }\n                    }\n                }\n            })();\n        }\n\n        features.selectionSupportsMultipleRanges = selectionSupportsMultipleRanges;\n        features.collapsedNonEditableSelectionsSupported = collapsedNonEditableSelectionsSupported;\n\n        // ControlRanges\n        var implementsControlRange = false, testControlRange;\n\n        if (body && isHostMethod(body, \"createControlRange\")) {\n            testControlRange = body.createControlRange();\n            if (util.areHostProperties(testControlRange, [\"item\", \"add\"])) {\n                implementsControlRange = true;\n            }\n        }\n        features.implementsControlRange = implementsControlRange;\n\n        // Selection collapsedness\n        if (selectionHasAnchorAndFocus) {\n            selectionIsCollapsed = function(sel) {\n                return sel.anchorNode === sel.focusNode && sel.anchorOffset === sel.focusOffset;\n            };\n        } else {\n            selectionIsCollapsed = function(sel) {\n                return sel.rangeCount ? sel.getRangeAt(sel.rangeCount - 1).collapsed : false;\n            };\n        }\n\n        function updateAnchorAndFocusFromRange(sel, range, backward) {\n            var anchorPrefix = backward ? \"end\" : \"start\", focusPrefix = backward ? \"start\" : \"end\";\n            sel.anchorNode = range[anchorPrefix + \"Container\"];\n            sel.anchorOffset = range[anchorPrefix + \"Offset\"];\n            sel.focusNode = range[focusPrefix + \"Container\"];\n            sel.focusOffset = range[focusPrefix + \"Offset\"];\n        }\n\n        function updateAnchorAndFocusFromNativeSelection(sel) {\n            var nativeSel = sel.nativeSelection;\n            sel.anchorNode = nativeSel.anchorNode;\n            sel.anchorOffset = nativeSel.anchorOffset;\n            sel.focusNode = nativeSel.focusNode;\n            sel.focusOffset = nativeSel.focusOffset;\n        }\n\n        function updateEmptySelection(sel) {\n            sel.anchorNode = sel.focusNode = null;\n            sel.anchorOffset = sel.focusOffset = 0;\n            sel.rangeCount = 0;\n            sel.isCollapsed = true;\n            sel._ranges.length = 0;\n        }\n\n        function getNativeRange(range) {\n            var nativeRange;\n            if (range instanceof DomRange) {\n                nativeRange = api.createNativeRange(range.getDocument());\n                nativeRange.setEnd(range.endContainer, range.endOffset);\n                nativeRange.setStart(range.startContainer, range.startOffset);\n            } else if (range instanceof WrappedRange) {\n                nativeRange = range.nativeRange;\n            } else if (features.implementsDomRange && (range instanceof dom.getWindow(range.startContainer).Range)) {\n                nativeRange = range;\n            }\n            return nativeRange;\n        }\n\n        function rangeContainsSingleElement(rangeNodes) {\n            if (!rangeNodes.length || rangeNodes[0].nodeType != 1) {\n                return false;\n            }\n            for (var i = 1, len = rangeNodes.length; i < len; ++i) {\n                if (!dom.isAncestorOf(rangeNodes[0], rangeNodes[i])) {\n                    return false;\n                }\n            }\n            return true;\n        }\n\n        function getSingleElementFromRange(range) {\n            var nodes = range.getNodes();\n            if (!rangeContainsSingleElement(nodes)) {\n                throw module.createError(\"getSingleElementFromRange: range \" + range.inspect() + \" did not consist of a single element\");\n            }\n            return nodes[0];\n        }\n\n        // Simple, quick test which only needs to distinguish between a TextRange and a ControlRange\n        function isTextRange(range) {\n            return !!range && typeof range.text != \"undefined\";\n        }\n\n        function updateFromTextRange(sel, range) {\n            // Create a Range from the selected TextRange\n            var wrappedRange = new WrappedRange(range);\n            sel._ranges = [wrappedRange];\n\n            updateAnchorAndFocusFromRange(sel, wrappedRange, false);\n            sel.rangeCount = 1;\n            sel.isCollapsed = wrappedRange.collapsed;\n        }\n\n        function updateControlSelection(sel) {\n            // Update the wrapped selection based on what's now in the native selection\n            sel._ranges.length = 0;\n            if (sel.docSelection.type == \"None\") {\n                updateEmptySelection(sel);\n            } else {\n                var controlRange = sel.docSelection.createRange();\n                if (isTextRange(controlRange)) {\n                    // This case (where the selection type is \"Control\" and calling createRange() on the selection returns\n                    // a TextRange) can happen in IE 9. It happens, for example, when all elements in the selected\n                    // ControlRange have been removed from the ControlRange and removed from the document.\n                    updateFromTextRange(sel, controlRange);\n                } else {\n                    sel.rangeCount = controlRange.length;\n                    var range, doc = getDocument(controlRange.item(0));\n                    for (var i = 0; i < sel.rangeCount; ++i) {\n                        range = api.createRange(doc);\n                        range.selectNode(controlRange.item(i));\n                        sel._ranges.push(range);\n                    }\n                    sel.isCollapsed = sel.rangeCount == 1 && sel._ranges[0].collapsed;\n                    updateAnchorAndFocusFromRange(sel, sel._ranges[sel.rangeCount - 1], false);\n                }\n            }\n        }\n\n        function addRangeToControlSelection(sel, range) {\n            var controlRange = sel.docSelection.createRange();\n            var rangeElement = getSingleElementFromRange(range);\n\n            // Create a new ControlRange containing all the elements in the selected ControlRange plus the element\n            // contained by the supplied range\n            var doc = getDocument(controlRange.item(0));\n            var newControlRange = getBody(doc).createControlRange();\n            for (var i = 0, len = controlRange.length; i < len; ++i) {\n                newControlRange.add(controlRange.item(i));\n            }\n            try {\n                newControlRange.add(rangeElement);\n            } catch (ex) {\n                throw module.createError(\"addRange(): Element within the specified Range could not be added to control selection (does it have layout?)\");\n            }\n            newControlRange.select();\n\n            // Update the wrapped selection based on what's now in the native selection\n            updateControlSelection(sel);\n        }\n\n        var getSelectionRangeAt;\n\n        if (isHostMethod(testSelection, \"getRangeAt\")) {\n            // try/catch is present because getRangeAt() must have thrown an error in some browser and some situation.\n            // Unfortunately, I didn't write a comment about the specifics and am now scared to take it out. Let that be a\n            // lesson to us all, especially me.\n            getSelectionRangeAt = function(sel, index) {\n                try {\n                    return sel.getRangeAt(index);\n                } catch (ex) {\n                    return null;\n                }\n            };\n        } else if (selectionHasAnchorAndFocus) {\n            getSelectionRangeAt = function(sel) {\n                var doc = getDocument(sel.anchorNode);\n                var range = api.createRange(doc);\n                range.setStartAndEnd(sel.anchorNode, sel.anchorOffset, sel.focusNode, sel.focusOffset);\n\n                // Handle the case when the selection was selected backwards (from the end to the start in the\n                // document)\n                if (range.collapsed !== this.isCollapsed) {\n                    range.setStartAndEnd(sel.focusNode, sel.focusOffset, sel.anchorNode, sel.anchorOffset);\n                }\n\n                return range;\n            };\n        }\n\n        function WrappedSelection(selection, docSelection, win) {\n            this.nativeSelection = selection;\n            this.docSelection = docSelection;\n            this._ranges = [];\n            this.win = win;\n            this.refresh();\n        }\n\n        WrappedSelection.prototype = api.selectionPrototype;\n\n        function deleteProperties(sel) {\n            sel.win = sel.anchorNode = sel.focusNode = sel._ranges = null;\n            sel.rangeCount = sel.anchorOffset = sel.focusOffset = 0;\n            sel.detached = true;\n        }\n\n        var cachedRangySelections = [];\n\n        function actOnCachedSelection(win, action) {\n            var i = cachedRangySelections.length, cached, sel;\n            while (i--) {\n                cached = cachedRangySelections[i];\n                sel = cached.selection;\n                if (action == \"deleteAll\") {\n                    deleteProperties(sel);\n                } else if (cached.win == win) {\n                    if (action == \"delete\") {\n                        cachedRangySelections.splice(i, 1);\n                        return true;\n                    } else {\n                        return sel;\n                    }\n                }\n            }\n            if (action == \"deleteAll\") {\n                cachedRangySelections.length = 0;\n            }\n            return null;\n        }\n\n        var getSelection = function(win) {\n            // Check if the parameter is a Rangy Selection object\n            if (win && win instanceof WrappedSelection) {\n                win.refresh();\n                return win;\n            }\n\n            win = getWindow(win, \"getNativeSelection\");\n\n            var sel = actOnCachedSelection(win);\n            var nativeSel = getNativeSelection(win), docSel = implementsDocSelection ? getDocSelection(win) : null;\n            if (sel) {\n                sel.nativeSelection = nativeSel;\n                sel.docSelection = docSel;\n                sel.refresh();\n            } else {\n                sel = new WrappedSelection(nativeSel, docSel, win);\n                cachedRangySelections.push( { win: win, selection: sel } );\n            }\n            return sel;\n        };\n\n        api.getSelection = getSelection;\n\n        util.createAliasForDeprecatedMethod(api, \"getIframeSelection\", \"getSelection\");\n\n        var selProto = WrappedSelection.prototype;\n\n        function createControlSelection(sel, ranges) {\n            // Ensure that the selection becomes of type \"Control\"\n            var doc = getDocument(ranges[0].startContainer);\n            var controlRange = getBody(doc).createControlRange();\n            for (var i = 0, el, len = ranges.length; i < len; ++i) {\n                el = getSingleElementFromRange(ranges[i]);\n                try {\n                    controlRange.add(el);\n                } catch (ex) {\n                    throw module.createError(\"setRanges(): Element within one of the specified Ranges could not be added to control selection (does it have layout?)\");\n                }\n            }\n            controlRange.select();\n\n            // Update the wrapped selection based on what's now in the native selection\n            updateControlSelection(sel);\n        }\n\n        // Selecting a range\n        if (!useDocumentSelection && selectionHasAnchorAndFocus && util.areHostMethods(testSelection, [\"removeAllRanges\", \"addRange\"])) {\n            selProto.removeAllRanges = function() {\n                this.nativeSelection.removeAllRanges();\n                updateEmptySelection(this);\n            };\n\n            var addRangeBackward = function(sel, range) {\n                addRangeBackwardToNative(sel.nativeSelection, range);\n                sel.refresh();\n            };\n\n            if (selectionHasRangeCount) {\n                selProto.addRange = function(range, direction) {\n                    if (implementsControlRange && implementsDocSelection && this.docSelection.type == CONTROL) {\n                        addRangeToControlSelection(this, range);\n                    } else {\n                        if (isDirectionBackward(direction) && selectionHasExtend) {\n                            addRangeBackward(this, range);\n                        } else {\n                            var previousRangeCount;\n                            if (selectionSupportsMultipleRanges) {\n                                previousRangeCount = this.rangeCount;\n                            } else {\n                                this.removeAllRanges();\n                                previousRangeCount = 0;\n                            }\n                            // Clone the native range so that changing the selected range does not affect the selection.\n                            // This is contrary to the spec but is the only way to achieve consistency between browsers. See\n                            // issue 80.\n                            var clonedNativeRange = getNativeRange(range).cloneRange();\n                            try {\n                                this.nativeSelection.addRange(clonedNativeRange);\n                            } catch (ex) {\n                            }\n\n                            // Check whether adding the range was successful\n                            this.rangeCount = this.nativeSelection.rangeCount;\n\n                            if (this.rangeCount == previousRangeCount + 1) {\n                                // The range was added successfully\n\n                                // Check whether the range that we added to the selection is reflected in the last range extracted from\n                                // the selection\n                                if (api.config.checkSelectionRanges) {\n                                    var nativeRange = getSelectionRangeAt(this.nativeSelection, this.rangeCount - 1);\n                                    if (nativeRange && !rangesEqual(nativeRange, range)) {\n                                        // Happens in WebKit with, for example, a selection placed at the start of a text node\n                                        range = new WrappedRange(nativeRange);\n                                    }\n                                }\n                                this._ranges[this.rangeCount - 1] = range;\n                                updateAnchorAndFocusFromRange(this, range, selectionIsBackward(this.nativeSelection));\n                                this.isCollapsed = selectionIsCollapsed(this);\n                            } else {\n                                // The range was not added successfully. The simplest thing is to refresh\n                                this.refresh();\n                            }\n                        }\n                    }\n                };\n            } else {\n                selProto.addRange = function(range, direction) {\n                    if (isDirectionBackward(direction) && selectionHasExtend) {\n                        addRangeBackward(this, range);\n                    } else {\n                        this.nativeSelection.addRange(getNativeRange(range));\n                        this.refresh();\n                    }\n                };\n            }\n\n            selProto.setRanges = function(ranges) {\n                if (implementsControlRange && implementsDocSelection && ranges.length > 1) {\n                    createControlSelection(this, ranges);\n                } else {\n                    this.removeAllRanges();\n                    for (var i = 0, len = ranges.length; i < len; ++i) {\n                        this.addRange(ranges[i]);\n                    }\n                }\n            };\n        } else if (isHostMethod(testSelection, \"empty\") && isHostMethod(testRange, \"select\") &&\n                   implementsControlRange && useDocumentSelection) {\n\n            selProto.removeAllRanges = function() {\n                // Added try/catch as fix for issue #21\n                try {\n                    this.docSelection.empty();\n\n                    // Check for empty() not working (issue #24)\n                    if (this.docSelection.type != \"None\") {\n                        // Work around failure to empty a control selection by instead selecting a TextRange and then\n                        // calling empty()\n                        var doc;\n                        if (this.anchorNode) {\n                            doc = getDocument(this.anchorNode);\n                        } else if (this.docSelection.type == CONTROL) {\n                            var controlRange = this.docSelection.createRange();\n                            if (controlRange.length) {\n                                doc = getDocument( controlRange.item(0) );\n                            }\n                        }\n                        if (doc) {\n                            var textRange = getBody(doc).createTextRange();\n                            textRange.select();\n                            this.docSelection.empty();\n                        }\n                    }\n                } catch(ex) {}\n                updateEmptySelection(this);\n            };\n\n            selProto.addRange = function(range) {\n                if (this.docSelection.type == CONTROL) {\n                    addRangeToControlSelection(this, range);\n                } else {\n                    api.WrappedTextRange.rangeToTextRange(range).select();\n                    this._ranges[0] = range;\n                    this.rangeCount = 1;\n                    this.isCollapsed = this._ranges[0].collapsed;\n                    updateAnchorAndFocusFromRange(this, range, false);\n                }\n            };\n\n            selProto.setRanges = function(ranges) {\n                this.removeAllRanges();\n                var rangeCount = ranges.length;\n                if (rangeCount > 1) {\n                    createControlSelection(this, ranges);\n                } else if (rangeCount) {\n                    this.addRange(ranges[0]);\n                }\n            };\n        } else {\n            module.fail(\"No means of selecting a Range or TextRange was found\");\n            return false;\n        }\n\n        selProto.getRangeAt = function(index) {\n            if (index < 0 || index >= this.rangeCount) {\n                throw new DOMException(\"INDEX_SIZE_ERR\");\n            } else {\n                // Clone the range to preserve selection-range independence. See issue 80.\n                return this._ranges[index].cloneRange();\n            }\n        };\n\n        var refreshSelection;\n\n        if (useDocumentSelection) {\n            refreshSelection = function(sel) {\n                var range;\n                if (api.isSelectionValid(sel.win)) {\n                    range = sel.docSelection.createRange();\n                } else {\n                    range = getBody(sel.win.document).createTextRange();\n                    range.collapse(true);\n                }\n\n                if (sel.docSelection.type == CONTROL) {\n                    updateControlSelection(sel);\n                } else if (isTextRange(range)) {\n                    updateFromTextRange(sel, range);\n                } else {\n                    updateEmptySelection(sel);\n                }\n            };\n        } else if (isHostMethod(testSelection, \"getRangeAt\") && typeof testSelection.rangeCount == NUMBER) {\n            refreshSelection = function(sel) {\n                if (implementsControlRange && implementsDocSelection && sel.docSelection.type == CONTROL) {\n                    updateControlSelection(sel);\n                } else {\n                    sel._ranges.length = sel.rangeCount = sel.nativeSelection.rangeCount;\n                    if (sel.rangeCount) {\n                        for (var i = 0, len = sel.rangeCount; i < len; ++i) {\n                            sel._ranges[i] = new api.WrappedRange(sel.nativeSelection.getRangeAt(i));\n                        }\n                        updateAnchorAndFocusFromRange(sel, sel._ranges[sel.rangeCount - 1], selectionIsBackward(sel.nativeSelection));\n                        sel.isCollapsed = selectionIsCollapsed(sel);\n                    } else {\n                        updateEmptySelection(sel);\n                    }\n                }\n            };\n        } else if (selectionHasAnchorAndFocus && typeof testSelection.isCollapsed == BOOLEAN && typeof testRange.collapsed == BOOLEAN && features.implementsDomRange) {\n            refreshSelection = function(sel) {\n                var range, nativeSel = sel.nativeSelection;\n                if (nativeSel.anchorNode) {\n                    range = getSelectionRangeAt(nativeSel, 0);\n                    sel._ranges = [range];\n                    sel.rangeCount = 1;\n                    updateAnchorAndFocusFromNativeSelection(sel);\n                    sel.isCollapsed = selectionIsCollapsed(sel);\n                } else {\n                    updateEmptySelection(sel);\n                }\n            };\n        } else {\n            module.fail(\"No means of obtaining a Range or TextRange from the user's selection was found\");\n            return false;\n        }\n\n        selProto.refresh = function(checkForChanges) {\n            var oldRanges = checkForChanges ? this._ranges.slice(0) : null;\n            var oldAnchorNode = this.anchorNode, oldAnchorOffset = this.anchorOffset;\n\n            refreshSelection(this);\n            if (checkForChanges) {\n                // Check the range count first\n                var i = oldRanges.length;\n                if (i != this._ranges.length) {\n                    return true;\n                }\n\n                // Now check the direction. Checking the anchor position is the same is enough since we're checking all the\n                // ranges after this\n                if (this.anchorNode != oldAnchorNode || this.anchorOffset != oldAnchorOffset) {\n                    return true;\n                }\n\n                // Finally, compare each range in turn\n                while (i--) {\n                    if (!rangesEqual(oldRanges[i], this._ranges[i])) {\n                        return true;\n                    }\n                }\n                return false;\n            }\n        };\n\n        // Removal of a single range\n        var removeRangeManually = function(sel, range) {\n            var ranges = sel.getAllRanges();\n            sel.removeAllRanges();\n            for (var i = 0, len = ranges.length; i < len; ++i) {\n                if (!rangesEqual(range, ranges[i])) {\n                    sel.addRange(ranges[i]);\n                }\n            }\n            if (!sel.rangeCount) {\n                updateEmptySelection(sel);\n            }\n        };\n\n        if (implementsControlRange && implementsDocSelection) {\n            selProto.removeRange = function(range) {\n                if (this.docSelection.type == CONTROL) {\n                    var controlRange = this.docSelection.createRange();\n                    var rangeElement = getSingleElementFromRange(range);\n\n                    // Create a new ControlRange containing all the elements in the selected ControlRange minus the\n                    // element contained by the supplied range\n                    var doc = getDocument(controlRange.item(0));\n                    var newControlRange = getBody(doc).createControlRange();\n                    var el, removed = false;\n                    for (var i = 0, len = controlRange.length; i < len; ++i) {\n                        el = controlRange.item(i);\n                        if (el !== rangeElement || removed) {\n                            newControlRange.add(controlRange.item(i));\n                        } else {\n                            removed = true;\n                        }\n                    }\n                    newControlRange.select();\n\n                    // Update the wrapped selection based on what's now in the native selection\n                    updateControlSelection(this);\n                } else {\n                    removeRangeManually(this, range);\n                }\n            };\n        } else {\n            selProto.removeRange = function(range) {\n                removeRangeManually(this, range);\n            };\n        }\n\n        // Detecting if a selection is backward\n        var selectionIsBackward;\n        if (!useDocumentSelection && selectionHasAnchorAndFocus && features.implementsDomRange) {\n            selectionIsBackward = winSelectionIsBackward;\n\n            selProto.isBackward = function() {\n                return selectionIsBackward(this);\n            };\n        } else {\n            selectionIsBackward = selProto.isBackward = function() {\n                return false;\n            };\n        }\n\n        // Create an alias for backwards compatibility. From 1.3, everything is \"backward\" rather than \"backwards\"\n        selProto.isBackwards = selProto.isBackward;\n\n        // Selection stringifier\n        // This is conformant to the old HTML5 selections draft spec but differs from WebKit and Mozilla's implementation.\n        // The current spec does not yet define this method.\n        selProto.toString = function() {\n            var rangeTexts = [];\n            for (var i = 0, len = this.rangeCount; i < len; ++i) {\n                rangeTexts[i] = \"\" + this._ranges[i];\n            }\n            return rangeTexts.join(\"\");\n        };\n\n        function assertNodeInSameDocument(sel, node) {\n            if (sel.win.document != getDocument(node)) {\n                throw new DOMException(\"WRONG_DOCUMENT_ERR\");\n            }\n        }\n\n        // No current browser conforms fully to the spec for this method, so Rangy's own method is always used\n        selProto.collapse = function(node, offset) {\n            assertNodeInSameDocument(this, node);\n            var range = api.createRange(node);\n            range.collapseToPoint(node, offset);\n            this.setSingleRange(range);\n            this.isCollapsed = true;\n        };\n\n        selProto.collapseToStart = function() {\n            if (this.rangeCount) {\n                var range = this._ranges[0];\n                this.collapse(range.startContainer, range.startOffset);\n            } else {\n                throw new DOMException(\"INVALID_STATE_ERR\");\n            }\n        };\n\n        selProto.collapseToEnd = function() {\n            if (this.rangeCount) {\n                var range = this._ranges[this.rangeCount - 1];\n                this.collapse(range.endContainer, range.endOffset);\n            } else {\n                throw new DOMException(\"INVALID_STATE_ERR\");\n            }\n        };\n\n        // The spec is very specific on how selectAllChildren should be implemented and not all browsers implement it as\n        // specified so the native implementation is never used by Rangy.\n        selProto.selectAllChildren = function(node) {\n            assertNodeInSameDocument(this, node);\n            var range = api.createRange(node);\n            range.selectNodeContents(node);\n            this.setSingleRange(range);\n        };\n\n        selProto.deleteFromDocument = function() {\n            // Sepcial behaviour required for IE's control selections\n            if (implementsControlRange && implementsDocSelection && this.docSelection.type == CONTROL) {\n                var controlRange = this.docSelection.createRange();\n                var element;\n                while (controlRange.length) {\n                    element = controlRange.item(0);\n                    controlRange.remove(element);\n                    dom.removeNode(element);\n                }\n                this.refresh();\n            } else if (this.rangeCount) {\n                var ranges = this.getAllRanges();\n                if (ranges.length) {\n                    this.removeAllRanges();\n                    for (var i = 0, len = ranges.length; i < len; ++i) {\n                        ranges[i].deleteContents();\n                    }\n                    // The spec says nothing about what the selection should contain after calling deleteContents on each\n                    // range. Firefox moves the selection to where the final selected range was, so we emulate that\n                    this.addRange(ranges[len - 1]);\n                }\n            }\n        };\n\n        // The following are non-standard extensions\n        selProto.eachRange = function(func, returnValue) {\n            for (var i = 0, len = this._ranges.length; i < len; ++i) {\n                if ( func( this.getRangeAt(i) ) ) {\n                    return returnValue;\n                }\n            }\n        };\n\n        selProto.getAllRanges = function() {\n            var ranges = [];\n            this.eachRange(function(range) {\n                ranges.push(range);\n            });\n            return ranges;\n        };\n\n        selProto.setSingleRange = function(range, direction) {\n            this.removeAllRanges();\n            this.addRange(range, direction);\n        };\n\n        selProto.callMethodOnEachRange = function(methodName, params) {\n            var results = [];\n            this.eachRange( function(range) {\n                results.push( range[methodName].apply(range, params || []) );\n            } );\n            return results;\n        };\n\n        function createStartOrEndSetter(isStart) {\n            return function(node, offset) {\n                var range;\n                if (this.rangeCount) {\n                    range = this.getRangeAt(0);\n                    range[\"set\" + (isStart ? \"Start\" : \"End\")](node, offset);\n                } else {\n                    range = api.createRange(this.win.document);\n                    range.setStartAndEnd(node, offset);\n                }\n                this.setSingleRange(range, this.isBackward());\n            };\n        }\n\n        selProto.setStart = createStartOrEndSetter(true);\n        selProto.setEnd = createStartOrEndSetter(false);\n\n        // Add select() method to Range prototype. Any existing selection will be removed.\n        api.rangePrototype.select = function(direction) {\n            getSelection( this.getDocument() ).setSingleRange(this, direction);\n        };\n\n        selProto.changeEachRange = function(func) {\n            var ranges = [];\n            var backward = this.isBackward();\n\n            this.eachRange(function(range) {\n                func(range);\n                ranges.push(range);\n            });\n\n            this.removeAllRanges();\n            if (backward && ranges.length == 1) {\n                this.addRange(ranges[0], \"backward\");\n            } else {\n                this.setRanges(ranges);\n            }\n        };\n\n        selProto.containsNode = function(node, allowPartial) {\n            return this.eachRange( function(range) {\n                return range.containsNode(node, allowPartial);\n            }, true ) || false;\n        };\n\n        selProto.getBookmark = function(containerNode) {\n            return {\n                backward: this.isBackward(),\n                rangeBookmarks: this.callMethodOnEachRange(\"getBookmark\", [containerNode])\n            };\n        };\n\n        selProto.moveToBookmark = function(bookmark) {\n            var selRanges = [];\n            for (var i = 0, rangeBookmark, range; rangeBookmark = bookmark.rangeBookmarks[i++]; ) {\n                range = api.createRange(this.win);\n                range.moveToBookmark(rangeBookmark);\n                selRanges.push(range);\n            }\n            if (bookmark.backward) {\n                this.setSingleRange(selRanges[0], \"backward\");\n            } else {\n                this.setRanges(selRanges);\n            }\n        };\n\n        selProto.saveRanges = function() {\n            return {\n                backward: this.isBackward(),\n                ranges: this.callMethodOnEachRange(\"cloneRange\")\n            };\n        };\n\n        selProto.restoreRanges = function(selRanges) {\n            this.removeAllRanges();\n            for (var i = 0, range; range = selRanges.ranges[i]; ++i) {\n                this.addRange(range, (selRanges.backward && i == 0));\n            }\n        };\n\n        selProto.toHtml = function() {\n            var rangeHtmls = [];\n            this.eachRange(function(range) {\n                rangeHtmls.push( DomRange.toHtml(range) );\n            });\n            return rangeHtmls.join(\"\");\n        };\n\n        if (features.implementsTextRange) {\n            selProto.getNativeTextRange = function() {\n                var sel, textRange;\n                if ( (sel = this.docSelection) ) {\n                    var range = sel.createRange();\n                    if (isTextRange(range)) {\n                        return range;\n                    } else {\n                        throw module.createError(\"getNativeTextRange: selection is a control selection\");\n                    }\n                } else if (this.rangeCount > 0) {\n                    return api.WrappedTextRange.rangeToTextRange( this.getRangeAt(0) );\n                } else {\n                    throw module.createError(\"getNativeTextRange: selection contains no range\");\n                }\n            };\n        }\n\n        function inspect(sel) {\n            var rangeInspects = [];\n            var anchor = new DomPosition(sel.anchorNode, sel.anchorOffset);\n            var focus = new DomPosition(sel.focusNode, sel.focusOffset);\n            var name = (typeof sel.getName == \"function\") ? sel.getName() : \"Selection\";\n\n            if (typeof sel.rangeCount != \"undefined\") {\n                for (var i = 0, len = sel.rangeCount; i < len; ++i) {\n                    rangeInspects[i] = DomRange.inspect(sel.getRangeAt(i));\n                }\n            }\n            return \"[\" + name + \"(Ranges: \" + rangeInspects.join(\", \") +\n                    \")(anchor: \" + anchor.inspect() + \", focus: \" + focus.inspect() + \"]\";\n        }\n\n        selProto.getName = function() {\n            return \"WrappedSelection\";\n        };\n\n        selProto.inspect = function() {\n            return inspect(this);\n        };\n\n        selProto.detach = function() {\n            actOnCachedSelection(this.win, \"delete\");\n            deleteProperties(this);\n        };\n\n        WrappedSelection.detachAll = function() {\n            actOnCachedSelection(null, \"deleteAll\");\n        };\n\n        WrappedSelection.inspect = inspect;\n        WrappedSelection.isDirectionBackward = isDirectionBackward;\n\n        api.Selection = WrappedSelection;\n\n        api.selectionPrototype = selProto;\n\n        api.addShimListener(function(win) {\n            if (typeof win.getSelection == \"undefined\") {\n                win.getSelection = function() {\n                    return getSelection(win);\n                };\n            }\n            win = null;\n        });\n    });\n    \r\n\r\n    /*----------------------------------------------------------------------------------------------------------------*/\r\n\r\n    // Wait for document to load before initializing\r\n    var docReady = false;\r\n\r\n    var loadHandler = function(e) {\r\n        if (!docReady) {\r\n            docReady = true;\r\n            if (!api.initialized && api.config.autoInitialize) {\r\n                init();\r\n            }\r\n        }\r\n    };\r\n\r\n    if (isBrowser) {\r\n        // Test whether the document has already been loaded and initialize immediately if so\r\n        if (document.readyState == \"complete\") {\r\n            loadHandler();\r\n        } else {\r\n            if (isHostMethod(document, \"addEventListener\")) {\r\n                document.addEventListener(\"DOMContentLoaded\", loadHandler, false);\r\n            }\r\n\r\n            // Add a fallback in case the DOMContentLoaded event isn't supported\r\n            addListener(window, \"load\", loadHandler);\r\n        }\r\n    }\r\n\r\n    return api;\r\n}, this);","/**\r\n * Text range module for Rangy.\r\n * Text-based manipulation and searching of ranges and selections.\r\n *\r\n * Features\r\n *\r\n * - Ability to move range boundaries by character or word offsets\r\n * - Customizable word tokenizer\r\n * - Ignores text nodes inside <script> or <style> elements or those hidden by CSS display and visibility properties\r\n * - Range findText method to search for text or regex within the page or within a range. Flags for whole words and case\r\n *   sensitivity\r\n * - Selection and range save/restore as text offsets within a node\r\n * - Methods to return visible text within a range or selection\r\n * - innerText method for elements\r\n *\r\n * References\r\n *\r\n * https://www.w3.org/Bugs/Public/show_bug.cgi?id=13145\r\n * http://aryeh.name/spec/innertext/innertext.html\r\n * http://dvcs.w3.org/hg/editing/raw-file/tip/editing.html\r\n *\r\n * Part of Rangy, a cross-browser JavaScript range and selection library\r\n * https://github.com/timdown/rangy\r\n *\r\n * Depends on Rangy core.\r\n *\r\n * Copyright 2015, Tim Down\r\n * Licensed under the MIT license.\r\n * Version: 1.3.0\r\n * Build date: 10 May 2015\r\n */\r\n\r\n/**\r\n * Problem: handling of trailing spaces before line breaks is handled inconsistently between browsers.\r\n *\r\n * First, a <br>: this is relatively simple. For the following HTML:\r\n *\r\n * 1 <br>2\r\n *\r\n * - IE and WebKit render the space, include it in the selection (i.e. when the content is selected and pasted into a\r\n *   textarea, the space is present) and allow the caret to be placed after it.\r\n * - Firefox does not acknowledge the space in the selection but it is possible to place the caret after it.\r\n * - Opera does not render the space but has two separate caret positions on either side of the space (left and right\r\n *   arrow keys show this) and includes the space in the selection.\r\n *\r\n * The other case is the line break or breaks implied by block elements. For the following HTML:\r\n *\r\n * <p>1 </p><p>2<p>\r\n *\r\n * - WebKit does not acknowledge the space in any way\r\n * - Firefox, IE and Opera as per <br>\r\n *\r\n * One more case is trailing spaces before line breaks in elements with white-space: pre-line. For the following HTML:\r\n *\r\n * <p style=\"white-space: pre-line\">1\r\n * 2</p>\r\n *\r\n * - Firefox and WebKit include the space in caret positions\r\n * - IE does not support pre-line up to and including version 9\r\n * - Opera ignores the space\r\n * - Trailing space only renders if there is a non-collapsed character in the line\r\n *\r\n * Problem is whether Rangy should ever acknowledge the space and if so, when. Another problem is whether this can be\r\n * feature-tested\r\n */\r\n(function(factory, root) {\n    if (typeof define == \"function\" && define.amd) {\n        // AMD. Register as an anonymous module with a dependency on Rangy.\n        define([\"./rangy-core\"], factory);\n    } else if (typeof module != \"undefined\" && typeof exports == \"object\") {\n        // Node/CommonJS style\n        module.exports = factory( require(\"rangy\") );\n    } else {\n        // No AMD or CommonJS support so we use the rangy property of root (probably the global variable)\n        factory(root.rangy);\n    }\n})(function(rangy) {\n    rangy.createModule(\"TextRange\", [\"WrappedSelection\"], function(api, module) {\n        var UNDEF = \"undefined\";\n        var CHARACTER = \"character\", WORD = \"word\";\n        var dom = api.dom, util = api.util;\n        var extend = util.extend;\n        var createOptions = util.createOptions;\n        var getBody = dom.getBody;\n\n\n        var spacesRegex = /^[ \\t\\f\\r\\n]+$/;\n        var spacesMinusLineBreaksRegex = /^[ \\t\\f\\r]+$/;\n        var allWhiteSpaceRegex = /^[\\t-\\r \\u0085\\u00A0\\u1680\\u180E\\u2000-\\u200B\\u2028\\u2029\\u202F\\u205F\\u3000]+$/;\n        var nonLineBreakWhiteSpaceRegex = /^[\\t \\u00A0\\u1680\\u180E\\u2000-\\u200B\\u202F\\u205F\\u3000]+$/;\n        var lineBreakRegex = /^[\\n-\\r\\u0085\\u2028\\u2029]$/;\n\n        var defaultLanguage = \"en\";\n\n        var isDirectionBackward = api.Selection.isDirectionBackward;\n\n        // Properties representing whether trailing spaces inside blocks are completely collapsed (as they are in WebKit,\n        // but not other browsers). Also test whether trailing spaces before <br> elements are collapsed.\n        var trailingSpaceInBlockCollapses = false;\n        var trailingSpaceBeforeBrCollapses = false;\n        var trailingSpaceBeforeBlockCollapses = false;\n        var trailingSpaceBeforeLineBreakInPreLineCollapses = true;\n\n        (function() {\n            var el = dom.createTestElement(document, \"<p>1 </p><p></p>\", true);\n            var p = el.firstChild;\n            var sel = api.getSelection();\n            sel.collapse(p.lastChild, 2);\n            sel.setStart(p.firstChild, 0);\n            trailingSpaceInBlockCollapses = (\"\" + sel).length == 1;\n\n            el.innerHTML = \"1 <br />\";\n            sel.collapse(el, 2);\n            sel.setStart(el.firstChild, 0);\n            trailingSpaceBeforeBrCollapses = (\"\" + sel).length == 1;\n\n            el.innerHTML = \"1 <p>1</p>\";\n            sel.collapse(el, 2);\n            sel.setStart(el.firstChild, 0);\n            trailingSpaceBeforeBlockCollapses = (\"\" + sel).length == 1;\n\n            dom.removeNode(el);\n            sel.removeAllRanges();\n        })();\n\n        /*----------------------------------------------------------------------------------------------------------------*/\n\n        // This function must create word and non-word tokens for the whole of the text supplied to it\n        function defaultTokenizer(chars, wordOptions) {\n            var word = chars.join(\"\"), result, tokenRanges = [];\n\n            function createTokenRange(start, end, isWord) {\n                tokenRanges.push( { start: start, end: end, isWord: isWord } );\n            }\n\n            // Match words and mark characters\n            var lastWordEnd = 0, wordStart, wordEnd;\n            while ( (result = wordOptions.wordRegex.exec(word)) ) {\n                wordStart = result.index;\n                wordEnd = wordStart + result[0].length;\n\n                // Create token for non-word characters preceding this word\n                if (wordStart > lastWordEnd) {\n                    createTokenRange(lastWordEnd, wordStart, false);\n                }\n\n                // Get trailing space characters for word\n                if (wordOptions.includeTrailingSpace) {\n                    while ( nonLineBreakWhiteSpaceRegex.test(chars[wordEnd]) ) {\n                        ++wordEnd;\n                    }\n                }\n                createTokenRange(wordStart, wordEnd, true);\n                lastWordEnd = wordEnd;\n            }\n\n            // Create token for trailing non-word characters, if any exist\n            if (lastWordEnd < chars.length) {\n                createTokenRange(lastWordEnd, chars.length, false);\n            }\n\n            return tokenRanges;\n        }\n\n        function convertCharRangeToToken(chars, tokenRange) {\n            var tokenChars = chars.slice(tokenRange.start, tokenRange.end);\n            var token = {\n                isWord: tokenRange.isWord,\n                chars: tokenChars,\n                toString: function() {\n                    return tokenChars.join(\"\");\n                }\n            };\n            for (var i = 0, len = tokenChars.length; i < len; ++i) {\n                tokenChars[i].token = token;\n            }\n            return token;\n        }\n\n        function tokenize(chars, wordOptions, tokenizer) {\n            var tokenRanges = tokenizer(chars, wordOptions);\n            var tokens = [];\n            for (var i = 0, tokenRange; tokenRange = tokenRanges[i++]; ) {\n                tokens.push( convertCharRangeToToken(chars, tokenRange) );\n            }\n            return tokens;\n        }\n\n        var defaultCharacterOptions = {\n            includeBlockContentTrailingSpace: true,\n            includeSpaceBeforeBr: true,\n            includeSpaceBeforeBlock: true,\n            includePreLineTrailingSpace: true,\n            ignoreCharacters: \"\"\n        };\n\n        function normalizeIgnoredCharacters(ignoredCharacters) {\n            // Check if character is ignored\n            var ignoredChars = ignoredCharacters || \"\";\n\n            // Normalize ignored characters into a string consisting of characters in ascending order of character code\n            var ignoredCharsArray = (typeof ignoredChars == \"string\") ? ignoredChars.split(\"\") : ignoredChars;\n            ignoredCharsArray.sort(function(char1, char2) {\n                return char1.charCodeAt(0) - char2.charCodeAt(0);\n            });\n\n            /// Convert back to a string and remove duplicates\n            return ignoredCharsArray.join(\"\").replace(/(.)\\1+/g, \"$1\");\n        }\n\n        var defaultCaretCharacterOptions = {\n            includeBlockContentTrailingSpace: !trailingSpaceBeforeLineBreakInPreLineCollapses,\n            includeSpaceBeforeBr: !trailingSpaceBeforeBrCollapses,\n            includeSpaceBeforeBlock: !trailingSpaceBeforeBlockCollapses,\n            includePreLineTrailingSpace: true\n        };\n\n        var defaultWordOptions = {\n            \"en\": {\n                wordRegex: /[a-z0-9]+('[a-z0-9]+)*/gi,\n                includeTrailingSpace: false,\n                tokenizer: defaultTokenizer\n            }\n        };\n\n        var defaultFindOptions = {\n            caseSensitive: false,\n            withinRange: null,\n            wholeWordsOnly: false,\n            wrap: false,\n            direction: \"forward\",\n            wordOptions: null,\n            characterOptions: null\n        };\n\n        var defaultMoveOptions = {\n            wordOptions: null,\n            characterOptions: null\n        };\n\n        var defaultExpandOptions = {\n            wordOptions: null,\n            characterOptions: null,\n            trim: false,\n            trimStart: true,\n            trimEnd: true\n        };\n\n        var defaultWordIteratorOptions = {\n            wordOptions: null,\n            characterOptions: null,\n            direction: \"forward\"\n        };\n\n        function createWordOptions(options) {\n            var lang, defaults;\n            if (!options) {\n                return defaultWordOptions[defaultLanguage];\n            } else {\n                lang = options.language || defaultLanguage;\n                defaults = {};\n                extend(defaults, defaultWordOptions[lang] || defaultWordOptions[defaultLanguage]);\n                extend(defaults, options);\n                return defaults;\n            }\n        }\n\n        function createNestedOptions(optionsParam, defaults) {\n            var options = createOptions(optionsParam, defaults);\n            if (defaults.hasOwnProperty(\"wordOptions\")) {\n                options.wordOptions = createWordOptions(options.wordOptions);\n            }\n            if (defaults.hasOwnProperty(\"characterOptions\")) {\n                options.characterOptions = createOptions(options.characterOptions, defaultCharacterOptions);\n            }\n            return options;\n        }\n\n        /*----------------------------------------------------------------------------------------------------------------*/\n\n        /* DOM utility functions */\n        var getComputedStyleProperty = dom.getComputedStyleProperty;\n\n        // Create cachable versions of DOM functions\n\n        // Test for old IE's incorrect display properties\n        var tableCssDisplayBlock;\n        (function() {\n            var table = document.createElement(\"table\");\n            var body = getBody(document);\n            body.appendChild(table);\n            tableCssDisplayBlock = (getComputedStyleProperty(table, \"display\") == \"block\");\n            body.removeChild(table);\n        })();\n\n        var defaultDisplayValueForTag = {\n            table: \"table\",\n            caption: \"table-caption\",\n            colgroup: \"table-column-group\",\n            col: \"table-column\",\n            thead: \"table-header-group\",\n            tbody: \"table-row-group\",\n            tfoot: \"table-footer-group\",\n            tr: \"table-row\",\n            td: \"table-cell\",\n            th: \"table-cell\"\n        };\n\n        // Corrects IE's \"block\" value for table-related elements\n        function getComputedDisplay(el, win) {\n            var display = getComputedStyleProperty(el, \"display\", win);\n            var tagName = el.tagName.toLowerCase();\n            return (display == \"block\" &&\n                    tableCssDisplayBlock &&\n                    defaultDisplayValueForTag.hasOwnProperty(tagName)) ?\n                defaultDisplayValueForTag[tagName] : display;\n        }\n\n        function isHidden(node) {\n            var ancestors = getAncestorsAndSelf(node);\n            for (var i = 0, len = ancestors.length; i < len; ++i) {\n                if (ancestors[i].nodeType == 1 && getComputedDisplay(ancestors[i]) == \"none\") {\n                    return true;\n                }\n            }\n\n            return false;\n        }\n\n        function isVisibilityHiddenTextNode(textNode) {\n            var el;\n            return textNode.nodeType == 3 &&\n                (el = textNode.parentNode) &&\n                getComputedStyleProperty(el, \"visibility\") == \"hidden\";\n        }\n\n        /*----------------------------------------------------------------------------------------------------------------*/\n\n    \n        // \"A block node is either an Element whose \"display\" property does not have\n        // resolved value \"inline\" or \"inline-block\" or \"inline-table\" or \"none\", or a\n        // Document, or a DocumentFragment.\"\n        function isBlockNode(node) {\n            return node &&\n                ((node.nodeType == 1 && !/^(inline(-block|-table)?|none)$/.test(getComputedDisplay(node))) ||\n                node.nodeType == 9 || node.nodeType == 11);\n        }\n\n        function getLastDescendantOrSelf(node) {\n            var lastChild = node.lastChild;\n            return lastChild ? getLastDescendantOrSelf(lastChild) : node;\n        }\n\n        function containsPositions(node) {\n            return dom.isCharacterDataNode(node) ||\n                !/^(area|base|basefont|br|col|frame|hr|img|input|isindex|link|meta|param)$/i.test(node.nodeName);\n        }\n\n        function getAncestors(node) {\n            var ancestors = [];\n            while (node.parentNode) {\n                ancestors.unshift(node.parentNode);\n                node = node.parentNode;\n            }\n            return ancestors;\n        }\n\n        function getAncestorsAndSelf(node) {\n            return getAncestors(node).concat([node]);\n        }\n\n        function nextNodeDescendants(node) {\n            while (node && !node.nextSibling) {\n                node = node.parentNode;\n            }\n            if (!node) {\n                return null;\n            }\n            return node.nextSibling;\n        }\n\n        function nextNode(node, excludeChildren) {\n            if (!excludeChildren && node.hasChildNodes()) {\n                return node.firstChild;\n            }\n            return nextNodeDescendants(node);\n        }\n\n        function previousNode(node) {\n            var previous = node.previousSibling;\n            if (previous) {\n                node = previous;\n                while (node.hasChildNodes()) {\n                    node = node.lastChild;\n                }\n                return node;\n            }\n            var parent = node.parentNode;\n            if (parent && parent.nodeType == 1) {\n                return parent;\n            }\n            return null;\n        }\n\n        // Adpated from Aryeh's code.\n        // \"A whitespace node is either a Text node whose data is the empty string; or\n        // a Text node whose data consists only of one or more tabs (0x0009), line\n        // feeds (0x000A), carriage returns (0x000D), and/or spaces (0x0020), and whose\n        // parent is an Element whose resolved value for \"white-space\" is \"normal\" or\n        // \"nowrap\"; or a Text node whose data consists only of one or more tabs\n        // (0x0009), carriage returns (0x000D), and/or spaces (0x0020), and whose\n        // parent is an Element whose resolved value for \"white-space\" is \"pre-line\".\"\n        function isWhitespaceNode(node) {\n            if (!node || node.nodeType != 3) {\n                return false;\n            }\n            var text = node.data;\n            if (text === \"\") {\n                return true;\n            }\n            var parent = node.parentNode;\n            if (!parent || parent.nodeType != 1) {\n                return false;\n            }\n            var computedWhiteSpace = getComputedStyleProperty(node.parentNode, \"whiteSpace\");\n\n            return (/^[\\t\\n\\r ]+$/.test(text) && /^(normal|nowrap)$/.test(computedWhiteSpace)) ||\n                (/^[\\t\\r ]+$/.test(text) && computedWhiteSpace == \"pre-line\");\n        }\n\n        // Adpated from Aryeh's code.\n        // \"node is a collapsed whitespace node if the following algorithm returns\n        // true:\"\n        function isCollapsedWhitespaceNode(node) {\n            // \"If node's data is the empty string, return true.\"\n            if (node.data === \"\") {\n                return true;\n            }\n\n            // \"If node is not a whitespace node, return false.\"\n            if (!isWhitespaceNode(node)) {\n                return false;\n            }\n\n            // \"Let ancestor be node's parent.\"\n            var ancestor = node.parentNode;\n\n            // \"If ancestor is null, return true.\"\n            if (!ancestor) {\n                return true;\n            }\n\n            // \"If the \"display\" property of some ancestor of node has resolved value \"none\", return true.\"\n            if (isHidden(node)) {\n                return true;\n            }\n\n            return false;\n        }\n\n        function isCollapsedNode(node) {\n            var type = node.nodeType;\n            return type == 7 /* PROCESSING_INSTRUCTION */ ||\n                type == 8 /* COMMENT */ ||\n                isHidden(node) ||\n                /^(script|style)$/i.test(node.nodeName) ||\n                isVisibilityHiddenTextNode(node) ||\n                isCollapsedWhitespaceNode(node);\n        }\n\n        function isIgnoredNode(node, win) {\n            var type = node.nodeType;\n            return type == 7 /* PROCESSING_INSTRUCTION */ ||\n                type == 8 /* COMMENT */ ||\n                (type == 1 && getComputedDisplay(node, win) == \"none\");\n        }\n\n        /*----------------------------------------------------------------------------------------------------------------*/\n\n        // Possibly overengineered caching system to prevent repeated DOM calls slowing everything down\n\n        function Cache() {\n            this.store = {};\n        }\n\n        Cache.prototype = {\n            get: function(key) {\n                return this.store.hasOwnProperty(key) ? this.store[key] : null;\n            },\n\n            set: function(key, value) {\n                return this.store[key] = value;\n            }\n        };\n\n        var cachedCount = 0, uncachedCount = 0;\n\n        function createCachingGetter(methodName, func, objProperty) {\n            return function(args) {\n                var cache = this.cache;\n                if (cache.hasOwnProperty(methodName)) {\n                    cachedCount++;\n                    return cache[methodName];\n                } else {\n                    uncachedCount++;\n                    var value = func.call(this, objProperty ? this[objProperty] : this, args);\n                    cache[methodName] = value;\n                    return value;\n                }\n            };\n        }\n\n        /*----------------------------------------------------------------------------------------------------------------*/\n\n        function NodeWrapper(node, session) {\n            this.node = node;\n            this.session = session;\n            this.cache = new Cache();\n            this.positions = new Cache();\n        }\n\n        var nodeProto = {\n            getPosition: function(offset) {\n                var positions = this.positions;\n                return positions.get(offset) || positions.set(offset, new Position(this, offset));\n            },\n\n            toString: function() {\n                return \"[NodeWrapper(\" + dom.inspectNode(this.node) + \")]\";\n            }\n        };\n\n        NodeWrapper.prototype = nodeProto;\n\n        var EMPTY = \"EMPTY\",\n            NON_SPACE = \"NON_SPACE\",\n            UNCOLLAPSIBLE_SPACE = \"UNCOLLAPSIBLE_SPACE\",\n            COLLAPSIBLE_SPACE = \"COLLAPSIBLE_SPACE\",\n            TRAILING_SPACE_BEFORE_BLOCK = \"TRAILING_SPACE_BEFORE_BLOCK\",\n            TRAILING_SPACE_IN_BLOCK = \"TRAILING_SPACE_IN_BLOCK\",\n            TRAILING_SPACE_BEFORE_BR = \"TRAILING_SPACE_BEFORE_BR\",\n            PRE_LINE_TRAILING_SPACE_BEFORE_LINE_BREAK = \"PRE_LINE_TRAILING_SPACE_BEFORE_LINE_BREAK\",\n            TRAILING_LINE_BREAK_AFTER_BR = \"TRAILING_LINE_BREAK_AFTER_BR\",\n            INCLUDED_TRAILING_LINE_BREAK_AFTER_BR = \"INCLUDED_TRAILING_LINE_BREAK_AFTER_BR\";\n\n        extend(nodeProto, {\n            isCharacterDataNode: createCachingGetter(\"isCharacterDataNode\", dom.isCharacterDataNode, \"node\"),\n            getNodeIndex: createCachingGetter(\"nodeIndex\", dom.getNodeIndex, \"node\"),\n            getLength: createCachingGetter(\"nodeLength\", dom.getNodeLength, \"node\"),\n            containsPositions: createCachingGetter(\"containsPositions\", containsPositions, \"node\"),\n            isWhitespace: createCachingGetter(\"isWhitespace\", isWhitespaceNode, \"node\"),\n            isCollapsedWhitespace: createCachingGetter(\"isCollapsedWhitespace\", isCollapsedWhitespaceNode, \"node\"),\n            getComputedDisplay: createCachingGetter(\"computedDisplay\", getComputedDisplay, \"node\"),\n            isCollapsed: createCachingGetter(\"collapsed\", isCollapsedNode, \"node\"),\n            isIgnored: createCachingGetter(\"ignored\", isIgnoredNode, \"node\"),\n            next: createCachingGetter(\"nextPos\", nextNode, \"node\"),\n            previous: createCachingGetter(\"previous\", previousNode, \"node\"),\n\n            getTextNodeInfo: createCachingGetter(\"textNodeInfo\", function(textNode) {\n                var spaceRegex = null, collapseSpaces = false;\n                var cssWhitespace = getComputedStyleProperty(textNode.parentNode, \"whiteSpace\");\n                var preLine = (cssWhitespace == \"pre-line\");\n                if (preLine) {\n                    spaceRegex = spacesMinusLineBreaksRegex;\n                    collapseSpaces = true;\n                } else if (cssWhitespace == \"normal\" || cssWhitespace == \"nowrap\") {\n                    spaceRegex = spacesRegex;\n                    collapseSpaces = true;\n                }\n\n                return {\n                    node: textNode,\n                    text: textNode.data,\n                    spaceRegex: spaceRegex,\n                    collapseSpaces: collapseSpaces,\n                    preLine: preLine\n                };\n            }, \"node\"),\n\n            hasInnerText: createCachingGetter(\"hasInnerText\", function(el, backward) {\n                var session = this.session;\n                var posAfterEl = session.getPosition(el.parentNode, this.getNodeIndex() + 1);\n                var firstPosInEl = session.getPosition(el, 0);\n\n                var pos = backward ? posAfterEl : firstPosInEl;\n                var endPos = backward ? firstPosInEl : posAfterEl;\n\n                /*\n                 <body><p>X  </p><p>Y</p></body>\n\n                 Positions:\n\n                 body:0:\"\"\n                 p:0:\"\"\n                 text:0:\"\"\n                 text:1:\"X\"\n                 text:2:TRAILING_SPACE_IN_BLOCK\n                 text:3:COLLAPSED_SPACE\n                 p:1:\"\"\n                 body:1:\"\\n\"\n                 p:0:\"\"\n                 text:0:\"\"\n                 text:1:\"Y\"\n\n                 A character is a TRAILING_SPACE_IN_BLOCK iff:\n\n                 - There is no uncollapsed character after it within the visible containing block element\n\n                 A character is a TRAILING_SPACE_BEFORE_BR iff:\n\n                 - There is no uncollapsed character after it preceding a <br> element\n\n                 An element has inner text iff\n\n                 - It is not hidden\n                 - It contains an uncollapsed character\n\n                 All trailing spaces (pre-line, before <br>, end of block) require definite non-empty characters to render.\n                 */\n\n                while (pos !== endPos) {\n                    pos.prepopulateChar();\n                    if (pos.isDefinitelyNonEmpty()) {\n                        return true;\n                    }\n                    pos = backward ? pos.previousVisible() : pos.nextVisible();\n                }\n\n                return false;\n            }, \"node\"),\n\n            isRenderedBlock: createCachingGetter(\"isRenderedBlock\", function(el) {\n                // Ensure that a block element containing a <br> is considered to have inner text\n                var brs = el.getElementsByTagName(\"br\");\n                for (var i = 0, len = brs.length; i < len; ++i) {\n                    if (!isCollapsedNode(brs[i])) {\n                        return true;\n                    }\n                }\n                return this.hasInnerText();\n            }, \"node\"),\n\n            getTrailingSpace: createCachingGetter(\"trailingSpace\", function(el) {\n                if (el.tagName.toLowerCase() == \"br\") {\n                    return \"\";\n                } else {\n                    switch (this.getComputedDisplay()) {\n                        case \"inline\":\n                            var child = el.lastChild;\n                            while (child) {\n                                if (!isIgnoredNode(child)) {\n                                    return (child.nodeType == 1) ? this.session.getNodeWrapper(child).getTrailingSpace() : \"\";\n                                }\n                                child = child.previousSibling;\n                            }\n                            break;\n                        case \"inline-block\":\n                        case \"inline-table\":\n                        case \"none\":\n                        case \"table-column\":\n                        case \"table-column-group\":\n                            break;\n                        case \"table-cell\":\n                            return \"\\t\";\n                        default:\n                            return this.isRenderedBlock(true) ? \"\\n\" : \"\";\n                    }\n                }\n                return \"\";\n            }, \"node\"),\n\n            getLeadingSpace: createCachingGetter(\"leadingSpace\", function(el) {\n                switch (this.getComputedDisplay()) {\n                    case \"inline\":\n                    case \"inline-block\":\n                    case \"inline-table\":\n                    case \"none\":\n                    case \"table-column\":\n                    case \"table-column-group\":\n                    case \"table-cell\":\n                        break;\n                    default:\n                        return this.isRenderedBlock(false) ? \"\\n\" : \"\";\n                }\n                return \"\";\n            }, \"node\")\n        });\n\n        /*----------------------------------------------------------------------------------------------------------------*/\n\n        function Position(nodeWrapper, offset) {\n            this.offset = offset;\n            this.nodeWrapper = nodeWrapper;\n            this.node = nodeWrapper.node;\n            this.session = nodeWrapper.session;\n            this.cache = new Cache();\n        }\n\n        function inspectPosition() {\n            return \"[Position(\" + dom.inspectNode(this.node) + \":\" + this.offset + \")]\";\n        }\n\n        var positionProto = {\n            character: \"\",\n            characterType: EMPTY,\n            isBr: false,\n\n            /*\n            This method:\n            - Fully populates positions that have characters that can be determined independently of any other characters.\n            - Populates most types of space positions with a provisional character. The character is finalized later.\n             */\n            prepopulateChar: function() {\n                var pos = this;\n                if (!pos.prepopulatedChar) {\n                    var node = pos.node, offset = pos.offset;\n                    var visibleChar = \"\", charType = EMPTY;\n                    var finalizedChar = false;\n                    if (offset > 0) {\n                        if (node.nodeType == 3) {\n                            var text = node.data;\n                            var textChar = text.charAt(offset - 1);\n\n                            var nodeInfo = pos.nodeWrapper.getTextNodeInfo();\n                            var spaceRegex = nodeInfo.spaceRegex;\n                            if (nodeInfo.collapseSpaces) {\n                                if (spaceRegex.test(textChar)) {\n                                    // \"If the character at position is from set, append a single space (U+0020) to newdata and advance\n                                    // position until the character at position is not from set.\"\n\n                                    // We also need to check for the case where we're in a pre-line and we have a space preceding a\n                                    // line break, because such spaces are collapsed in some browsers\n                                    if (offset > 1 && spaceRegex.test(text.charAt(offset - 2))) {\n                                    } else if (nodeInfo.preLine && text.charAt(offset) === \"\\n\") {\n                                        visibleChar = \" \";\n                                        charType = PRE_LINE_TRAILING_SPACE_BEFORE_LINE_BREAK;\n                                    } else {\n                                        visibleChar = \" \";\n                                        //pos.checkForFollowingLineBreak = true;\n                                        charType = COLLAPSIBLE_SPACE;\n                                    }\n                                } else {\n                                    visibleChar = textChar;\n                                    charType = NON_SPACE;\n                                    finalizedChar = true;\n                                }\n                            } else {\n                                visibleChar = textChar;\n                                charType = UNCOLLAPSIBLE_SPACE;\n                                finalizedChar = true;\n                            }\n                        } else {\n                            var nodePassed = node.childNodes[offset - 1];\n                            if (nodePassed && nodePassed.nodeType == 1 && !isCollapsedNode(nodePassed)) {\n                                if (nodePassed.tagName.toLowerCase() == \"br\") {\n                                    visibleChar = \"\\n\";\n                                    pos.isBr = true;\n                                    charType = COLLAPSIBLE_SPACE;\n                                    finalizedChar = false;\n                                } else {\n                                    pos.checkForTrailingSpace = true;\n                                }\n                            }\n\n                            // Check the leading space of the next node for the case when a block element follows an inline\n                            // element or text node. In that case, there is an implied line break between the two nodes.\n                            if (!visibleChar) {\n                                var nextNode = node.childNodes[offset];\n                                if (nextNode && nextNode.nodeType == 1 && !isCollapsedNode(nextNode)) {\n                                    pos.checkForLeadingSpace = true;\n                                }\n                            }\n                        }\n                    }\n\n                    pos.prepopulatedChar = true;\n                    pos.character = visibleChar;\n                    pos.characterType = charType;\n                    pos.isCharInvariant = finalizedChar;\n                }\n            },\n\n            isDefinitelyNonEmpty: function() {\n                var charType = this.characterType;\n                return charType == NON_SPACE || charType == UNCOLLAPSIBLE_SPACE;\n            },\n\n            // Resolve leading and trailing spaces, which may involve prepopulating other positions\n            resolveLeadingAndTrailingSpaces: function() {\n                if (!this.prepopulatedChar) {\n                    this.prepopulateChar();\n                }\n                if (this.checkForTrailingSpace) {\n                    var trailingSpace = this.session.getNodeWrapper(this.node.childNodes[this.offset - 1]).getTrailingSpace();\n                    if (trailingSpace) {\n                        this.isTrailingSpace = true;\n                        this.character = trailingSpace;\n                        this.characterType = COLLAPSIBLE_SPACE;\n                    }\n                    this.checkForTrailingSpace = false;\n                }\n                if (this.checkForLeadingSpace) {\n                    var leadingSpace = this.session.getNodeWrapper(this.node.childNodes[this.offset]).getLeadingSpace();\n                    if (leadingSpace) {\n                        this.isLeadingSpace = true;\n                        this.character = leadingSpace;\n                        this.characterType = COLLAPSIBLE_SPACE;\n                    }\n                    this.checkForLeadingSpace = false;\n                }\n            },\n\n            getPrecedingUncollapsedPosition: function(characterOptions) {\n                var pos = this, character;\n                while ( (pos = pos.previousVisible()) ) {\n                    character = pos.getCharacter(characterOptions);\n                    if (character !== \"\") {\n                        return pos;\n                    }\n                }\n\n                return null;\n            },\n\n            getCharacter: function(characterOptions) {\n                this.resolveLeadingAndTrailingSpaces();\n\n                var thisChar = this.character, returnChar;\n\n                // Check if character is ignored\n                var ignoredChars = normalizeIgnoredCharacters(characterOptions.ignoreCharacters);\n                var isIgnoredCharacter = (thisChar !== \"\" && ignoredChars.indexOf(thisChar) > -1);\n\n                // Check if this position's  character is invariant (i.e. not dependent on character options) and return it\n                // if so\n                if (this.isCharInvariant) {\n                    returnChar = isIgnoredCharacter ? \"\" : thisChar;\n                    return returnChar;\n                }\n\n                var cacheKey = [\"character\", characterOptions.includeSpaceBeforeBr, characterOptions.includeBlockContentTrailingSpace, characterOptions.includePreLineTrailingSpace, ignoredChars].join(\"_\");\n                var cachedChar = this.cache.get(cacheKey);\n                if (cachedChar !== null) {\n                    return cachedChar;\n                }\n\n                // We need to actually get the character now\n                var character = \"\";\n                var collapsible = (this.characterType == COLLAPSIBLE_SPACE);\n\n                var nextPos, previousPos;\n                var gotPreviousPos = false;\n                var pos = this;\n\n                function getPreviousPos() {\n                    if (!gotPreviousPos) {\n                        previousPos = pos.getPrecedingUncollapsedPosition(characterOptions);\n                        gotPreviousPos = true;\n                    }\n                    return previousPos;\n                }\n\n                // Disallow a collapsible space that is followed by a line break or is the last character\n                if (collapsible) {\n                    // Allow a trailing space that we've previously determined should be included\n                    if (this.type == INCLUDED_TRAILING_LINE_BREAK_AFTER_BR) {\n                        character = \"\\n\";\n                    }\n                    // Disallow a collapsible space that follows a trailing space or line break, or is the first character,\n                    // or follows a collapsible included space\n                    else if (thisChar == \" \" &&\n                            (!getPreviousPos() || previousPos.isTrailingSpace || previousPos.character == \"\\n\" || (previousPos.character == \" \" && previousPos.characterType == COLLAPSIBLE_SPACE))) {\n                    }\n                    // Allow a leading line break unless it follows a line break\n                    else if (thisChar == \"\\n\" && this.isLeadingSpace) {\n                        if (getPreviousPos() && previousPos.character != \"\\n\") {\n                            character = \"\\n\";\n                        } else {\n                        }\n                    } else {\n                        nextPos = this.nextUncollapsed();\n                        if (nextPos) {\n                            if (nextPos.isBr) {\n                                this.type = TRAILING_SPACE_BEFORE_BR;\n                            } else if (nextPos.isTrailingSpace && nextPos.character == \"\\n\") {\n                                this.type = TRAILING_SPACE_IN_BLOCK;\n                            } else if (nextPos.isLeadingSpace && nextPos.character == \"\\n\") {\n                                this.type = TRAILING_SPACE_BEFORE_BLOCK;\n                            }\n\n                            if (nextPos.character == \"\\n\") {\n                                if (this.type == TRAILING_SPACE_BEFORE_BR && !characterOptions.includeSpaceBeforeBr) {\n                                } else if (this.type == TRAILING_SPACE_BEFORE_BLOCK && !characterOptions.includeSpaceBeforeBlock) {\n                                } else if (this.type == TRAILING_SPACE_IN_BLOCK && nextPos.isTrailingSpace && !characterOptions.includeBlockContentTrailingSpace) {\n                                } else if (this.type == PRE_LINE_TRAILING_SPACE_BEFORE_LINE_BREAK && nextPos.type == NON_SPACE && !characterOptions.includePreLineTrailingSpace) {\n                                } else if (thisChar == \"\\n\") {\n                                    if (nextPos.isTrailingSpace) {\n                                        if (this.isTrailingSpace) {\n                                        } else if (this.isBr) {\n                                            nextPos.type = TRAILING_LINE_BREAK_AFTER_BR;\n\n                                            if (getPreviousPos() && previousPos.isLeadingSpace && !previousPos.isTrailingSpace && previousPos.character == \"\\n\") {\n                                                nextPos.character = \"\";\n                                            } else {\n                                                nextPos.type = INCLUDED_TRAILING_LINE_BREAK_AFTER_BR;\n                                            }\n                                        }\n                                    } else {\n                                        character = \"\\n\";\n                                    }\n                                } else if (thisChar == \" \") {\n                                    character = \" \";\n                                } else {\n                                }\n                            } else {\n                                character = thisChar;\n                            }\n                        } else {\n                        }\n                    }\n                }\n\n                if (ignoredChars.indexOf(character) > -1) {\n                    character = \"\";\n                }\n\n\n                this.cache.set(cacheKey, character);\n\n                return character;\n            },\n\n            equals: function(pos) {\n                return !!pos && this.node === pos.node && this.offset === pos.offset;\n            },\n\n            inspect: inspectPosition,\n\n            toString: function() {\n                return this.character;\n            }\n        };\n\n        Position.prototype = positionProto;\n\n        extend(positionProto, {\n            next: createCachingGetter(\"nextPos\", function(pos) {\n                var nodeWrapper = pos.nodeWrapper, node = pos.node, offset = pos.offset, session = nodeWrapper.session;\n                if (!node) {\n                    return null;\n                }\n                var nextNode, nextOffset, child;\n                if (offset == nodeWrapper.getLength()) {\n                    // Move onto the next node\n                    nextNode = node.parentNode;\n                    nextOffset = nextNode ? nodeWrapper.getNodeIndex() + 1 : 0;\n                } else {\n                    if (nodeWrapper.isCharacterDataNode()) {\n                        nextNode = node;\n                        nextOffset = offset + 1;\n                    } else {\n                        child = node.childNodes[offset];\n                        // Go into the children next, if children there are\n                        if (session.getNodeWrapper(child).containsPositions()) {\n                            nextNode = child;\n                            nextOffset = 0;\n                        } else {\n                            nextNode = node;\n                            nextOffset = offset + 1;\n                        }\n                    }\n                }\n\n                return nextNode ? session.getPosition(nextNode, nextOffset) : null;\n            }),\n\n            previous: createCachingGetter(\"previous\", function(pos) {\n                var nodeWrapper = pos.nodeWrapper, node = pos.node, offset = pos.offset, session = nodeWrapper.session;\n                var previousNode, previousOffset, child;\n                if (offset == 0) {\n                    previousNode = node.parentNode;\n                    previousOffset = previousNode ? nodeWrapper.getNodeIndex() : 0;\n                } else {\n                    if (nodeWrapper.isCharacterDataNode()) {\n                        previousNode = node;\n                        previousOffset = offset - 1;\n                    } else {\n                        child = node.childNodes[offset - 1];\n                        // Go into the children next, if children there are\n                        if (session.getNodeWrapper(child).containsPositions()) {\n                            previousNode = child;\n                            previousOffset = dom.getNodeLength(child);\n                        } else {\n                            previousNode = node;\n                            previousOffset = offset - 1;\n                        }\n                    }\n                }\n                return previousNode ? session.getPosition(previousNode, previousOffset) : null;\n            }),\n\n            /*\n             Next and previous position moving functions that filter out\n\n             - Hidden (CSS visibility/display) elements\n             - Script and style elements\n             */\n            nextVisible: createCachingGetter(\"nextVisible\", function(pos) {\n                var next = pos.next();\n                if (!next) {\n                    return null;\n                }\n                var nodeWrapper = next.nodeWrapper, node = next.node;\n                var newPos = next;\n                if (nodeWrapper.isCollapsed()) {\n                    // We're skipping this node and all its descendants\n                    newPos = nodeWrapper.session.getPosition(node.parentNode, nodeWrapper.getNodeIndex() + 1);\n                }\n                return newPos;\n            }),\n\n            nextUncollapsed: createCachingGetter(\"nextUncollapsed\", function(pos) {\n                var nextPos = pos;\n                while ( (nextPos = nextPos.nextVisible()) ) {\n                    nextPos.resolveLeadingAndTrailingSpaces();\n                    if (nextPos.character !== \"\") {\n                        return nextPos;\n                    }\n                }\n                return null;\n            }),\n\n            previousVisible: createCachingGetter(\"previousVisible\", function(pos) {\n                var previous = pos.previous();\n                if (!previous) {\n                    return null;\n                }\n                var nodeWrapper = previous.nodeWrapper, node = previous.node;\n                var newPos = previous;\n                if (nodeWrapper.isCollapsed()) {\n                    // We're skipping this node and all its descendants\n                    newPos = nodeWrapper.session.getPosition(node.parentNode, nodeWrapper.getNodeIndex());\n                }\n                return newPos;\n            })\n        });\n\n        /*----------------------------------------------------------------------------------------------------------------*/\n\n        var currentSession = null;\n\n        var Session = (function() {\n            function createWrapperCache(nodeProperty) {\n                var cache = new Cache();\n\n                return {\n                    get: function(node) {\n                        var wrappersByProperty = cache.get(node[nodeProperty]);\n                        if (wrappersByProperty) {\n                            for (var i = 0, wrapper; wrapper = wrappersByProperty[i++]; ) {\n                                if (wrapper.node === node) {\n                                    return wrapper;\n                                }\n                            }\n                        }\n                        return null;\n                    },\n\n                    set: function(nodeWrapper) {\n                        var property = nodeWrapper.node[nodeProperty];\n                        var wrappersByProperty = cache.get(property) || cache.set(property, []);\n                        wrappersByProperty.push(nodeWrapper);\n                    }\n                };\n            }\n\n            var uniqueIDSupported = util.isHostProperty(document.documentElement, \"uniqueID\");\n\n            function Session() {\n                this.initCaches();\n            }\n\n            Session.prototype = {\n                initCaches: function() {\n                    this.elementCache = uniqueIDSupported ? (function() {\n                        var elementsCache = new Cache();\n\n                        return {\n                            get: function(el) {\n                                return elementsCache.get(el.uniqueID);\n                            },\n\n                            set: function(elWrapper) {\n                                elementsCache.set(elWrapper.node.uniqueID, elWrapper);\n                            }\n                        };\n                    })() : createWrapperCache(\"tagName\");\n\n                    // Store text nodes keyed by data, although we may need to truncate this\n                    this.textNodeCache = createWrapperCache(\"data\");\n                    this.otherNodeCache = createWrapperCache(\"nodeName\");\n                },\n\n                getNodeWrapper: function(node) {\n                    var wrapperCache;\n                    switch (node.nodeType) {\n                        case 1:\n                            wrapperCache = this.elementCache;\n                            break;\n                        case 3:\n                            wrapperCache = this.textNodeCache;\n                            break;\n                        default:\n                            wrapperCache = this.otherNodeCache;\n                            break;\n                    }\n\n                    var wrapper = wrapperCache.get(node);\n                    if (!wrapper) {\n                        wrapper = new NodeWrapper(node, this);\n                        wrapperCache.set(wrapper);\n                    }\n                    return wrapper;\n                },\n\n                getPosition: function(node, offset) {\n                    return this.getNodeWrapper(node).getPosition(offset);\n                },\n\n                getRangeBoundaryPosition: function(range, isStart) {\n                    var prefix = isStart ? \"start\" : \"end\";\n                    return this.getPosition(range[prefix + \"Container\"], range[prefix + \"Offset\"]);\n                },\n\n                detach: function() {\n                    this.elementCache = this.textNodeCache = this.otherNodeCache = null;\n                }\n            };\n\n            return Session;\n        })();\n\n        /*----------------------------------------------------------------------------------------------------------------*/\n\n        function startSession() {\n            endSession();\n            return (currentSession = new Session());\n        }\n\n        function getSession() {\n            return currentSession || startSession();\n        }\n\n        function endSession() {\n            if (currentSession) {\n                currentSession.detach();\n            }\n            currentSession = null;\n        }\n\n        /*----------------------------------------------------------------------------------------------------------------*/\n\n        // Extensions to the rangy.dom utility object\n\n        extend(dom, {\n            nextNode: nextNode,\n            previousNode: previousNode\n        });\n\n        /*----------------------------------------------------------------------------------------------------------------*/\n\n        function createCharacterIterator(startPos, backward, endPos, characterOptions) {\n\n            // Adjust the end position to ensure that it is actually reached\n            if (endPos) {\n                if (backward) {\n                    if (isCollapsedNode(endPos.node)) {\n                        endPos = startPos.previousVisible();\n                    }\n                } else {\n                    if (isCollapsedNode(endPos.node)) {\n                        endPos = endPos.nextVisible();\n                    }\n                }\n            }\n\n            var pos = startPos, finished = false;\n\n            function next() {\n                var charPos = null;\n                if (backward) {\n                    charPos = pos;\n                    if (!finished) {\n                        pos = pos.previousVisible();\n                        finished = !pos || (endPos && pos.equals(endPos));\n                    }\n                } else {\n                    if (!finished) {\n                        charPos = pos = pos.nextVisible();\n                        finished = !pos || (endPos && pos.equals(endPos));\n                    }\n                }\n                if (finished) {\n                    pos = null;\n                }\n                return charPos;\n            }\n\n            var previousTextPos, returnPreviousTextPos = false;\n\n            return {\n                next: function() {\n                    if (returnPreviousTextPos) {\n                        returnPreviousTextPos = false;\n                        return previousTextPos;\n                    } else {\n                        var pos, character;\n                        while ( (pos = next()) ) {\n                            character = pos.getCharacter(characterOptions);\n                            if (character) {\n                                previousTextPos = pos;\n                                return pos;\n                            }\n                        }\n                        return null;\n                    }\n                },\n\n                rewind: function() {\n                    if (previousTextPos) {\n                        returnPreviousTextPos = true;\n                    } else {\n                        throw module.createError(\"createCharacterIterator: cannot rewind. Only one position can be rewound.\");\n                    }\n                },\n\n                dispose: function() {\n                    startPos = endPos = null;\n                }\n            };\n        }\n\n        var arrayIndexOf = Array.prototype.indexOf ?\n            function(arr, val) {\n                return arr.indexOf(val);\n            } :\n            function(arr, val) {\n                for (var i = 0, len = arr.length; i < len; ++i) {\n                    if (arr[i] === val) {\n                        return i;\n                    }\n                }\n                return -1;\n            };\n\n        // Provides a pair of iterators over text positions, tokenized. Transparently requests more text when next()\n        // is called and there is no more tokenized text\n        function createTokenizedTextProvider(pos, characterOptions, wordOptions) {\n            var forwardIterator = createCharacterIterator(pos, false, null, characterOptions);\n            var backwardIterator = createCharacterIterator(pos, true, null, characterOptions);\n            var tokenizer = wordOptions.tokenizer;\n\n            // Consumes a word and the whitespace beyond it\n            function consumeWord(forward) {\n                var pos, textChar;\n                var newChars = [], it = forward ? forwardIterator : backwardIterator;\n\n                var passedWordBoundary = false, insideWord = false;\n\n                while ( (pos = it.next()) ) {\n                    textChar = pos.character;\n\n\n                    if (allWhiteSpaceRegex.test(textChar)) {\n                        if (insideWord) {\n                            insideWord = false;\n                            passedWordBoundary = true;\n                        }\n                    } else {\n                        if (passedWordBoundary) {\n                            it.rewind();\n                            break;\n                        } else {\n                            insideWord = true;\n                        }\n                    }\n                    newChars.push(pos);\n                }\n\n\n                return newChars;\n            }\n\n            // Get initial word surrounding initial position and tokenize it\n            var forwardChars = consumeWord(true);\n            var backwardChars = consumeWord(false).reverse();\n            var tokens = tokenize(backwardChars.concat(forwardChars), wordOptions, tokenizer);\n\n            // Create initial token buffers\n            var forwardTokensBuffer = forwardChars.length ?\n                tokens.slice(arrayIndexOf(tokens, forwardChars[0].token)) : [];\n\n            var backwardTokensBuffer = backwardChars.length ?\n                tokens.slice(0, arrayIndexOf(tokens, backwardChars.pop().token) + 1) : [];\n\n            function inspectBuffer(buffer) {\n                var textPositions = [\"[\" + buffer.length + \"]\"];\n                for (var i = 0; i < buffer.length; ++i) {\n                    textPositions.push(\"(word: \" + buffer[i] + \", is word: \" + buffer[i].isWord + \")\");\n                }\n                return textPositions;\n            }\n\n\n            return {\n                nextEndToken: function() {\n                    var lastToken, forwardChars;\n\n                    // If we're down to the last token, consume character chunks until we have a word or run out of\n                    // characters to consume\n                    while ( forwardTokensBuffer.length == 1 &&\n                        !(lastToken = forwardTokensBuffer[0]).isWord &&\n                        (forwardChars = consumeWord(true)).length > 0) {\n\n                        // Merge trailing non-word into next word and tokenize\n                        forwardTokensBuffer = tokenize(lastToken.chars.concat(forwardChars), wordOptions, tokenizer);\n                    }\n\n                    return forwardTokensBuffer.shift();\n                },\n\n                previousStartToken: function() {\n                    var lastToken, backwardChars;\n\n                    // If we're down to the last token, consume character chunks until we have a word or run out of\n                    // characters to consume\n                    while ( backwardTokensBuffer.length == 1 &&\n                        !(lastToken = backwardTokensBuffer[0]).isWord &&\n                        (backwardChars = consumeWord(false)).length > 0) {\n\n                        // Merge leading non-word into next word and tokenize\n                        backwardTokensBuffer = tokenize(backwardChars.reverse().concat(lastToken.chars), wordOptions, tokenizer);\n                    }\n\n                    return backwardTokensBuffer.pop();\n                },\n\n                dispose: function() {\n                    forwardIterator.dispose();\n                    backwardIterator.dispose();\n                    forwardTokensBuffer = backwardTokensBuffer = null;\n                }\n            };\n        }\n\n        function movePositionBy(pos, unit, count, characterOptions, wordOptions) {\n            var unitsMoved = 0, currentPos, newPos = pos, charIterator, nextPos, absCount = Math.abs(count), token;\n            if (count !== 0) {\n                var backward = (count < 0);\n\n                switch (unit) {\n                    case CHARACTER:\n                        charIterator = createCharacterIterator(pos, backward, null, characterOptions);\n                        while ( (currentPos = charIterator.next()) && unitsMoved < absCount ) {\n                            ++unitsMoved;\n                            newPos = currentPos;\n                        }\n                        nextPos = currentPos;\n                        charIterator.dispose();\n                        break;\n                    case WORD:\n                        var tokenizedTextProvider = createTokenizedTextProvider(pos, characterOptions, wordOptions);\n                        var next = backward ? tokenizedTextProvider.previousStartToken : tokenizedTextProvider.nextEndToken;\n\n                        while ( (token = next()) && unitsMoved < absCount ) {\n                            if (token.isWord) {\n                                ++unitsMoved;\n                                newPos = backward ? token.chars[0] : token.chars[token.chars.length - 1];\n                            }\n                        }\n                        break;\n                    default:\n                        throw new Error(\"movePositionBy: unit '\" + unit + \"' not implemented\");\n                }\n\n                // Perform any necessary position tweaks\n                if (backward) {\n                    newPos = newPos.previousVisible();\n                    unitsMoved = -unitsMoved;\n                } else if (newPos && newPos.isLeadingSpace && !newPos.isTrailingSpace) {\n                    // Tweak the position for the case of a leading space. The problem is that an uncollapsed leading space\n                    // before a block element (for example, the line break between \"1\" and \"2\" in the following HTML:\n                    // \"1<p>2</p>\") is considered to be attached to the position immediately before the block element, which\n                    // corresponds with a different selection position in most browsers from the one we want (i.e. at the\n                    // start of the contents of the block element). We get round this by advancing the position returned to\n                    // the last possible equivalent visible position.\n                    if (unit == WORD) {\n                        charIterator = createCharacterIterator(pos, false, null, characterOptions);\n                        nextPos = charIterator.next();\n                        charIterator.dispose();\n                    }\n                    if (nextPos) {\n                        newPos = nextPos.previousVisible();\n                    }\n                }\n            }\n\n\n            return {\n                position: newPos,\n                unitsMoved: unitsMoved\n            };\n        }\n\n        function createRangeCharacterIterator(session, range, characterOptions, backward) {\n            var rangeStart = session.getRangeBoundaryPosition(range, true);\n            var rangeEnd = session.getRangeBoundaryPosition(range, false);\n            var itStart = backward ? rangeEnd : rangeStart;\n            var itEnd = backward ? rangeStart : rangeEnd;\n\n            return createCharacterIterator(itStart, !!backward, itEnd, characterOptions);\n        }\n\n        function getRangeCharacters(session, range, characterOptions) {\n\n            var chars = [], it = createRangeCharacterIterator(session, range, characterOptions), pos;\n            while ( (pos = it.next()) ) {\n                chars.push(pos);\n            }\n\n            it.dispose();\n            return chars;\n        }\n\n        function isWholeWord(startPos, endPos, wordOptions) {\n            var range = api.createRange(startPos.node);\n            range.setStartAndEnd(startPos.node, startPos.offset, endPos.node, endPos.offset);\n            return !range.expand(\"word\", { wordOptions: wordOptions });\n        }\n\n        function findTextFromPosition(initialPos, searchTerm, isRegex, searchScopeRange, findOptions) {\n            var backward = isDirectionBackward(findOptions.direction);\n            var it = createCharacterIterator(\n                initialPos,\n                backward,\n                initialPos.session.getRangeBoundaryPosition(searchScopeRange, backward),\n                findOptions.characterOptions\n            );\n            var text = \"\", chars = [], pos, currentChar, matchStartIndex, matchEndIndex;\n            var result, insideRegexMatch;\n            var returnValue = null;\n\n            function handleMatch(startIndex, endIndex) {\n                var startPos = chars[startIndex].previousVisible();\n                var endPos = chars[endIndex - 1];\n                var valid = (!findOptions.wholeWordsOnly || isWholeWord(startPos, endPos, findOptions.wordOptions));\n\n                return {\n                    startPos: startPos,\n                    endPos: endPos,\n                    valid: valid\n                };\n            }\n\n            while ( (pos = it.next()) ) {\n                currentChar = pos.character;\n                if (!isRegex && !findOptions.caseSensitive) {\n                    currentChar = currentChar.toLowerCase();\n                }\n\n                if (backward) {\n                    chars.unshift(pos);\n                    text = currentChar + text;\n                } else {\n                    chars.push(pos);\n                    text += currentChar;\n                }\n\n                if (isRegex) {\n                    result = searchTerm.exec(text);\n                    if (result) {\n                        matchStartIndex = result.index;\n                        matchEndIndex = matchStartIndex + result[0].length;\n                        if (insideRegexMatch) {\n                            // Check whether the match is now over\n                            if ((!backward && matchEndIndex < text.length) || (backward && matchStartIndex > 0)) {\n                                returnValue = handleMatch(matchStartIndex, matchEndIndex);\n                                break;\n                            }\n                        } else {\n                            insideRegexMatch = true;\n                        }\n                    }\n                } else if ( (matchStartIndex = text.indexOf(searchTerm)) != -1 ) {\n                    returnValue = handleMatch(matchStartIndex, matchStartIndex + searchTerm.length);\n                    break;\n                }\n            }\n\n            // Check whether regex match extends to the end of the range\n            if (insideRegexMatch) {\n                returnValue = handleMatch(matchStartIndex, matchEndIndex);\n            }\n            it.dispose();\n\n            return returnValue;\n        }\n\n        function createEntryPointFunction(func) {\n            return function() {\n                var sessionRunning = !!currentSession;\n                var session = getSession();\n                var args = [session].concat( util.toArray(arguments) );\n                var returnValue = func.apply(this, args);\n                if (!sessionRunning) {\n                    endSession();\n                }\n                return returnValue;\n            };\n        }\n\n        /*----------------------------------------------------------------------------------------------------------------*/\n\n        // Extensions to the Rangy Range object\n\n        function createRangeBoundaryMover(isStart, collapse) {\n            /*\n             Unit can be \"character\" or \"word\"\n             Options:\n\n             - includeTrailingSpace\n             - wordRegex\n             - tokenizer\n             - collapseSpaceBeforeLineBreak\n             */\n            return createEntryPointFunction(\n                function(session, unit, count, moveOptions) {\n                    if (typeof count == UNDEF) {\n                        count = unit;\n                        unit = CHARACTER;\n                    }\n                    moveOptions = createNestedOptions(moveOptions, defaultMoveOptions);\n\n                    var boundaryIsStart = isStart;\n                    if (collapse) {\n                        boundaryIsStart = (count >= 0);\n                        this.collapse(!boundaryIsStart);\n                    }\n                    var moveResult = movePositionBy(session.getRangeBoundaryPosition(this, boundaryIsStart), unit, count, moveOptions.characterOptions, moveOptions.wordOptions);\n                    var newPos = moveResult.position;\n                    this[boundaryIsStart ? \"setStart\" : \"setEnd\"](newPos.node, newPos.offset);\n                    return moveResult.unitsMoved;\n                }\n            );\n        }\n\n        function createRangeTrimmer(isStart) {\n            return createEntryPointFunction(\n                function(session, characterOptions) {\n                    characterOptions = createOptions(characterOptions, defaultCharacterOptions);\n                    var pos;\n                    var it = createRangeCharacterIterator(session, this, characterOptions, !isStart);\n                    var trimCharCount = 0;\n                    while ( (pos = it.next()) && allWhiteSpaceRegex.test(pos.character) ) {\n                        ++trimCharCount;\n                    }\n                    it.dispose();\n                    var trimmed = (trimCharCount > 0);\n                    if (trimmed) {\n                        this[isStart ? \"moveStart\" : \"moveEnd\"](\n                            \"character\",\n                            isStart ? trimCharCount : -trimCharCount,\n                            { characterOptions: characterOptions }\n                        );\n                    }\n                    return trimmed;\n                }\n            );\n        }\n\n        extend(api.rangePrototype, {\n            moveStart: createRangeBoundaryMover(true, false),\n\n            moveEnd: createRangeBoundaryMover(false, false),\n\n            move: createRangeBoundaryMover(true, true),\n\n            trimStart: createRangeTrimmer(true),\n\n            trimEnd: createRangeTrimmer(false),\n\n            trim: createEntryPointFunction(\n                function(session, characterOptions) {\n                    var startTrimmed = this.trimStart(characterOptions), endTrimmed = this.trimEnd(characterOptions);\n                    return startTrimmed || endTrimmed;\n                }\n            ),\n\n            expand: createEntryPointFunction(\n                function(session, unit, expandOptions) {\n                    var moved = false;\n                    expandOptions = createNestedOptions(expandOptions, defaultExpandOptions);\n                    var characterOptions = expandOptions.characterOptions;\n                    if (!unit) {\n                        unit = CHARACTER;\n                    }\n                    if (unit == WORD) {\n                        var wordOptions = expandOptions.wordOptions;\n                        var startPos = session.getRangeBoundaryPosition(this, true);\n                        var endPos = session.getRangeBoundaryPosition(this, false);\n\n                        var startTokenizedTextProvider = createTokenizedTextProvider(startPos, characterOptions, wordOptions);\n                        var startToken = startTokenizedTextProvider.nextEndToken();\n                        var newStartPos = startToken.chars[0].previousVisible();\n                        var endToken, newEndPos;\n\n                        if (this.collapsed) {\n                            endToken = startToken;\n                        } else {\n                            var endTokenizedTextProvider = createTokenizedTextProvider(endPos, characterOptions, wordOptions);\n                            endToken = endTokenizedTextProvider.previousStartToken();\n                        }\n                        newEndPos = endToken.chars[endToken.chars.length - 1];\n\n                        if (!newStartPos.equals(startPos)) {\n                            this.setStart(newStartPos.node, newStartPos.offset);\n                            moved = true;\n                        }\n                        if (newEndPos && !newEndPos.equals(endPos)) {\n                            this.setEnd(newEndPos.node, newEndPos.offset);\n                            moved = true;\n                        }\n\n                        if (expandOptions.trim) {\n                            if (expandOptions.trimStart) {\n                                moved = this.trimStart(characterOptions) || moved;\n                            }\n                            if (expandOptions.trimEnd) {\n                                moved = this.trimEnd(characterOptions) || moved;\n                            }\n                        }\n\n                        return moved;\n                    } else {\n                        return this.moveEnd(CHARACTER, 1, expandOptions);\n                    }\n                }\n            ),\n\n            text: createEntryPointFunction(\n                function(session, characterOptions) {\n                    return this.collapsed ?\n                        \"\" : getRangeCharacters(session, this, createOptions(characterOptions, defaultCharacterOptions)).join(\"\");\n                }\n            ),\n\n            selectCharacters: createEntryPointFunction(\n                function(session, containerNode, startIndex, endIndex, characterOptions) {\n                    var moveOptions = { characterOptions: characterOptions };\n                    if (!containerNode) {\n                        containerNode = getBody( this.getDocument() );\n                    }\n                    this.selectNodeContents(containerNode);\n                    this.collapse(true);\n                    this.moveStart(\"character\", startIndex, moveOptions);\n                    this.collapse(true);\n                    this.moveEnd(\"character\", endIndex - startIndex, moveOptions);\n                }\n            ),\n\n            // Character indexes are relative to the start of node\n            toCharacterRange: createEntryPointFunction(\n                function(session, containerNode, characterOptions) {\n                    if (!containerNode) {\n                        containerNode = getBody( this.getDocument() );\n                    }\n                    var parent = containerNode.parentNode, nodeIndex = dom.getNodeIndex(containerNode);\n                    var rangeStartsBeforeNode = (dom.comparePoints(this.startContainer, this.endContainer, parent, nodeIndex) == -1);\n                    var rangeBetween = this.cloneRange();\n                    var startIndex, endIndex;\n                    if (rangeStartsBeforeNode) {\n                        rangeBetween.setStartAndEnd(this.startContainer, this.startOffset, parent, nodeIndex);\n                        startIndex = -rangeBetween.text(characterOptions).length;\n                    } else {\n                        rangeBetween.setStartAndEnd(parent, nodeIndex, this.startContainer, this.startOffset);\n                        startIndex = rangeBetween.text(characterOptions).length;\n                    }\n                    endIndex = startIndex + this.text(characterOptions).length;\n\n                    return {\n                        start: startIndex,\n                        end: endIndex\n                    };\n                }\n            ),\n\n            findText: createEntryPointFunction(\n                function(session, searchTermParam, findOptions) {\n                    // Set up options\n                    findOptions = createNestedOptions(findOptions, defaultFindOptions);\n\n                    // Create word options if we're matching whole words only\n                    if (findOptions.wholeWordsOnly) {\n                        // We don't ever want trailing spaces for search results\n                        findOptions.wordOptions.includeTrailingSpace = false;\n                    }\n\n                    var backward = isDirectionBackward(findOptions.direction);\n\n                    // Create a range representing the search scope if none was provided\n                    var searchScopeRange = findOptions.withinRange;\n                    if (!searchScopeRange) {\n                        searchScopeRange = api.createRange();\n                        searchScopeRange.selectNodeContents(this.getDocument());\n                    }\n\n                    // Examine and prepare the search term\n                    var searchTerm = searchTermParam, isRegex = false;\n                    if (typeof searchTerm == \"string\") {\n                        if (!findOptions.caseSensitive) {\n                            searchTerm = searchTerm.toLowerCase();\n                        }\n                    } else {\n                        isRegex = true;\n                    }\n\n                    var initialPos = session.getRangeBoundaryPosition(this, !backward);\n\n                    // Adjust initial position if it lies outside the search scope\n                    var comparison = searchScopeRange.comparePoint(initialPos.node, initialPos.offset);\n\n                    if (comparison === -1) {\n                        initialPos = session.getRangeBoundaryPosition(searchScopeRange, true);\n                    } else if (comparison === 1) {\n                        initialPos = session.getRangeBoundaryPosition(searchScopeRange, false);\n                    }\n\n                    var pos = initialPos;\n                    var wrappedAround = false;\n\n                    // Try to find a match and ignore invalid ones\n                    var findResult;\n                    while (true) {\n                        findResult = findTextFromPosition(pos, searchTerm, isRegex, searchScopeRange, findOptions);\n\n                        if (findResult) {\n                            if (findResult.valid) {\n                                this.setStartAndEnd(findResult.startPos.node, findResult.startPos.offset, findResult.endPos.node, findResult.endPos.offset);\n                                return true;\n                            } else {\n                                // We've found a match that is not a whole word, so we carry on searching from the point immediately\n                                // after the match\n                                pos = backward ? findResult.startPos : findResult.endPos;\n                            }\n                        } else if (findOptions.wrap && !wrappedAround) {\n                            // No result found but we're wrapping around and limiting the scope to the unsearched part of the range\n                            searchScopeRange = searchScopeRange.cloneRange();\n                            pos = session.getRangeBoundaryPosition(searchScopeRange, !backward);\n                            searchScopeRange.setBoundary(initialPos.node, initialPos.offset, backward);\n                            wrappedAround = true;\n                        } else {\n                            // Nothing found and we can't wrap around, so we're done\n                            return false;\n                        }\n                    }\n                }\n            ),\n\n            pasteHtml: function(html) {\n                this.deleteContents();\n                if (html) {\n                    var frag = this.createContextualFragment(html);\n                    var lastChild = frag.lastChild;\n                    this.insertNode(frag);\n                    this.collapseAfter(lastChild);\n                }\n            }\n        });\n\n        /*----------------------------------------------------------------------------------------------------------------*/\n\n        // Extensions to the Rangy Selection object\n\n        function createSelectionTrimmer(methodName) {\n            return createEntryPointFunction(\n                function(session, characterOptions) {\n                    var trimmed = false;\n                    this.changeEachRange(function(range) {\n                        trimmed = range[methodName](characterOptions) || trimmed;\n                    });\n                    return trimmed;\n                }\n            );\n        }\n\n        extend(api.selectionPrototype, {\n            expand: createEntryPointFunction(\n                function(session, unit, expandOptions) {\n                    this.changeEachRange(function(range) {\n                        range.expand(unit, expandOptions);\n                    });\n                }\n            ),\n\n            move: createEntryPointFunction(\n                function(session, unit, count, options) {\n                    var unitsMoved = 0;\n                    if (this.focusNode) {\n                        this.collapse(this.focusNode, this.focusOffset);\n                        var range = this.getRangeAt(0);\n                        if (!options) {\n                            options = {};\n                        }\n                        options.characterOptions = createOptions(options.characterOptions, defaultCaretCharacterOptions);\n                        unitsMoved = range.move(unit, count, options);\n                        this.setSingleRange(range);\n                    }\n                    return unitsMoved;\n                }\n            ),\n\n            trimStart: createSelectionTrimmer(\"trimStart\"),\n            trimEnd: createSelectionTrimmer(\"trimEnd\"),\n            trim: createSelectionTrimmer(\"trim\"),\n\n            selectCharacters: createEntryPointFunction(\n                function(session, containerNode, startIndex, endIndex, direction, characterOptions) {\n                    var range = api.createRange(containerNode);\n                    range.selectCharacters(containerNode, startIndex, endIndex, characterOptions);\n                    this.setSingleRange(range, direction);\n                }\n            ),\n\n            saveCharacterRanges: createEntryPointFunction(\n                function(session, containerNode, characterOptions) {\n                    var ranges = this.getAllRanges(), rangeCount = ranges.length;\n                    var rangeInfos = [];\n\n                    var backward = rangeCount == 1 && this.isBackward();\n\n                    for (var i = 0, len = ranges.length; i < len; ++i) {\n                        rangeInfos[i] = {\n                            characterRange: ranges[i].toCharacterRange(containerNode, characterOptions),\n                            backward: backward,\n                            characterOptions: characterOptions\n                        };\n                    }\n\n                    return rangeInfos;\n                }\n            ),\n\n            restoreCharacterRanges: createEntryPointFunction(\n                function(session, containerNode, saved) {\n                    this.removeAllRanges();\n                    for (var i = 0, len = saved.length, range, rangeInfo, characterRange; i < len; ++i) {\n                        rangeInfo = saved[i];\n                        characterRange = rangeInfo.characterRange;\n                        range = api.createRange(containerNode);\n                        range.selectCharacters(containerNode, characterRange.start, characterRange.end, rangeInfo.characterOptions);\n                        this.addRange(range, rangeInfo.backward);\n                    }\n                }\n            ),\n\n            text: createEntryPointFunction(\n                function(session, characterOptions) {\n                    var rangeTexts = [];\n                    for (var i = 0, len = this.rangeCount; i < len; ++i) {\n                        rangeTexts[i] = this.getRangeAt(i).text(characterOptions);\n                    }\n                    return rangeTexts.join(\"\");\n                }\n            )\n        });\n\n        /*----------------------------------------------------------------------------------------------------------------*/\n\n        // Extensions to the core rangy object\n\n        api.innerText = function(el, characterOptions) {\n            var range = api.createRange(el);\n            range.selectNodeContents(el);\n            var text = range.text(characterOptions);\n            return text;\n        };\n\n        api.createWordIterator = function(startNode, startOffset, iteratorOptions) {\n            var session = getSession();\n            iteratorOptions = createNestedOptions(iteratorOptions, defaultWordIteratorOptions);\n            var startPos = session.getPosition(startNode, startOffset);\n            var tokenizedTextProvider = createTokenizedTextProvider(startPos, iteratorOptions.characterOptions, iteratorOptions.wordOptions);\n            var backward = isDirectionBackward(iteratorOptions.direction);\n\n            return {\n                next: function() {\n                    return backward ? tokenizedTextProvider.previousStartToken() : tokenizedTextProvider.nextEndToken();\n                },\n\n                dispose: function() {\n                    tokenizedTextProvider.dispose();\n                    this.next = function() {};\n                }\n            };\n        };\n\n        /*----------------------------------------------------------------------------------------------------------------*/\n\n        api.noMutation = function(func) {\n            var session = getSession();\n            func(session);\n            endSession();\n        };\n\n        api.noMutation.createEntryPointFunction = createEntryPointFunction;\n\n        api.textRange = {\n            isBlockNode: isBlockNode,\n            isCollapsedWhitespaceNode: isCollapsedWhitespaceNode,\n\n            createPosition: createEntryPointFunction(\n                function(session, node, offset) {\n                    return session.getPosition(node, offset);\n                }\n            )\n        };\n    });\n    \n    return rangy;\n}, this);","import config from \"trix/config\"\n\nimport { triggerEvent } from \"event_helpers\"\nimport { defer } from \"trix/core/helpers\"\nimport { selectionChangeObserver } from \"trix/observers/selection_change_observer\"\n\nimport rangy from \"rangy\"\nimport \"rangy/lib/rangy-textrange\"\n\nwindow.rangy = rangy\n\nconst keyCodes = {}\nfor (const code in config.keyNames) {\n  const name = config.keyNames[code]\n  keyCodes[name] = code\n}\n\nconst keys = {\n  left: \"ArrowLeft\",\n  right: \"ArrowRight\",\n}\n\nexport const moveCursor = function (options, callback) {\n  let direction, move, times\n  if (typeof options === \"string\") {\n    direction = options\n  } else {\n    times = options.times\n    direction = options.direction\n  }\n\n  if (!times) times = 1\n\n  return (move = () =>\n    defer(() => {\n      if (triggerEvent(document.activeElement, \"keydown\", { keyCode: keyCodes[direction], key: keys[direction] })) {\n        const selection = rangy.getSelection()\n        selection.move(\"character\", direction === \"right\" ? 1 : -1)\n        selectionChangeObserver.update()\n      }\n\n      if (--times === 0) {\n        defer(() => callback(getCursorCoordinates()))\n      } else {\n        return move()\n      }\n    }))()\n}\n\nexport const expandSelection = (options, callback) =>\n  defer(() => {\n    let direction, expand, times\n    if (typeof options === \"string\") {\n      direction = options\n    } else {\n      ({ direction } = options)\n      times = options.times\n    }\n\n    if (!times) times = 1\n\n    return (expand = () =>\n      defer(() => {\n        if (triggerEvent(document.activeElement, \"keydown\", { keyCode: keyCodes[direction], key: keys[direction], shiftKey: true })) {\n          getComposition().expandSelectionInDirection(direction === \"left\" ? \"backward\" : \"forward\")\n        }\n\n        if (--times === 0) {\n          defer(callback)\n        } else {\n          return expand()\n        }\n      }))()\n  })\n\nexport const collapseSelection = function (direction, callback) {\n  const selection = rangy.getSelection()\n  if (direction === \"left\") {\n    selection.collapseToStart()\n  } else {\n    selection.collapseToEnd()\n  }\n  selectionChangeObserver.update()\n  defer(callback)\n}\n\nexport const selectAll = function (callback) {\n  rangy.getSelection().selectAllChildren(document.activeElement)\n  selectionChangeObserver.update()\n  defer(callback)\n}\n\nexport const deleteSelection = () => {\n  const selection = rangy.getSelection()\n  selection.getRangeAt(0).deleteContents()\n  selectionChangeObserver.update()\n}\n\nexport const selectionIsCollapsed = () => rangy.getSelection().isCollapsed\n\nexport const insertNode = function (node, callback) {\n  const selection = rangy.getSelection()\n  const range = selection.getRangeAt(0)\n  range.splitBoundaries()\n  range.insertNode(node)\n  range.setStartAfter(node)\n  range.deleteContents()\n  selection.setSingleRange(range)\n  selectionChangeObserver.update()\n  if (callback) {\n    requestAnimationFrame(callback)\n  }\n}\n\nexport const selectNode = function (node, callback) {\n  const selection = rangy.getSelection()\n  selection.selectAllChildren(node)\n  selectionChangeObserver.update()\n  if (callback) callback()\n}\n\nexport const createDOMRangeFromPoint = function (px, py) {\n  if (document.caretPositionFromPoint) {\n    const { offsetNode, offset } = document.caretPositionFromPoint(px, py)\n    const domRange = document.createRange()\n    domRange.setStart(offsetNode, offset)\n    return domRange\n  } else if (document.caretRangeFromPoint) {\n    return document.caretRangeFromPoint(px, py)\n  }\n}\n\nconst getCursorCoordinates = () => {\n  const rect = window.getSelection().getRangeAt(0).getClientRects()[0]\n  if (rect) {\n    return {\n      clientX: rect.left,\n      clientY: rect.top + rect.height / 2,\n    }\n  }\n}\n","import config from \"trix/config\"\nimport { defer } from \"trix/core/helpers\"\nimport { triggerEvent } from \"./event_helpers\"\nimport {\n  collapseSelection,\n  createDOMRangeFromPoint,\n  deleteSelection,\n  insertNode,\n  selectNode,\n  selectionIsCollapsed,\n} from \"./selection_helpers\"\n\nconst keyCodes = {}\n\nObject.keys(config.keyNames).forEach(code => {\n  const name = config.keyNames[code]\n  keyCodes[name] = code\n})\n\nconst isIE = /Windows.*Trident/.test(navigator.userAgent)\n\nexport const triggerInputEvent = function (element, type, properties = {}) {\n  if (config.input.getLevel() === 2) {\n    let ranges\n    if (properties.ranges) {\n      ({ ranges } = properties)\n      delete properties.ranges\n    } else {\n      ranges = []\n      const selection = window.getSelection()\n      if (selection.rangeCount > 0) {\n        ranges.push(selection.getRangeAt(0).cloneRange())\n      }\n    }\n    properties.getTargetRanges = () => ranges\n    triggerEvent(element, type, properties)\n  }\n}\n\nexport const pasteContent = function (contentType, value, callback) {\n  let data\n\n  if (typeof contentType === \"object\") {\n    data = contentType\n    callback = value\n  } else {\n    data = { [contentType]: value }\n  }\n\n  const testClipboardData = {\n    getData: (type) => data[type],\n    types: Object.keys(data),\n    items: Object.values(data),\n  }\n\n  if (testClipboardData.types.includes(\"Files\")) {\n    testClipboardData.files = testClipboardData.items\n  }\n\n  triggerInputEvent(document.activeElement, \"beforeinput\", {\n    inputType: \"insertFromPaste\",\n    dataTransfer: testClipboardData,\n  })\n\n  triggerEvent(document.activeElement, \"paste\", { testClipboardData })\n\n  if (callback) {\n    requestAnimationFrame (callback)\n  }\n}\n\nexport const createFile = function (properties = {}) {\n  const file = {\n    getAsFile() {\n      return {}\n    },\n  }\n  for (const key in properties) {\n    const value = properties[key]\n    file[key] = value\n  }\n  return file\n}\n\nexport const typeCharacters = function (string, callback) {\n  let characters, typeNextCharacter\n  if (Array.isArray(string)) {\n    characters = string\n  } else {\n    characters = string.split(\"\")\n  }\n\n  return (typeNextCharacter = () =>\n    defer(function () {\n      const character = characters.shift()\n      if (character != null) {\n        switch (character) {\n          case \"\\n\":\n            return pressKey(\"return\", typeNextCharacter)\n          case \"\\b\":\n            return pressKey(\"backspace\", typeNextCharacter)\n          default:\n            return typeCharacterInElement(character, document.activeElement, typeNextCharacter)\n        }\n      } else {\n        return callback()\n      }\n    }))()\n}\n\nexport const pressKey = function (keyName, callback) {\n  const element = document.activeElement\n  const code = keyCodes[keyName]\n  const properties = { which: code, keyCode: code, charCode: 0, key: capitalize(keyName) }\n\n  if (!triggerEvent(element, \"keydown\", properties)) {\n    return callback()\n  }\n\n  return simulateKeypress(keyName, () =>\n    defer(function () {\n      triggerEvent(element, \"keyup\", properties)\n      defer(callback)\n    })\n  )\n}\n\nexport const startComposition = function (data, callback) {\n  const element = document.activeElement\n  triggerEvent(element, \"compositionstart\", { data: \"\" })\n  triggerInputEvent(element, \"beforeinput\", { inputType: \"insertCompositionText\", data })\n  triggerEvent(element, \"compositionupdate\", { data })\n  triggerEvent(element, \"input\")\n\n  const node = document.createTextNode(data)\n  insertNode(node)\n  selectNode(node, callback)\n}\n\nexport const updateComposition = function (data, callback) {\n  const element = document.activeElement\n  triggerInputEvent(element, \"beforeinput\", { inputType: \"insertCompositionText\", data })\n  triggerEvent(element, \"compositionupdate\", { data })\n  triggerEvent(element, \"input\")\n\n  const node = document.createTextNode(data)\n  insertNode(node)\n  selectNode(node, callback)\n}\n\nexport const endComposition = function (data, callback) {\n  const element = document.activeElement\n  triggerInputEvent(element, \"beforeinput\", { inputType: \"insertCompositionText\", data })\n  triggerEvent(element, \"compositionupdate\", { data })\n\n  const node = document.createTextNode(data)\n  insertNode(node)\n  selectNode(node)\n  collapseSelection(\"right\", function () {\n    triggerEvent(element, \"input\")\n    triggerEvent(element, \"compositionend\", { data })\n    requestAnimationFrame (callback)\n  })\n}\n\nexport const clickElement = function (element, callback) {\n  if (triggerEvent(element, \"mousedown\")) {\n    defer(function () {\n      if (triggerEvent(element, \"mouseup\")) {\n        defer(function () {\n          triggerEvent(element, \"click\")\n          defer(callback)\n        })\n      }\n    })\n  }\n}\n\nexport const dragToCoordinates = function (coordinates, callback) {\n  const element = document.activeElement\n\n  // IE only allows writing \"text\" to DataTransfer\n  // https://msdn.microsoft.com/en-us/library/ms536744(v=vs.85).aspx\n  const dataTransfer = {\n    files: [],\n    data: {},\n    getData(format) {\n      if (isIE && format.toLowerCase() !== \"text\") {\n        throw new Error(\"Invalid argument.\")\n      } else {\n        this.data[format]\n        return true\n      }\n    },\n    setData(format, data) {\n      if (isIE && format.toLowerCase() !== \"text\") {\n        throw new Error(\"Unexpected call to method or property access.\")\n      } else {\n        this.data[format] = data\n      }\n    },\n  }\n\n  triggerEvent(element, \"mousemove\")\n\n  const dragstartData = { dataTransfer }\n  triggerEvent(element, \"dragstart\", dragstartData)\n  triggerInputEvent(element, \"beforeinput\", { inputType: \"deleteByDrag\" })\n\n  const dropData = { dataTransfer }\n  for (const key in coordinates) {\n    const value = coordinates[key]\n    dropData[key] = value\n  }\n  triggerEvent(element, \"drop\", dropData)\n\n  const { clientX, clientY } = coordinates\n  const domRange = createDOMRangeFromPoint(clientX, clientY)\n  triggerInputEvent(element, \"beforeinput\", { inputType: \"insertFromDrop\", ranges: [ domRange ] })\n\n  defer(callback)\n}\n\nexport const mouseDownOnElementAndMove = function (element, distance, callback) {\n  const coordinates = getElementCoordinates(element)\n  triggerEvent(element, \"mousedown\", coordinates)\n\n  const destination = (offset) => ({\n    clientX: coordinates.clientX + offset,\n    clientY: coordinates.clientY + offset,\n  })\n\n  const dragSpeed = 20\n\n  return after(dragSpeed, function () {\n    let drag\n    let offset = 0\n    return (drag = () => {\n      if (++offset <= distance) {\n        triggerEvent(element, \"mousemove\", destination(offset))\n        return after(dragSpeed, drag)\n      } else {\n        triggerEvent(element, \"mouseup\", destination(distance))\n        return after(dragSpeed, callback)\n      }\n    })()\n  })\n}\n\nconst typeCharacterInElement = function (character, element, callback) {\n  const charCode = character.charCodeAt(0)\n  const keyCode = character.toUpperCase().charCodeAt(0)\n\n  if (!triggerEvent(element, \"keydown\", { keyCode, charCode: 0 })) {\n    return callback()\n  }\n\n  defer(function () {\n    if (!triggerEvent(element, \"keypress\", { keyCode: charCode, charCode })) {\n      return callback()\n    }\n    triggerInputEvent(element, \"beforeinput\", { inputType: \"insertText\", data: character })\n    return insertCharacter(character, function () {\n      triggerEvent(element, \"input\")\n\n      defer(function () {\n        triggerEvent(element, \"keyup\", { keyCode, charCode: 0 })\n        return callback()\n      })\n    })\n  })\n}\n\nconst insertCharacter = function (character, callback) {\n  const node = document.createTextNode(character)\n  return insertNode(node, callback)\n}\n\nconst simulateKeypress = function (keyName, callback) {\n  switch (keyName) {\n    case \"backspace\":\n      return deleteInDirection(\"left\", callback)\n    case \"delete\":\n      return deleteInDirection(\"right\", callback)\n    case \"return\":\n      defer(function () {\n        triggerInputEvent(document.activeElement, \"beforeinput\", { inputType: \"insertParagraph\" })\n        const node = document.createElement(\"br\")\n        return insertNode(node, callback)\n      })\n  }\n}\n\nconst deleteInDirection = function (direction, callback) {\n  if (selectionIsCollapsed()) {\n    getComposition().expandSelectionInDirection(direction === \"left\" ? \"backward\" : \"forward\")\n    defer(function () {\n      const inputType = direction === \"left\" ? \"deleteContentBackward\" : \"deleteContentForward\"\n      triggerInputEvent(document.activeElement, \"beforeinput\", { inputType })\n      defer(function () {\n        deleteSelection()\n        return callback()\n      })\n    })\n  } else {\n    triggerInputEvent(document.activeElement, \"beforeinput\", { inputType: \"deleteContentBackward\" })\n    deleteSelection()\n    return callback()\n  }\n}\n\nconst getElementCoordinates = function (element) {\n  const rect = element.getBoundingClientRect()\n  return {\n    clientX: rect.left + rect.width / 2,\n    clientY: rect.top + rect.height / 2,\n  }\n}\n\nconst capitalize = (string) => string.charAt(0).toUpperCase() + string.slice(1)\n","import { TEST_IMAGE_URL } from \"test/test_helpers/fixtures/test_image_url\"\nimport Attachment from \"trix/models/attachment\"\n\nexport const insertString = function (string) {\n  getComposition().insertString(string)\n  render()\n}\n\nexport const insertText = function (text) {\n  getComposition().insertText(text)\n  render()\n}\n\nexport const insertDocument = function (document) {\n  getComposition().insertDocument(document)\n  render()\n}\n\nexport const insertFile = function (file) {\n  getComposition().insertFile(file)\n  render()\n}\n\nexport const insertAttachment = function (attachment) {\n  getComposition().insertAttachment(attachment)\n  render()\n}\n\nexport const insertAttachments = function (attachments) {\n  getComposition().insertAttachments(attachments)\n  render()\n}\n\nexport const insertImageAttachment = function (attributes) {\n  const attachment = createImageAttachment(attributes)\n  return insertAttachment(attachment)\n}\n\nexport const createImageAttachment = function (attributes) {\n  if (!attributes) {\n    attributes = {\n      url: TEST_IMAGE_URL,\n      width: 10,\n      height: 10,\n      filename: \"image.gif\",\n      filesize: 35,\n      contentType: \"image/gif\",\n    }\n  }\n\n  return new Attachment(attributes)\n}\n\nexport const replaceDocument = function (document) {\n  getComposition().setDocument(document)\n  render()\n}\n\nconst render = () => getEditorController().render()\n","import { defer } from \"trix/core/helpers\"\nimport { triggerEvent } from \"./event_helpers\"\nimport { selectionChangeObserver } from \"trix/observers/selection_change_observer\"\n\nexport const clickToolbarButton = function (selector, callback) {\n  selectionChangeObserver.update()\n  const button = getToolbarButton(selector)\n  triggerEvent(button, \"mousedown\")\n  defer(callback)\n}\n\nexport const typeToolbarKeyCommand = function (selector, callback) {\n  const button = getToolbarButton(selector)\n  const { trixKey } = button.dataset\n  if (trixKey) {\n    const keyCode = trixKey.toUpperCase().charCodeAt(0)\n    triggerEvent(getEditorElement(), \"keydown\", { keyCode, charCode: 0, metaKey: true, ctrlKey: true })\n  }\n  defer(callback)\n}\n\nexport const clickToolbarDialogButton = function ({ method }, callback) {\n  const button = getToolbarElement().querySelector(`[data-trix-dialog] [data-trix-method='${method}']`)\n  triggerEvent(button, \"click\")\n  defer(callback)\n}\n\nexport const isToolbarButtonActive = function (selector) {\n  const button = getToolbarButton(selector)\n  return button.hasAttribute(\"data-trix-active\") && button.classList.contains(\"trix-active\")\n}\n\nexport const isToolbarButtonDisabled = (selector) => getToolbarButton(selector).disabled\n\nexport const typeInToolbarDialog = function (string, { attribute }, callback) {\n  const dialog = getToolbarDialog({ attribute })\n  const input = dialog.querySelector(`[data-trix-input][name='${attribute}']`)\n  const button = dialog.querySelector(\"[data-trix-method='setAttribute']\")\n  input.value = string\n  triggerEvent(button, \"click\")\n  defer(callback)\n}\n\nexport const isToolbarDialogActive = function (selector) {\n  const dialog = getToolbarDialog(selector)\n  return dialog.hasAttribute(\"data-trix-active\") && dialog.classList.contains(\"trix-active\")\n}\n\nconst getToolbarButton = ({ attribute, action }) =>\n  getToolbarElement().querySelector(`[data-trix-attribute='${attribute}'], [data-trix-action='${action}']`)\n\nconst getToolbarDialog = ({ attribute, action }) => getToolbarElement().querySelector(`[data-trix-dialog='${attribute}']`)\n","import config from \"trix/config\"\n\nexport * from \"trix/core/helpers/functions\"\nexport * from \"trix/core/helpers/global\"\nexport * from \"./test_helpers/event_helpers\"\nexport * from \"./test_helpers/assertions\"\nexport * from \"./test_helpers/test_helpers\"\nexport * from \"./test_helpers/test_stubs\"\nexport * from \"./test_helpers/functions\"\nexport * from \"./test_helpers/fixtures/fixtures\"\nexport * from \"./test_helpers/event_helpers\"\nexport * from \"./test_helpers/input_helpers\"\nexport * from \"./test_helpers/editor_helpers\"\nexport * from \"./test_helpers/toolbar_helpers\"\nexport * from \"./test_helpers/selection_helpers\"\n\nconfig.undoInterval = 0\n\nQUnit.config.hidepassed = true\nQUnit.config.testTimeout = 20000\n\ndocument.head.insertAdjacentHTML(\n  \"beforeend\",\n  `\\\n<style type=\"text/css\">\n  #trix-container { height: 150px; }\n  trix-toolbar { margin-bottom: 10px; }\n  trix-toolbar button { border: 1px solid #ccc; background: #fff; }\n  trix-toolbar button.active { background: #d3e6fd; }\n  trix-toolbar button:disabled { color: #ccc; }\n</style>\\\n`\n)\n","import { assert, test, testGroup } from \"test/test_helper\"\nimport Attachment from \"trix/models/attachment\"\n\ntestGroup(\"Attachment\", () => {\n  const previewableTypes = \"image image/gif image/png image/jpg\".split(\" \")\n  const nonPreviewableTypes = \"image/tiff application/foo\".split(\" \")\n\n  const createAttachment = (attributes) => new Attachment(attributes)\n\n  previewableTypes.forEach((contentType) => {\n    test(`${contentType} content type is previewable`, () => {\n      assert.ok(createAttachment({ contentType }).isPreviewable())\n    })\n  })\n\n  nonPreviewableTypes.forEach((contentType) => {\n    test(`${contentType} content type is NOT previewable`, () => {\n      assert.notOk(createAttachment({ contentType }).isPreviewable())\n    })\n  })\n\n  test(\"'previewable' attribute determines previewability\", () => {\n    let attrs = { previewable: true, contentType: nonPreviewableTypes[0] }\n    assert.ok(createAttachment(attrs).isPreviewable())\n\n    attrs = { previewable: false, contentType: previewableTypes[0] }\n    assert.notOk(createAttachment(attrs).isPreviewable())\n  })\n})\n","import { assert, test, testGroup } from \"test/test_helper\"\n\nimport Text from \"trix/models/text\"\nimport Block from \"trix/models/block\"\n\ntestGroup(\"Block\", () => {\n  test(\"consolidating blocks creates text with one blockBreak piece\", () => {\n    const blockA = new Block(Text.textForStringWithAttributes(\"a\"))\n    const blockB = new Block(Text.textForStringWithAttributes(\"b\"))\n    const consolidatedBlock = blockA.consolidateWith(blockB)\n    const pieces = consolidatedBlock.text.getPieces()\n\n    assert.equal(pieces.length, 2, JSON.stringify(pieces))\n    assert.deepEqual(pieces[0].getAttributes(), {})\n    assert.deepEqual(pieces[1].getAttributes(), { blockBreak: true })\n    assert.equal(consolidatedBlock.toString(), \"a\\nb\\n\")\n  })\n\n  test(\"consolidating empty blocks creates text with one blockBreak piece\", () => {\n    const consolidatedBlock = new Block().consolidateWith(new Block())\n    const pieces = consolidatedBlock.text.getPieces()\n\n    assert.equal(pieces.length, 2, JSON.stringify(pieces))\n    assert.deepEqual(pieces[0].getAttributes(), {})\n    assert.deepEqual(pieces[1].getAttributes(), { blockBreak: true })\n    assert.equal(consolidatedBlock.toString(), \"\\n\\n\")\n  })\n})\n","import { assert, test, testGroup } from \"test/test_helper\"\n\nimport Composition from \"trix/models/composition\"\nimport { TestCompositionDelegate } from \"test/test_helpers/test_stubs\"\n\nlet composition = null\nconst setup = () => {\n  composition = new Composition()\n  composition.delegate = new TestCompositionDelegate()\n}\n\ntestGroup(\"Composition\", { setup }, () =>\n  test(\"deleteInDirection respects UTF-16 character boundaries\", () => {\n    composition.insertString(\"abc😭\")\n    composition.deleteInDirection(\"backward\")\n    composition.insertString(\"d\")\n    assert.equal(composition.document.toString(), \"abcd\\n\")\n  })\n)\n","import { assert, test, testGroup } from \"test/test_helper\"\n\nimport Text from \"trix/models/text\"\nimport Block from \"trix/models/block\"\nimport Attachment from \"trix/models/attachment\"\nimport Document from \"trix/models/document\"\nimport HTMLParser from \"trix/models/html_parser\"\n\ntestGroup(\"Document\", () => {\n  const createDocumentWithAttachment = function (attachment) {\n    const text = Text.textForAttachmentWithAttributes(attachment)\n    return new Document([ new Block(text) ])\n  }\n\n  test(\"documents with different attachments are not equal\", () => {\n    const aDoc = createDocumentWithAttachment(new Attachment({ url: \"a\" }))\n    const bDoc = createDocumentWithAttachment(new Attachment({ url: \"b\" }))\n    assert.notOk(aDoc.isEqualTo(bDoc))\n  })\n\n  test(\"getStringAtRange does not leak trailing block breaks\", () => {\n    const document = Document.fromString(\"Hey\")\n    assert.equal(document.getStringAtRange([ 0, 0 ]), \"\")\n    assert.equal(document.getStringAtRange([ 0, 1 ]), \"H\")\n    assert.equal(document.getStringAtRange([ 0, 2 ]), \"He\")\n    assert.equal(document.getStringAtRange([ 0, 3 ]), \"Hey\")\n    assert.equal(document.getStringAtRange([ 0, 4 ]), \"Hey\\n\")\n  })\n\n  test(\"findRangesForTextAttribute\", () => {\n    const document = HTMLParser.parse(\n      `\n      <div>Hello <strong>world, <em>this</em> is</strong> a <strong>test</strong>.<br></div>\n    `\n    ).getDocument()\n    assert.deepEqual(document.findRangesForTextAttribute(\"bold\"), [\n      [ 6, 20 ],\n      [ 23, 27 ],\n    ])\n    assert.deepEqual(document.findRangesForTextAttribute(\"italic\"), [ [ 13, 17 ] ])\n    assert.deepEqual(document.findRangesForTextAttribute(\"href\"), [])\n  })\n\n  test(\"findRangesForTextAttribute withValue\", () => {\n    const document = HTMLParser.parse(\n      `\n      <div>Hello <a href=\"http://google.com/\">world, <em>this</em> is</a> a <a href=\"http://basecamp.com/\">test</a>.<br></div>\n    `\n    ).getDocument()\n    assert.deepEqual(document.findRangesForTextAttribute(\"href\"), [\n      [ 6, 20 ],\n      [ 23, 27 ],\n    ])\n    assert.deepEqual(document.findRangesForTextAttribute(\"href\", { withValue: \"http://google.com/\" }), [ [ 6, 20 ] ])\n    assert.deepEqual(document.findRangesForTextAttribute(\"href\", { withValue: \"http://basecamp.com/\" }), [ [ 23, 27 ] ])\n    assert.deepEqual(document.findRangesForTextAttribute(\"href\", { withValue: \"http://amazon.com/\" }), [])\n  })\n})\n","import { assert, eachFixture, test, testGroup } from \"test/test_helper\"\n\ntestGroup(\"DocumentView\", () => {\n  eachFixture((name, details) => {\n    test(name, () => {\n      assert.documentHTMLEqual(details.document, details.html)\n    })\n  })\n})\n","import {\n  TEST_IMAGE_URL,\n  after,\n  assert,\n  createCursorTarget,\n  eachFixture,\n  fixtures,\n  getHTML,\n  test,\n  testGroup,\n} from \"test/test_helper\"\n\nimport config from \"trix/config\"\nimport HTMLParser from \"trix/models/html_parser\"\n\nconst cursorTargetLeft = createCursorTarget(\"left\").outerHTML\nconst cursorTargetRight = createCursorTarget(\"right\").outerHTML\n\ntestGroup(\"HTMLParser\", () => {\n  eachFixture((name, { html, serializedHTML, document }) =>\n    test(name, () => {\n      const parsedDocument = HTMLParser.parse(html).getDocument()\n      assert.documentHTMLEqual(parsedDocument.copyUsingObjectsFromDocument(document), html)\n    })\n  )\n\n  eachFixture((name, { html, serializedHTML, document }) => {\n    if (serializedHTML) {\n      test(`${name} (serialized)`, () => {\n        const parsedDocument = HTMLParser.parse(serializedHTML).getDocument()\n        assert.documentHTMLEqual(parsedDocument.copyUsingObjectsFromDocument(document), html)\n      })\n    }\n  })\n\n  testGroup(\"nested line breaks\", () => {\n    const cases = {\n      \"<div>a<div>b</div>c</div>\": \"<div><!--block-->a<br>b<br>c</div>\",\n      \"<div>a<div><div><div>b</div></div></div>c</div>\": \"<div><!--block-->a<br>b<br>c</div>\",\n      \"<blockquote>a<div>b</div>c</blockquote>\": \"<blockquote><!--block-->a<br>b<br>c</blockquote>\",\n    }\n    // TODO:\n    // \"<div><div>a</div><div>b</div>c</div>\": \"<div><!--block-->a<br>b<br>c</div>\"\n    // \"<blockquote><div>a</div><div>b</div><div>c</div></blockquote>\": \"<blockquote><!--block-->a<br>b<br>c</blockquote>\"\n    // \"<blockquote><div>a<br></div><div><br></div><div>b<br></div></blockquote>\": \"<blockquote><!--block-->a<br><br>b</blockquote>\"\n\n    for (const [ html, expectedHTML ] of Object.entries(cases)) {\n      test(html, () => {\n        assert.documentHTMLEqual(HTMLParser.parse(html).getDocument(), expectedHTML)\n      })\n    }\n  })\n\n  test(\"parses absolute image URLs\", () => {\n    const src = `${getOrigin()}/test_helpers/fixtures/logo.png`\n    const pattern = new RegExp(`src=\"${src}\"`)\n    const html = `<img src=\"${src}\">`\n\n    const finalHTML = getHTML(HTMLParser.parse(html).getDocument())\n    assert.ok(pattern.test(finalHTML), `${pattern} not found in ${JSON.stringify(finalHTML)}`)\n  })\n\n  test(\"parses relative image URLs\", () => {\n    const src = \"/test_helpers/fixtures/logo.png\"\n    const pattern = new RegExp(`src=\"${src}\"`)\n    const html = `<img src=\"${src}\">`\n\n    const finalHTML = getHTML(HTMLParser.parse(html).getDocument())\n    assert.ok(pattern.test(finalHTML), `${pattern} not found in ${JSON.stringify(finalHTML)}`)\n  })\n\n  test(\"parses unfamiliar html\", () => {\n    const html =\n      \"<meta charset=\\\"UTF-8\\\"><span style=\\\"font-style: italic\\\">abc</span><span>d</span><section style=\\\"margin:0\\\"><blink>123</blink><a href=\\\"http://example.com\\\">45<b>6</b></a>x<br />y</section><p style=\\\"margin:0\\\">9</p>\"\n    const expectedHTML =\n      \"<div><!--block--><em>abc</em>d</div><div><!--block-->123<a href=\\\"http://example.com\\\">45<strong>6</strong></a>x<br>y</div><div><!--block-->9</div>\"\n    assert.documentHTMLEqual(HTMLParser.parse(html).getDocument(), expectedHTML)\n  })\n\n  test(\"ignores leading whitespace before <meta> tag\", () => {\n    const html = \" \\n <meta charset=\\\"UTF-8\\\"><pre>abc</pre>\"\n    const expectedHTML = \"<pre><!--block-->abc</pre>\"\n    assert.documentHTMLEqual(HTMLParser.parse(html).getDocument(), expectedHTML)\n  })\n\n  test(\"ignores content after </html>\", () => {\n    const html = `\n      <html xmlns:o=\"urn:schemas-microsoft-com:office:office\" xmlns:w=\"urn:schemas-microsoft-com:office:word\" xmlns:m=\"http://schemas.microsoft.com/office/2004/12/omml\" xmlns=\"http://www.w3.org/TR/REC-html40\">\n      <head>\n      <meta http-equiv=Content-Type content=\"text/html; charset=utf-8\">\n      <meta name=ProgId content=Word.Document>\n      </head>\n\n      <body lang=EN-US link=blue vlink=\"#954F72\" style='tab-interval:.5in'>\n      <!--StartFragment--><span lang=EN style='font-size:12.0pt;font-family:\n      \"Arial\",sans-serif;mso-fareast-font-family:\"Times New Roman\";mso-ansi-language:\n      EN;mso-fareast-language:EN-US;mso-bidi-language:AR-SA'>abc</span><!--EndFragment-->\n      </body>\n\n      </html>\n      TAxelFCg��K��`\n\n    const expectedHTML = \"<div><!--block-->abc</div>\"\n    assert.documentHTMLEqual(HTMLParser.parse(html).getDocument(), expectedHTML)\n  })\n\n  test(\"parses incorrectly nested list html\", () => {\n    const html = \"<ul><li>a</li><ul><li>b</li><ol><li>1</li><li>2</li><ol></ul></ul>\"\n    const expectedHTML =\n      \"<ul><li><!--block-->a<ul><li><!--block-->b<ol><li><!--block-->1</li><li><!--block-->2</li></ol></li></ul></li></ul>\"\n    assert.documentHTMLEqual(HTMLParser.parse(html).getDocument(), expectedHTML)\n  })\n\n  test(\"ignores whitespace between block elements\", () => {\n    const html = \"<div>a</div> \\n <div>b</div>     <article>c</article>  \\n\\n <section>d</section> \"\n    const expectedHTML =\n      \"<div><!--block-->a</div><div><!--block-->b</div><div><!--block-->c</div><div><!--block-->d</div>\"\n    assert.documentHTMLEqual(HTMLParser.parse(html).getDocument(), expectedHTML)\n  })\n\n  test(\"ingores whitespace between nested block elements\", () => {\n    const html = \"<ul> <li>a</li> \\n  <li>b</li>  </ul><div>  <div> \\n <blockquote>c</blockquote>\\n </div>  \\n</div>\"\n    const expectedHTML = \"<ul><li><!--block-->a</li><li><!--block-->b</li></ul><blockquote><!--block-->c</blockquote>\"\n    assert.documentHTMLEqual(HTMLParser.parse(html).getDocument(), expectedHTML)\n  })\n\n  test(\"ignores inline whitespace that can't be displayed\", () => {\n    const html = \" a  \\n b    <span>c\\n</span><span>d  \\ne </span> f <span style=\\\"white-space: pre\\\">  g\\n\\n h  </span>\"\n    const expectedHTML = \"<div><!--block-->a b c d e f &nbsp; g<br><br>&nbsp;h &nbsp;</div>\"\n    assert.documentHTMLEqual(HTMLParser.parse(html).getDocument(), expectedHTML)\n  })\n\n  test(\"parses significant whitespace in empty inline elements\", () => {\n    const html = \"a<span style='mso-spacerun:yes'> </span>b<span style='mso-spacerun:yes'>  </span>c\"\n    const expectedHTML = \"<div><!--block-->a b c</div>\"\n    assert.documentHTMLEqual(HTMLParser.parse(html).getDocument(), expectedHTML)\n  })\n\n  test(\"parses block elements with leading breakable whitespace\", () => {\n    const html =\n      \"<blockquote> <span>a</span> <blockquote>\\n <strong>b</strong> <pre> <span>c</span></pre></blockquote></blockquote>\"\n    const expectedHTML =\n      \"<blockquote><!--block-->a<blockquote><!--block--><strong>b</strong><pre><!--block--> c</pre></blockquote></blockquote>\"\n    assert.documentHTMLEqual(HTMLParser.parse(html).getDocument(), expectedHTML)\n  })\n\n  test(\"parses block elements with leading non-breaking whitespace\", () => {\n    const html = \"<blockquote>&nbsp;<span>a</span></blockquote>\"\n    const expectedHTML = \"<blockquote><!--block-->&nbsp;a</blockquote>\"\n    assert.documentHTMLEqual(HTMLParser.parse(html).getDocument(), expectedHTML)\n  })\n\n  test(\"converts newlines to spaces\", () => {\n    const html = \"<div>a\\nb \\nc \\n d \\n\\ne</div><pre>1\\n2</pre>\"\n    const expectedHTML = \"<div><!--block-->a b c d e</div><pre><!--block-->1\\n2</pre>\"\n    assert.documentHTMLEqual(HTMLParser.parse(html).getDocument(), expectedHTML)\n  })\n\n  test(\"parses entire HTML document\", () => {\n    const html =\n      \"<html><head><style>.bold {font-weight: bold}</style></head><body><span class=\\\"bold\\\">abc</span></body></html>\"\n    const expectedHTML = \"<div><!--block--><strong>abc</strong></div>\"\n    assert.documentHTMLEqual(HTMLParser.parse(html).getDocument(), expectedHTML)\n  })\n\n  test(\"parses inline element following block element\", () => {\n    const html = \"<blockquote>abc</blockquote><strong>123</strong>\"\n    const expectedHTML = \"<blockquote><!--block-->abc</blockquote><div><!--block--><strong>123</strong></div>\"\n    assert.documentHTMLEqual(HTMLParser.parse(html).getDocument(), expectedHTML)\n  })\n\n  test(\"parses text nodes following block elements\", () => {\n    const html = \"<ul><li>a</li></ul>b<blockquote>c</blockquote>d\"\n    const expectedHTML =\n      \"<ul><li><!--block-->a</li></ul><div><!--block-->b</div><blockquote><!--block-->c</blockquote><div><!--block-->d</div>\"\n    assert.documentHTMLEqual(HTMLParser.parse(html).getDocument(), expectedHTML)\n  })\n\n  test(\"parses whitespace-only text nodes without a containing block element\", () => {\n    const html = \"a <strong>b</strong> <em>c</em>\"\n    const expectedHTML = \"<div><!--block-->a <strong>b</strong> <em>c</em></div>\"\n    assert.documentHTMLEqual(HTMLParser.parse(html).getDocument(), expectedHTML)\n  })\n\n  test(\"parses spaces around cursor targets\", () => {\n    const html = `<div>a ${cursorTargetLeft}<span>b</span>${cursorTargetRight} c</div>`\n    const expectedHTML = \"<div><!--block-->a b c</div>\"\n    assert.documentHTMLEqual(HTMLParser.parse(html).getDocument(), expectedHTML)\n  })\n\n  test(\"parses spanned text elements that don't have a parser function\", () => {\n    assert.notOk(config.textAttributes.strike.parser)\n    const html = \"<del>a <strong>b</strong></del>\"\n    const expectedHTML = \"<div><!--block--><del>a </del><strong><del>b</del></strong></div>\"\n    assert.documentHTMLEqual(HTMLParser.parse(html).getDocument(), expectedHTML)\n  })\n\n  test(\"translates tables into plain text\", () => {\n    const html = \"<table><tr><td>a</td><td>b</td></tr><tr><td>1</td><td><p>2</p></td></tr><table>\"\n    const expectedHTML = \"<div><!--block-->a | b<br>1 | 2</div>\"\n    assert.documentHTMLEqual(HTMLParser.parse(html).getDocument(), expectedHTML)\n  })\n\n  test(\"translates block element margins to newlines\", () => {\n    const html =\n      \"<p style=\\\"margin: 0 0 1em 0\\\">a</p><p style=\\\"margin: 0\\\">b</p><article style=\\\"margin: 1em 0 0 0\\\">c</article>\"\n    const expectedHTML = \"<div><!--block-->a<br><br></div><div><!--block-->b</div><div><!--block--><br>c</div>\"\n    const document = HTMLParser.parse(html).getDocument()\n    assert.documentHTMLEqual(document, expectedHTML)\n  })\n\n  test(\"skips translating empty block element margins to newlines\", () => {\n    const html =\n      \"<p style=\\\"margin: 0 0 1em 0\\\">a</p><p style=\\\"margin: 0 0 1em 0\\\"><span></span></p><p style=\\\"margin: 0\\\">b</p>\"\n    const expectedHTML = \"<div><!--block-->a<br><br></div><div><!--block--><br></div><div><!--block-->b</div>\"\n    const document = HTMLParser.parse(html).getDocument()\n    assert.documentHTMLEqual(document, expectedHTML)\n  })\n\n  test(\"ignores text nodes in script elements\", () => {\n    const html = \"<div>a<script>alert(\\\"b\\\")</script></div>\"\n    const expectedHTML = \"<div><!--block-->a</div>\"\n    assert.documentHTMLEqual(HTMLParser.parse(html).getDocument(), expectedHTML)\n  })\n\n  test(\"ignores iframe elements\", () => {\n    const html = \"<div>a<iframe src=\\\"data:text/html;base64,PHNjcmlwdD5hbGVydCgneHNzJyk7PC9zY3JpcHQ+\\\">b</iframe></div>\"\n    const expectedHTML = \"<div><!--block-->a</div>\"\n    assert.documentHTMLEqual(HTMLParser.parse(html).getDocument(), expectedHTML)\n  })\n\n  test(\"sanitizes unsafe html\", (done) => {\n    window.unsanitized = []\n    HTMLParser.parse(`\n      <img onload=\"window.unsanitized.push('img.onload');\" src=\"${TEST_IMAGE_URL}\">\n      <img onerror=\"window.unsanitized.push('img.onerror');\" src=\"data:image/gif;base64,TOTALLYBOGUS\">\n      <script>\n        window.unsanitized.push('script tag');\n      </script>`)\n\n    after(20, () => {\n      assert.deepEqual(window.unsanitized, [])\n      delete window.unsanitized\n      done()\n    })\n  })\n\n  test(\"forbids href attributes with javascript: protocol\", () => {\n    const html =\n      \"<a href=\\\"javascript:alert()\\\">a</a> <a href=\\\" javascript: alert()\\\">b</a> <a href=\\\"JavaScript:alert()\\\">c</a>\"\n    const expectedHTML = \"<div><!--block-->a b c</div>\"\n    assert.documentHTMLEqual(HTMLParser.parse(html).getDocument(), expectedHTML)\n  })\n\n  test(\"ignores attachment elements with malformed JSON\", () => {\n    const html =\n      \"<div>a</div><div data-trix-attachment data-trix-attributes></div>\" +\n      \"<div data-trix-attachment=\\\"\\\" data-trix-attributes=\\\"\\\"></div>\" +\n      \"<div data-trix-attachment=\\\"{&quot;x:}\\\" data-trix-attributes=\\\"{&quot;x:}\\\"></div>\" +\n      \"<div>b</div>\"\n    const expectedHTML = \"<div><!--block-->a</div><div><!--block--><br></div><div><!--block-->b</div>\"\n    assert.documentHTMLEqual(HTMLParser.parse(html).getDocument(), expectedHTML)\n  })\n\n  test(\"parses attachment caption from large html string\", (done) => {\n    let { html } = fixtures[\"image attachment with edited caption\"]\n\n    for (let i = 1; i <= 30; i++) {\n      html += fixtures[\"image attachment\"].html\n    }\n\n    for (let n = 1; n <= 3; n++) {\n      const attachmentPiece = HTMLParser.parse(html).getDocument().getAttachmentPieces()[0]\n      assert.equal(attachmentPiece.getCaption(), \"Example\")\n    }\n\n    done()\n  })\n\n  test(\"parses foreground color when configured\", () => {\n    const attrConfig = { foregroundColor: { styleProperty: \"color\" } }\n\n    withTextAttributeConfig(attrConfig, () => {\n      const html = \"<span style=\\\"color: rgb(60, 179, 113);\\\">green</span>\"\n      const expectedHTML = \"<div><!--block--><span style=\\\"color: rgb(60, 179, 113);\\\">green</span></div>\"\n      const document = HTMLParser.parse(html).getDocument()\n      assert.documentHTMLEqual(document, expectedHTML)\n    })\n  })\n\n  test(\"parses background color when configured\", () => {\n    const attrConfig = { backgroundColor: { styleProperty: \"backgroundColor\" } }\n\n    withTextAttributeConfig(attrConfig, () => {\n      const html = \"<span style=\\\"background-color: yellow;\\\">on yellow</span>\"\n      const expectedHTML = \"<div><!--block--><span style=\\\"background-color: yellow;\\\">on yellow</span></div>\"\n      const document = HTMLParser.parse(html).getDocument()\n      assert.documentHTMLEqual(document, expectedHTML)\n    })\n  })\n\n  test(\"parses configured foreground color on formatted text\", () => {\n    const attrConfig = { foregroundColor: { styleProperty: \"color\" } }\n\n    withTextAttributeConfig(attrConfig, () => {\n      const html = \"<strong style=\\\"color: rgb(60, 179, 113);\\\">GREEN</strong>\"\n      const expectedHTML = \"<div><!--block--><strong style=\\\"color: rgb(60, 179, 113);\\\">GREEN</strong></div>\"\n      const document = HTMLParser.parse(html).getDocument()\n      assert.documentHTMLEqual(document, expectedHTML)\n    })\n  })\n\n  test(\"parses foreground color using configured parser function\", () => {\n    const attrConfig = {\n      foregroundColor: {\n        styleProperty: \"color\",\n        parser(element) {\n          const { color } = element.style\n          if (color === \"rgb(60, 179, 113)\") {\n            return color\n          }\n        },\n      },\n    }\n\n    withTextAttributeConfig(attrConfig, () => {\n      const html = \"<span style=\\\"color: rgb(60, 179, 113);\\\">green</span><span style=\\\"color: yellow;\\\">not yellow</span>\"\n      const expectedHTML = \"<div><!--block--><span style=\\\"color: rgb(60, 179, 113);\\\">green</span>not yellow</div>\"\n      const document = HTMLParser.parse(html).getDocument()\n      assert.documentHTMLEqual(document, expectedHTML)\n    })\n  })\n})\n\nconst withTextAttributeConfig = (attrConfig = {}, fn) => {\n  const originalConfig = {}\n\n  for (const [ key, value ] of Object.entries(attrConfig)) {\n    originalConfig[key] = config.textAttributes[key]\n    config.textAttributes[key] = value\n  }\n\n  try {\n    fn()\n  } finally {\n    for (const [ key, value ] of Object.entries(originalConfig)) {\n      if (value) {\n        config.textAttributes[key] = value\n      } else {\n        delete config.textAttributes[key]\n      }\n    }\n  }\n}\n\nconst getOrigin = () => {\n  const { protocol, hostname, port } = window.location\n  return `${protocol}//${hostname}${port ? `:${port}` : \"\"}`\n}\n","import { TEST_IMAGE_URL, assert, test, testGroup } from \"test/test_helper\"\n\nimport DocumentView from \"trix/views/document_view\"\nimport Document from \"trix/models/document\"\nimport LocationMapper from \"trix/models/location_mapper\"\n\ntestGroup(\"LocationMapper\", () => {\n  test(\"findLocationFromContainerAndOffset\", () => {\n    setDocument([\n      // <trix-editor>\n      // 0 <div>\n      //     0 <!--block-->\n      //     1 <strong>\n      //         0 a\n      //         1 <br>\n      //       </strong>\n      //     2 <br>\n      //   </div>\n      // 1 <blockquote>\n      //     0 <!--block-->\n      //     1 b😭cd\n      //     2 <span data-trix-cursor-target>\n      //         0 (zero-width space)\n      //       </span>\n      //     3 <a href=\"data:image/png,\" data-trix-attachment=\"\" ...>\n      //         0 <figure ...>...</figure>\n      //       </a>\n      //     4 <span data-trix-cursor-target>\n      //         0 (zero-width space)\n      //       </span>\n      //     5 e\n      //   </blockquote>\n      // </trix-editor>\n      {\n        text: [\n          { type: \"string\", attributes: { bold: true }, string: \"a\\n\" },\n          { type: \"string\", attributes: { blockBreak: true }, string: \"\\n\" },\n        ],\n        attributes: [],\n      },\n      {\n        text: [\n          { type: \"string\", attributes: {}, string: \"b😭cd\" },\n          {\n            type: \"attachment\",\n            attributes: {},\n            attachment: {\n              contentType: \"image/png\",\n              filename: \"x.png\",\n              filesize: 0,\n              height: 13,\n              href: TEST_IMAGE_URL,\n              identifier: \"1\",\n              url: TEST_IMAGE_URL,\n              width: 15,\n            },\n          },\n          { type: \"string\", attributes: {}, string: \"e\" },\n          { type: \"string\", attributes: { blockBreak: true }, string: \"\\n\" },\n        ],\n        attributes: [ \"quote\" ],\n      },\n    ])\n\n    const assertions = [\n      { location: [ 0, 0 ], container: [], offset: 0 },\n      { location: [ 0, 0 ], container: [ 0 ], offset: 0 },\n      { location: [ 0, 0 ], container: [ 0 ], offset: 1 },\n      { location: [ 0, 0 ], container: [ 0, 1 ], offset: 0 },\n      { location: [ 0, 0 ], container: [ 0, 1, 0 ], offset: 0 },\n      { location: [ 0, 1 ], container: [ 0, 1, 0 ], offset: 1 },\n      { location: [ 0, 1 ], container: [ 0, 1 ], offset: 1 },\n      { location: [ 0, 2 ], container: [ 0, 1 ], offset: 2 },\n      { location: [ 0, 2 ], container: [ 0 ], offset: 2 },\n      { location: [ 0, 3 ], container: [], offset: 1 },\n      { location: [ 0, 3 ], container: [ 1 ], offset: 0 },\n      { location: [ 1, 0 ], container: [ 1 ], offset: 1 },\n      { location: [ 1, 0 ], container: [ 1, 1 ], offset: 0 },\n      { location: [ 1, 1 ], container: [ 1, 1 ], offset: 1 },\n      { location: [ 1, 2 ], container: [ 1, 1 ], offset: 2 },\n      { location: [ 1, 3 ], container: [ 1, 1 ], offset: 3 },\n      { location: [ 1, 4 ], container: [ 1, 1 ], offset: 4 },\n      { location: [ 1, 5 ], container: [ 1, 1 ], offset: 5 },\n      { location: [ 1, 6 ], container: [ 1, 1 ], offset: 6 },\n      { location: [ 1, 5 ], container: [ 1 ], offset: 2 },\n      { location: [ 1, 5 ], container: [ 1, 2 ], offset: 0 },\n      { location: [ 1, 5 ], container: [ 1, 2 ], offset: 1 },\n      { location: [ 1, 5 ], container: [ 1 ], offset: 3 },\n      { location: [ 1, 5 ], container: [ 1, 3 ], offset: 0 },\n      { location: [ 1, 5 ], container: [ 1, 3 ], offset: 1 },\n      { location: [ 1, 6 ], container: [ 1 ], offset: 4 },\n      { location: [ 1, 6 ], container: [ 1, 4 ], offset: 0 },\n      { location: [ 1, 6 ], container: [ 1, 4 ], offset: 1 },\n      { location: [ 1, 6 ], container: [ 1 ], offset: 5 },\n      { location: [ 1, 6 ], container: [ 1, 5 ], offset: 0 },\n      { location: [ 1, 7 ], container: [ 1, 5 ], offset: 1 },\n      { location: [ 1, 7 ], container: [], offset: 2 },\n    ]\n\n    for (const assertion of assertions) {\n      const path = assertion.container\n      const container = findContainer(path)\n      const { offset } = assertion\n\n      const expectedLocation = { index: assertion.location[0], offset: assertion.location[1] }\n      const actualLocation = mapper.findLocationFromContainerAndOffset(container, offset)\n\n      assert.equal(\n        format(actualLocation),\n        format(expectedLocation),\n        `${describe(container)} at [${path.join(\", \")}], offset ${offset} = ${format(expectedLocation)}`\n      )\n    }\n  })\n\n  test(\"findContainerAndOffsetFromLocation: (0/0)\", () => {\n    setDocument([\n      // <trix-editor>\n      // 0 <ul>\n      //     0 <li>\n      //         0 <!--block-->\n      //         1 <br>\n      //       </li>\n      //   </ul>\n      // </trix-editor>\n      {\n        text: [ { type: \"string\", attributes: { blockBreak: true }, string: \"\\n\" } ],\n        attributes: [ \"bulletList\", \"bullet\" ],\n      },\n    ])\n\n    const location = { index: 0, offset: 0 }\n    const container = findContainer([ 0, 0 ])\n    const offset = 1\n\n    assert.deepEqual(mapper.findContainerAndOffsetFromLocation(location), [ container, offset ])\n  })\n\n  test(\"findContainerAndOffsetFromLocation after newline in formatted text\", () => {\n    setDocument([\n      // <trix-editor>\n      // 0 <div>\n      //     0 <!--block-->\n      //     0 <strong>\n      //         0 a\n      //         1 <br>\n      //       </strong>\n      //   </div>\n      // </trix-editor>\n      {\n        text: [\n          { type: \"string\", attributes: { bold: true }, string: \"a\\n\" },\n          { type: \"string\", attributes: { blockBreak: true }, string: \"\\n\" },\n        ],\n        attributes: [],\n      },\n    ])\n\n    const location = { index: 0, offset: 2 }\n    const container = findContainer([ 0 ])\n    const offset = 2\n\n    assert.deepEqual(mapper.findContainerAndOffsetFromLocation(location), [ container, offset ])\n  })\n\n  test(\"findContainerAndOffsetFromLocation after nested block\", () => {\n    setDocument([\n      // <trix-editor>\n      //   <blockquote>\n      //     <ul>\n      //       <li>\n      //         <!--block-->\n      //         a\n      //       </li>\n      //     </ul>\n      //     <!--block-->\n      //     <br>\n      //   </blockquote>\n      // </trix-editor>\n      {\n        text: [\n          { type: \"string\", attributes: {}, string: \"a\" },\n          { type: \"string\", attributes: { blockBreak: true }, string: \"\\n\" },\n        ],\n        attributes: [ \"quote\", \"bulletList\", \"bullet\" ],\n      },\n      {\n        text: [ { type: \"string\", attributes: { blockBreak: true }, string: \"\\n\" } ],\n        attributes: [ \"quote\" ],\n      },\n    ])\n\n    const location = { index: 1, offset: 0 }\n    const container = findContainer([ 0 ])\n    const offset = 2\n\n    assert.deepEqual(mapper.findContainerAndOffsetFromLocation(location), [ container, offset ])\n  })\n})\n\n// ---\nlet document = null\nlet element = null\nlet mapper = null\n\nconst setDocument = (json) => {\n  document = Document.fromJSON(json)\n  element = DocumentView.render(document)\n  return mapper = new LocationMapper(element)\n}\n\nconst findContainer = (path) => {\n  let el = element\n  for (const index of path) {\n    el = el.childNodes[index]\n  }\n  return el\n}\n\nconst format = ({ index, offset }) => `${index}/${offset}`\n\nconst describe = (node) => {\n  if (node.nodeType === Node.TEXT_NODE) {\n    return `text node ${JSON.stringify(node.textContent)}`\n  } else {\n    return `container <${node.tagName.toLowerCase()}>`\n  }\n}\n","import { assert, defer, test, testGroup } from \"test/test_helper\"\n\nimport MutationObserver from \"trix/observers/mutation_observer\"\n\nlet observer = null\nlet element = null\nlet summaries = []\n\nconst install = function (html) {\n  element = document.createElement(\"div\")\n  if (html) {\n    element.innerHTML = html\n  }\n  observer = new MutationObserver(element)\n  observer.delegate = {\n    elementDidMutate(summary) {\n      summaries.push(summary)\n    },\n  }\n}\n\nconst uninstall = () => {\n  observer?.stop()\n  observer = null\n  element = null\n  summaries = []\n}\n\nconst observerTest = (name, options = {}, callback) =>\n  test(name, (done) => {\n    install(options.html)\n    callback(() => {\n      uninstall()\n      done()\n    })\n  })\n\ntestGroup(\"MutationObserver\", () => {\n  observerTest(\"add character\", { html: \"a\" }, (done) => {\n    element.firstChild.data += \"b\"\n    defer(() => {\n      assert.equal(summaries.length, 1)\n      assert.deepEqual(summaries[0], { textAdded: \"b\" })\n      done()\n    })\n  })\n\n  observerTest(\"remove character\", { html: \"ab\" }, (done) => {\n    element.firstChild.data = \"a\"\n    defer(() => {\n      assert.equal(summaries.length, 1)\n      assert.deepEqual(summaries[0], { textDeleted: \"b\" })\n      done()\n    })\n  })\n\n  observerTest(\"replace character\", { html: \"ab\" }, (done) => {\n    element.firstChild.data = \"ac\"\n    defer(() => {\n      assert.equal(summaries.length, 1)\n      assert.deepEqual(summaries[0], { textAdded: \"c\", textDeleted: \"b\" })\n      done()\n    })\n  })\n\n  observerTest(\"add <br>\", { html: \"a\" }, (done) => {\n    element.appendChild(document.createElement(\"br\"))\n    defer(() => {\n      assert.equal(summaries.length, 1)\n      assert.deepEqual(summaries[0], { textAdded: \"\\n\" })\n      done()\n    })\n  })\n\n  observerTest(\"remove <br>\", { html: \"a<br>\" }, (done) => {\n    element.removeChild(element.lastChild)\n    defer(() => {\n      assert.equal(summaries.length, 1)\n      assert.deepEqual(summaries[0], { textDeleted: \"\\n\" })\n      done()\n    })\n  })\n\n  observerTest(\"remove block comment\", { html: \"<div><!--block-->a</div>\" }, (done) => {\n    element.firstChild.removeChild(element.firstChild.firstChild)\n    defer(() => {\n      assert.equal(summaries.length, 1)\n      assert.deepEqual(summaries[0], { textDeleted: \"\\n\" })\n      done()\n    })\n  })\n\n  observerTest(\"remove formatted element\", { html: \"a<strong>b</strong>\" }, (done) => {\n    element.removeChild(element.lastChild)\n    defer(() => {\n      assert.equal(summaries.length, 1)\n      assert.deepEqual(summaries[0], { textDeleted: \"b\" })\n      done()\n    })\n  })\n\n  observerTest(\"remove nested formatted elements\", { html: \"a<strong>b<em>c</em></strong>\" }, (done) => {\n    element.removeChild(element.lastChild)\n    defer(() => {\n      assert.equal(summaries.length, 1)\n      assert.deepEqual(summaries[0], { textDeleted: \"bc\" })\n      done()\n    })\n  })\n})\n","import { serializeToContentType } from \"trix/core/serialization\"\nimport { assert, eachFixture, test, testGroup } from \"test/test_helper\"\n\ntestGroup(\"serializeToContentType\", () => {\n  eachFixture((name, details) => {\n    if (details.serializedHTML) {\n      test(name, () => {\n        assert.equal(serializeToContentType(details.document, \"text/html\"), details.serializedHTML)\n      })\n    }\n  })\n})\n","import { assert, test, testGroup } from \"test/test_helper\"\n\nimport { summarizeStringChange } from \"trix/core/helpers\"\n\ntestGroup(\"summarizeStringChange\", () => {\n  const assertions = {\n    \"no change\": {\n      oldString: \"abc\",\n      newString: \"abc\",\n      change: { added: \"\", removed: \"\" },\n    },\n    \"adding a character\": {\n      oldString: \"\",\n      newString: \"a\",\n      change: { added: \"a\", removed: \"\" },\n    },\n    \"appending a character\": {\n      oldString: \"ab\",\n      newString: \"abc\",\n      change: { added: \"c\", removed: \"\" },\n    },\n    \"appending a multibyte character\": {\n      oldString: \"a💩\",\n      newString: \"a💩💩\",\n      change: { added: \"💩\", removed: \"\" },\n    },\n    \"prepending a character\": {\n      oldString: \"bc\",\n      newString: \"abc\",\n      change: { added: \"a\", removed: \"\" },\n    },\n    \"inserting a character\": {\n      oldString: \"ac\",\n      newString: \"abc\",\n      change: { added: \"b\", removed: \"\" },\n    },\n    \"inserting a string\": {\n      oldString: \"ac\",\n      newString: \"aZZZc\",\n      change: { added: \"ZZZ\", removed: \"\" },\n    },\n    \"replacing a character\": {\n      oldString: \"abc\",\n      newString: \"aZc\",\n      change: { added: \"Z\", removed: \"b\" },\n    },\n    \"replacing a character with a string\": {\n      oldString: \"abc\",\n      newString: \"aXYc\",\n      change: { added: \"XY\", removed: \"b\" },\n    },\n    \"replacing a string with a character\": {\n      oldString: \"abcde\",\n      newString: \"aXe\",\n      change: { added: \"X\", removed: \"bcd\" },\n    },\n    \"replacing a string with a string\": {\n      oldString: \"abcde\",\n      newString: \"aBCDe\",\n      change: { added: \"BCD\", removed: \"bcd\" },\n    },\n    \"removing a character\": {\n      oldString: \"abc\",\n      newString: \"ac\",\n      change: { added: \"\", removed: \"b\" },\n    },\n  }\n\n  for (const name in assertions) {\n    test(name, () => {\n      const details = assertions[name]\n      const { oldString, newString, change } = details\n      assert.deepEqual(summarizeStringChange(oldString, newString), change)\n    })\n  }\n})\n","import { assert, test, testGroup } from \"test/test_helper\"\n\nimport Text from \"trix/models/text\"\nimport StringPiece from \"trix/models/string_piece\"\n\ntestGroup(\"Text\", () =>\n  testGroup(\"#removeTextAtRange\", () => {\n    test(\"removes text with range in single piece\", () => {\n      const text = new Text([ new StringPiece(\"abc\") ])\n      const pieces = text.removeTextAtRange([ 0, 1 ]).getPieces()\n      assert.equal(pieces.length, 1)\n      assert.equal(pieces[0].toString(), \"bc\")\n      assert.deepEqual(pieces[0].getAttributes(), {})\n    })\n\n    test(\"removes text with range spanning pieces\", () => {\n      const text = new Text([ new StringPiece(\"abc\"), new StringPiece(\"123\", { bold: true }) ])\n      const pieces = text.removeTextAtRange([ 2, 4 ]).getPieces()\n      assert.equal(pieces.length, 2)\n      assert.equal(pieces[0].toString(), \"ab\")\n      assert.deepEqual(pieces[0].getAttributes(), {})\n      assert.equal(pieces[1].toString(), \"23\")\n      assert.deepEqual(pieces[1].getAttributes(), { bold: true })\n    })\n  })\n)\n","import { assert, test, testGroup, triggerEvent } from \"test/test_helper\"\n\ntestGroup(\"Accessibility attributes\", { template: \"editor_default_aria_label\" }, () => {\n  test(\"sets the role to textbox\", () => {\n    const editor = document.getElementById(\"editor-without-labels\")\n    assert.equal(editor.getAttribute(\"role\"), \"textbox\")\n  })\n\n  test(\"does not set aria-label when the element has no <label> elements\", () => {\n    const editor = document.getElementById(\"editor-without-labels\")\n    assert.equal(editor.hasAttribute(\"aria-label\"), false)\n  })\n\n  test(\"does not override aria-label when the element declares it\", () => {\n    const editor = document.getElementById(\"editor-with-aria-label\")\n    assert.equal(editor.getAttribute(\"aria-label\"), \"ARIA Label text\")\n  })\n\n  test(\"does not set aria-label when the element declares aria-labelledby\", () => {\n    const editor = document.getElementById(\"editor-with-aria-labelledby\")\n    assert.equal(editor.hasAttribute(\"aria-label\"), false)\n    assert.equal(editor.getAttribute(\"aria-labelledby\"), \"aria-labelledby-id\")\n  })\n\n  test(\"assigns aria-label to the text of the element's <label> elements\", () => {\n    const editor = document.getElementById(\"editor-with-labels\")\n    assert.equal(editor.getAttribute(\"aria-label\"), \"Label 1 Label 2 Label 3\")\n  })\n\n  test(\"updates the aria-label on focus\", () => {\n    const editor = document.getElementById(\"editor-with-modified-label\")\n    const label = document.getElementById(\"modified-label\")\n\n    label.innerHTML = \"<span>New Value</span>\"\n    triggerEvent(editor, \"focus\")\n    assert.equal(editor.getAttribute(\"aria-label\"), \"New Value\")\n  })\n})\n","import config from \"trix/config\"\nimport { assert, insertImageAttachment, test, testGroup } from \"test/test_helper\"\n\ntestGroup(\"Attachment captions\", { template: \"editor_empty\" }, () => {\n  test(\"default caption includes file name and size\", () => {\n    insertImageAttachment()\n    const element = getCaptionElement()\n    assert.notOk(element.hasAttribute(\"data-trix-placeholder\"))\n    assert.equal(element.textContent, \"image.gif 35 Bytes\")\n  })\n\n  test(\"caption excludes file name when configured\", () => {\n    withPreviewCaptionConfig({ name: false, size: true }, () => {\n      insertImageAttachment()\n      const element = getCaptionElement()\n      assert.notOk(element.hasAttribute(\"data-trix-placeholder\"))\n      assert.equal(element.textContent, \"35 Bytes\")\n    })\n  })\n\n  test(\"caption excludes file size when configured\", () => {\n    withPreviewCaptionConfig({ name: true, size: false }, () => {\n      insertImageAttachment()\n      const element = getCaptionElement()\n      assert.notOk(element.hasAttribute(\"data-trix-placeholder\"))\n      assert.equal(element.textContent, \"image.gif\")\n    })\n  })\n\n  test(\"caption is empty when configured\", () => {\n    withPreviewCaptionConfig({ name: false, size: false }, () => {\n      insertImageAttachment()\n      const element = getCaptionElement()\n      assert.ok(element.hasAttribute(\"data-trix-placeholder\"))\n      assert.equal(element.getAttribute(\"data-trix-placeholder\"), config.lang.captionPlaceholder)\n      assert.equal(element.textContent, \"\")\n    })\n  })\n})\n\nconst withPreviewCaptionConfig = (captionConfig, fn) => {\n  if (!captionConfig) captionConfig = {}\n  const { caption } = config.attachments.preview\n  config.attachments.preview.caption = captionConfig\n  try {\n    return fn()\n  } finally {\n    config.attachments.preview.caption = caption\n  }\n}\n\nconst getCaptionElement = () => getEditorElement().querySelector(\"figcaption\")\n","import {\n  assert,\n  clickToolbarButton,\n  createImageAttachment,\n  insertAttachments,\n  pressKey,\n  test,\n  testGroup,\n  typeCharacters,\n} from \"test/test_helper\"\nimport { OBJECT_REPLACEMENT_CHARACTER } from \"trix/constants\"\n\nconst ORC = OBJECT_REPLACEMENT_CHARACTER\n\ntestGroup(\"Attachment galleries\", { template: \"editor_empty\" }, () => {\n  test(\"inserting more than one image attachment creates a gallery block\", function (expectDocument) {\n    insertAttachments(createImageAttachments(2))\n    assert.blockAttributes([ 0, 2 ], [ \"attachmentGallery\" ])\n    expectDocument(`${ORC}${ORC}\\n`)\n  })\n\n  test(\"gallery formatting is removed from blocks containing less than two image attachments\", function (expectDocument) {\n    insertAttachments(createImageAttachments(2))\n    assert.blockAttributes([ 0, 2 ], [ \"attachmentGallery\" ])\n    getEditor().setSelectedRange([ 1, 2 ])\n    pressKey(\"backspace\", () =>\n      requestAnimationFrame(() => {\n        assert.blockAttributes([ 0, 2 ], [])\n        expectDocument(`${ORC}\\n`)\n      })\n    )\n  })\n\n  test(\"typing in an attachment gallery block splits it\", function (expectDocument) {\n    insertAttachments(createImageAttachments(4))\n    getEditor().setSelectedRange(2)\n    typeCharacters(\"a\", () =>\n      requestAnimationFrame(() => {\n        assert.blockAttributes([ 0, 2 ], [ \"attachmentGallery\" ])\n        assert.blockAttributes([ 3, 4 ], [])\n        assert.blockAttributes([ 5, 7 ], [ \"attachmentGallery\" ])\n        expectDocument(`${ORC}${ORC}\\na\\n${ORC}${ORC}\\n`)\n      })\n    )\n  })\n\n  test(\"inserting a gallery in a formatted block\", (expectDocument) =>\n    clickToolbarButton({ attribute: \"quote\" }, () =>\n      typeCharacters(\"abc\", () => {\n        insertAttachments(createImageAttachments(2))\n        requestAnimationFrame(() => {\n          assert.blockAttributes([ 0, 3 ], [ \"quote\" ])\n          assert.blockAttributes([ 4, 6 ], [ \"attachmentGallery\" ])\n          expectDocument(`abc\\n${ORC}${ORC}\\n`)\n        })\n      })\n    ))\n})\n\nconst createImageAttachments = function (num) {\n  if (num == null) {\n    num = 1\n  }\n  const attachments = []\n  while (attachments.length < num) {\n    attachments.push(createImageAttachment())\n  }\n  return attachments\n}\n","import config from \"trix/config\"\nimport { OBJECT_REPLACEMENT_CHARACTER } from \"trix/constants\"\n\nimport {\n  after,\n  assert,\n  clickElement,\n  clickToolbarButton,\n  createFile,\n  defer,\n  dragToCoordinates,\n  moveCursor,\n  pressKey,\n  test,\n  testGroup,\n  triggerEvent,\n  typeCharacters,\n} from \"test/test_helper\"\n\ntestGroup(\"Attachments\", { template: \"editor_with_image\" }, () => {\n  test(\"moving an image by drag and drop\", (expectDocument) => {\n    typeCharacters(\"!\", () => {\n      moveCursor({ direction: \"right\", times: 1 }, (coordinates) => {\n        const img = document.activeElement.querySelector(\"img\")\n        triggerEvent(img, \"mousedown\")\n        defer(() => {\n          dragToCoordinates(coordinates, () => {\n            expectDocument(`!a${OBJECT_REPLACEMENT_CHARACTER}b\\n`)\n          })\n        })\n      })\n    })\n  })\n\n  test(\"removing an image\", (expectDocument) => {\n    after(20, () => {\n      clickElement(getFigure(), () => {\n        const closeButton = getFigure().querySelector(\"[data-trix-action=remove]\")\n        clickElement(closeButton, () => {\n          expectDocument(\"ab\\n\")\n        })\n      })\n    })\n  })\n\n  test(\"editing an image caption\", (expectDocument) => {\n    after(20, () => {\n      clickElement(findElement(\"figure\"), () => {\n        clickElement(findElement(\"figcaption\"), () => {\n          defer(() => {\n            const textarea = findElement(\"textarea\")\n            assert.ok(textarea)\n            textarea.focus()\n            textarea.value = \"my\"\n            triggerEvent(textarea, \"input\")\n            defer(() => {\n              textarea.value = \"\"\n              defer(() => {\n                textarea.value = \"my caption\"\n                triggerEvent(textarea, \"input\")\n                pressKey(\"return\", () => {\n                  assert.notOk(findElement(\"textarea\"))\n                  assert.textAttributes([ 2, 3 ], { caption: \"my caption\" })\n                  assert.locationRange({ index: 0, offset: 3 })\n                  expectDocument(`ab${OBJECT_REPLACEMENT_CHARACTER}\\n`)\n                })\n              })\n            })\n          })\n        })\n      })\n    })\n  })\n\n  test(\"editing an attachment caption with no filename\", (done) =>\n    after(20, () => {\n      let captionElement = findElement(\"figcaption\")\n      assert.ok(captionElement.clientHeight > 0)\n      assert.equal(captionElement.getAttribute(\"data-trix-placeholder\"), config.lang.captionPlaceholder)\n\n      clickElement(findElement(\"figure\"), () => {\n        captionElement = findElement(\"figcaption\")\n        assert.ok(captionElement.clientHeight > 0)\n        assert.equal(captionElement.getAttribute(\"data-trix-placeholder\"), config.lang.captionPlaceholder)\n        done()\n      })\n    }))\n\n  test(\"updating an attachment's href attribute while editing its caption\", (expectDocument) => {\n    const attachment = getEditorController().attachmentManager.getAttachments()[0]\n\n    after(20, () => {\n      clickElement(findElement(\"figure\"), () => {\n        clickElement(findElement(\"figcaption\"), () => {\n          defer(() => {\n            let textarea = findElement(\"textarea\")\n            assert.ok(textarea)\n            textarea.focus()\n            textarea.value = \"my caption\"\n            triggerEvent(textarea, \"input\")\n            attachment.setAttributes({ href: \"https://example.com\" })\n            defer(() => {\n              textarea = findElement(\"textarea\")\n              assert.ok(document.activeElement === textarea)\n              assert.equal(textarea.value, \"my caption\")\n              pressKey(\"return\", () => {\n                assert.notOk(findElement(\"textarea\"))\n                assert.textAttributes([ 2, 3 ], { caption: \"my caption\" })\n                assert.locationRange({ index: 0, offset: 3 })\n                expectDocument(`ab${OBJECT_REPLACEMENT_CHARACTER}\\n`)\n              })\n            })\n          })\n        })\n      })\n    })\n  })\n\n  testGroup(\"File insertion\", { template: \"editor_empty\" }, () => {\n    test(\"inserting a file in a formatted block\", (expectDocument) => {\n      clickToolbarButton({ attribute: \"bullet\" }, () => {\n        clickToolbarButton({ attribute: \"bold\" }, () => {\n          getComposition().insertFile(createFile())\n          assert.blockAttributes([ 0, 1 ], [ \"bulletList\", \"bullet\" ])\n          assert.textAttributes([ 0, 1 ], {})\n          expectDocument(`${OBJECT_REPLACEMENT_CHARACTER}\\n`)\n        })\n      })\n    })\n\n    test(\"inserting a files in a formatted block\", (expectDocument) => {\n      clickToolbarButton({ attribute: \"quote\" }, () => {\n        clickToolbarButton({ attribute: \"italic\" }, () => {\n          getComposition().insertFiles([ createFile(), createFile() ])\n\n          assert.blockAttributes([ 0, 2 ], [ \"quote\" ])\n          assert.textAttributes([ 0, 1 ], {})\n          assert.textAttributes([ 1, 2 ], {})\n          expectDocument(`${OBJECT_REPLACEMENT_CHARACTER}${OBJECT_REPLACEMENT_CHARACTER}\\n`)\n        })\n      })\n    })\n  })\n})\n\nconst getFigure = () => findElement(\"figure\")\n\nconst findElement = (selector) => getEditorElement().querySelector(selector)\n","import config from \"trix/config\"\nimport {\n  assert,\n  defer,\n  dragToCoordinates,\n  expandSelection,\n  insertNode,\n  moveCursor,\n  pressKey,\n  selectAll,\n  test,\n  testGroup,\n  testIf,\n  triggerEvent,\n  typeCharacters,\n} from \"test/test_helper\"\n\ntestGroup(\"Basic input\", { template: \"editor_empty\" }, () => {\n  test(\"typing\", (expectDocument) => typeCharacters(\"abc\", () => expectDocument(\"abc\\n\")))\n\n  test(\"backspacing\", (expectDocument) =>\n    typeCharacters(\"abc\\b\", () => {\n      assert.locationRange({ index: 0, offset: 2 })\n      expectDocument(\"ab\\n\")\n    }))\n\n  test(\"pressing delete\", (expectDocument) =>\n    typeCharacters(\"ab\", () => moveCursor(\"left\", () => pressKey(\"delete\", () => expectDocument(\"a\\n\")))))\n\n  test(\"pressing return\", (expectDocument) =>\n    typeCharacters(\"ab\", () => pressKey(\"return\", () => typeCharacters(\"c\", () => expectDocument(\"ab\\nc\\n\")))))\n\n  test(\"pressing escape in Safari\", (expectDocument) =>\n    typeCharacters(\"a\", () => {\n      if (triggerEvent(document.activeElement, \"keydown\", { charCode: 0, keyCode: 27, which: 27, key: \"Escape\", code: \"Escape\" })) {\n        triggerEvent(document.activeElement, \"keypress\", { charCode: 27, keyCode: 27, which: 27, key: \"Escape\", code: \"Escape\" })\n      }\n      defer(() => expectDocument(\"a\\n\"))\n    }))\n\n  test(\"pressing escape in Firefox\", (expectDocument) =>\n    typeCharacters(\"a\", () => {\n      if (triggerEvent(document.activeElement, \"keydown\", { charCode: 0, keyCode: 27, which: 27, key: \"Escape\", code: \"Escape\" })) {\n        triggerEvent(document.activeElement, \"keypress\", { charCode: 0, keyCode: 27, which: 0, key: \"Escape\", code: \"Escape\" })\n      }\n      defer(() => expectDocument(\"a\\n\"))\n    }))\n\n  test(\"pressing escape in Chrome\", (expectDocument) =>\n    typeCharacters(\"a\", () => {\n      triggerEvent(document.activeElement, \"keydown\", {\n        charCode: 0,\n        keyCode: 27,\n        which: 27,\n        key: \"Escape\",\n        code: \"Escape\",\n      })\n      defer(() => expectDocument(\"a\\n\"))\n    }))\n\n  test(\"cursor left\", (expectDocument) =>\n    typeCharacters(\"ac\", () => moveCursor(\"left\", () => typeCharacters(\"b\", () => expectDocument(\"abc\\n\")))))\n\n  test(\"replace entire document\", (expectDocument) =>\n    typeCharacters(\"abc\", () => selectAll(() => typeCharacters(\"d\", () => expectDocument(\"d\\n\")))))\n\n  test(\"remove entire document\", (expectDocument) =>\n    typeCharacters(\"abc\", () => selectAll(() => typeCharacters(\"\\b\", () => expectDocument(\"\\n\")))))\n\n  test(\"drag text\", (expectDocument) =>\n    typeCharacters(\"abc\", () =>\n      moveCursor({ direction: \"left\", times: 2 }, (coordinates) =>\n        moveCursor(\"right\", () =>\n          expandSelection(\"right\", () => dragToCoordinates(coordinates, () => expectDocument(\"acb\\n\")))\n        )\n      )\n    ))\n\n  testIf(config.input.getLevel() === 0, \"inserting newline after cursor (control + o)\", (expectDocument) =>\n    typeCharacters(\"ab\", () =>\n      moveCursor(\"left\", () => {\n        triggerEvent(document.activeElement, \"keydown\", { charCode: 0, keyCode: 79, which: 79, ctrlKey: true })\n        defer(() => {\n          assert.locationRange({ index: 0, offset: 1 })\n          expectDocument(\"a\\nb\\n\")\n        })\n      })\n    )\n  )\n\n  testIf(config.input.getLevel() === 0, \"inserting ó with control + alt + o (AltGr)\", (expectDocument) =>\n    typeCharacters(\"ab\", () =>\n      moveCursor(\"left\", () => {\n        if (triggerEvent(document.activeElement, \"keydown\", { charCode: 0, keyCode: 79, which: 79, altKey: true, ctrlKey: true })) {\n          triggerEvent(document.activeElement, \"keypress\", { charCode: 243, keyCode: 243, which: 243, altKey: true, ctrlKey: true })\n          insertNode(document.createTextNode(\"ó\"))\n        }\n\n        defer(() => {\n          assert.locationRange({ index: 0, offset: 2 })\n          expectDocument(\"aób\\n\")\n        })\n      })\n    )\n  )\n})\n","import Text from \"trix/models/text\"\nimport Block from \"trix/models/block\"\nimport Document from \"trix/models/document\"\n\nimport {\n  assert,\n  clickToolbarButton,\n  defer,\n  expandSelection,\n  isToolbarButtonActive,\n  isToolbarButtonDisabled,\n  moveCursor,\n  pressKey,\n  replaceDocument,\n  selectAll,\n  test,\n  testGroup,\n  typeCharacters,\n} from \"test/test_helper\"\n\ntestGroup(\"Block formatting\", { template: \"editor_empty\" }, () => {\n  test(\"applying block attributes\", (done) =>\n    typeCharacters(\"abc\", () =>\n      clickToolbarButton({ attribute: \"quote\" }, () => {\n        assert.blockAttributes([ 0, 4 ], [ \"quote\" ])\n        assert.ok(isToolbarButtonActive({ attribute: \"quote\" }))\n        clickToolbarButton({ attribute: \"code\" }, () => {\n          assert.blockAttributes([ 0, 4 ], [ \"quote\", \"code\" ])\n          assert.ok(isToolbarButtonActive({ attribute: \"code\" }))\n          clickToolbarButton({ attribute: \"code\" }, () => {\n            assert.blockAttributes([ 0, 4 ], [ \"quote\" ])\n            assert.notOk(isToolbarButtonActive({ attribute: \"code\" }))\n            assert.ok(isToolbarButtonActive({ attribute: \"quote\" }))\n            done()\n          })\n        })\n      })\n    ))\n\n  test(\"applying block attributes to text after newline\", (done) => {\n    typeCharacters(\"a\\nbc\", () => {\n      clickToolbarButton({ attribute: \"quote\" }, () => {\n        assert.blockAttributes([ 0, 2 ], [])\n        assert.blockAttributes([ 2, 4 ], [ \"quote\" ])\n        done()\n      })\n    })\n  })\n\n  test(\"applying block attributes to text between newlines\", (done) => {\n    typeCharacters(\"ab\\ndef\\nghi\\nj\\n\", () => {\n      moveCursor({ direction: \"left\", times: 2 }, () => {\n        expandSelection({ direction: \"left\", times: 5 }, () => {\n          clickToolbarButton({ attribute: \"quote\" }, () => {\n            assert.blockAttributes([ 0, 3 ], [])\n            assert.blockAttributes([ 3, 11 ], [ \"quote\" ])\n            assert.blockAttributes([ 11, 13 ], [])\n            done()\n          })\n        })\n      })\n    })\n  })\n\n  test(\"applying bullets to text with newlines\", (done) => {\n    typeCharacters(\"abc\\ndef\\nghi\\njkl\\nmno\\n\", () => {\n      moveCursor({ direction: \"left\", times: 2 }, () => {\n        expandSelection({ direction: \"left\", times: 15 }, () => {\n          clickToolbarButton({ attribute: \"bullet\" }, () => {\n            assert.blockAttributes([ 0, 4 ], [ \"bulletList\", \"bullet\" ])\n            assert.blockAttributes([ 4, 8 ], [ \"bulletList\", \"bullet\" ])\n            assert.blockAttributes([ 8, 12 ], [ \"bulletList\", \"bullet\" ])\n            assert.blockAttributes([ 12, 16 ], [ \"bulletList\", \"bullet\" ])\n            assert.blockAttributes([ 16, 20 ], [ \"bulletList\", \"bullet\" ])\n            done()\n          })\n        })\n      })\n    })\n  })\n\n  test(\"applying block attributes to adjacent unformatted blocks consolidates them\", (done) => {\n    const document = new Document([\n      new Block(Text.textForStringWithAttributes(\"1\"), [ \"bulletList\", \"bullet\" ]),\n      new Block(Text.textForStringWithAttributes(\"a\"), []),\n      new Block(Text.textForStringWithAttributes(\"b\"), []),\n      new Block(Text.textForStringWithAttributes(\"c\"), []),\n      new Block(Text.textForStringWithAttributes(\"2\"), [ \"bulletList\", \"bullet\" ]),\n      new Block(Text.textForStringWithAttributes(\"3\"), [ \"bulletList\", \"bullet\" ]),\n    ])\n\n    replaceDocument(document)\n    getEditorController().setLocationRange([\n      { index: 0, offset: 0 },\n      { index: 5, offset: 1 },\n    ])\n    defer(() => {\n      clickToolbarButton({ attribute: \"quote\" }, () => {\n        assert.blockAttributes([ 0, 2 ], [ \"bulletList\", \"bullet\", \"quote\" ])\n        assert.blockAttributes([ 2, 8 ], [ \"quote\" ])\n        assert.blockAttributes([ 8, 10 ], [ \"bulletList\", \"bullet\", \"quote\" ])\n        assert.blockAttributes([ 10, 12 ], [ \"bulletList\", \"bullet\", \"quote\" ])\n        done()\n      })\n    })\n  })\n\n  test(\"breaking out of the end of a block\", (done) => {\n    typeCharacters(\"abc\", () => {\n      clickToolbarButton({ attribute: \"quote\" }, () => {\n        typeCharacters(\"\\n\\n\", () => {\n          const document = getDocument()\n          assert.equal(document.getBlockCount(), 2)\n\n          let block = document.getBlockAtIndex(0)\n          assert.deepEqual(block.getAttributes(), [ \"quote\" ])\n          assert.equal(block.toString(), \"abc\\n\")\n\n          block = document.getBlockAtIndex(1)\n          assert.deepEqual(block.getAttributes(), [])\n          assert.equal(block.toString(), \"\\n\")\n\n          assert.locationRange({ index: 1, offset: 0 })\n          done()\n        })\n      })\n    })\n  })\n\n  test(\"breaking out of the middle of a block before character\", (done) => {\n    // * = cursor\n    //\n    // ab\n    // *c\n    //\n    typeCharacters(\"abc\", () => {\n      clickToolbarButton({ attribute: \"quote\" }, () => {\n        moveCursor(\"left\", () => {\n          typeCharacters(\"\\n\\n\", () => {\n            const document = getDocument()\n            assert.equal(document.getBlockCount(), 3)\n\n            let block = document.getBlockAtIndex(0)\n            assert.deepEqual(block.getAttributes(), [ \"quote\" ])\n            assert.equal(block.toString(), \"ab\\n\")\n\n            block = document.getBlockAtIndex(1)\n            assert.deepEqual(block.getAttributes(), [])\n            assert.equal(block.toString(), \"\\n\")\n\n            block = document.getBlockAtIndex(2)\n            assert.deepEqual(block.getAttributes(), [ \"quote\" ])\n            assert.equal(block.toString(), \"c\\n\")\n\n            assert.locationRange({ index: 2, offset: 0 })\n            done()\n          })\n        })\n      })\n    })\n  })\n\n  test(\"breaking out of the middle of a block before newline\", (done) => // * = cursor\n    //\n    // ab\n    // *\n    // c\n    //\n    typeCharacters(\"abc\", () =>\n      clickToolbarButton({ attribute: \"quote\" }, () =>\n        moveCursor(\"left\", () =>\n          typeCharacters(\"\\n\", () =>\n            moveCursor(\"left\", () =>\n              typeCharacters(\"\\n\\n\", () => {\n                const document = getDocument()\n                assert.equal(document.getBlockCount(), 3)\n\n                let block = document.getBlockAtIndex(0)\n                assert.deepEqual(block.getAttributes(), [ \"quote\" ])\n                assert.equal(block.toString(), \"ab\\n\")\n\n                block = document.getBlockAtIndex(1)\n                assert.deepEqual(block.getAttributes(), [])\n                assert.equal(block.toString(), \"\\n\")\n\n                block = document.getBlockAtIndex(2)\n                assert.deepEqual(block.getAttributes(), [ \"quote\" ])\n                assert.equal(block.toString(), \"c\\n\")\n\n                done()\n              })\n            )\n          )\n        )\n      )\n    ))\n\n  test(\"breaking out of a formatted block with adjacent non-formatted blocks\", (expectDocument) => {\n    // * = cursor\n    //\n    // a\n    // b*\n    // c\n    let document = new Document([\n      new Block(Text.textForStringWithAttributes(\"a\"), []),\n      new Block(Text.textForStringWithAttributes(\"b\"), [ \"quote\" ]),\n      new Block(Text.textForStringWithAttributes(\"c\"), []),\n    ])\n\n    replaceDocument(document)\n    getEditor().setSelectedRange(3)\n\n    typeCharacters(\"\\n\\n\", () => {\n      document = getDocument()\n      assert.equal(document.getBlockCount(), 4)\n      assert.blockAttributes([ 0, 1 ], [])\n      assert.blockAttributes([ 2, 3 ], [ \"quote\" ])\n      assert.blockAttributes([ 4, 5 ], [])\n      assert.blockAttributes([ 5, 6 ], [])\n      expectDocument(\"a\\nb\\n\\nc\\n\")\n    })\n  })\n\n  test(\"breaking out a block after newline at offset 0\", (done) => // * = cursor\n    //\n    //\n    // *a\n    //\n    typeCharacters(\"a\", () => {\n      clickToolbarButton({ attribute: \"quote\" }, () => {\n        moveCursor(\"left\", () => {\n          typeCharacters(\"\\n\\n\", () => {\n            const document = getDocument()\n            assert.equal(document.getBlockCount(), 2)\n\n            let block = document.getBlockAtIndex(0)\n            assert.deepEqual(block.getAttributes(), [])\n            assert.equal(block.toString(), \"\\n\")\n\n            block = document.getBlockAtIndex(1)\n            assert.deepEqual(block.getAttributes(), [ \"quote\" ])\n            assert.equal(block.toString(), \"a\\n\")\n            assert.locationRange({ index: 1, offset: 0 })\n\n            done()\n          })\n        })\n      })\n    }))\n\n  test(\"deleting the only non-block-break character in a block\", (done) => {\n    typeCharacters(\"ab\", () => {\n      clickToolbarButton({ attribute: \"quote\" }, () => {\n        typeCharacters(\"\\b\\b\", () => {\n          assert.blockAttributes([ 0, 1 ], [ \"quote\" ])\n          done()\n        })\n      })\n    })\n  })\n\n  test(\"backspacing a quote\", (done) => {\n    clickToolbarButton({ attribute: \"quote\" }, () => {\n      assert.blockAttributes([ 0, 1 ], [ \"quote\" ])\n      pressKey(\"backspace\", () => {\n        assert.blockAttributes([ 0, 1 ], [])\n        done()\n      })\n    })\n  })\n\n  test(\"backspacing a nested quote\", (done) => {\n    clickToolbarButton({ attribute: \"quote\" }, () => {\n      clickToolbarButton({ action: \"increaseNestingLevel\" }, () => {\n        assert.blockAttributes([ 0, 1 ], [ \"quote\", \"quote\" ])\n        pressKey(\"backspace\", () => {\n          assert.blockAttributes([ 0, 1 ], [ \"quote\" ])\n          pressKey(\"backspace\", () => {\n            assert.blockAttributes([ 0, 1 ], [])\n            done()\n          })\n        })\n      })\n    })\n  })\n\n  test(\"backspacing a list item\", (done) => {\n    clickToolbarButton({ attribute: \"bullet\" }, () => {\n      assert.blockAttributes([ 0, 1 ], [ \"bulletList\", \"bullet\" ])\n      pressKey(\"backspace\", () => {\n        assert.blockAttributes([ 0, 0 ], [])\n        done()\n      })\n    })\n  })\n\n  test(\"backspacing a nested list item\", (expectDocument) => {\n    clickToolbarButton({ attribute: \"bullet\" }, () => {\n      typeCharacters(\"a\\n\", () => {\n        clickToolbarButton({ action: \"increaseNestingLevel\" }, () => {\n          assert.blockAttributes([ 2, 3 ], [ \"bulletList\", \"bullet\", \"bulletList\", \"bullet\" ])\n          pressKey(\"backspace\", () => {\n            assert.blockAttributes([ 2, 3 ], [ \"bulletList\", \"bullet\" ])\n            expectDocument(\"a\\n\\n\")\n          })\n        })\n      })\n    })\n  })\n\n  test(\"backspacing a list item inside a quote\", (done) => {\n    clickToolbarButton({ attribute: \"quote\" }, () => {\n      clickToolbarButton({ attribute: \"bullet\" }, () => {\n        assert.blockAttributes([ 0, 1 ], [ \"quote\", \"bulletList\", \"bullet\" ])\n        pressKey(\"backspace\", () => {\n          assert.blockAttributes([ 0, 1 ], [ \"quote\" ])\n          pressKey(\"backspace\", () => {\n            assert.blockAttributes([ 0, 1 ], [])\n            done()\n          })\n        })\n      })\n    })\n  })\n\n  test(\"backspacing selected nested list items\", (expectDocument) => {\n    clickToolbarButton({ attribute: \"bullet\" }, () => {\n      typeCharacters(\"a\\n\", () => {\n        clickToolbarButton({ action: \"increaseNestingLevel\" }, () => {\n          typeCharacters(\"b\", () => {\n            getSelectionManager().setLocationRange([\n              { index: 0, offset: 0 },\n              { index: 1, offset: 1 },\n            ])\n            pressKey(\"backspace\", () => {\n              assert.blockAttributes([ 0, 1 ], [ \"bulletList\", \"bullet\" ])\n              expectDocument(\"\\n\")\n            })\n          })\n        })\n      })\n    })\n  })\n\n  test(\"backspace selection spanning formatted blocks\", (expectDocument) => {\n    clickToolbarButton({ attribute: \"quote\" }, () => {\n      typeCharacters(\"ab\\n\\n\", () => {\n        clickToolbarButton({ attribute: \"code\" }, () => {\n          typeCharacters(\"cd\", () => {\n            getSelectionManager().setLocationRange([\n              { index: 0, offset: 1 },\n              { index: 1, offset: 1 },\n            ])\n            getComposition().deleteInDirection(\"backward\")\n            assert.blockAttributes([ 0, 2 ], [ \"quote\" ])\n            expectDocument(\"ad\\n\")\n          })\n        })\n      })\n    })\n  })\n\n  test(\"backspace selection spanning and entire formatted block and a formatted block\", (expectDocument) => {\n    clickToolbarButton({ attribute: \"quote\" }, () => {\n      typeCharacters(\"ab\\n\\n\", () => {\n        clickToolbarButton({ attribute: \"code\" }, () => {\n          typeCharacters(\"cd\", () => {\n            getSelectionManager().setLocationRange([\n              { index: 0, offset: 0 },\n              { index: 1, offset: 1 },\n            ])\n            getComposition().deleteInDirection(\"backward\")\n            assert.blockAttributes([ 0, 2 ], [ \"code\" ])\n            expectDocument(\"d\\n\")\n          })\n        })\n      })\n    })\n  })\n\n  test(\"increasing list level\", (done) => {\n    assert.ok(isToolbarButtonDisabled({ action: \"increaseNestingLevel\" }))\n    assert.ok(isToolbarButtonDisabled({ action: \"decreaseNestingLevel\" }))\n    clickToolbarButton({ attribute: \"bullet\" }, () => {\n      assert.ok(isToolbarButtonDisabled({ action: \"increaseNestingLevel\" }))\n      assert.notOk(isToolbarButtonDisabled({ action: \"decreaseNestingLevel\" }))\n      typeCharacters(\"a\\n\", () => {\n        assert.notOk(isToolbarButtonDisabled({ action: \"increaseNestingLevel\" }))\n        assert.notOk(isToolbarButtonDisabled({ action: \"decreaseNestingLevel\" }))\n        clickToolbarButton({ action: \"increaseNestingLevel\" }, () => {\n          typeCharacters(\"b\", () => {\n            assert.ok(isToolbarButtonDisabled({ action: \"increaseNestingLevel\" }))\n            assert.notOk(isToolbarButtonDisabled({ action: \"decreaseNestingLevel\" }))\n            assert.blockAttributes([ 0, 2 ], [ \"bulletList\", \"bullet\" ])\n            assert.blockAttributes([ 2, 4 ], [ \"bulletList\", \"bullet\", \"bulletList\", \"bullet\" ])\n            done()\n          })\n        })\n      })\n    })\n  })\n\n  test(\"changing list type\", (done) =>\n    clickToolbarButton({ attribute: \"bullet\" }, () => {\n      assert.blockAttributes([ 0, 1 ], [ \"bulletList\", \"bullet\" ])\n      clickToolbarButton({ attribute: \"number\" }, () => {\n        assert.blockAttributes([ 0, 1 ], [ \"numberList\", \"number\" ])\n        done()\n      })\n    }))\n\n  test(\"adding bullet to heading block\", (done) =>\n    clickToolbarButton({ attribute: \"heading1\" }, () =>\n      clickToolbarButton({ attribute: \"bullet\" }, () => {\n        assert.ok(isToolbarButtonActive({ attribute: \"heading1\" }))\n        assert.blockAttributes([ 1, 2 ], [])\n        done()\n      })\n    ))\n\n  test(\"removing bullet from heading block\", (done) =>\n    clickToolbarButton({ attribute: \"bullet\" }, () =>\n      clickToolbarButton({ attribute: \"heading1\" }, () => {\n        assert.ok(isToolbarButtonDisabled({ attribute: \"bullet\" }))\n        done()\n      })\n    ))\n\n  test(\"breaking out of heading in list\", (expectDocument) =>\n    clickToolbarButton({ attribute: \"bullet\" }, () =>\n      clickToolbarButton({ attribute: \"heading1\" }, () => {\n        assert.ok(isToolbarButtonActive({ attribute: \"heading1\" }))\n        typeCharacters(\"abc\", () => {\n          typeCharacters(\"\\n\", () => {\n            assert.ok(isToolbarButtonActive({ attribute: \"bullet\" }))\n            const document = getDocument()\n            assert.equal(document.getBlockCount(), 2)\n            assert.blockAttributes([ 0, 4 ], [ \"bulletList\", \"bullet\", \"heading1\" ])\n            assert.blockAttributes([ 4, 5 ], [ \"bulletList\", \"bullet\" ])\n            expectDocument(\"abc\\n\\n\")\n          })\n        })\n      })\n    ))\n\n  test(\"breaking out of middle of heading block\", (expectDocument) =>\n    clickToolbarButton({ attribute: \"heading1\" }, () =>\n      typeCharacters(\"abc\", () => {\n        assert.ok(isToolbarButtonActive({ attribute: \"heading1\" }))\n        moveCursor({ direction: \"left\", times: 1 }, () => {\n          typeCharacters(\"\\n\", () => {\n            const document = getDocument()\n            assert.equal(document.getBlockCount(), 2)\n            assert.blockAttributes([ 0, 3 ], [ \"heading1\" ])\n            assert.blockAttributes([ 3, 4 ], [ \"heading1\" ])\n            expectDocument(\"ab\\nc\\n\")\n          })\n        })\n      })\n    ))\n\n  test(\"breaking out of middle of heading block with preceding blocks\", (expectDocument) => {\n    let document = new Document([\n      new Block(Text.textForStringWithAttributes(\"a\"), [ \"heading1\" ]),\n      new Block(Text.textForStringWithAttributes(\"b\"), []),\n      new Block(Text.textForStringWithAttributes(\"cd\"), [ \"heading1\" ]),\n    ])\n\n    replaceDocument(document)\n    getEditor().setSelectedRange(5)\n    assert.ok(isToolbarButtonActive({ attribute: \"heading1\" }))\n\n    typeCharacters(\"\\n\", () => {\n      document = getDocument()\n      assert.equal(document.getBlockCount(), 4)\n      assert.blockAttributes([ 0, 1 ], [ \"heading1\" ])\n      assert.blockAttributes([ 2, 3 ], [])\n      assert.blockAttributes([ 4, 5 ], [ \"heading1\" ])\n      assert.blockAttributes([ 6, 7 ], [ \"heading1\" ])\n      expectDocument(\"a\\nb\\nc\\nd\\n\")\n    })\n  })\n\n  test(\"breaking out of end of heading block with preceding blocks\", (expectDocument) => {\n    let document = new Document([\n      new Block(Text.textForStringWithAttributes(\"a\"), [ \"heading1\" ]),\n      new Block(Text.textForStringWithAttributes(\"b\"), []),\n      new Block(Text.textForStringWithAttributes(\"cd\"), [ \"heading1\" ]),\n    ])\n\n    replaceDocument(document)\n    getEditor().setSelectedRange(6)\n    assert.ok(isToolbarButtonActive({ attribute: \"heading1\" }))\n\n    typeCharacters(\"\\n\", () => {\n      document = getDocument()\n      assert.equal(document.getBlockCount(), 4)\n      assert.blockAttributes([ 0, 1 ], [ \"heading1\" ])\n      assert.blockAttributes([ 2, 3 ], [])\n      assert.blockAttributes([ 4, 6 ], [ \"heading1\" ])\n      assert.blockAttributes([ 7, 8 ], [])\n      expectDocument(\"a\\nb\\ncd\\n\\n\")\n    })\n  })\n\n  test(\"inserting newline before heading\", (done) => {\n    let document = new Document([\n      new Block(Text.textForStringWithAttributes(\"\\n\"), []),\n      new Block(Text.textForStringWithAttributes(\"abc\"), [ \"heading1\" ]),\n    ])\n\n    replaceDocument(document)\n    getEditor().setSelectedRange(0)\n\n    typeCharacters(\"\\n\", () => {\n      document = getDocument()\n      assert.equal(document.getBlockCount(), 2)\n\n      let block = document.getBlockAtIndex(0)\n      assert.deepEqual(block.getAttributes(), [])\n      assert.equal(block.toString(), \"\\n\\n\\n\")\n\n      block = document.getBlockAtIndex(1)\n      assert.deepEqual(block.getAttributes(), [ \"heading1\" ])\n      assert.equal(block.toString(), \"abc\\n\")\n\n      done()\n    })\n  })\n\n  test(\"inserting multiple newlines before heading\", (done) => {\n    let document = new Document([\n      new Block(Text.textForStringWithAttributes(\"\\n\"), []),\n      new Block(Text.textForStringWithAttributes(\"abc\"), [ \"heading1\" ]),\n    ])\n\n    replaceDocument(document)\n    getEditor().setSelectedRange(0)\n\n    typeCharacters(\"\\n\\n\", () => {\n      document = getDocument()\n      assert.equal(document.getBlockCount(), 2)\n\n      let block = document.getBlockAtIndex(0)\n      assert.deepEqual(block.getAttributes(), [])\n      assert.equal(block.toString(), \"\\n\\n\\n\\n\")\n\n      block = document.getBlockAtIndex(1)\n      assert.deepEqual(block.getAttributes(), [ \"heading1\" ])\n      assert.equal(block.toString(), \"abc\\n\")\n      done()\n    })\n  })\n\n  test(\"inserting multiple newlines before formatted block\", (expectDocument) => {\n    let document = new Document([\n      new Block(Text.textForStringWithAttributes(\"\\n\"), []),\n      new Block(Text.textForStringWithAttributes(\"abc\"), [ \"quote\" ]),\n    ])\n\n    replaceDocument(document)\n    getEditor().setSelectedRange(1)\n\n    typeCharacters(\"\\n\\n\", () => {\n      document = getDocument()\n      assert.equal(document.getBlockCount(), 2)\n      assert.blockAttributes([ 0, 1 ], [])\n      assert.blockAttributes([ 2, 3 ], [])\n      assert.blockAttributes([ 4, 6 ], [ \"quote\" ])\n      assert.locationRange({ index: 0, offset: 3 })\n      expectDocument(\"\\n\\n\\n\\nabc\\n\")\n    })\n  })\n\n  test(\"inserting newline after heading with text in following block\", (expectDocument) => {\n    let document = new Document([\n      new Block(Text.textForStringWithAttributes(\"ab\"), [ \"heading1\" ]),\n      new Block(Text.textForStringWithAttributes(\"cd\"), []),\n    ])\n\n    replaceDocument(document)\n    getEditor().setSelectedRange(2)\n\n    typeCharacters(\"\\n\", () => {\n      document = getDocument()\n      assert.equal(document.getBlockCount(), 3)\n      assert.blockAttributes([ 0, 2 ], [ \"heading1\" ])\n      assert.blockAttributes([ 3, 4 ], [])\n      assert.blockAttributes([ 5, 6 ], [])\n      expectDocument(\"ab\\n\\ncd\\n\")\n    })\n  })\n\n  test(\"backspacing a newline in an empty block with adjacent formatted blocks\", (expectDocument) => {\n    let document = new Document([\n      new Block(Text.textForStringWithAttributes(\"abc\"), [ \"heading1\" ]),\n      new Block(),\n      new Block(Text.textForStringWithAttributes(\"d\"), [ \"heading1\" ]),\n    ])\n\n    replaceDocument(document)\n    getEditor().setSelectedRange(4)\n\n    pressKey(\"backspace\", () => {\n      document = getDocument()\n      assert.equal(document.getBlockCount(), 2)\n      assert.blockAttributes([ 0, 1 ], [ \"heading1\" ])\n      assert.blockAttributes([ 2, 3 ], [ \"heading1\" ])\n      expectDocument(\"abc\\nd\\n\")\n    })\n  })\n\n  test(\"backspacing a newline at beginning of non-formatted block\", (expectDocument) => {\n    let document = new Document([\n      new Block(Text.textForStringWithAttributes(\"ab\"), [ \"heading1\" ]),\n      new Block(Text.textForStringWithAttributes(\"\\ncd\"), []),\n    ])\n\n    replaceDocument(document)\n    getEditor().setSelectedRange(3)\n\n    pressKey(\"backspace\", () => {\n      document = getDocument()\n      assert.equal(document.getBlockCount(), 2)\n      assert.blockAttributes([ 0, 2 ], [ \"heading1\" ])\n      assert.blockAttributes([ 3, 5 ], [])\n      expectDocument(\"ab\\ncd\\n\")\n    })\n  })\n\n  test(\"inserting newline after single character header\", (expectDocument) =>\n    clickToolbarButton({ attribute: \"heading1\" }, () =>\n      typeCharacters(\"a\", () =>\n        typeCharacters(\"\\n\", () => {\n          const document = getDocument()\n          assert.equal(document.getBlockCount(), 2)\n          assert.blockAttributes([ 0, 1 ], [ \"heading1\" ])\n          expectDocument(\"a\\n\\n\")\n        })\n      )\n    ))\n\n  test(\"terminal attributes are only added once\", (expectDocument) => {\n    replaceDocument(\n      new Document([\n        new Block(Text.textForStringWithAttributes(\"a\"), []),\n        new Block(Text.textForStringWithAttributes(\"b\"), [ \"heading1\" ]),\n        new Block(Text.textForStringWithAttributes(\"c\"), []),\n      ])\n    )\n\n    selectAll(() =>\n      clickToolbarButton({ attribute: \"heading1\" }, () => {\n        assert.equal(getDocument().getBlockCount(), 3)\n        assert.blockAttributes([ 0, 1 ], [ \"heading1\" ])\n        assert.blockAttributes([ 2, 3 ], [ \"heading1\" ])\n        assert.blockAttributes([ 4, 5 ], [ \"heading1\" ])\n        expectDocument(\"a\\nb\\nc\\n\")\n      })\n    )\n  })\n\n  test(\"terminal attributes replace existing terminal attributes\", (expectDocument) => {\n    replaceDocument(\n      new Document([\n        new Block(Text.textForStringWithAttributes(\"a\"), []),\n        new Block(Text.textForStringWithAttributes(\"b\"), [ \"heading1\" ]),\n        new Block(Text.textForStringWithAttributes(\"c\"), []),\n      ])\n    )\n\n    selectAll(() =>\n      clickToolbarButton({ attribute: \"code\" }, () => {\n        assert.equal(getDocument().getBlockCount(), 3)\n        assert.blockAttributes([ 0, 1 ], [ \"code\" ])\n        assert.blockAttributes([ 2, 3 ], [ \"code\" ])\n        assert.blockAttributes([ 4, 5 ], [ \"code\" ])\n        expectDocument(\"a\\nb\\nc\\n\")\n      })\n    )\n  })\n\n  test(\"code blocks preserve newlines\", (expectDocument) =>\n    typeCharacters(\"a\\nb\", () =>\n      selectAll(() =>\n        clickToolbarButton({ attribute: \"code\" }, () => {\n          assert.equal(getDocument().getBlockCount(), 1)\n          assert.blockAttributes([ 0, 3 ], [ \"code\" ])\n          expectDocument(\"a\\nb\\n\")\n        })\n      )\n    ))\n\n  test(\"code blocks are not indentable\", (done) =>\n    clickToolbarButton({ attribute: \"code\" }, () => {\n      assert.notOk(isToolbarButtonActive({ action: \"increaseNestingLevel\" }))\n      done()\n    }))\n\n  test(\"code blocks are terminal\", (done) =>\n    clickToolbarButton({ attribute: \"code\" }, () => {\n      assert.ok(isToolbarButtonDisabled({ attribute: \"quote\" }))\n      assert.ok(isToolbarButtonDisabled({ attribute: \"heading1\" }))\n      assert.ok(isToolbarButtonDisabled({ attribute: \"bullet\" }))\n      assert.ok(isToolbarButtonDisabled({ attribute: \"number\" }))\n      assert.notOk(isToolbarButtonDisabled({ attribute: \"code\" }))\n      assert.notOk(isToolbarButtonDisabled({ attribute: \"bold\" }))\n      assert.notOk(isToolbarButtonDisabled({ attribute: \"italic\" }))\n      done()\n    }))\n\n  test(\"unindenting a code block inside a bullet\", (expectDocument) =>\n    clickToolbarButton({ attribute: \"bullet\" }, () =>\n      clickToolbarButton({ attribute: \"code\" }, () =>\n        typeCharacters(\"a\", () =>\n          clickToolbarButton({ action: \"decreaseNestingLevel\" }, () => {\n            const document = getDocument()\n            assert.equal(document.getBlockCount(), 1)\n            assert.blockAttributes([ 0, 1 ], [ \"code\" ])\n            expectDocument(\"a\\n\")\n          })\n        )\n      )\n    ))\n\n  test(\"indenting a heading inside a bullet\", (expectDocument) =>\n    clickToolbarButton({ attribute: \"bullet\" }, () =>\n      typeCharacters(\"a\", () =>\n        typeCharacters(\"\\n\", () =>\n          clickToolbarButton({ attribute: \"heading1\" }, () =>\n            typeCharacters(\"b\", () =>\n              clickToolbarButton({ action: \"increaseNestingLevel\" }, () => {\n                const document = getDocument()\n                assert.equal(document.getBlockCount(), 2)\n                assert.blockAttributes([ 0, 1 ], [ \"bulletList\", \"bullet\" ])\n                assert.blockAttributes([ 2, 3 ], [ \"bulletList\", \"bullet\", \"bulletList\", \"bullet\", \"heading1\" ])\n                expectDocument(\"a\\nb\\n\")\n              })\n            )\n          )\n        )\n      )\n    ))\n\n  test(\"indenting a quote inside a bullet\", (expectDocument) =>\n    clickToolbarButton({ attribute: \"bullet\" }, () =>\n      clickToolbarButton({ attribute: \"quote\" }, () =>\n        clickToolbarButton({ action: \"increaseNestingLevel\" }, () => {\n          const document = getDocument()\n          assert.equal(document.getBlockCount(), 1)\n          assert.blockAttributes([ 0, 1 ], [ \"bulletList\", \"bullet\", \"quote\", \"quote\" ])\n          expectDocument(\"\\n\")\n        })\n      )\n    ))\n\n  test(\"list indentation constraints consider the list type\", (expectDocument) =>\n    clickToolbarButton({ attribute: \"bullet\" }, () =>\n      typeCharacters(\"a\\n\\n\", () =>\n        clickToolbarButton({ attribute: \"number\" }, () =>\n          clickToolbarButton({ action: \"increaseNestingLevel\" }, () => {\n            const document = getDocument()\n            assert.equal(document.getBlockCount(), 2)\n            assert.blockAttributes([ 0, 1 ], [ \"bulletList\", \"bullet\" ])\n            assert.blockAttributes([ 2, 3 ], [ \"numberList\", \"number\" ])\n            expectDocument(\"a\\n\\n\")\n          })\n        )\n      )\n    ))\n})\n","import { assert, clickToolbarButton, moveCursor, test, testGroup, typeCharacters } from \"test/test_helper\"\n\ntestGroup(\"View caching\", { template: \"editor_empty\" }, () => {\n  test(\"reparsing and rendering identical texts\", (done) =>\n    typeCharacters(\"a\\nb\\na\", () =>\n      moveCursor({ direction: \"left\", times: 2 }, () =>\n        clickToolbarButton({ attribute: \"quote\" }, () => {\n          const html = getEditorElement().innerHTML\n          getEditorController().reparse()\n          getEditorController().render()\n          assert.equal(getEditorElement().innerHTML, html)\n          done()\n        })\n      )\n    ))\n\n  test(\"reparsing and rendering identical blocks\", (done) =>\n    clickToolbarButton({ attribute: \"bullet\" }, () =>\n      typeCharacters(\"a\\na\", () => {\n        const html = getEditorElement().innerHTML\n        getEditorController().reparse()\n        getEditorController().render()\n        assert.equal(getEditorElement().innerHTML, html)\n        done()\n      })\n    ))\n})\n","import { pressKey, test, testGroup, typeCharacters } from \"test/test_helper\"\n\nconst testOptions = {\n  template: \"editor_empty\",\n  setup() {\n    let handler\n    addEventListener(\"keydown\", cancel, true)\n    addEventListener(\n      \"trix-before-initialize\",\n      handler = function ({ target }) {\n        removeEventListener(\"trix-before-initialize\", handler)\n        target.addEventListener(\"keydown\", cancel)\n      }\n    )\n  },\n  teardown() {\n    removeEventListener(\"keydown\", cancel, true)\n  },\n}\n\nlet cancelingInCapturingPhase = false\nlet cancelingAtTarget = false\n\nconst cancel = (event) => {\n  switch (event.eventPhase) {\n    case Event.prototype.CAPTURING_PHASE:\n      if (cancelingInCapturingPhase) {\n        event.preventDefault()\n      }\n      break\n    case Event.prototype.AT_TARGET:\n      if (cancelingAtTarget) {\n        event.preventDefault()\n      }\n      break\n  }\n}\n\ntestGroup(\"Canceled input\", testOptions, () => {\n  test(\"ignoring canceled input events in capturing phase\", (expectDocument) =>\n    typeCharacters(\"a\", () => {\n      cancelingInCapturingPhase = true\n      pressKey(\"backspace\", () =>\n        pressKey(\"return\", () => {\n          cancelingInCapturingPhase = false\n          typeCharacters(\"b\", () => expectDocument(\"ab\\n\"))\n        })\n      )\n    }))\n\n  test(\"ignoring canceled input events at target\", (expectDocument) =>\n    typeCharacters(\"a\", () => {\n      cancelingAtTarget = true\n      pressKey(\"backspace\", () =>\n        pressKey(\"return\", () => {\n          cancelingAtTarget = false\n          typeCharacters(\"b\", () => expectDocument(\"ab\\n\"))\n        })\n      )\n    }))\n})\n","import config from \"trix/config\"\n\nimport {\n  assert,\n  clickToolbarButton,\n  defer,\n  endComposition,\n  insertNode,\n  pressKey,\n  selectNode,\n  startComposition,\n  test,\n  testGroup,\n  testIf,\n  triggerEvent,\n  triggerInputEvent,\n  typeCharacters,\n  updateComposition,\n} from \"test/test_helper\"\n\ntestGroup(\"Composition input\", { template: \"editor_empty\" }, () => {\n  test(\"composing\", (expectDocument) =>\n    startComposition(\"a\", () => updateComposition(\"ab\", () => endComposition(\"abc\", () => expectDocument(\"abc\\n\")))))\n\n  test(\"typing and composing\", (expectDocument) =>\n    typeCharacters(\"a\", () =>\n      startComposition(\"b\", () =>\n        updateComposition(\"bc\", () => endComposition(\"bcd\", () => typeCharacters(\"e\", () => expectDocument(\"abcde\\n\"))))\n      )\n    ))\n\n  test(\"composition input is serialized\", (expectDocument) =>\n    startComposition(\"´\", () =>\n      endComposition(\"é\", () => {\n        assert.equal(getEditorElement().value, \"<div>é</div>\")\n        expectDocument(\"é\\n\")\n      })\n    ))\n\n  test(\"pressing after a canceled composition\", (expectDocument) =>\n    typeCharacters(\"ab\", () => {\n      triggerEvent(document.activeElement, \"compositionend\", { data: \"ab\" })\n      pressKey(\"return\", () => expectDocument(\"ab\\n\\n\"))\n    }))\n\n  test(\"composing formatted text\", (expectDocument) =>\n    typeCharacters(\"abc\", () =>\n      clickToolbarButton({ attribute: \"bold\" }, () =>\n        startComposition(\"d\", () =>\n          updateComposition(\"de\", () =>\n            endComposition(\"def\", () => {\n              assert.textAttributes([ 0, 3 ], {})\n              assert.textAttributes([ 3, 6 ], { bold: true })\n              expectDocument(\"abcdef\\n\")\n            })\n          )\n        )\n      )\n    ))\n\n  test(\"composing away from formatted text\", (expectDocument) =>\n    clickToolbarButton({ attribute: \"bold\" }, () =>\n      typeCharacters(\"abc\", () =>\n        clickToolbarButton({ attribute: \"bold\" }, () =>\n          startComposition(\"d\", () =>\n            updateComposition(\"de\", () =>\n              endComposition(\"def\", () => {\n                assert.textAttributes([ 0, 3 ], { bold: true })\n                assert.textAttributes([ 3, 6 ], {})\n                expectDocument(\"abcdef\\n\")\n              })\n            )\n          )\n        )\n      )\n    ))\n\n  test(\"composing another language using a QWERTY keyboard\", (expectDocument) => {\n    const element = getEditorElement()\n    const keyCodes = { x: 120, i: 105 }\n\n    triggerEvent(element, \"keypress\", { charCode: keyCodes.x, keyCode: keyCodes.x, which: keyCodes.x })\n    startComposition(\"x\", () => {\n      triggerEvent(element, \"keypress\", { charCode: keyCodes.i, keyCode: keyCodes.i, which: keyCodes.i })\n      updateComposition(\"xi\", () => endComposition(\"喜\", () => expectDocument(\"喜\\n\")))\n    })\n  })\n\n  // Simulates the sequence of events when pressing backspace through a word on Android\n  testIf(config.input.getLevel() === 0, \"backspacing through a composition\", (expectDocument) => {\n    const element = getEditorElement()\n    element.editor.insertString(\"a cat\")\n\n    triggerEvent(element, \"keydown\", { charCode: 0, keyCode: 229, which: 229 })\n    triggerEvent(element, \"compositionupdate\", { data: \"ca\" })\n    triggerEvent(element, \"input\")\n    removeCharacters(-1, () => {\n      triggerEvent(element, \"keydown\", { charCode: 0, keyCode: 229, which: 229 })\n      triggerEvent(element, \"compositionupdate\", { data: \"c\" })\n      triggerEvent(element, \"input\")\n      triggerEvent(element, \"compositionend\", { data: \"c\" })\n      removeCharacters(-1, () => pressKey(\"backspace\", () => expectDocument(\"a \\n\")))\n    })\n  })\n\n  // Simulates the sequence of events when pressing backspace at the end of a\n  // word and updating it on Android (running older versions of System WebView)\n  testIf(config.input.getLevel() === 0, \"updating a composition\", (expectDocument) => {\n    const element = getEditorElement()\n    element.editor.insertString(\"cat\")\n\n    triggerEvent(element, \"keydown\", { charCode: 0, keyCode: 229, which: 229 })\n    triggerEvent(element, \"compositionstart\", { data: \"cat\" })\n    triggerEvent(element, \"compositionupdate\", { data: \"cat\" })\n    triggerEvent(element, \"input\")\n    removeCharacters(-1, () => {\n      triggerEvent(element, \"keydown\", { charCode: 0, keyCode: 229, which: 229 })\n      triggerEvent(element, \"compositionupdate\", { data: \"car\" })\n      triggerEvent(element, \"input\")\n      triggerEvent(element, \"compositionend\", { data: \"car\" })\n      insertNode(document.createTextNode(\"r\"), () => expectDocument(\"car\\n\"))\n    })\n  })\n\n  // Simulates the sequence of events when typing on Android and then tapping elsewhere\n  testIf(config.input.getLevel() === 0, \"leaving a composition\", (expectDocument) => {\n    const element = getEditorElement()\n\n    triggerEvent(element, \"keydown\", { charCode: 0, keyCode: 229, which: 229 })\n    triggerEvent(element, \"compositionstart\", { data: \"\" })\n    triggerInputEvent(element, \"beforeinput\", { inputType: \"insertCompositionText\", data: \"c\" })\n    triggerEvent(element, \"compositionupdate\", { data: \"c\" })\n    triggerEvent(element, \"input\")\n    const node = document.createTextNode(\"c\")\n    insertNode(node)\n    selectNode(node)\n    defer(() => {\n      triggerEvent(element, \"keydown\", { charCode: 0, keyCode: 229, which: 229 })\n      triggerInputEvent(element, \"beforeinput\", { inputType: \"insertCompositionText\", data: \"ca\" })\n      triggerEvent(element, \"compositionupdate\", { data: \"ca\" })\n      triggerEvent(element, \"input\")\n      node.data = \"ca\"\n      defer(() => {\n        triggerEvent(element, \"compositionend\", { data: \"\" })\n        defer(() => expectDocument(\"ca\\n\"))\n      })\n    })\n  })\n\n  testIf(config.browser.composesExistingText, \"composition events from cursor movement are ignored\", (expectDocument) => {\n    const element = getEditorElement()\n    element.editor.insertString(\"ab \")\n\n    element.editor.setSelectedRange(0)\n    triggerEvent(element, \"compositionstart\", { data: \"\" })\n    triggerEvent(element, \"compositionupdate\", { data: \"ab\" })\n    defer(() => {\n      element.editor.setSelectedRange(1)\n      triggerEvent(element, \"compositionupdate\", { data: \"ab\" })\n      defer(() => {\n        element.editor.setSelectedRange(2)\n        triggerEvent(element, \"compositionupdate\", { data: \"ab\" })\n        defer(() => {\n          element.editor.setSelectedRange(3)\n          triggerEvent(element, \"compositionend\", { data: \"ab\" })\n          defer(() => expectDocument(\"ab \\n\"))\n        })\n      })\n    })\n  })\n\n  // Simulates compositions in Firefox where the final composition data is\n  // dispatched as both compositionupdate and compositionend.\n  testIf(config.input.getLevel() === 0, \"composition ending with same data as last update\", (expectDocument) => {\n    const element = getEditorElement()\n\n    triggerEvent(element, \"keydown\", { charCode: 0, keyCode: 229, which: 229 })\n    triggerEvent(element, \"compositionstart\", { data: \"\" })\n    triggerEvent(element, \"compositionupdate\", { data: \"´\" })\n    const node = document.createTextNode(\"´\")\n    insertNode(node)\n    selectNode(node)\n    defer(() => {\n      triggerEvent(element, \"keydown\", { charCode: 0, keyCode: 229, which: 229 })\n      triggerEvent(element, \"compositionupdate\", { data: \"é\" })\n      triggerEvent(element, \"input\")\n      node.data = \"é\"\n      defer(() => {\n        triggerEvent(element, \"keydown\", { charCode: 0, keyCode: 229, which: 229 })\n        triggerEvent(element, \"compositionupdate\", { data: \"éé\" })\n        triggerEvent(element, \"input\")\n        node.data = \"éé\"\n        defer(() => {\n          triggerEvent(element, \"compositionend\", { data: \"éé\" })\n          defer(() => {\n            assert.locationRange({ index: 0, offset: 2 })\n            expectDocument(\"éé\\n\")\n          })\n        })\n      })\n    })\n  })\n})\n\nconst removeCharacters = function (direction, callback) {\n  const selection = rangy.getSelection()\n  const range = selection.getRangeAt(0)\n  range.moveStart(\"character\", direction)\n  range.deleteContents()\n  defer(callback)\n}\n","import {\n  assert,\n  createFile,\n  expandSelection,\n  insertFile,\n  insertString,\n  moveCursor,\n  test,\n  testGroup,\n} from \"test/test_helper\"\n\ntestGroup(\"Cursor movement\", { template: \"editor_empty\" }, () => {\n  test(\"move cursor around attachment\", (done) => {\n    insertFile(createFile())\n    assert.locationRange({ index: 0, offset: 1 })\n    moveCursor(\"left\", () => {\n      assert.locationRange({ index: 0, offset: 0 }, { index: 0, offset: 1 })\n      moveCursor(\"left\", () => {\n        assert.locationRange({ index: 0, offset: 0 })\n        moveCursor(\"right\", () => {\n          assert.locationRange({ index: 0, offset: 0 }, { index: 0, offset: 1 })\n          moveCursor(\"right\", () => {\n            assert.locationRange({ index: 0, offset: 1 })\n            done()\n          })\n        })\n      })\n    })\n  })\n\n  test(\"move cursor around attachment and text\", (done) => {\n    insertString(\"a\")\n    insertFile(createFile())\n    insertString(\"b\")\n    assert.locationRange({ index: 0, offset: 3 })\n    moveCursor(\"left\", () => {\n      assert.locationRange({ index: 0, offset: 2 })\n      moveCursor(\"left\", () => {\n        assert.locationRange({ index: 0, offset: 1 }, { index: 0, offset: 2 })\n        moveCursor(\"left\", () => {\n          assert.locationRange({ index: 0, offset: 1 })\n          moveCursor(\"left\", () => {\n            assert.locationRange({ index: 0, offset: 0 })\n            done()\n          })\n        })\n      })\n    })\n  })\n\n  test(\"expand selection over attachment\", (done) => {\n    insertFile(createFile())\n    assert.locationRange({ index: 0, offset: 1 })\n    expandSelection(\"left\", () => {\n      assert.locationRange({ index: 0, offset: 0 }, { index: 0, offset: 1 })\n      moveCursor(\"left\", () => {\n        assert.locationRange({ index: 0, offset: 0 })\n        expandSelection(\"right\", () => {\n          assert.locationRange({ index: 0, offset: 0 }, { index: 0, offset: 1 })\n          done()\n        })\n      })\n    })\n  })\n\n  test(\"expand selection over attachment and text\", (done) => {\n    insertString(\"a\")\n    insertFile(createFile())\n    insertString(\"b\")\n    assert.locationRange({ index: 0, offset: 3 })\n    expandSelection(\"left\", () => {\n      assert.locationRange({ index: 0, offset: 2 }, { index: 0, offset: 3 })\n      expandSelection(\"left\", () => {\n        assert.locationRange({ index: 0, offset: 1 }, { index: 0, offset: 3 })\n        expandSelection(\"left\", () => {\n          assert.locationRange({ index: 0, offset: 0 }, { index: 0, offset: 3 })\n          done()\n        })\n      })\n    })\n  })\n})\n","import { rangesAreEqual } from \"trix/core/helpers\"\n\nimport {\n  TEST_IMAGE_URL,\n  after,\n  assert,\n  clickElement,\n  clickToolbarButton,\n  createFile,\n  defer,\n  insertImageAttachment,\n  moveCursor,\n  pasteContent,\n  test,\n  testGroup,\n  testIf,\n  triggerEvent,\n  typeCharacters,\n  typeInToolbarDialog,\n} from \"test/test_helper\"\n\ntestGroup(\"Custom element API\", { template: \"editor_empty\" }, () => {\n  test(\"element triggers trix-initialize on first connect\", (done) => {\n    const container = document.getElementById(\"trix-container\")\n    container.innerHTML = \"\"\n\n    let initializeEventCount = 0\n    const element = document.createElement(\"trix-editor\")\n    element.addEventListener(\"trix-initialize\", () => initializeEventCount++)\n\n    container.appendChild(element)\n    requestAnimationFrame(() => {\n      container.removeChild(element)\n      requestAnimationFrame(() => {\n        container.appendChild(element)\n        after(60, () => {\n          assert.equal(initializeEventCount, 1)\n          done()\n        })\n      })\n    })\n  })\n\n  test(\"files are accepted by default\", () => {\n    getComposition().insertFile(createFile())\n    assert.equal(getComposition().getAttachments().length, 1)\n  })\n\n  test(\"rejecting a file by canceling the trix-file-accept event\", () => {\n    getEditorElement().addEventListener(\"trix-file-accept\", (event) => event.preventDefault())\n    getComposition().insertFile(createFile())\n    assert.equal(getComposition().getAttachments().length, 0)\n  })\n\n  test(\"element triggers attachment events\", () => {\n    const file = createFile()\n    const element = getEditorElement()\n    const composition = getComposition()\n    let attachment = null\n    const events = []\n\n    element.addEventListener(\"trix-file-accept\", function (event) {\n      events.push(event.type)\n      assert.ok(file === event.file)\n    })\n\n    element.addEventListener(\"trix-attachment-add\", function (event) {\n      events.push(event.type)\n      attachment = event.attachment\n    })\n\n    composition.insertFile(file)\n    assert.deepEqual(events, [ \"trix-file-accept\", \"trix-attachment-add\" ])\n\n    element.addEventListener(\"trix-attachment-remove\", function (event) {\n      events.push(event.type)\n      assert.ok(attachment === event.attachment)\n    })\n\n    attachment.remove()\n    assert.deepEqual(events, [ \"trix-file-accept\", \"trix-attachment-add\", \"trix-attachment-remove\" ])\n  })\n\n  test(\"element triggers trix-change when an attachment is edited\", () => {\n    const file = createFile()\n    const element = getEditorElement()\n    const composition = getComposition()\n    let attachment = null\n    const events = []\n\n    element.addEventListener(\"trix-attachment-add\", (event) => attachment = event.attachment)\n\n    composition.insertFile(file)\n\n    element.addEventListener(\"trix-attachment-edit\", (event) => events.push(event.type))\n\n    element.addEventListener(\"trix-change\", (event) => events.push(event.type))\n\n    attachment.setAttributes({ width: 9876 })\n    assert.deepEqual(events, [ \"trix-attachment-edit\", \"trix-change\" ])\n  })\n\n  test(\"editing the document in a trix-attachment-add handler doesn't trigger trix-attachment-add again\", () => {\n    const element = getEditorElement()\n    const composition = getComposition()\n    let eventCount = 0\n\n    element.addEventListener(\"trix-attachment-add\", () => {\n      if (eventCount++ === 0) {\n        element.editor.setSelectedRange([ 0, 1 ])\n        element.editor.activateAttribute(\"bold\")\n      }\n    })\n\n    composition.insertFile(createFile())\n    assert.equal(eventCount, 1)\n  })\n\n  test(\"element triggers trix-change events when the document changes\", (done) => {\n    const element = getEditorElement()\n    let eventCount = 0\n    element.addEventListener(\"trix-change\", (event) => eventCount++)\n\n    typeCharacters(\"a\", () => {\n      assert.equal(eventCount, 1)\n      moveCursor(\"left\", () => {\n        assert.equal(eventCount, 1)\n        typeCharacters(\"bcd\", () => {\n          assert.equal(eventCount, 4)\n          clickToolbarButton({ action: \"undo\" }, () => {\n            assert.equal(eventCount, 5)\n            done()\n          })\n        })\n      })\n    })\n  })\n\n  test(\"element triggers trix-change event after toggling attributes\", (done) => {\n    const element = getEditorElement()\n    const { editor } = element\n\n    const afterChangeEvent = function (edit, callback) {\n      let handler\n      element.addEventListener(\n        \"trix-change\",\n        handler = function (event) {\n          element.removeEventListener(\"trix-change\", handler)\n          callback(event)\n        }\n      )\n      edit()\n    }\n\n    typeCharacters(\"hello\", () => {\n      let edit = () => editor.activateAttribute(\"quote\")\n      afterChangeEvent(edit, () => {\n        assert.ok(editor.attributeIsActive(\"quote\"))\n\n        edit = () => editor.deactivateAttribute(\"quote\")\n        afterChangeEvent(edit, () => {\n          assert.notOk(editor.attributeIsActive(\"quote\"))\n\n          editor.setSelectedRange([ 0, 5 ])\n          edit = () => editor.activateAttribute(\"bold\")\n          afterChangeEvent(edit, () => {\n            assert.ok(editor.attributeIsActive(\"bold\"))\n\n            edit = () => editor.deactivateAttribute(\"bold\")\n            afterChangeEvent(edit, () => {\n              assert.notOk(editor.attributeIsActive(\"bold\"))\n              done()\n            })\n          })\n        })\n      })\n    })\n  })\n\n  test(\"disabled attributes aren't considered active\", (done) => {\n    const { editor } = getEditorElement()\n    editor.activateAttribute(\"heading1\")\n    assert.notOk(editor.attributeIsActive(\"code\"))\n    assert.notOk(editor.attributeIsActive(\"quote\"))\n    done()\n  })\n\n  test(\"element triggers trix-selection-change events when the location range changes\", (done) => {\n    const element = getEditorElement()\n    let eventCount = 0\n    element.addEventListener(\"trix-selection-change\", (event) => eventCount++)\n\n    typeCharacters(\"a\", () => {\n      assert.equal(eventCount, 1)\n      moveCursor(\"left\", () => {\n        assert.equal(eventCount, 2)\n        done()\n      })\n    })\n  })\n\n  test(\"only triggers trix-selection-change events on the active element\", (done) => {\n    const elementA = getEditorElement()\n    const elementB = document.createElement(\"trix-editor\")\n    elementA.parentNode.insertBefore(elementB, elementA.nextSibling)\n\n    elementB.addEventListener(\"trix-initialize\", () => {\n      elementA.editor.insertString(\"a\")\n      elementB.editor.insertString(\"b\")\n      rangy.getSelection().removeAllRanges()\n\n      let eventCountA = 0\n      let eventCountB = 0\n      elementA.addEventListener(\"trix-selection-change\", (event) => eventCountA++)\n      elementB.addEventListener(\"trix-selection-change\", (event) => eventCountB++)\n\n      elementA.editor.setSelectedRange(0)\n      assert.equal(eventCountA, 1)\n      assert.equal(eventCountB, 0)\n\n      elementB.editor.setSelectedRange(0)\n      assert.equal(eventCountA, 1)\n      assert.equal(eventCountB, 1)\n\n      elementA.editor.setSelectedRange(1)\n      assert.equal(eventCountA, 2)\n      assert.equal(eventCountB, 1)\n      done()\n    })\n  })\n\n  test(\"element triggers toolbar dialog events\", (done) => {\n    const element = getEditorElement()\n    const events = []\n\n    element.addEventListener(\"trix-toolbar-dialog-show\", (event) => events.push(event.type))\n\n    element.addEventListener(\"trix-toolbar-dialog-hide\", (event) => events.push(event.type))\n\n    clickToolbarButton({ action: \"link\" }, () =>\n      typeInToolbarDialog(\"http://example.com\", { attribute: \"href\" }, () =>\n        defer(() => {\n          assert.deepEqual(events, [ \"trix-toolbar-dialog-show\", \"trix-toolbar-dialog-hide\" ])\n          done()\n        })\n      )\n    )\n  })\n\n  test(\"element triggers before-paste event with paste data\", (expectDocument) => {\n    const element = getEditorElement()\n    let eventCount = 0\n    let paste = null\n\n    element.addEventListener(\"trix-before-paste\", function (event) {\n      eventCount++\n      paste = event.paste\n    })\n\n    typeCharacters(\"\", () =>\n      pasteContent(\"text/html\", \"<strong>hello</strong>\", () => {\n        assert.equal(eventCount, 1)\n        assert.equal(paste.type, \"text/html\")\n        assert.equal(paste.html, \"<strong>hello</strong>\")\n        expectDocument(\"hello\\n\")\n      })\n    )\n  })\n\n  test(\"element triggers before-paste event with mutable paste data\", (expectDocument) => {\n    const element = getEditorElement()\n    let eventCount = 0\n    let paste = null\n\n    element.addEventListener(\"trix-before-paste\", function (event) {\n      eventCount++\n      paste = event.paste\n      paste.html = \"<strong>greetings</strong>\"\n    })\n\n    typeCharacters(\"\", () =>\n      pasteContent(\"text/html\", \"<strong>hello</strong>\", () => {\n        assert.equal(eventCount, 1)\n        assert.equal(paste.type, \"text/html\")\n        expectDocument(\"greetings\\n\")\n      })\n    )\n  })\n\n  test(\"element triggers paste event with position range\", (done) => {\n    const element = getEditorElement()\n    let eventCount = 0\n    let paste = null\n\n    element.addEventListener(\"trix-paste\", function (event) {\n      eventCount++\n      paste = event.paste\n    })\n\n    typeCharacters(\"\", () =>\n      pasteContent(\"text/html\", \"<strong>hello</strong>\", () => {\n        assert.equal(eventCount, 1)\n        assert.equal(paste.type, \"text/html\")\n        assert.ok(rangesAreEqual([ 0, 5 ], paste.range))\n        done()\n      })\n    )\n  })\n\n  test(\"element triggers attribute change events\", (done) => {\n    const element = getEditorElement()\n    let eventCount = 0\n    let attributes = null\n\n    element.addEventListener(\"trix-attributes-change\", function (event) {\n      eventCount++\n      attributes = event.attributes\n    })\n\n    typeCharacters(\"\", () => {\n      assert.equal(eventCount, 0)\n      clickToolbarButton({ attribute: \"bold\" }, () => {\n        assert.equal(eventCount, 1)\n        assert.deepEqual({ bold: true }, attributes)\n        done()\n      })\n    })\n  })\n\n  test(\"element triggers action change events\", (done) => {\n    const element = getEditorElement()\n    let eventCount = 0\n    let actions = null\n\n    element.addEventListener(\"trix-actions-change\", function (event) {\n      eventCount++\n      actions = event.actions\n    })\n\n    typeCharacters(\"\", () => {\n      assert.equal(eventCount, 0)\n      clickToolbarButton({ attribute: \"bullet\" }, () => {\n        assert.equal(eventCount, 1)\n        assert.equal(actions.decreaseNestingLevel, true)\n        assert.equal(actions.increaseNestingLevel, false)\n        done()\n      })\n    })\n  })\n\n  test(\"element triggers custom focus and blur events\", (done) => {\n    const element = getEditorElement()\n\n    let focusEventCount = 0\n    let blurEventCount = 0\n    element.addEventListener(\"trix-focus\", () => focusEventCount++)\n    element.addEventListener(\"trix-blur\", () => blurEventCount++)\n\n    triggerEvent(element, \"blur\")\n    defer(() => {\n      assert.equal(blurEventCount, 1)\n      assert.equal(focusEventCount, 0)\n\n      triggerEvent(element, \"focus\")\n      defer(() => {\n        assert.equal(blurEventCount, 1)\n        assert.equal(focusEventCount, 1)\n\n        insertImageAttachment()\n        after(20, () =>\n          clickElement(element.querySelector(\"figure\"), () => {\n            const textarea = element.querySelector(\"textarea\")\n            textarea.focus()\n            defer(() => {\n              assert.equal(document.activeElement, textarea)\n              assert.equal(blurEventCount, 1)\n              assert.equal(focusEventCount, 1)\n              done()\n            })\n          })\n        )\n      })\n    })\n  })\n\n  // Selenium doesn't seem to focus windows properly in some browsers (FF 47 on OS X)\n  // so skip this test when unfocused pending a better solution.\n  testIf(document.hasFocus(), \"element triggers custom focus event when autofocusing\", (done) => {\n    const element = document.createElement(\"trix-editor\")\n    element.setAttribute(\"autofocus\", \"\")\n\n    let focusEventCount = 0\n    element.addEventListener(\"trix-focus\", () => focusEventCount++)\n\n    const container = document.getElementById(\"trix-container\")\n    container.innerHTML = \"\"\n    container.appendChild(element)\n\n    element.addEventListener(\"trix-initialize\", () => {\n      assert.equal(focusEventCount, 1)\n      done()\n    })\n  })\n\n  test(\"element serializes HTML after attribute changes\", (done) => {\n    const element = getEditorElement()\n    let serializedHTML = element.value\n\n    typeCharacters(\"a\", () => {\n      assert.notEqual(serializedHTML, element.value)\n      serializedHTML = element.value\n\n      clickToolbarButton({ attribute: \"quote\" }, () => {\n        assert.notEqual(serializedHTML, element.value)\n        serializedHTML = element.value\n\n        clickToolbarButton({ attribute: \"quote\" }, () => {\n          assert.notEqual(serializedHTML, element.value)\n          done()\n        })\n      })\n    })\n  })\n\n  test(\"element serializes HTML after attachment attribute changes\", (done) => {\n    const element = getEditorElement()\n    const attributes = { url: \"test_helpers/fixtures/logo.png\", contentType: \"image/png\" }\n\n    element.addEventListener(\"trix-attachment-add\", function (event) {\n      const { attachment } = event\n      requestAnimationFrame(() => {\n        let serializedHTML = element.value\n        attachment.setAttributes(attributes)\n        assert.notEqual(serializedHTML, element.value)\n\n        serializedHTML = element.value\n        assert.ok(serializedHTML.indexOf(TEST_IMAGE_URL) < 0, \"serialized HTML contains previous attachment attributes\")\n        assert.ok(\n          serializedHTML.indexOf(attributes.url) > 0,\n          \"serialized HTML doesn't contain current attachment attributes\"\n        )\n\n        attachment.remove()\n        requestAnimationFrame(() => done())\n      })\n    })\n\n    requestAnimationFrame(() => insertImageAttachment())\n  })\n\n  test(\"editor resets to its original value on form reset\", (expectDocument) => {\n    const element = getEditorElement()\n    const { form } = element.inputElement\n\n    typeCharacters(\"hello\", () => {\n      form.reset()\n      expectDocument(\"\\n\")\n    })\n  })\n\n  test(\"editor resets to last-set value on form reset\", (expectDocument) => {\n    const element = getEditorElement()\n    const { form } = element.inputElement\n\n    element.value = \"hi\"\n    typeCharacters(\"hello\", () => {\n      form.reset()\n      expectDocument(\"hi\\n\")\n    })\n  })\n\n  test(\"editor respects preventDefault on form reset\", (expectDocument) => {\n    const element = getEditorElement()\n    const { form } = element.inputElement\n    const preventDefault = (event) => event.preventDefault()\n\n    typeCharacters(\"hello\", () => {\n      form.addEventListener(\"reset\", preventDefault, false)\n      form.reset()\n      form.removeEventListener(\"reset\", preventDefault, false)\n      expectDocument(\"hello\\n\")\n    })\n  })\n})\n\ntestGroup(\"<label> support\", { template: \"editor_with_labels\" }, () => {\n  test(\"associates all label elements\", (done) => {\n    const labels = [ document.getElementById(\"label-1\"), document.getElementById(\"label-3\") ]\n    assert.deepEqual(getEditorElement().labels, labels)\n    done()\n  })\n\n  test(\"focuses when <label> clicked\", (done) => {\n    document.getElementById(\"label-1\").click()\n    assert.equal(getEditorElement(), document.activeElement)\n    done()\n  })\n\n  test(\"focuses when <label> descendant clicked\", (done) => {\n    document.getElementById(\"label-1\").querySelector(\"span\").click()\n    assert.equal(getEditorElement(), document.activeElement)\n    done()\n  })\n\n  test(\"does not focus when <label> controls another element\", (done) => {\n    const label = document.getElementById(\"label-2\")\n    assert.notEqual(getEditorElement(), label.control)\n    label.click()\n    assert.notEqual(getEditorElement(), document.activeElement)\n    done()\n  })\n})\n\ntestGroup(\"form property references its <form>\", { template: \"editors_with_forms\", container: \"div\" }, () => {\n  test(\"accesses its ancestor form\", (done) => {\n    const form = document.getElementById(\"ancestor-form\")\n    const editor = document.getElementById(\"editor-with-ancestor-form\")\n    assert.equal(editor.form, form)\n    done()\n  })\n\n  test(\"transitively accesses its related <input> element's <form>\", (done) => {\n    const form = document.getElementById(\"input-form\")\n    const editor = document.getElementById(\"editor-with-input-form\")\n    assert.equal(editor.form, form)\n    done()\n  })\n\n  test(\"returns null when there is no associated <form>\", (done) => {\n    const editor = document.getElementById(\"editor-with-no-form\")\n    assert.equal(editor.form, null)\n    done()\n  })\n})\n","import { TEST_IMAGE_URL, after, assert, test, testGroup } from \"test/test_helper\"\nimport { OBJECT_REPLACEMENT_CHARACTER } from \"trix/constants\"\n\ntestGroup(\"HTML loading\", () => {\n  testGroup(\"inline elements\", { template: \"editor_with_styled_content\" }, () => {\n    const cases = {\n      \"BR before block element styled otherwise\": {\n        html: `a<br><figure class=\"attachment\"><img src=\"${TEST_IMAGE_URL}\"></figure>`,\n        expectedDocument: `a\\n${OBJECT_REPLACEMENT_CHARACTER}\\n`,\n      },\n\n      \"BR in text before block element styled otherwise\": {\n        html: `<div>a<br>b<figure class=\"attachment\"><img src=\"${TEST_IMAGE_URL}\"></figure></div>`,\n        expectedDocument: `a\\nb${OBJECT_REPLACEMENT_CHARACTER}\\n`,\n      },\n    }\n\n    for (const name in cases) {\n      const details = cases[name]\n      test(name, (expectDocument) => {\n        getEditor().loadHTML(details.html)\n        expectDocument(details.expectedDocument)\n      })\n    }\n  })\n\n  testGroup(\"bold elements\", { template: \"editor_with_bold_styles\" }, () => {\n    test(\"<strong> with font-weight: 500\", (expectDocument) => {\n      getEditor().loadHTML(\"<strong>a</strong>\")\n      assert.textAttributes([ 0, 1 ], { bold: true })\n      expectDocument(\"a\\n\")\n    })\n\n    test(\"<span> with font-weight: 600\", (expectDocument) => {\n      getEditor().loadHTML(\"<span>a</span>\")\n      assert.textAttributes([ 0, 1 ], { bold: true })\n      expectDocument(\"a\\n\")\n    })\n\n    test(\"<article> with font-weight: bold\", (expectDocument) => {\n      getEditor().loadHTML(\"<article>a</article>\")\n      assert.textAttributes([ 0, 1 ], { bold: true })\n      expectDocument(\"a\\n\")\n    })\n  })\n\n  testGroup(\"styled block elements\", { template: \"editor_with_block_styles\" }, () => {\n    test(\"<em> in <blockquote> with font-style: italic\", (expectDocument) => {\n      getEditor().loadHTML(\"<blockquote>a<em>b</em></blockquote>\")\n      assert.textAttributes([ 0, 1 ], {})\n      assert.textAttributes([ 1, 2 ], { italic: true })\n      assert.blockAttributes([ 0, 2 ], [ \"quote\" ])\n      expectDocument(\"ab\\n\")\n    })\n\n    test(\"<strong> in <li> with font-weight: bold\", (expectDocument) => {\n      getEditor().loadHTML(\"<ul><li>a<strong>b</strong></li></ul>\")\n      assert.textAttributes([ 0, 1 ], {})\n      assert.textAttributes([ 1, 2 ], { bold: true })\n      assert.blockAttributes([ 0, 2 ], [ \"bulletList\", \"bullet\" ])\n      expectDocument(\"ab\\n\")\n    })\n\n    test(\"newline in <li> with font-weight: bold\", (expectDocument) => {\n      getEditor().loadHTML(\"<ul><li>a<br>b</li></ul>\")\n      assert.textAttributes([ 0, 2 ], {})\n      assert.blockAttributes([ 0, 2 ], [ \"bulletList\", \"bullet\" ])\n      expectDocument(\"a\\nb\\n\")\n    })\n  })\n\n  testGroup(\"in a table\", { template: \"editor_in_table\" }, () =>\n    test(\"block elements\", (expectDocument) => {\n      getEditor().loadHTML(\"<h1>a</h1><blockquote>b</blockquote>\")\n      assert.blockAttributes([ 0, 2 ], [ \"heading1\" ])\n      assert.blockAttributes([ 2, 4 ], [ \"quote\" ])\n      expectDocument(\"a\\nb\\n\")\n    })\n  )\n\n  testGroup(\"images\", { template: \"editor_empty\" }, () => {\n    test(\"without dimensions\", (expectDocument) => {\n      getEditor().loadHTML(`<img src=\"${TEST_IMAGE_URL}\">`)\n      after(50, () => {\n        const attachment = getDocument().getAttachments()[0]\n        const image = getEditorElement().querySelector(\"img\")\n        assert.equal(attachment.getWidth(), 1)\n        assert.equal(attachment.getHeight(), 1)\n        assert.equal(image.getAttribute(\"width\"), \"1\")\n        assert.equal(image.getAttribute(\"height\"), \"1\")\n        expectDocument(`${OBJECT_REPLACEMENT_CHARACTER}\\n`)\n      })\n    })\n\n    test(\"with dimensions\", (expectDocument) => {\n      getEditor().loadHTML(`<img src=\"${TEST_IMAGE_URL}\" width=\"10\" height=\"20\">`)\n      after(50, () => {\n        const attachment = getDocument().getAttachments()[0]\n        const image = getEditorElement().querySelector(\"img\")\n        assert.equal(attachment.getWidth(), 10)\n        assert.equal(attachment.getHeight(), 20)\n        assert.equal(image.getAttribute(\"width\"), \"10\")\n        assert.equal(image.getAttribute(\"height\"), \"20\")\n        expectDocument(`${OBJECT_REPLACEMENT_CHARACTER}\\n`)\n      })\n    })\n  })\n\n  testGroup(\"text after closing tag\", { template: \"editor_empty\" }, () =>\n    test(\"parses text as separate block\", (expectDocument) => {\n      getEditor().loadHTML(\"<h1>a</h1>b\")\n      assert.blockAttributes([ 0, 2 ], [ \"heading1\" ])\n      assert.blockAttributes([ 2, 4 ], [])\n      expectDocument(\"a\\nb\\n\")\n    })\n  )\n})\n","import { assert, test, testGroup } from \"test/test_helper\"\n\ntestGroup(\"HTML Reparsing\", { template: \"editor_empty\" }, () => {\n  test(\"mutation resulting in identical blocks\", (expectDocument) => {\n    const element = getEditorElement()\n    element.editor.loadHTML(\"<ul><li>a</li><li>b</li></ul>\")\n    requestAnimationFrame(() => {\n      element.querySelector(\"li\").textContent = \"b\"\n      requestAnimationFrame(() => {\n        assert.blockAttributes([ 0, 1 ], [ \"bulletList\", \"bullet\" ])\n        assert.blockAttributes([ 2, 3 ], [ \"bulletList\", \"bullet\" ])\n        assert.equal(element.value, \"<ul><li>b</li><li>b</li></ul>\")\n        expectDocument(\"b\\nb\\n\")\n      })\n    })\n  })\n\n  test(\"mutation resulting in identical pieces\", (expectDocument) => {\n    const element = getEditorElement()\n    element.editor.loadHTML(\"<div><strong>a</strong> <strong>b</strong></div>\")\n    requestAnimationFrame(() => {\n      element.querySelector(\"strong\").textContent = \"b\"\n      requestAnimationFrame(() => {\n        assert.textAttributes([ 0, 1 ], { bold: true })\n        assert.textAttributes([ 2, 3 ], { bold: true })\n        assert.equal(element.value, \"<div><strong>b</strong> <strong>b</strong></div>\")\n        expectDocument(\"b b\\n\")\n      })\n    })\n  })\n})\n","import config from \"trix/config\"\n\nimport { assert, testGroup, testIf, triggerEvent } from \"test/test_helper\"\n\nconst test = function() {\n  testIf(config.input.getLevel() === 0, ...arguments)\n}\n\ntestGroup(\"Level 0 input: HTML replacement\", () =>\n  testGroup(\"deleting with command+backspace\", { template: \"editor_empty\" }, () => {\n    test(\"from the end of a line\", function (expectDocument) {\n      getEditor().loadHTML(\"<div>a</div><blockquote>b</blockquote><div>c</div>\")\n      getSelectionManager().setLocationRange({ index: 1, offset: 1 })\n      pressCommandBackspace({ replaceText: \"b\" }, () => {\n        assert.locationRange({ index: 1, offset: 0 })\n        assert.blockAttributes([ 0, 2 ], [])\n        assert.blockAttributes([ 2, 3 ], [ \"quote\" ])\n        assert.blockAttributes([ 3, 5 ], [])\n        expectDocument(\"a\\n\\nc\\n\")\n      })\n    })\n\n    test(\"in the first block\", function (expectDocument) {\n      getEditor().loadHTML(\"<div>a</div><blockquote>b</blockquote>\")\n      getSelectionManager().setLocationRange({ index: 0, offset: 1 })\n      pressCommandBackspace({ replaceText: \"a\" }, () => {\n        assert.locationRange({ index: 0, offset: 0 })\n        assert.blockAttributes([ 0, 1 ], [])\n        assert.blockAttributes([ 1, 3 ], [ \"quote\" ])\n        expectDocument(\"\\nb\\n\")\n      })\n    })\n\n    test(\"from the middle of a line\", function (expectDocument) {\n      getEditor().loadHTML(\"<div>a</div><blockquote>bc</blockquote><div>d</div>\")\n      getSelectionManager().setLocationRange({ index: 1, offset: 1 })\n      pressCommandBackspace({ replaceText: \"b\" }, () => {\n        assert.locationRange({ index: 1, offset: 0 })\n        assert.blockAttributes([ 0, 2 ], [])\n        assert.blockAttributes([ 2, 4 ], [ \"quote\" ])\n        assert.blockAttributes([ 4, 6 ], [])\n        expectDocument(\"a\\nc\\nd\\n\")\n      })\n    })\n\n    test(\"from the middle of a line in a multi-line block\", function (expectDocument) {\n      getEditor().loadHTML(\"<div>a</div><blockquote>bc<br>d</blockquote><div>e</div>\")\n      getSelectionManager().setLocationRange({ index: 1, offset: 1 })\n      pressCommandBackspace({ replaceText: \"b\" }, () => {\n        assert.locationRange({ index: 1, offset: 0 })\n        assert.blockAttributes([ 0, 2 ], [])\n        assert.blockAttributes([ 2, 6 ], [ \"quote\" ])\n        expectDocument(\"a\\nc\\nd\\ne\\n\")\n      })\n    })\n\n    test(\"from the end of a list item\", function (expectDocument) {\n      getEditor().loadHTML(\"<ul><li>a</li><li>b</li></ul>\")\n      getSelectionManager().setLocationRange({ index: 1, offset: 1 })\n      pressCommandBackspace({ replaceText: \"b\" }, () => {\n        assert.locationRange({ index: 1, offset: 0 })\n        assert.blockAttributes([ 0, 2 ], [ \"bulletList\", \"bullet\" ])\n        assert.blockAttributes([ 2, 4 ], [ \"bulletList\", \"bullet\" ])\n        expectDocument(\"a\\n\\n\")\n      })\n    })\n\n    test(\"a character that is its text node's only data\", function (expectDocument) {\n      getEditor().loadHTML(\"<div>a<br>b<br><strong>c</strong></div>\")\n      getSelectionManager().setLocationRange({ index: 0, offset: 3 })\n      pressCommandBackspace({ replaceText: \"b\" }, () => {\n        assert.locationRange({ index: 0, offset: 2 })\n        expectDocument(\"a\\n\\nc\\n\")\n      })\n    })\n\n    test(\"a formatted word\", function (expectDocument) {\n      getEditor().loadHTML(\"<div>a<strong>bc</strong></div>\")\n      getSelectionManager().setLocationRange({ index: 0, offset: 4 })\n      pressCommandBackspace({ replaceElementWithText: \"bc\" }, () => {\n        assert.locationRange({ index: 0, offset: 1 })\n        expectDocument(\"a\\n\")\n      })\n    })\n  })\n)\n\nconst pressCommandBackspace = function ({ replaceText, replaceElementWithText }, callback) {\n  let previousSibling\n  triggerEvent(document.activeElement, \"keydown\", { charCode: 0, keyCode: 8, which: 8, metaKey: true })\n  const range = rangy.getSelection().getRangeAt(0)\n\n  if (replaceElementWithText) {\n    const element = getElementWithText(replaceElementWithText)\n    previousSibling = element.previousSibling\n    element.parentNode.removeChild(element)\n    range.collapseAfter(previousSibling)\n  } else {\n    range.findText(replaceText, { direction: \"backward\" })\n    range.splitBoundaries()\n\n    const node = range.getNodes()[0]\n    previousSibling = node.previousSibling\n    const { nextSibling, parentNode } = node\n\n    if (previousSibling?.nodeType === Node.COMMENT_NODE) {\n      parentNode.removeChild(previousSibling)\n    }\n\n    node.data = \"\"\n    parentNode.removeChild(node)\n\n    if (!parentNode.hasChildNodes()) {\n      parentNode.appendChild(document.createElement(\"br\"))\n    }\n\n    range.collapseBefore(nextSibling ? nextSibling : parentNode.firstChild)\n  }\n\n  range.select()\n  requestAnimationFrame(callback)\n}\n\nconst getElementWithText = function (text) {\n  for (const element of Array.from(document.activeElement.querySelectorAll(\"*\"))) {\n    if (element.innerText === text) {\n      return element\n    }\n  }\n  return null\n}\n","import EditorController from \"trix/controllers/editor_controller\"\n\nimport { assert, defer, test, testGroup } from \"test/test_helper\"\n\ntestGroup(\"Installation process\", { template: \"editor_html\" }, () => {\n  test(\"element.editorController\", () => {\n    assert.ok(getEditorController() instanceof EditorController)\n  })\n\n  test(\"creates a contenteditable element\", () => assert.ok(getEditorElement()))\n\n  test(\"loads the initial document\", () => {\n    assert.equal(getEditorElement().textContent, \"Hello world\")\n  })\n\n  test(\"sets value property\", (done) =>\n    defer(() => {\n      assert.equal(getEditorElement().value, \"<div>Hello world</div>\")\n      done()\n    }))\n})\n\ntestGroup(\"Installation process without specified elements\", { template: \"editor_empty\" }, () =>\n  test(\"creates identified toolbar and input elements\", (done) => {\n    const editorElement = getEditorElement()\n\n    const toolbarId = editorElement.getAttribute(\"toolbar\")\n    assert.ok(/trix-toolbar-\\d+/.test(toolbarId), `toolbar id not assert.ok ${JSON.stringify(toolbarId)}`)\n    const toolbarElement = document.getElementById(toolbarId)\n    assert.ok(toolbarElement, \"toolbar element not assert.ok\")\n    assert.equal(editorElement.toolbarElement, toolbarElement)\n\n    const inputId = editorElement.getAttribute(\"input\")\n    assert.ok(/trix-input-\\d+/.test(inputId), `input id not assert.ok ${JSON.stringify(inputId)}`)\n    const inputElement = document.getElementById(inputId)\n    assert.ok(inputElement, \"input element not assert.ok\")\n    assert.equal(editorElement.inputElement, inputElement)\n\n    done()\n  })\n)\n\ntestGroup(\"Installation process with specified elements\", { template: \"editor_with_toolbar_and_input\" }, () => {\n  test(\"uses specified elements\", (done) => {\n    const editorElement = getEditorElement()\n    assert.equal(editorElement.toolbarElement, document.getElementById(\"my_toolbar\"))\n    assert.equal(editorElement.inputElement, document.getElementById(\"my_input\"))\n    assert.equal(editorElement.value, \"<div>Hello world</div>\")\n    done()\n  })\n\n  test(\"can be cloned\", (done) => {\n    const originalElement = document.getElementById(\"my_editor\")\n    const clonedElement = originalElement.cloneNode(true)\n\n    const { parentElement } = originalElement\n    parentElement.removeChild(originalElement)\n    parentElement.appendChild(clonedElement)\n\n    defer(() => {\n      const editorElement = getEditorElement()\n      assert.equal(editorElement.toolbarElement, document.getElementById(\"my_toolbar\"))\n      assert.equal(editorElement.inputElement, document.getElementById(\"my_input\"))\n      assert.equal(editorElement.value, \"<div>Hello world</div>\")\n      done()\n    })\n  })\n})\n","import config from \"trix/config\"\nimport { OBJECT_REPLACEMENT_CHARACTER } from \"trix/constants\"\n\nimport {\n  after,\n  assert,\n  clickToolbarButton,\n  insertNode,\n  insertString,\n  isToolbarButtonActive,\n  selectNode,\n  testGroup,\n  testIf,\n  triggerEvent,\n  triggerInputEvent,\n  typeCharacters,\n} from \"test/test_helper\"\n\nconst test = function() {\n  testIf(config.input.getLevel() === 2, ...arguments)\n}\n\nconst testOptions = {\n  template: \"editor_empty\",\n  setup() {\n    addEventListener(\"beforeinput\", recordInputEvent, true)\n    addEventListener(\"input\", recordInputEvent, true)\n  },\n  teardown() {\n    removeEventListener(\"beforeinput\", recordInputEvent, true)\n    removeEventListener(\"input\", recordInputEvent, true)\n  },\n}\n\nlet inputEvents = []\n\nconst recordInputEvent = function (event) {\n  // Not all browsers dispatch \"beforeinput\" event when calling execCommand() so\n  // we manually dispatch a synthetic one. If a second one arrives, ignore it.\n  if (event.type === \"beforeinput\" && inputEvents.length === 1 && inputEvents[0].type === \"beforeinput\") {\n    event.stopImmediatePropagation()\n  } else {\n    const { type, inputType, data } = event\n    inputEvents.push({ type, inputType, data })\n  }\n}\n\n// Borrowed from https://github.com/web-platform-tests/wpt/blob/master/input-events/input-events-exec-command.html\nconst performInputTypeUsingExecCommand = function (command, { inputType, data }, callback) {\n  inputEvents = []\n  requestAnimationFrame(() => {\n    triggerInputEvent(document.activeElement, \"beforeinput\", { inputType, data })\n    document.execCommand(command, false, data)\n    assert.equal(inputEvents.length, 2)\n    assert.equal(inputEvents[0].type, \"beforeinput\")\n    assert.equal(inputEvents[1].type, \"input\")\n    assert.equal(inputEvents[0].inputType, inputType)\n    assert.equal(inputEvents[0].data, data)\n    requestAnimationFrame(() => requestAnimationFrame(callback))\n  })\n}\n\ntestGroup(\"Level 2 Input\", testOptions, () => {\n  test(\"insertText\", (expectDocument) =>\n    performInputTypeUsingExecCommand(\"insertText\", { inputType: \"insertText\", data: \"abc\" }, () =>\n      expectDocument(\"abc\\n\")\n    ))\n\n  test(\"insertOrderedList\", (expectDocument) => {\n    insertString(\"a\\nb\")\n    performInputTypeUsingExecCommand(\"insertOrderedList\", { inputType: \"insertOrderedList\" }, () => {\n      assert.blockAttributes([ 0, 2 ], [])\n      assert.blockAttributes([ 2, 4 ], [ \"numberList\", \"number\" ])\n      assert.ok(isToolbarButtonActive({ attribute: \"number\" }))\n      expectDocument(\"a\\nb\\n\")\n    })\n  })\n\n  test(\"insertUnorderedList\", (expectDocument) => {\n    insertString(\"a\\nb\")\n    performInputTypeUsingExecCommand(\"insertUnorderedList\", { inputType: \"insertUnorderedList\" }, () => {\n      assert.blockAttributes([ 0, 2 ], [])\n      assert.blockAttributes([ 2, 4 ], [ \"bulletList\", \"bullet\" ])\n      assert.ok(isToolbarButtonActive({ attribute: \"bullet\" }))\n      expectDocument(\"a\\nb\\n\")\n    })\n  })\n\n  test(\"insertLineBreak\", (expectDocument) =>\n    clickToolbarButton({ attribute: \"quote\" }, () => {\n      insertString(\"abc\")\n      performInputTypeUsingExecCommand(\"insertLineBreak\", { inputType: \"insertLineBreak\" }, () =>\n        performInputTypeUsingExecCommand(\"insertLineBreak\", { inputType: \"insertLineBreak\" }, () => {\n          assert.blockAttributes([ 0, 6 ], [ \"quote\" ])\n          expectDocument(\"abc\\n\\n\\n\")\n        })\n      )\n    }))\n\n  test(\"insertParagraph\", (expectDocument) =>\n    clickToolbarButton({ attribute: \"quote\" }, () => {\n      insertString(\"abc\")\n      performInputTypeUsingExecCommand(\"insertParagraph\", { inputType: \"insertParagraph\" }, () =>\n        performInputTypeUsingExecCommand(\"insertParagraph\", { inputType: \"insertParagraph\" }, () => {\n          assert.blockAttributes([ 0, 4 ], [ \"quote\" ])\n          assert.blockAttributes([ 4, 5 ], [])\n          expectDocument(\"abc\\n\\n\")\n        })\n      )\n    }))\n\n  test(\"formatBold\", (expectDocument) => {\n    insertString(\"abc\")\n    getComposition().setSelectedRange([ 1, 2 ])\n    performInputTypeUsingExecCommand(\"bold\", { inputType: \"formatBold\" }, () => {\n      assert.textAttributes([ 0, 1 ], {})\n      assert.textAttributes([ 1, 2 ], { bold: true })\n      assert.textAttributes([ 2, 3 ], {})\n      expectDocument(\"abc\\n\")\n    })\n  })\n\n  test(\"formatItalic\", (expectDocument) => {\n    insertString(\"abc\")\n    getComposition().setSelectedRange([ 1, 2 ])\n    performInputTypeUsingExecCommand(\"italic\", { inputType: \"formatItalic\" }, () => {\n      assert.textAttributes([ 0, 1 ], {})\n      assert.textAttributes([ 1, 2 ], { italic: true })\n      assert.textAttributes([ 2, 3 ], {})\n      expectDocument(\"abc\\n\")\n    })\n  })\n\n  test(\"formatStrikeThrough\", (expectDocument) => {\n    insertString(\"abc\")\n    getComposition().setSelectedRange([ 1, 2 ])\n    performInputTypeUsingExecCommand(\"strikeThrough\", { inputType: \"formatStrikeThrough\" }, () => {\n      assert.textAttributes([ 0, 1 ], {})\n      assert.textAttributes([ 1, 2 ], { strike: true })\n      assert.textAttributes([ 2, 3 ], {})\n      expectDocument(\"abc\\n\")\n    })\n  })\n\n  // https://input-inspector.now.sh/profiles/hVXS1cHYFvc2EfdRyTWQ\n  test(\"correcting a misspelled word in Chrome\", (expectDocument) => {\n    insertString(\"onr\")\n    getComposition().setSelectedRange([ 0, 3 ])\n    requestAnimationFrame(() => {\n      const inputType = \"insertReplacementText\"\n      const dataTransfer = createDataTransfer({ \"text/plain\": \"one\" })\n      const event = createEvent(\"beforeinput\", { inputType, dataTransfer })\n      document.activeElement.dispatchEvent(event)\n      requestAnimationFrame(() => expectDocument(\"one\\n\"))\n    })\n  })\n\n  // https://input-inspector.now.sh/profiles/XsZVwKtFxakwnsNs0qnX\n  test(\"correcting a misspelled word in Safari\", (expectDocument) => {\n    insertString(\"onr\")\n    getComposition().setSelectedRange([ 0, 3 ])\n    requestAnimationFrame(() => {\n      const inputType = \"insertText\"\n      const dataTransfer = createDataTransfer({ \"text/plain\": \"one\", \"text/html\": \"one\" })\n      const event = createEvent(\"beforeinput\", { inputType, dataTransfer })\n      document.activeElement.dispatchEvent(event)\n      requestAnimationFrame(() => expectDocument(\"one\\n\"))\n    })\n  })\n\n  // https://input-inspector.now.sh/profiles/yZlsrfG93QMzp2oyr0BE\n  test(\"deleting the last character in a composed word on Android\", (expectDocument) => {\n    insertString(\"c\")\n    const element = getEditorElement()\n    const textNode = element.firstChild.lastChild\n    selectNode(textNode, () => {\n      triggerInputEvent(element, \"beforeinput\", { inputType: \"insertCompositionText\", data: \"\" })\n      triggerEvent(element, \"compositionend\", { data: \"\" })\n      requestAnimationFrame(() => expectDocument(\"\\n\"))\n    })\n  })\n\n  test(\"pasting a file\", (expectDocument) =>\n    createFile((file) => {\n      const clipboardData = createDataTransfer({ Files: [ file ] })\n      const dataTransfer = createDataTransfer({ Files: [ file ] })\n      paste({ clipboardData, dataTransfer }, () => {\n        const attachments = getDocument().getAttachments()\n        assert.equal(attachments.length, 1)\n        assert.equal(attachments[0].getFilename(), file.name)\n        expectDocument(`${OBJECT_REPLACEMENT_CHARACTER}\\n`)\n      })\n    }))\n\n  // \"insertFromPaste InputEvent missing pasted files in dataTransfer\"\n  // - https://bugs.webkit.org/show_bug.cgi?id=194921\n  test(\"pasting a file in Safari\", (expectDocument) =>\n    createFile((file) => {\n      const clipboardData = createDataTransfer({ Files: [ file ] })\n      const dataTransfer = createDataTransfer({ \"text/html\": `<img src=\"blob:${location.origin}/531de8\">` })\n      paste({ clipboardData, dataTransfer }, () => {\n        const attachments = getDocument().getAttachments()\n        assert.equal(attachments.length, 1)\n        assert.equal(attachments[0].getFilename(), file.name)\n        expectDocument(`${OBJECT_REPLACEMENT_CHARACTER}\\n`)\n      })\n    }))\n\n  // \"insertFromPaste InputEvent missing text/uri-list in dataTransfer for pasted links\"\n  // - https://bugs.webkit.org/show_bug.cgi?id=196702\n  test(\"pasting a link in Safari\", (expectDocument) =>\n    createFile((file) => {\n      const url = \"https://bugs.webkit.org\"\n      const text = \"WebKit Bugzilla\"\n      const clipboardData = createDataTransfer({ URL: url, \"text/uri-list\": url, \"text/plain\": text })\n      const dataTransfer = createDataTransfer({ \"text/html\": `<a href=\"${url}\">${text}</a>`, \"text/plain\": text })\n      paste({ clipboardData, dataTransfer }, () => {\n        assert.textAttributes([ 0, url.length ], { href: url })\n        expectDocument(`${url}\\n`)\n      })\n    }))\n\n  // Pastes from MS Word include an image of the copied text 🙃\n  // https://input-inspector.now.sh/profiles/QWDITsV60dpEVl1SOZg8\n  test(\"pasting text from MS Word\", (expectDocument) =>\n    createFile((file) => {\n      const dataTransfer = createDataTransfer({\n        \"text/html\": \"<span class=\\\"MsoNormal\\\">abc</span>\",\n        \"text/plain\": \"abc\",\n        Files: [ file ],\n      })\n\n      paste({ dataTransfer }, () => {\n        const attachments = getDocument().getAttachments()\n        assert.equal(attachments.length, 0)\n        expectDocument(\"abc\\n\")\n      })\n    }))\n\n  // \"beforeinput\" event is not fired for Paste and Match Style operations\n  // - https://bugs.chromium.org/p/chromium/issues/detail?id=934448\n  test(\"Paste and Match Style in Chrome\", (expectDocument) => {\n    const done = () => expectDocument(\"a\\n\\nb\\n\\nc\\n\")\n    typeCharacters(\"a\\n\\n\", () => {\n      const clipboardData = createDataTransfer({ \"text/plain\": \"b\\n\\nc\" })\n      const pasteEvent = createEvent(\"paste\", { clipboardData })\n      if (document.activeElement.dispatchEvent(pasteEvent)) {\n        const node = document.createElement(\"div\")\n        node.innerHTML = \"<div>b</div><div><br></div><div>c</div>\"\n        insertNode(node, done)\n      } else {\n        requestAnimationFrame(done)\n      }\n    })\n  })\n})\n\nconst createFile = function (callback) {\n  const canvas = document.createElement(\"canvas\")\n  canvas.toBlob(function (file) {\n    file.name = \"image.png\"\n    callback(file)\n  })\n}\n\nconst createDataTransfer = function (data = {}) {\n  return {\n    types: Object.keys(data),\n    files: data.Files || [],\n    getData: (type) => data[type],\n  }\n}\n\nconst createEvent = function (type, properties = {}) {\n  const event = document.createEvent(\"Events\")\n  event.initEvent(type, true, true)\n  for (const key in properties) {\n    const value = properties[key]\n    Object.defineProperty(event, key, { value })\n  }\n  return event\n}\n\nconst paste = function (param = {}, callback) {\n  const { dataTransfer, clipboardData } = param\n  const pasteEvent = createEvent(\"paste\", { clipboardData: clipboardData || dataTransfer })\n  const inputEvent = createEvent(\"beforeinput\", { inputType: \"insertFromPaste\", dataTransfer })\n  if (document.activeElement.dispatchEvent(pasteEvent)) {\n    document.activeElement.dispatchEvent(inputEvent)\n  }\n  after(60, callback)\n}\n","import config from \"trix/config\"\n\nimport {\n  assert,\n  clickToolbarButton,\n  defer,\n  moveCursor,\n  pressKey,\n  test,\n  testGroup,\n  testIf,\n  triggerEvent,\n  typeCharacters,\n} from \"test/test_helper\"\n\ntestGroup(\"List formatting\", { template: \"editor_empty\" }, () => {\n  test(\"creating a new list item\", (done) =>\n    typeCharacters(\"a\", () =>\n      clickToolbarButton({ attribute: \"bullet\" }, () =>\n        typeCharacters(\"\\n\", () => {\n          assert.locationRange({ index: 1, offset: 0 })\n          assert.blockAttributes([ 0, 2 ], [ \"bulletList\", \"bullet\" ])\n          assert.blockAttributes([ 2, 3 ], [ \"bulletList\", \"bullet\" ])\n          done()\n        })\n      )\n    ))\n\n  test(\"breaking out of a list\", (expectDocument) =>\n    typeCharacters(\"a\", () =>\n      clickToolbarButton({ attribute: \"bullet\" }, () =>\n        typeCharacters(\"\\n\\n\", () => {\n          assert.blockAttributes([ 0, 2 ], [ \"bulletList\", \"bullet\" ])\n          assert.blockAttributes([ 2, 3 ], [])\n          expectDocument(\"a\\n\\n\")\n        })\n      )\n    ))\n\n  test(\"pressing return at the beginning of a non-empty list item\", (expectDocument) =>\n    clickToolbarButton({ attribute: \"bullet\" }, () =>\n      typeCharacters(\"a\\nb\", () =>\n        moveCursor(\"left\", () =>\n          pressKey(\"return\", () => {\n            assert.blockAttributes([ 0, 2 ], [ \"bulletList\", \"bullet\" ])\n            assert.blockAttributes([ 2, 3 ], [ \"bulletList\", \"bullet\" ])\n            assert.blockAttributes([ 3, 5 ], [ \"bulletList\", \"bullet\" ])\n            expectDocument(\"a\\n\\nb\\n\")\n          })\n        )\n      )\n    ))\n\n  test(\"pressing tab increases nesting level, tab+shift decreases nesting level\", (expectDocument) =>\n    clickToolbarButton({ attribute: \"bullet\" }, () =>\n      typeCharacters(\"a\", () =>\n        pressKey(\"return\", () =>\n          pressKey(\"tab\", () =>\n            typeCharacters(\"b\", () => {\n              assert.blockAttributes([ 0, 1 ], [ \"bulletList\", \"bullet\" ])\n              assert.blockAttributes([ 2, 3 ], [ \"bulletList\", \"bullet\", \"bulletList\", \"bullet\" ])\n              defer(() => {\n                // press shift tab\n                triggerEvent(document.activeElement, \"keydown\", {\n                  key: \"Tab\",\n                  charCode: 0,\n                  keyCode: 9,\n                  which: 9,\n                  shiftKey: true,\n                })\n                assert.blockAttributes([ 0, 1 ], [ \"bulletList\", \"bullet\" ])\n                assert.blockAttributes([ 2, 3 ], [ \"bulletList\", \"bullet\" ])\n                expectDocument(\"a\\nb\\n\")\n              })\n            })\n          )\n        )\n      )\n    ))\n\n  testIf(config.input.getLevel() === 0, \"pressing shift-return at the end of a list item\", (expectDocument) =>\n    clickToolbarButton({ attribute: \"bullet\" }, () =>\n      typeCharacters(\"a\", () => {\n        const pressShiftReturn = triggerEvent(document.activeElement, \"keydown\", {\n          charCode: 0,\n          keyCode: 13,\n          which: 13,\n          shiftKey: true,\n        })\n        assert.notOk(pressShiftReturn) // Assert defaultPrevented\n        assert.blockAttributes([ 0, 2 ], [ \"bulletList\", \"bullet\" ])\n        expectDocument(\"a\\n\\n\")\n      })\n    )\n  )\n\n  test(\"pressing delete at the beginning of a non-empty nested list item\", (expectDocument) =>\n    clickToolbarButton({ attribute: \"bullet\" }, () =>\n      typeCharacters(\"a\\n\", () =>\n        clickToolbarButton({ action: \"increaseNestingLevel\" }, () =>\n          typeCharacters(\"b\\n\", () =>\n            clickToolbarButton({ action: \"increaseNestingLevel\" }, () =>\n              typeCharacters(\"c\", () => {\n                getSelectionManager().setLocationRange({ index: 1, offset: 0 })\n                getComposition().deleteInDirection(\"backward\")\n                getEditorController().render()\n                defer(() => {\n                  assert.blockAttributes([ 0, 2 ], [ \"bulletList\", \"bullet\" ])\n                  assert.blockAttributes([ 3, 4 ], [ \"bulletList\", \"bullet\", \"bulletList\", \"bullet\" ])\n                  expectDocument(\"ab\\nc\\n\")\n                })\n              })\n            )\n          )\n        )\n      )\n    ))\n\n  test(\"decreasing list item's level decreases its nested items level too\", (expectDocument) =>\n    clickToolbarButton({ attribute: \"bullet\" }, () =>\n      typeCharacters(\"a\\n\", () =>\n        clickToolbarButton({ action: \"increaseNestingLevel\" }, () =>\n          typeCharacters(\"b\\n\", () =>\n            clickToolbarButton({ action: \"increaseNestingLevel\" }, () =>\n              typeCharacters(\"c\", () => {\n                getSelectionManager().setLocationRange({ index: 1, offset: 1 })\n\n                for (let n = 0; n < 3; n++) {\n                  getComposition().deleteInDirection(\"backward\")\n                  getEditorController().render()\n                }\n\n                assert.blockAttributes([ 0, 2 ], [ \"bulletList\", \"bullet\" ])\n                assert.blockAttributes([ 2, 3 ], [])\n                assert.blockAttributes([ 3, 5 ], [ \"bulletList\", \"bullet\" ])\n                expectDocument(\"a\\n\\nc\\n\")\n              })\n            )\n          )\n        )\n      )\n    ))\n})\n","import config from \"trix/config\"\n\nimport {\n  TEST_IMAGE_URL,\n  assert,\n  clickToolbarButton,\n  defer,\n  insertNode,\n  isToolbarButtonActive,\n  testGroup,\n  testIf,\n  triggerEvent,\n  typeCharacters,\n} from \"test/test_helper\"\n\nconst test = function() {\n  testIf(config.input.getLevel() === 0, ...arguments)\n}\n\ntestGroup(\"Mutation input\", { template: \"editor_empty\" }, () => {\n  test(\"deleting a newline\", function (expectDocument) {\n    const element = getEditorElement()\n    element.editor.insertString(\"a\\n\\nb\")\n\n    triggerEvent(element, \"keydown\", { charCode: 0, keyCode: 229, which: 229 })\n    const br = element.querySelectorAll(\"br\")[1]\n    br.parentNode.removeChild(br)\n    requestAnimationFrame(() => expectDocument(\"a\\nb\\n\"))\n  })\n\n  test(\"typing a space in formatted text at the end of a block\", function (expectDocument) {\n    const element = getEditorElement()\n\n    clickToolbarButton({ attribute: \"bold\" }, () =>\n      typeCharacters(\"a\", () => {\n        // Press space key\n        triggerEvent(element, \"keydown\", { charCode: 0, keyCode: 32, which: 32 })\n        triggerEvent(element, \"keypress\", { charCode: 32, keyCode: 32, which: 32 })\n\n        const boldElement = element.querySelector(\"strong\")\n        boldElement.appendChild(document.createTextNode(\" \"))\n        boldElement.appendChild(document.createElement(\"br\"))\n\n        requestAnimationFrame(() => {\n          assert.ok(isToolbarButtonActive({ attribute: \"bold\" }))\n          assert.textAttributes([ 0, 2 ], { bold: true })\n          expectDocument(\"a \\n\")\n        })\n      })\n    )\n  })\n\n  test(\"typing formatted text after a newline at the end of block\", function (expectDocument) {\n    const element = getEditorElement()\n    element.editor.insertHTML(\"<ul><li>a</li><li><br></li></ul>\")\n    element.editor.setSelectedRange(3)\n\n    clickToolbarButton({ attribute: \"bold\" }, () => {\n      // Press B key\n      triggerEvent(element, \"keydown\", { charCode: 0, keyCode: 66, which: 66 })\n      triggerEvent(element, \"keypress\", { charCode: 98, keyCode: 98, which: 98 })\n\n      const node = document.createTextNode(\"b\")\n      const extraBR = element.querySelectorAll(\"br\")[1]\n      extraBR.parentNode.insertBefore(node, extraBR)\n      extraBR.parentNode.removeChild(extraBR)\n\n      requestAnimationFrame(() => {\n        assert.ok(isToolbarButtonActive({ attribute: \"bold\" }))\n        assert.textAttributes([ 0, 1 ], {})\n        assert.textAttributes([ 3, 4 ], { bold: true })\n        expectDocument(\"a\\n\\nb\\n\")\n      })\n    })\n  })\n\n  test(\"typing an emoji after a newline at the end of block\", function (expectDocument) {\n    const element = getEditorElement()\n\n    typeCharacters(\"\\n\", () => {\n      // Tap 👏🏻 on iOS\n      triggerEvent(element, \"keydown\", { charCode: 0, keyCode: 0, which: 0, key: \"👏🏻\" })\n      triggerEvent(element, \"keypress\", { charCode: 128079, keyCode: 128079, which: 128079, key: \"👏🏻\" })\n\n      const node = document.createTextNode(\"👏🏻\")\n      const extraBR = element.querySelectorAll(\"br\")[1]\n      extraBR.parentNode.insertBefore(node, extraBR)\n      extraBR.parentNode.removeChild(extraBR)\n\n      requestAnimationFrame(() => expectDocument(\"\\n👏🏻\\n\"))\n    })\n  })\n\n  test(\"backspacing an attachment at the beginning of an otherwise empty document\", function (expectDocument) {\n    const element = getEditorElement()\n    element.editor.loadHTML(`<img src=\"${TEST_IMAGE_URL}\" width=\"10\" height=\"10\">`)\n\n    requestAnimationFrame(() => {\n      element.editor.setSelectedRange([ 0, 1 ])\n      triggerEvent(element, \"keydown\", { charCode: 0, keyCode: 8, which: 8 })\n\n      element.firstElementChild.innerHTML = \"<br>\"\n\n      requestAnimationFrame(() => {\n        assert.locationRange({ index: 0, offset: 0 })\n        expectDocument(\"\\n\")\n      })\n    })\n  })\n\n  test(\"backspacing a block comment node\", function (expectDocument) {\n    const element = getEditorElement()\n    element.editor.loadHTML(\"<blockquote>a</blockquote><div>b</div>\")\n    defer(() => {\n      element.editor.setSelectedRange(2)\n      triggerEvent(element, \"keydown\", { charCode: 0, keyCode: 8, which: 8 })\n      const commentNode = element.lastChild.firstChild\n      commentNode.parentNode.removeChild(commentNode)\n      defer(() => {\n        assert.locationRange({ index: 0, offset: 1 })\n        expectDocument(\"ab\\n\")\n      })\n    })\n  })\n\n  test(\"typing formatted text with autocapitalization on\", function (expectDocument) {\n    const element = getEditorElement()\n\n    clickToolbarButton({ attribute: \"bold\" }, () => {\n      // Type \"b\", autocapitalize to \"B\"\n      triggerEvent(element, \"keydown\", { charCode: 0, keyCode: 66, which: 66 })\n      triggerEvent(element, \"keypress\", { charCode: 98, keyCode: 98, which: 98 })\n      triggerEvent(element, \"textInput\", { data: \"B\" })\n\n      insertNode(document.createTextNode(\"B\"), () => {\n        assert.ok(isToolbarButtonActive({ attribute: \"bold\" }))\n        assert.textAttributes([ 0, 1 ], { bold: true })\n        expectDocument(\"B\\n\")\n      })\n    })\n  })\n})\n","import config from \"trix/config\"\nimport { OBJECT_REPLACEMENT_CHARACTER } from \"trix/constants\"\n\nimport {\n  TEST_IMAGE_URL,\n  after,\n  assert,\n  clickToolbarButton,\n  createFile,\n  defer,\n  expandSelection,\n  moveCursor,\n  pasteContent,\n  pressKey,\n  test,\n  testGroup,\n  testIf,\n  triggerEvent,\n  typeCharacters,\n} from \"test/test_helper\"\n\ntestGroup(\"Pasting\", { template: \"editor_empty\" }, () => {\n  test(\"paste plain text\", (expectDocument) =>\n    typeCharacters(\"abc\", () =>\n      moveCursor(\"left\", () => pasteContent(\"text/plain\", \"!\", () => expectDocument(\"ab!c\\n\")))\n    ))\n\n  test(\"paste simple html\", (expectDocument) =>\n    typeCharacters(\"abc\", () =>\n      moveCursor(\"left\", () => pasteContent(\"text/html\", \"&lt;\", () => expectDocument(\"ab<c\\n\")))\n    ))\n\n  test(\"paste complex html\", (expectDocument) =>\n    typeCharacters(\"abc\", () =>\n      moveCursor(\"left\", () =>\n        pasteContent(\"text/html\", \"<div>Hello world<br></div><div>This is a test</div>\", () =>\n          expectDocument(\"abHello world\\nThis is a test\\nc\\n\")\n        )\n      )\n    ))\n\n  test(\"paste html in expanded selection\", (expectDocument) =>\n    typeCharacters(\"abc\", () =>\n      moveCursor(\"left\", () =>\n        expandSelection({ direction: \"left\", times: 2 }, () =>\n          pasteContent(\"text/html\", \"<strong>x</strong>\", () => {\n            assert.selectedRange(1)\n            expectDocument(\"xc\\n\")\n          })\n        )\n      )\n    ))\n\n  test(\"paste plain text with CRLF \", (expectDocument) =>\n    pasteContent(\"text/plain\", \"a\\r\\nb\\r\\nc\", () => expectDocument(\"a\\nb\\nc\\n\")))\n\n  test(\"paste html with CRLF \", (expectDocument) =>\n    pasteContent(\"text/html\", \"<div>a<br></div>\\r\\n<div>b<br></div>\\r\\n<div>c<br></div>\", () =>\n      expectDocument(\"a\\nb\\nc\\n\")\n    ))\n\n  test(\"paste unsafe html\", (done) => {\n    window.unsanitized = []\n    const pasteData = {\n      \"text/plain\": \"x\",\n      \"text/html\": `\\\n<img onload=\"window.unsanitized.push('img.onload');\" src=\"${TEST_IMAGE_URL}\">\n<img onerror=\"window.unsanitized.push('img.onerror');\" src=\"data:image/gif;base64,TOTALLYBOGUS\">\n<script>\n  window.unsanitized.push('script tag');\n</script>\\\n`,\n    }\n\n    pasteContent(pasteData, () =>\n      after(20, () => {\n        assert.deepEqual(window.unsanitized, [])\n        delete window.unsanitized\n        done()\n      })\n    )\n  })\n\n  test(\"prefers plain text when html lacks formatting\", function (expectDocument) {\n    const pasteData = {\n      \"text/html\": \"<meta charset='utf-8'>a\\nb\",\n      \"text/plain\": \"a\\nb\",\n    }\n\n    pasteContent(pasteData, () => expectDocument(\"a\\nb\\n\"))\n  })\n\n  test(\"prefers formatted html\", function (expectDocument) {\n    const pasteData = {\n      \"text/html\": \"<meta charset='utf-8'>a\\n<strong>b</strong>\",\n      \"text/plain\": \"a\\nb\",\n    }\n\n    pasteContent(pasteData, () => expectDocument(\"a b\\n\"))\n  })\n\n  test(\"paste URL\", (expectDocument) =>\n    typeCharacters(\"a\", () =>\n      pasteContent(\"URL\", \"http://example.com\", () => {\n        assert.textAttributes([ 1, 18 ], { href: \"http://example.com\" })\n        expectDocument(\"ahttp://example.com\\n\")\n      })\n    ))\n\n  test(\"paste URL with name\", function (expectDocument) {\n    const pasteData = {\n      URL: \"http://example.com\",\n      \"public.url-name\": \"Example\",\n      \"text/plain\": \"http://example.com\",\n    }\n\n    pasteContent(pasteData, () => {\n      assert.textAttributes([ 0, 7 ], { href: \"http://example.com\" })\n      expectDocument(\"Example\\n\")\n    })\n  })\n\n  test(\"paste JavaScript URL\", function (expectDocument) {\n    const pasteData = { URL: \"javascript:alert('XSS')\" }\n    pasteContent(pasteData, () => {\n      assert.textAttributes([ 0, 23 ], {})\n      expectDocument(\"javascript:alert('XSS')\\n\")\n    })\n  })\n\n  test(\"paste URL with name containing extraneous whitespace\", function (expectDocument) {\n    const pasteData = {\n      URL: \"http://example.com\",\n      \"public.url-name\": \"   Example from \\n link  around\\n\\nnested \\nelements \",\n      \"text/plain\": \"http://example.com\",\n    }\n\n    pasteContent(pasteData, () => {\n      assert.textAttributes([ 0, 40 ], { href: \"http://example.com\" })\n      expectDocument(\"Example from link around nested elements\\n\")\n    })\n  })\n\n  test(\"paste complex html into formatted block\", (done) =>\n    typeCharacters(\"abc\", () =>\n      clickToolbarButton({ attribute: \"quote\" }, () =>\n        pasteContent(\"text/html\", \"<div>Hello world<br></div><pre>This is a test</pre>\", () => {\n          const document = getDocument()\n          assert.equal(document.getBlockCount(), 2)\n\n          let block = document.getBlockAtIndex(0)\n          assert.deepEqual(block.getAttributes(), [ \"quote\" ], assert.equal(block.toString(), \"abcHello world\\n\"))\n\n          block = document.getBlockAtIndex(1)\n          assert.deepEqual(block.getAttributes(), [ \"quote\", \"code\" ])\n          assert.equal(block.toString(), \"This is a test\\n\")\n\n          done()\n        })\n      )\n    ))\n\n  test(\"paste list into list\", (done) =>\n    clickToolbarButton({ attribute: \"bullet\" }, () =>\n      typeCharacters(\"abc\\n\", () =>\n        pasteContent(\"text/html\", \"<ul><li>one</li><li>two</li></ul>\", () => {\n          const document = getDocument()\n          assert.equal(document.getBlockCount(), 3)\n\n          let block = document.getBlockAtIndex(0)\n          assert.deepEqual(block.getAttributes(), [ \"bulletList\", \"bullet\" ])\n          assert.equal(block.toString(), \"abc\\n\")\n\n          block = document.getBlockAtIndex(1)\n          assert.deepEqual(block.getAttributes(), [ \"bulletList\", \"bullet\" ])\n          assert.equal(block.toString(), \"one\\n\")\n\n          block = document.getBlockAtIndex(2)\n          assert.deepEqual(block.getAttributes(), [ \"bulletList\", \"bullet\" ])\n          assert.equal(block.toString(), \"two\\n\")\n\n          done()\n        })\n      )\n    ))\n\n  test(\"paste list into quote\", (done) =>\n    clickToolbarButton({ attribute: \"quote\" }, () =>\n      typeCharacters(\"abc\", () =>\n        pasteContent(\"text/html\", \"<ul><li>one</li><li>two</li></ul>\", () => {\n          const document = getDocument()\n          assert.equal(document.getBlockCount(), 3)\n\n          let block = document.getBlockAtIndex(0)\n          assert.deepEqual(block.getAttributes(), [ \"quote\" ])\n          assert.equal(block.toString(), \"abc\\n\")\n\n          block = document.getBlockAtIndex(1)\n          assert.deepEqual(block.getAttributes(), [ \"quote\", \"bulletList\", \"bullet\" ])\n          assert.equal(block.toString(), \"one\\n\")\n\n          block = document.getBlockAtIndex(2)\n          assert.deepEqual(block.getAttributes(), [ \"quote\", \"bulletList\", \"bullet\" ])\n          assert.equal(block.toString(), \"two\\n\")\n\n          done()\n        })\n      )\n    ))\n\n  test(\"paste list into quoted list\", (done) =>\n    clickToolbarButton({ attribute: \"quote\" }, () =>\n      clickToolbarButton({ attribute: \"bullet\" }, () =>\n        typeCharacters(\"abc\\n\", () =>\n          pasteContent(\"text/html\", \"<ul><li>one</li><li>two</li></ul>\", () => {\n            const document = getDocument()\n            assert.equal(document.getBlockCount(), 3)\n\n            let block = document.getBlockAtIndex(0)\n            assert.deepEqual(block.getAttributes(), [ \"quote\", \"bulletList\", \"bullet\" ])\n            assert.equal(block.toString(), \"abc\\n\")\n\n            block = document.getBlockAtIndex(1)\n            assert.deepEqual(block.getAttributes(), [ \"quote\", \"bulletList\", \"bullet\" ])\n            assert.equal(block.toString(), \"one\\n\")\n\n            block = document.getBlockAtIndex(2)\n            assert.deepEqual(block.getAttributes(), [ \"quote\", \"bulletList\", \"bullet\" ])\n            assert.equal(block.toString(), \"two\\n\")\n\n            done()\n          })\n        )\n      )\n    ))\n\n  test(\"paste nested list into empty list item\", (done) =>\n    clickToolbarButton({ attribute: \"bullet\" }, () =>\n      typeCharacters(\"y\\nzz\", () => {\n        getSelectionManager().setLocationRange({ index: 0, offset: 1 })\n        defer(() =>\n          pressKey(\"backspace\", () => {\n            pasteContent(\"text/html\", \"<ul><li>a<ul><li>b</li></ul></li></ul>\", () => {})\n            const document = getDocument()\n            assert.equal(document.getBlockCount(), 3)\n\n            let block = document.getBlockAtIndex(0)\n            assert.deepEqual(block.getAttributes(), [ \"bulletList\", \"bullet\" ])\n            assert.equal(block.toString(), \"a\\n\")\n\n            block = document.getBlockAtIndex(1)\n            assert.deepEqual(block.getAttributes(), [ \"bulletList\", \"bullet\", \"bulletList\", \"bullet\" ])\n            assert.equal(block.toString(), \"b\\n\")\n\n            block = document.getBlockAtIndex(2)\n            assert.deepEqual(block.getAttributes(), [ \"bulletList\", \"bullet\" ])\n            assert.equal(block.toString(), \"zz\\n\")\n            done()\n          })\n        )\n      })\n    ))\n\n  test(\"paste nested list over list item contents\", (done) =>\n    clickToolbarButton({ attribute: \"bullet\" }, () =>\n      typeCharacters(\"y\\nzz\", () => {\n        getSelectionManager().setLocationRange({ index: 0, offset: 1 })\n        defer(() =>\n          expandSelection(\"left\", () => {\n            pasteContent(\"text/html\", \"<ul><li>a<ul><li>b</li></ul></li></ul>\", () => {})\n            const document = getDocument()\n            assert.equal(document.getBlockCount(), 3)\n\n            let block = document.getBlockAtIndex(0)\n            assert.deepEqual(block.getAttributes(), [ \"bulletList\", \"bullet\" ])\n            assert.equal(block.toString(), \"a\\n\")\n\n            block = document.getBlockAtIndex(1)\n            assert.deepEqual(block.getAttributes(), [ \"bulletList\", \"bullet\", \"bulletList\", \"bullet\" ])\n            assert.equal(block.toString(), \"b\\n\")\n\n            block = document.getBlockAtIndex(2)\n            assert.deepEqual(block.getAttributes(), [ \"bulletList\", \"bullet\" ])\n            assert.equal(block.toString(), \"zz\\n\")\n            done()\n          })\n        )\n      })\n    ))\n\n  test(\"paste list into empty block before list\", (done) =>\n    clickToolbarButton({ attribute: \"bullet\" }, () =>\n      typeCharacters(\"c\", () =>\n        moveCursor(\"left\", () =>\n          pressKey(\"return\", () => {\n            getSelectionManager().setLocationRange({ index: 0, offset: 0 })\n            defer(() =>\n              pasteContent(\"text/html\", \"<ul><li>a</li><li>b</li></ul>\", () => {\n                const document = getDocument()\n                assert.equal(document.getBlockCount(), 3)\n\n                let block = document.getBlockAtIndex(0)\n                assert.deepEqual(block.getAttributes(), [ \"bulletList\", \"bullet\" ])\n                assert.equal(block.toString(), \"a\\n\")\n\n                block = document.getBlockAtIndex(1)\n                assert.deepEqual(block.getAttributes(), [ \"bulletList\", \"bullet\" ])\n                assert.equal(block.toString(), \"b\\n\")\n\n                block = document.getBlockAtIndex(2)\n                assert.deepEqual(block.getAttributes(), [ \"bulletList\", \"bullet\" ])\n                assert.equal(block.toString(), \"c\\n\")\n                done()\n              })\n            )\n          })\n        )\n      )\n    ))\n\n  test(\"paste file\", (expectDocument) =>\n    typeCharacters(\"a\", () =>\n      pasteContent(\"Files\", createFile(), () => expectDocument(`a${OBJECT_REPLACEMENT_CHARACTER}\\n`))\n    ))\n\n  testIf(config.input.getLevel() === 0, \"paste event with no clipboardData\", (expectDocument) =>\n    typeCharacters(\"a\", () => {\n      triggerEvent(document.activeElement, \"paste\")\n      document.activeElement.insertAdjacentHTML(\"beforeend\", \"<span>bc</span>\")\n      requestAnimationFrame(() => expectDocument(\"abc\\n\"))\n    })\n  )\n})\n","import config from \"trix/config\"\nimport { makeElement } from \"trix/core/helpers\"\nimport Text from \"trix/models/text\"\n\nimport {\n  assert,\n  clickElement,\n  clickToolbarButton,\n  clickToolbarDialogButton,\n  collapseSelection,\n  expandSelection,\n  fixtures,\n  insertString,\n  insertText,\n  isToolbarButtonActive,\n  isToolbarButtonDisabled,\n  isToolbarDialogActive,\n  moveCursor,\n  pressKey,\n  test,\n  testGroup,\n  testIf,\n  typeCharacters,\n  typeInToolbarDialog,\n  typeToolbarKeyCommand,\n} from \"test/test_helper\"\n\ntestGroup(\"Text formatting\", { template: \"editor_empty\" }, () => {\n  test(\"applying attributes to text\", (done) =>\n    typeCharacters(\"abc\", () =>\n      expandSelection(\"left\", () =>\n        clickToolbarButton({ attribute: \"bold\" }, () => {\n          assert.textAttributes([ 0, 2 ], {})\n          assert.textAttributes([ 2, 3 ], { bold: true })\n          assert.textAttributes([ 3, 4 ], { blockBreak: true })\n          done()\n        })\n      )\n    ))\n\n  test(\"applying a link to text\", (done) =>\n    typeCharacters(\"abc\", () =>\n      moveCursor(\"left\", () =>\n        expandSelection(\"left\", () =>\n          clickToolbarButton({ attribute: \"href\" }, () => {\n            assert.ok(isToolbarDialogActive({ attribute: \"href\" }))\n            typeInToolbarDialog(\"http://example.com\", { attribute: \"href\" }, () => {\n              assert.textAttributes([ 0, 1 ], {})\n              assert.textAttributes([ 1, 2 ], { href: \"http://example.com\" })\n              assert.textAttributes([ 2, 3 ], {})\n              done()\n            })\n          })\n        )\n      )\n    ))\n\n  test(\"inserting a link\", (expectDocument) =>\n    typeCharacters(\"a\", () =>\n      clickToolbarButton({ attribute: \"href\" }, () => {\n        assert.ok(isToolbarDialogActive({ attribute: \"href\" }))\n        typeInToolbarDialog(\"http://example.com\", { attribute: \"href\" }, () => {\n          assert.textAttributes([ 0, 1 ], {})\n          assert.textAttributes([ 1, 19 ], { href: \"http://example.com\" })\n          expectDocument(\"ahttp://example.com\\n\")\n        })\n      })\n    ))\n\n  test(\"editing a link\", (done) => {\n    insertString(\"a\")\n    const text = Text.textForStringWithAttributes(\"bc\", { href: \"http://example.com\" })\n    insertText(text)\n    insertString(\"d\")\n    moveCursor({ direction: \"left\", times: 2 }, () =>\n      clickToolbarButton({ attribute: \"href\" }, () => {\n        assert.ok(isToolbarDialogActive({ attribute: \"href\" }))\n        assert.locationRange({ index: 0, offset: 1 }, { index: 0, offset: 3 })\n        typeInToolbarDialog(\"http://example.org\", { attribute: \"href\" }, () => {\n          assert.textAttributes([ 0, 1 ], {})\n          assert.textAttributes([ 1, 3 ], { href: \"http://example.org\" })\n          assert.textAttributes([ 3, 4 ], {})\n          done()\n        })\n      })\n    )\n  })\n\n  test(\"removing a link\", (done) => {\n    const text = Text.textForStringWithAttributes(\"ab\", { href: \"http://example.com\" })\n    insertText(text)\n    assert.textAttributes([ 0, 2 ], { href: \"http://example.com\" })\n    expandSelection({ direction: \"left\", times: 2 }, () =>\n      clickToolbarButton({ attribute: \"href\" }, () =>\n        clickToolbarDialogButton({ method: \"removeAttribute\" }, () => {\n          assert.textAttributes([ 0, 2 ], {})\n          done()\n        })\n      )\n    )\n  })\n\n  test(\"selecting an attachment disables text formatting\", (done) => {\n    const text = fixtures[\"file attachment\"].document.getBlockAtIndex(0).getTextWithoutBlockBreak()\n    insertText(text)\n    typeCharacters(\"a\", () => {\n      assert.notOk(isToolbarButtonDisabled({ attribute: \"bold\" }))\n      expandSelection(\"left\", () => {\n        assert.notOk(isToolbarButtonDisabled({ attribute: \"bold\" }))\n        expandSelection(\"left\", () => {\n          assert.ok(isToolbarButtonDisabled({ attribute: \"bold\" }))\n          done()\n        })\n      })\n    })\n  })\n\n  test(\"selecting an attachment deactivates toolbar dialog\", (done) => {\n    const text = fixtures[\"file attachment\"].document.getBlockAtIndex(0).getTextWithoutBlockBreak()\n    insertText(text)\n    clickToolbarButton({ attribute: \"href\" }, () => {\n      assert.ok(isToolbarDialogActive({ attribute: \"href\" }))\n      clickElement(getEditorElement().querySelector(\"figure\"), () => {\n        assert.notOk(isToolbarDialogActive({ attribute: \"href\" }))\n        assert.ok(isToolbarButtonDisabled({ attribute: \"href\" }))\n        done()\n      })\n    })\n  })\n\n  test(\"typing over a selected attachment does not apply disabled formatting attributes\", function (expectDocument) {\n    const text = fixtures[\"file attachment\"].document.getBlockAtIndex(0).getTextWithoutBlockBreak()\n    insertText(text)\n    expandSelection(\"left\", () => {\n      assert.ok(isToolbarButtonDisabled({ attribute: \"bold\" }))\n      typeCharacters(\"a\", () => {\n        assert.textAttributes([ 0, 1 ], {})\n        expectDocument(\"a\\n\")\n      })\n    })\n  })\n\n  test(\"applying a link to an attachment with a host-provided href\", (done) => {\n    const text = fixtures[\"file attachment\"].document.getBlockAtIndex(0).getTextWithoutBlockBreak()\n    insertText(text)\n    typeCharacters(\"a\", () => {\n      assert.notOk(isToolbarButtonDisabled({ attribute: \"href\" }))\n      expandSelection(\"left\", () => {\n        assert.notOk(isToolbarButtonDisabled({ attribute: \"href\" }))\n        expandSelection(\"left\", () => {\n          assert.ok(isToolbarButtonDisabled({ attribute: \"href\" }))\n          done()\n        })\n      })\n    })\n  })\n\n  test(\"typing after a link\", (done) =>\n    typeCharacters(\"ab\", () =>\n      expandSelection({ direction: \"left\", times: 2 }, () =>\n        clickToolbarButton({ attribute: \"href\" }, () =>\n          typeInToolbarDialog(\"http://example.com\", { attribute: \"href\" }, () =>\n            collapseSelection(\"right\", () => {\n              assert.locationRange({ index: 0, offset: 2 })\n              typeCharacters(\"c\", () => {\n                assert.textAttributes([ 0, 2 ], { href: \"http://example.com\" })\n                assert.textAttributes([ 2, 3 ], {})\n                moveCursor(\"left\", () => {\n                  assert.notOk(isToolbarButtonActive({ attribute: \"href\" }))\n                  moveCursor(\"left\", () => {\n                    assert.ok(isToolbarButtonActive({ attribute: \"href\" }))\n                    done()\n                  })\n                })\n              })\n            })\n          )\n        )\n      )\n    ))\n\n  test(\"applying formatting and then typing\", (done) =>\n    typeCharacters(\"a\", () =>\n      clickToolbarButton({ attribute: \"bold\" }, () =>\n        typeCharacters(\"bcd\", () =>\n          clickToolbarButton({ attribute: \"bold\" }, () =>\n            typeCharacters(\"e\", () => {\n              assert.textAttributes([ 0, 1 ], {})\n              assert.textAttributes([ 1, 4 ], { bold: true })\n              assert.textAttributes([ 4, 5 ], {})\n              done()\n            })\n          )\n        )\n      )\n    ))\n\n  test(\"applying formatting and then moving the cursor away\", (done) =>\n    typeCharacters(\"abc\", () =>\n      moveCursor(\"left\", () => {\n        assert.notOk(isToolbarButtonActive({ attribute: \"bold\" }))\n        clickToolbarButton({ attribute: \"bold\" }, () => {\n          assert.ok(isToolbarButtonActive({ attribute: \"bold\" }))\n          moveCursor(\"right\", () => {\n            assert.notOk(isToolbarButtonActive({ attribute: \"bold\" }))\n            moveCursor(\"left\", () => {\n              assert.notOk(isToolbarButtonActive({ attribute: \"bold\" }))\n              assert.textAttributes([ 0, 3 ], {})\n              assert.textAttributes([ 3, 4 ], { blockBreak: true })\n              done()\n            })\n          })\n        })\n      })\n    ))\n\n  test(\"applying formatting to an unfocused editor\", (done) => {\n    const input = makeElement(\"input\", { type: \"text\" })\n    document.body.appendChild(input)\n    input.focus()\n\n    clickToolbarButton({ attribute: \"bold\" }, () =>\n      typeCharacters(\"a\", () => {\n        assert.textAttributes([ 0, 1 ], { bold: true })\n        document.body.removeChild(input)\n        done()\n      })\n    )\n  })\n\n  test(\"editing formatted text\", (done) =>\n    clickToolbarButton({ attribute: \"bold\" }, () =>\n      typeCharacters(\"ab\", () =>\n        clickToolbarButton({ attribute: \"bold\" }, () =>\n          typeCharacters(\"c\", () => {\n            assert.notOk(isToolbarButtonActive({ attribute: \"bold\" }))\n            moveCursor(\"left\", () => {\n              assert.ok(isToolbarButtonActive({ attribute: \"bold\" }))\n              moveCursor(\"left\", () => {\n                assert.ok(isToolbarButtonActive({ attribute: \"bold\" }))\n                typeCharacters(\"Z\", () => {\n                  assert.ok(isToolbarButtonActive({ attribute: \"bold\" }))\n                  assert.textAttributes([ 0, 3 ], { bold: true })\n                  assert.textAttributes([ 3, 4 ], {})\n                  assert.textAttributes([ 4, 5 ], { blockBreak: true })\n                  moveCursor(\"right\", () => {\n                    assert.ok(isToolbarButtonActive({ attribute: \"bold\" }))\n                    moveCursor(\"right\", () => {\n                      assert.notOk(isToolbarButtonActive({ attribute: \"bold\" }))\n                      done()\n                    })\n                  })\n                })\n              })\n            })\n          })\n        )\n      )\n    ))\n\n  testIf(config.input.getLevel() === 0, \"key command activates toolbar button\", (done) =>\n    typeToolbarKeyCommand({ attribute: \"bold\" }, () => {\n      assert.ok(isToolbarButtonActive({ attribute: \"bold\" }))\n      done()\n    })\n  )\n\n  test(\"backspacing newline after text\", (expectDocument) =>\n    typeCharacters(\"a\\n\", () => pressKey(\"backspace\", () => expectDocument(\"a\\n\"))))\n})\n","import {\n  assert,\n  clickToolbarButton,\n  expandSelection,\n  moveCursor,\n  test,\n  testGroup,\n  typeCharacters,\n} from \"test/test_helper\"\n\ntestGroup(\"Undo/Redo\", { template: \"editor_empty\" }, () => {\n  test(\"typing and undoing\", (done) => {\n    const first = getDocument().copy()\n    typeCharacters(\"abc\", () => {\n      assert.notOk(getDocument().isEqualTo(first))\n      clickToolbarButton({ action: \"undo\" }, () => {\n        assert.ok(getDocument().isEqualTo(first))\n        done()\n      })\n    })\n  })\n\n  test(\"typing, formatting, typing, and undoing\", (done) => {\n    const first = getDocument().copy()\n    typeCharacters(\"abc\", () => {\n      const second = getDocument().copy()\n      clickToolbarButton({ attribute: \"bold\" }, () =>\n        typeCharacters(\"def\", () => {\n          const third = getDocument().copy()\n          clickToolbarButton({ action: \"undo\" }, () => {\n            assert.ok(getDocument().isEqualTo(second))\n            clickToolbarButton({ action: \"undo\" }, () => {\n              assert.ok(getDocument().isEqualTo(first))\n              clickToolbarButton({ action: \"redo\" }, () => {\n                assert.ok(getDocument().isEqualTo(second))\n                clickToolbarButton({ action: \"redo\" }, () => {\n                  assert.ok(getDocument().isEqualTo(third))\n                  done()\n                })\n              })\n            })\n          })\n        })\n      )\n    })\n  })\n\n  test(\"formatting changes are batched by location range\", (done) =>\n    typeCharacters(\"abc\", () => {\n      const first = getDocument().copy()\n      expandSelection(\"left\", () =>\n        clickToolbarButton({ attribute: \"bold\" }, () =>\n          clickToolbarButton({ attribute: \"italic\" }, () => {\n            const second = getDocument().copy()\n            moveCursor(\"left\", () =>\n              expandSelection(\"left\", () =>\n                clickToolbarButton({ attribute: \"italic\" }, () => {\n                  const third = getDocument().copy()\n                  clickToolbarButton({ action: \"undo\" }, () => {\n                    assert.ok(getDocument().isEqualTo(second))\n                    clickToolbarButton({ action: \"undo\" }, () => {\n                      assert.ok(getDocument().isEqualTo(first))\n                      clickToolbarButton({ action: \"redo\" }, () => {\n                        assert.ok(getDocument().isEqualTo(second))\n                        clickToolbarButton({ action: \"redo\" }, () => {\n                          assert.ok(getDocument().isEqualTo(third))\n                          done()\n                        })\n                      })\n                    })\n                  })\n                })\n              )\n            )\n          })\n        )\n      )\n    }))\n\n  test(\"block formatting are undoable\", (done) => {\n    typeCharacters(\"abc\", () => {\n      const first = getDocument().copy()\n      clickToolbarButton({ attribute: \"heading1\" }, () => {\n        const second = getDocument().copy()\n        clickToolbarButton({ action: \"undo\" }, () => {\n          assert.ok(getDocument().isEqualTo(first))\n          clickToolbarButton({ action: \"redo\" }, () => {\n            assert.ok(getDocument().isEqualTo(second))\n            done()\n          })\n        })\n      })\n    })\n  })\n})\n","/* eslint-disable\n*/\nimport Trix from \"trix/trix\"\nimport config from \"trix/config\"\n\nimport \"trix/core/helpers/global\"\nimport \"test/test_helper\"\n\nimport \"test/unit\"\nimport \"test/system\"\n\nconfig.undoInterval = 0\n\nQUnit.config.hidepassed = true\nQUnit.config.testTimeout = 20000\n\ndocument.head.insertAdjacentHTML(\n  \"beforeend\",\n  `\\\n<style type=\"text/css\">\n  #trix-container { height: 150px; }\n  trix-toolbar { margin-bottom: 10px; }\n  trix-toolbar button { border: 1px solid #ccc; background: #fff; }\n  trix-toolbar button.active { background: #d3e6fd; }\n  trix-toolbar button:disabled { color: #ccc; }\n</style>\\\n`\n)\n"],"names":["attachmentSelector","attachments","preview","presentation","caption","name","size","file","attributes","default","tagName","parse","quote","nestable","heading1","terminal","breakOnReturn","group","code","text","plaintext","bulletList","bullet","listAttribute","test","element","parentNode","numberList","number","attachmentGallery","exclusive","toLowerCase","composesExistingText","navigator","userAgent","forcesObjectResizing","supportsInputEvents","InputEvent","property","prototype","attachment","attachmentCaption","attachmentCaptionEditor","attachmentMetadata","attachmentMetadataContainer","attachmentName","attachmentProgress","attachmentSize","attachmentToolbar","attachFiles","bold","bullets","byte","bytes","captionPlaceholder","indent","italic","link","numbers","outdent","redo","remove","strike","undo","unlink","url","urlPlaceholder","GB","KB","MB","PB","TB","sizes","lang","prefix","precision","formatter","base","exp","Math","floor","log","humanSize","pow","string","toFixed","withoutInsignificantZeros","replace","input","level2Enabled","getLevel","browser","inheritable","parser","style","window","getComputedStyle","fontWeight","fontStyle","href","groupTagName","matchingSelector","closest","getAttribute","frozen","backgroundColor","getDefaultHTML","undoInterval","config","blockAttributes","css","fileSize","keyNames","textAttributes","toolbar","Trix","VERSION","version","BasicObject","proxyMethod","expression","toMethod","toProperty","optional","parseProxyMethodExpression","subject","object","apply","call","arguments","match","proxyMethodExpressionPattern","Error","args","Function","RegExp","UTF16String","box","value","fromUCS2String","toString","ucs2String","ucs2decode","fromCodepoints","codepoints","ucs2encode","constructor","length","ucs2Length","offsetToUCS2Offset","offset","slice","max","offsetFromUCS2Offset","ucs2Offset","charAt","isEqualTo","toJSON","getCacheKey","hasArrayFrom","Array","from","hasStringCodePointAt","codePointAt","hasStringFromCodePoint","String","fromCodePoint","map","char","output","counter","charCodeAt","extra","push","array","characters","result","forEach","fromCharCode","join","id","TrixObject","fromJSONString","jsonString","fromJSON","JSON","hasSameConstructorAs","inspect","parts","contents","contentsForInspection","key","toJSONString","stringify","toUTF16String","arraysAreEqual","a","b","index","arrayStartsWith","spliceArray","splice","summarizeArrayChange","oldArray","newArray","added","removed","existingValues","Set","add","currentValues","has","ZERO_WIDTH_SPACE","NON_BREAKING_SPACE","OBJECT_REPLACEMENT_CHARACTER","extend","properties","html","document","documentElement","matches","handleEvent","eventName","onElement","withCallback","inPhase","preventDefault","times","selector","useCapture","handler","event","destroy","target","findClosestElementFromNode","removeEventListener","addEventListener","handleEventOnce","options","triggerEvent","bubbles","cancelable","createEvent","initEvent","dispatchEvent","elementMatchesSelector","nodeType","node","untilNode","Node","ELEMENT_NODE","findInnerElement","firstElementChild","innerElementIsActive","activeElement","elementContainsNode","findNodeFromContainerAndOffset","container","TEXT_NODE","firstChild","childNodes","item","findElementFromContainerAndOffset","findChildIndexOfNode","childIndex","previousSibling","removeNode","removeChild","walkTree","tree","onlyNodesOfType","usingFilter","expandEntityReferences","whatToShow","NodeFilter","SHOW_ELEMENT","SHOW_TEXT","SHOW_COMMENT","SHOW_ALL","createTreeWalker","makeElement","tag","createElement","editable","contenteditable","setAttribute","data","dataset","className","split","classList","textContent","concat","childNode","appendChild","blockTagNames","undefined","getBlockTagNames","nodeIsBlockContainer","nodeIsBlockStartComment","nodeProbablyIsBlockContainer","includes","nodeIsBlockStart","strict","nodeIsCommentNode","COMMENT_NODE","nodeIsCursorTarget","nodeIsTextNode","trixCursorTarget","nodeIsAttachmentElement","nodeIsEmptyTextNode","RTL_PATTERN","getDirection","dir","dirName","form","supportsDirName","FormData","error","supportsDirSelector","get","trim","allAttributeNames","blockAttributeNames","textAttributeNames","listAttributeNames","getAllAttributeNames","getTextAttributeNames","getBlockAttributeNames","getBlockConfig","attributeName","Object","keys","getTextConfig","getListAttributeNames","installDefaultCSSForTagName","defaultCSS","styleElement","insertStyleElementForTagName","nonce","getCSPNonce","head","insertBefore","getMetaElement","querySelector","testTransferData","dataTransferIsPlainText","dataTransfer","getData","body","DOMParser","parseFromString","dataTransferIsWritable","setData","keyEventIsKeyboardCommand","platform","metaKey","ctrlKey","defer","fn","setTimeout","copyObject","objectsAreEqual","normalizeRange","range","isArray","copyValue","rangeIsCollapsed","start","end","rangeValuesAreEqual","rangesAreEqual","leftRange","rightRange","leftStart","leftEnd","rightStart","rightEnd","left","right","SelectionChangeObserver","update","bind","run","selectionManagers","started","stop","registerSelectionManager","selectionManager","unregisterSelectionManager","filter","s","notifySelectionManagersOfSelectionChange","selectionDidChange","domRange","getDOMRange","domRangesAreEqual","reset","requestAnimationFrame","startContainer","startOffset","endContainer","endOffset","selectionChangeObserver","getDOMSelection","selection","getSelection","rangeCount","getRangeAt","domRangeIsPrivate","setDOMRange","removeAllRanges","addRange","nodeIsPrivate","getPrototypeOf","normalizeSpaces","normalizeNewlines","breakableWhitespacePattern","squishBreakableWhitespace","source","summarizeStringChange","oldString","newString","utf16StringDifferences","diffA","utf16StringDifference","utf16String","diffB","leftIndex","rightIndexA","rightIndexB","Hash","fromCommonAttributesOfObjects","objects","hash","getKeys","getKeysCommonToHash","values","copy","merge","unbox","toArray","isEmpty","toObject","keyToRemove","sortedKeys","sort","ObjectGroup","groupObjects","ungroupedObjects","depth","asTree","canBeGrouped","canBeGroupedWith","getObjects","getDepth","ObjectMap","find","ElementStore","elements","getKey","trixStoreKey","Operation","isPerforming","performing","hasPerformed","performed","hasSucceeded","succeeded","hasFailed","getPromise","promise","Promise","resolve","reject","perform","callback","release","cancel","ObjectView","childViews","rootView","getNodes","nodes","createNodes","cloneNode","invalidate","parentView","invalidateViewForObject","findViewForObject","findOrCreateCachedChildView","viewClass","view","getCachedViewForObject","recordChildView","createChildView","cacheViewForObject","ObjectGroupView","getAllChildViews","views","childView","findElement","findElementForObject","getViewCache","isViewCachingEnabled","viewCache","shouldCacheViews","enableViewCaching","disableViewCaching","cache","garbageCollectCachedViews","objectKeys","objectGroup","getChildViews","createContainerElement","AttachmentView","uploadProgressDelegate","attachmentPiece","piece","createContentNodes","innerElement","figure","getClassName","getHref","tabindex","hasContent","innerHTML","getContent","createCaptionElement","isPending","progressElement","class","getUploadProgress","trixMutable","createCursorTarget","figcaption","getCaption","captionConfig","getCaptionConfig","getFilename","getFormattedFilesize","nameElement","createTextNode","sizeElement","names","getType","extension","getExtension","trixAttachment","trixContentType","getContentType","trixId","trixAttributes","trixSerialize","htmlContainsTagName","type","findProgressElement","attachmentDidChangeUploadProgress","div","PreviewableAttachmentView","previewDelegate","image","src","refresh","updateAttributesForImage","getURL","previewURL","getPreviewURL","removeAttribute","serializedAttributes","width","getWidth","height","getHeight","storeKey","attachmentDidChangeAttributes","PieceView","getAttributes","textConfig","context","createAttachmentNodes","createStringNodes","isPreviewable","iterable","substring","preserveSpaces","styles","pendingElement","styleProperty","isLast","isFirst","followsWhitespace","TextView","pieces","getPieces","lastIndex","endsWithWhitespace","previousPiece","hasAttribute","BlockView","block","comment","createComment","getLastAttribute","textView","shouldAddExtraNewlineElement","isRTL","getBlockBreakPosition","DocumentView","render","sync","elementStore","setDocument","shadowElement","getBlocks","isSynced","elementsHaveEqualHTML","fragment","createDocumentFragmentForSync","lastChild","didSync","findStoredElements","createDocumentFragment","storedElement","replaceChild","querySelectorAll","otherElement","ignoreSpaces","Piece","registerType","types","pieceJSON","copyWithAttributes","getValue","copyWithAdditionalAttributes","copyWithoutAttribute","attribute","getAttributesHash","getCommonAttributes","pieceList","getPieceAtIndex","eachPiece","hasSameStringValueAsPiece","hasSameAttributesAsPiece","isBlockBreak","isSerializable","getLength","canBeConsolidatedWith","ImagePreloadOperation","Image","onload","naturalWidth","naturalHeight","onerror","Attachment","attachmentForFile","attributesForFile","setFile","filename","filesize","contentType","attachmentJSON","releaseFile","didChangeAttributes","setAttributes","newAttributes","delegate","preloadURL","previewablePattern","getFilesize","getFile","preloadFile","releasePreloadedFile","uploadProgress","setUploadProgress","preloadingURL","setPreviewURL","attachmentDidChangePreviewURL","preload","fileObjectURL","URL","createObjectURL","revokeObjectURL","operation","then","catch","AttachmentPiece","ensureAttachmentExclusivelyHasAttribute","removeProhibitedAttributes","permittedAttributes","json","toConsole","StringPiece","consolidateWith","splitAtOffset","SplittableList","indexOf","eachObject","insertObjectAtIndex","insertSplittableListAtIndex","splittableList","insertSplittableListAtPosition","position","splitObjectAtPosition","editObjectAtIndex","replaceObjectAtIndex","removeObjectAtIndex","getObjectAtIndex","getSplittableListInRange","rightIndex","splitObjectsAtRange","selectSplittableList","removeObjectsInRange","transformObjectsInRange","transform","transformedObjects","rightOuterIndex","leftInnerIndex","startOfRange","endOfRange","getObjectAtPosition","findIndexAndOffsetAtPosition","splitIndex","splitOffset","leftObject","rightObject","consolidate","pendingObject","consolidateFromIndexToIndex","startIndex","endIndex","objectsInRange","consolidatedInRange","currentPosition","nextPosition","findPositionAtIndexAndOffset","currentIndex","getEndPosition","endPosition","objectArraysAreEqual","Text","textForAttachmentWithAttributes","textForStringWithAttributes","textJSON","notEmpty","copyWithPieceList","copyUsingObjectMap","objectMap","appendText","insertTextAtPosition","removeTextAtRange","replaceTextAtRange","moveTextFromRangeToPosition","getTextAtRange","addAttributeAtRange","addAttributesAtRange","removeAttributeAtRange","setAttributesAtRange","getAttributesAtPosition","getCommonAttributesAtRange","getExpandedRangeForAttributeAtOffset","getStringAtRange","getStringAtPosition","startsWithString","endsWithString","getAttachmentPieces","getAttachments","getAttachmentAndPositionById","attachmentId","getAttachmentById","getRangeOfAttachment","attachmentAndPosition","updateAttributesForAttachment","getPieceAtPosition","toSerializableText","Block","blockJSON","applyBlockBreakToText","copyWithText","copyWithoutText","copyWithoutAttributes","mappedText","addAttribute","expandAttribute","removeLastValue","removeLastAttribute","getLastElement","getAttributeLevel","getAttributeAtLevel","level","hasAttributes","getLastNestableAttribute","getNestableAttributes","getNestingLevel","decreaseNestingLevel","increaseNestingLevel","lastIndexOf","getListItemAttributes","isListItem","isTerminalBlock","breaksOnReturn","findLineBreakInDirectionFromPosition","direction","newlineText","getTextWithoutBlockBreak","textEndsInBlockBreak","otherBlock","otherAttributes","otherAttribute","unmarkExistingInnerBlockBreaksInText","addBlockBreakToText","modified","innerPieces","lastPiece","unmarkBlockBreakPiece","blockBreakText","blockBreak","endText","Document","documentJSON","blocks","fromString","blockList","getBlockAtIndex","consolidateBlocks","copyUsingObjectsFromDocument","sourceDocument","mappedBlock","copyWithBaseBlockAttributes","replaceBlock","oldBlock","newBlock","insertDocumentAtRange","locationFromPosition","getBlockAtPosition","mergeDocumentAtRange","formattedDocument","startPosition","startLocation","baseBlockAttributes","getBaseBlockAttributes","trailingBlockAttributes","leadingBlockAttributes","blockCount","getBlockCount","firstBlock","firstText","insertTextAtRange","leftPosition","rightPosition","leftLocation","rightLocation","locationRangeFromRange","leftOffset","leftBlock","rightOffset","rightBlock","removeRightNewline","leftText","rightText","removingLeftBlock","useRightBlock","affectedBlockCount","getDocumentAtRange","movingRightward","eachBlockAtRange","textRange","eachBlock","getTextAtIndex","removeAttributeForAttachment","insertBlockBreakAtRange","applyBlockAttributeAtRange","expanded","expandRangeToLineBreaksAndSplitBlocks","blockConfig","removeLastListAttributeAtRange","exceptAttributeName","converted","convertLineBreaksToBlockBreaksInRange","removeBlockAttributesAtRange","removeLastTerminalAttributeAtRange","consolidateBlocksAtRange","lastAttributeName","endLocation","startBlock","positionFromLocation","endBlock","getTextAtPosition","getCharacterAtPosition","getEditCount","editCount","getCommonAttributesAtPosition","attributesForBlock","commonAttributes","attributesLeft","inheritableAttributes","getRangeOfCommonAttributeAtPosition","blockIndex","lastAttributeIndex","min","attachmentPieces","getLocationRangeOfAttachment","getAttachmentPieceForAttachment","findRangesForBlockAttribute","ranges","findRangesForTextAttribute","withValue","location","locationRangeFromPosition","rangeFromLocationRange","locationRange","getTexts","toSerializableDocument","DEFAULT_ALLOWED_ATTRIBUTES","DEFAULT_FORBIDDEN_PROTOCOLS","DEFAULT_FORBIDDEN_ELEMENTS","HTMLSanitizer","sanitize","sanitizer","allowedAttributes","forbiddenProtocols","forbiddenElements","createBodyElementForHTML","sanitizeElements","normalizeListElementNesting","getHTML","getBody","walker","nodesToRemove","nextNode","currentNode","elementIsRemovable","sanitizeElement","protocol","listElement","previousElement","previousElementSibling","elementIsForbidden","elementIsntSerializable","doc","implementation","createHTMLDocument","pieceForString","pieceForAttachment","blockForAttributes","parseTrixDataAttribute","getImageDimensions","dimensions","parseInt","HTMLParser","referenceElement","blockElements","processedElements","getDocument","createHiddenContainer","containerElement","nodeFilter","processNode","translateBlockElementMarginsToNewlines","removeHiddenContainer","display","nextSibling","isInsignificantTextNode","appendBlockForTextNode","processTextNode","appendBlockForElement","processElement","currentBlockElement","isBlockElement","appendStringWithAttributes","getBlockAttributes","currentBlock","appendBlockForAttributesWithElement","elementIsBlockElement","currentBlockContainsElement","parentBlockElement","findParentBlockElement","appendEmptyBlock","parentElement","elementCanDisplayPreformattedText","stringEndsWithWhitespace","leftTrimBreakableWhitespace","getTextAttributes","appendAttachmentWithAttributes","isExtraBR","appendPiece","appendStringToTextAtIndex","prependStringToTextAtIndex","unshift","configAttr","attributeInheritedFromBlock","blockElement","findBlockElementAncestors","attrConfig","reverse","ancestors","stringIsAllBreakableWhitespace","nodeEndsWithNonWhitespace","defaultMargin","getMarginOfDefaultBlockElement","margin","getMarginOfBlockElementAtIndex","top","bottom","getBlockElementMargin","whiteSpace","marginTop","marginBottom","FILTER_REJECT","FILTER_ACCEPT","unserializableElementSelector","unserializableAttributeNames","serializedAttributesAttribute","serializedAttributesSelector","blockCommentPattern","serializers","serializable","HTMLElement","el","deserializers","serializeToContentType","serializer","deserializeFromContentType","deserializer","mutableAttributeName","mutableSelector","childList","characterData","characterDataOldValue","subtree","MutationObserver","didMutate","observer","observe","disconnect","mutations","findSignificantMutations","elementDidMutate","getMutationSummary","mutation","mutationIsSignificant","nodeIsMutable","nodesModifiedByMutation","nodeIsSignificant","addedNodes","removedNodes","getTextMutationSummary","additions","deletions","getTextChangesFromCharacterData","textChanges","getTextChangesFromChildList","addition","summary","textAdded","deleted","textDeleted","getMutationsByType","textRemoved","singleBlockCommentRemoved","getTextForNodes","characterMutations","startMutation","endMutation","oldValue","summarized","Controller","FileVerificationOperation","reader","FileReader","abort","readAsArrayBuffer","InputController","mutationObserver","events","handlerFor","mutationSummary","editorWillSyncDocumentView","editorDidSyncDocumentView","requestRender","inputControllerDidRequestRender","requestReparse","inputControllerDidRequestReparse","files","operations","all","handleInput","inputControllerWillAttachFiles","responder","insertFiles","defaultPrevented","inputControllerWillHandleInput","inputControllerDidHandleInput","createLinkHTML","outerHTML","pastedFileCount","Level0InputController","resetInputSummary","setInputSummary","inputSummary","isComposing","inputControllerDidAllowUnhandledInput","mutationIsExpected","preferDocument","mutationAdditionMatchesSummary","mutationDeletionMatchesSummary","didDelete","unexpectedNewlineAddition","unexpectedNewlineDeletion","singleUnexpectedNewline","getSelectedRange","positionIsBlockBreak","textChanged","composedEmptyString","compositionInput","getEndData","getCompositionInput","CompositionInput","isEnded","deleteInDirection","serializeSelectionToDataTransfer","getSelectedDocument","canAcceptDataTransfer","Files","getPastedHTMLUsingHiddenElement","selectedRange","pageXOffset","pageYOffset","opacity","focus","setSelectedRange","keydown","didInput","keyName","keyCode","modifier","character","inputControllerDidReceiveKeyboardCommand","keypress","altKey","stringFromKeyEvent","inputControllerWillPerformTyping","insertString","selectionIsExpanded","textInput","toUpperCase","dragenter","dragstart","draggedRange","inputControllerDidStartDrag","dragover","draggingPoint","x","clientX","y","clientY","inputControllerDidReceiveDragOverPoint","dragend","inputControllerDidCancelDrag","drop","point","setLocationRangeFromPointRange","inputControllerWillMoveText","moveTextFromRange","insertDocument","cut","clipboardData","inputControllerWillCutText","paste","clipboard","testClipboardData","pasteEventIsCrippledSafariHTMLPaste","inputControllerWillPaste","insertHTML","inputControllerDidPaste","items","getAsFile","extensionForFile","insertFile","compositionstart","compositionupdate","compositionend","beforeinput","stopPropagation","backspace","delete","return","insertLineBreak","tab","canIncreaseNestingLevel","selectionIsInCursorTarget","moveCursorInDirection","control","d","h","o","updatePosition","shift","canDecreaseNestingLevel","expandSelectionInDirection","alt","meta","which","charCode","hasPasteboardFlavor","hasReadableDynamicData","mightBePasteAndMatchStyle","isExternalHTMLPaste","isExternalRichTextPaste","inputController","isSignificant","insertPlaceholder","selectPlaceholder","forgetPlaceholder","canApplyToDocument","Level2InputController","scheduledRender","composing","reparse","scheduleRender","cancelAnimationFrame","afterRender","withTargetDOMRange","toggleAttributeIfSupported","inputControllerWillPerformFormatting","toggleCurrentAttribute","activateAttributeIfSupported","setCurrentAttribute","recordUndoEntry","getTargetDOMRange","minLength","targetRanges","getTargetRanges","staticRangeToRange","withEvent","command","keyboardCommandFromKeyEvent","shiftKey","pasteEventHasFilesOnly","pasteEventHasPlainTextOnly","inputTypes","inputType","selectionContainsAttachments","dragging","pointFromEvent","dragEventHasFiles","ArrowLeft","shouldManageMovingCursorInDirection","ArrowRight","Backspace","shouldManageDeletingInDirection","Tab","deleteByComposition","deleteByCut","deleteByDrag","deleteByDragRange","deleteCompositionText","deleteContent","deleteContentBackward","deleteContentForward","deleteEntireSoftLine","deleteHardLineBackward","deleteHardLineForward","deleteSoftLineBackward","deleteSoftLineForward","deleteWordBackward","deleteWordForward","formatBackColor","formatBold","formatFontColor","formatFontName","formatIndent","formatItalic","formatJustifyCenter","formatJustifyFull","formatJustifyLeft","formatJustifyRight","formatOutdent","formatRemove","getCurrentAttributes","removeCurrentAttribute","formatSetBlockTextDirection","formatSetInlineTextDirection","formatStrikeThrough","formatSubscript","formatSuperscript","formatUnderline","historyRedo","inputControllerWillPerformRedo","historyUndo","inputControllerWillPerformUndo","insertCompositionText","insertFromComposition","insertFromDrop","insertFromPaste","insertFromYank","insertLink","insertOrderedList","insertParagraph","insertReplacementText","insertText","insertTranspose","insertUnorderedList","staticRange","createRange","setStart","setEnd","undoable","commands","do","undos","AttachmentEditorController","title","trixAction","didClickToolbar","didClickActionButton","textarea","placeholder","textareaClone","tabIndex","autoresize","scrollHeight","didInputCaption","didKeyDownCaption","didChangeCaption","didBlurCaption","editingFigcaption","editCaption","install","makeElementMutable","addToolbar","installCaptionEditor","uninstall","pop","savePendingCaption","didUninstallAttachmentEditor","pendingCaption","attachmentEditorDidRequestUpdatingAttributesForAttachment","attachmentEditorDidRequestRemovingAttributeForAttachment","action","attachmentEditorDidRequestRemovalOfAttachment","attachmentEditorDidRequestDeselectingAttachment","CompositionController","composition","didFocus","didBlur","didClickAttachment","documentView","focused","compositionControllerDidFocus","blurPromise","compositionControllerDidBlur","findAttachmentForElement","compositionControllerDidSelectAttachment","getSerializableElement","isEditingAttachment","revision","canSyncDocumentView","compositionControllerWillSyncDocumentView","compositionControllerDidSyncDocumentView","compositionControllerDidRender","rerenderViewForObject","refreshViewCache","attachmentEditor","installAttachmentEditorForAttachment","uninstallAttachmentEditor","compositionControllerWillUpdateAttachment","compositionControllerDidRequestRemovalOfAttachment","compositionControllerDidRequestDeselectingAttachment","attributeButtonSelector","actionButtonSelector","toolbarButtonSelector","dialogSelector","activeDialogSelector","dialogButtonSelector","dialogInputSelector","getInputForDialog","getAttributeName","getActionName","getDialogName","ToolbarController","didClickAttributeButton","didClickDialogButton","didKeyDownDialogInput","actions","resetDialogInputs","toolbarDidClickButton","actionName","getDialog","toggleDialog","toolbarDidInvokeAction","toolbarDidToggleAttribute","refreshAttributeButtons","dialogElement","method","dialog","hideDialog","updateActions","refreshActionButtons","eachActionButton","disabled","updateAttributes","eachAttributeButton","dialogIsVisible","applyKeyboardCommand","keyString","button","buttonKeys","buttonKeyString","dialogName","showDialog","toolbarWillShowDialog","disabledInput","select","toolbarDidShowDialog","willValidate","checkValidity","toolbarDidUpdateAttribute","toolbarDidRemoveAttribute","toolbarDidHideDialog","LineBreakInsertion","previousCharacter","nextCharacter","shouldInsertBlockBreak","shouldBreakFormattedBlock","shouldDecreaseListLevel","shouldPrependListItem","shouldRemoveLastBlockAttribute","PLACEHOLDER","Composition","currentAttributes","refreshAttachments","compositionDidChangeDocument","getSnapshot","loadSnapshot","compositionWillLoadSnapshot","setSelection","compositionDidLoadSnapshot","notifyDelegateOfInsertionAtRange","insertBlock","getCurrentTextAttributes","insertBlockBreak","insertion","decreaseListLevel","removeLastBlockAttribute","breakFormattedBlock","replaceHTML","getLocationRange","compositionShouldAcceptFile","insertAttachments","insertAttachment","attachmentText","deletingIntoPreviousBlock","selectionSpansBlocks","selectionIsCollapsed","canDecreaseBlockAttributeLevel","getBlock","decreaseBlockAttributeLevel","getExpandedRangeInDirection","getAttachmentAtRange","editAttachment","removeAttachment","stopEditingAttachment","placeholderPosition","getPosition","hasCurrentAttribute","canSetCurrentAttribute","canSetCurrentBlockAttribute","canSetCurrentTextAttribute","setBlockAttribute","setTextAttribute","notifyDelegateOfCurrentAttributesChange","removeBlockAttribute","updateCurrentAttributes","removeTextAttribute","previousBlock","getPreviousBlock","attributeLevel","ignoreLock","freezeSelection","thawSelection","hasFrozenSelection","compositionDidRequestChangingSelectionToLocationRange","getSelectionManager","setLocationRange","targetLocationRange","withTargetLocationRange","withTargetRange","createLocationRangeFromDOMRange","translateUTF16PositionFromOffset","editingAttachment","canEditAttachment","expandSelectionForEditing","expandSelectionAroundCommonAttribute","getSelectedAttachments","positionIsCursorTarget","locationIsCursorTarget","compositionDidRemoveAttachment","compositionDidAddAttachment","compositionDidEditAttachment","compositionDidChangeAttachmentPreviewURL","compositionDidStartEditingAttachment","compositionDidStopEditingAttachment","newDocument","compositionDidChangeCurrentAttributes","compositionDidPerformInsertionAtRange","utf16string","utf16position","UndoManager","undoEntries","redoEntries","description","consolidatable","previousEntry","entryHasDescriptionAndContext","undoEntry","createEntry","redoEntry","snapshot","canUndo","canRedo","entry","attachmentGalleryFilter","Filter","BLOCK_ATTRIBUTE_NAME","TEXT_ATTRIBUTE_NAME","TEXT_ATTRIBUTE_VALUE","applyBlockAttribute","findRangesOfBlocks","findRangesOfPieces","moveSelectedRangeForward","DEFAULT_FILTERS","Editor","undoManager","filters","loadDocument","loadHTML","loadJSON","getClientRectAtPosition","getClientRectAtLocationRange","activateAttribute","attributeIsActive","canActivateAttribute","deactivateAttribute","ManagedAttachment","attachmentManager","requestRemovalOfAttachment","AttachmentManager","managedAttachments","manageAttachment","attachmentIsManaged","attachmentManagerDidRequestRemovalOfAttachment","unmanageAttachment","managedAttachment","LocationMapper","findLocationFromContainerAndOffset","foundBlock","attachmentElement","findAttachmentElementParentForNode","rejectAttachmentContents","nodeLength","findContainerAndOffsetFromLocation","nodeOffset","findNodeAndOffsetFromLocation","getSignificantNodesForIndex","acceptSignificantNodes","recordingNodes","rejectEmptyTextNodes","PointMapper","createDOMRangeFromPoint","caretPositionFromPoint","offsetNode","caretRangeFromPoint","createTextRange","originalDOMRange","moveToPoint","getClientRectsForDOMRange","getClientRects","SelectionManager","didMouseDown","locationMapper","pointMapper","lockCount","currentLocationRange","lockedLocationRange","createDOMRangeFromLocationRange","updateCurrentLocationRange","pointRange","getLocationAtPoint","lock","unlock","clearSelection","collapsed","domRangeWithinElement","pauseTemporarily","resumeHandlers","paused","resume","clearTimeout","resumeTimeout","locationRangeDidChange","rangeStart","rangeEnd","snapshotsAreEqual","EditorController","editorElement","compositionController","toolbarController","toolbarElement","editor","notifyEditorElement","handlingInput","updateCurrentActions","pasting","pastedRange","attachmentLocationRange","loadingSnapshot","isFocused","requestedLocationRange","compositionRevisionWhenLocationRangeRequested","renderedCompositionRevision","runEditorFilters","isFocusedInvisibly","requestedRender","recordTypingUndoEntry","recordFormattingUndoEntry","locationRangeBeforeDrag","invokeAction","selectionFrozen","canInvokeAction","actionIsExternal","getCurrentActions","currentActions","updateInputElement","setInputElementValue","message","documentChangedSinceLastRender","notify","getUndoContext","getLocationContext","getTimeContext","Date","getTime","ownerDocument","pickFiles","TrixToolbarElement","connectedCallback","customElements","define","autofocus","makeEditable","configureContentEditable","disableObjectResizing","setDefaultParagraphSeparator","queryCommandSupported","execCommand","addAccessibilityRole","ensureAriaLabel","texts","labels","label","contains","cursorTargetStyles","TrixEditorElement","getElementById","toolbarId","inputElement","inputId","nextElementSibling","editorController","defaultValue","registerResetListener","registerClickListener","disconnectedCallback","unregisterResetListener","unregisterClickListener","resetListener","resetBubbled","clickListener","clickBubbled","this","getEditorElement","getToolbarElement","getEditorController","getEditor","getComposition","assert","QUnit","expectedLocationRange","actualLocationRange","deepEqual","expectedRange","actualRange","textIndex","documentHTMLEqual","trixDocument","equal","TEST_IMAGE_URL","fixtureTemplates","editorDefaultAriaLabel","editorEmpty","editorHtml","editorInTable","editorWithBlockStyles","editorWithBoldStyles","editorWithImage","editorWithLabels","editorWithStyledContent","editorWithToolbarAndInput","editorsWithForms","createDocument","part","cursorTargetLeft","cursorTargetRight","blockComment","removeWhitespace","fixtures","serializedHTML","attrs","serializedFigure","stringText","textAttrs","progress","content","eachFixture","details","setFixtureHTML","insertAdjacentElement","ready","testGroup","setup","teardown","template","beforeEach","afterEach","module","hooks","doneAsync","async","done","expectedDocumentValue","testIf","condition","skip","TestCompositionDelegate","TestSelectionManager","preserveSelection","setLocationRangeFromPoint","after","delay","factory","root","amd","rangy","OBJECT","FUNCTION","UNDEFINED","domRangeProperties","domRangeMethods","textRangeProperties","textRangeMethods","isHostMethod","p","t","isHostObject","isHostProperty","createMultiplePropertyTest","testFunc","props","i","areHostMethods","areHostObjects","areHostProperties","isTextRange","getElementsByTagName","arr","func","len","modules","isBrowser","util","api","initialized","supported","features","alertOnFail","alertOnWarn","preferTextRange","autoInitialize","rangyAutoInitialize","consoleLog","msg","console","alertOrLog","shouldAlert","alert","fail","reason","warn","hasOwnProperty","obj","deep","createOptions","optionsParam","defaults","arrayLike","e","addListener","eventType","listener","attachEvent","initListeners","getErrorDesc","ex","init","testRange","implementsDomRange","implementsTextRange","nodeName","errorMessage","moduleName","Module","deprecationNotice","deprecated","replacement","createAliasForDeprecatedMethod","owner","addInitListener","shimListeners","addShimListener","shim","win","createMissingNativeApi","dependencies","initializer","requiredModuleNames","requiredModule","createError","createModule","initFunc","newModule","stack","createCoreModule","RangePrototype","rangePrototype","SelectionPrototype","selectionPrototype","UNDEF","textNode","arrayContains","val","isHtmlNamespace","ns","namespaceURI","parent","getNodeIndex","getNodeLength","getCommonAncestor","node1","node2","n","isAncestorOf","ancestor","descendant","selfIsAncestor","isOrIsAncestorOf","getClosestAncestorIn","isCharacterDataNode","isTextOrCommentNode","insertAfter","precedingNode","splitDataNode","positionsToPreserve","newNode","deleteData","getWindow","defaultView","parentWindow","getIframeDocument","iframeEl","contentDocument","contentWindow","getIframeWindow","isWindow","getContentDocument","methodName","getRootContainer","comparePoints","nodeA","offsetA","nodeB","offsetB","nodeC","childA","childB","crashyTextNodes","isBrokenNode","inspectNode","idAttr","fragmentFromNodeChildren","child","getComputedStyleProperty","propName","currentStyle","createTestElement","contentEditable","bodyFirstChild","NodeIterator","_next","_current","hasNext","next","detach","createIterator","DomPosition","equals","pos","DOMException","codeName","INDEX_SIZE_ERR","HIERARCHY_REQUEST_ERR","WRONG_DOCUMENT_ERR","NO_MODIFICATION_ALLOWED_ERR","NOT_FOUND_ERR","NOT_SUPPORTED_ERR","INVALID_STATE_ERR","INVALID_NODE_TYPE_ERR","dom","isNonTextPartiallySelected","getRangeDocument","getRangeRoot","getBoundaryBeforeNode","getBoundaryAfterNode","insertNodeAtPosition","firstNodeInserted","rangesIntersect","rangeA","rangeB","touchingIsIntersecting","assertRangeValid","startComparison","endComparison","cloneSubtree","iterator","partiallySelected","frag","subIterator","isPartiallySelectedSubtree","getSubtreeIterator","iterateSubtree","rangeIterator","iteratorState","it","subRangeIterator","deleteSubtree","extractSubtree","getNodesInRange","nodeTypes","filterNodeTypes","regex","filterExists","RangeIterator","sc","ec","getName","clonePartiallySelectedTextNodes","so","eo","commonAncestorContainer","isSingleCharacterDataNode","_first","_last","current","subRange","cloneRange","collapse","Range","updateBoundaries","beforeAfterNodeTypes","rootContainerNodeTypes","readonlyNodeTypes","insertableNodeTypes","surroundNodeTypes","createAncestorFinder","getDocumentOrFragmentContainer","getReadonlyAncestor","getDocTypeNotationEntityAncestor","assertNoDocTypeNotationEntityAncestor","allowSelf","assertValidNodeType","invalidTypes","assertValidOffset","assertSameDocumentOrFragment","assertNodeNotReadOnly","assertNode","isValidOffset","isRangeValid","styleEl","htmlParsingConforms","createContextualFragment","fragmentStr","splitRangeBoundaries","startEndSame","setStartAndEnd","rangeToHtml","cloneContents","rangeProperties","s2s","s2e","e2e","e2s","n_b","n_a","n_b_a","n_i","compareBoundaryPoints","how","prefixA","prefixB","insertNode","setStartBefore","clone","canSurroundContents","boundariesInvalid","surroundContents","extractContents","hasChildNodes","selectNode","prop","textParts","compareNode","nodeIndex","comparePoint","toHtml","intersectsNode","isPointInRange","intersectsRange","intersectsOrTouchesRange","intersection","intersectionRange","union","unionRange","containsNode","allowPartial","containsNodeContents","containsRange","containsNodeText","nodeRange","textNodes","lastTextNode","collapseBefore","setEndBefore","collapseAfter","setStartAfter","getBookmark","containerNode","preSelectionRange","selectNodeContents","moveToBookmark","bookmark","charIndex","nodeStack","foundStart","nextCharIndex","rangesEqual","isValid","copyComparisonConstantsToObject","START_TO_START","START_TO_END","END_TO_END","END_TO_START","NODE_BEFORE","NODE_AFTER","NODE_BEFORE_AND_AFTER","NODE_INSIDE","copyComparisonConstants","createRangeContentRemover","remover","boundaryUpdater","boundary","returnValue","createPrototypeRange","createBeforeAfterNodeSetter","isBefore","isStart","setRangeStart","setRangeEnd","F","setBoundary","setEndAfter","deleteContents","splitBoundaries","splitBoundariesPreservingPositions","normalizeBoundaries","mergeForward","sibling","appendData","mergeBackward","insertData","normalizeStart","endNode","startNode","collapseToPoint","updateCollapsedAndCommonAncestor","r1","r2","DomRange","WrappedRange","WrappedTextRange","rangeProto","updateRangeProperties","nativeRange","updateNativeRange","startMoved","endMoved","nativeRangeDifferent","testTextNode","oppositeName","range2","createNativeRange","getTextRangeContainerElement","parentEl","duplicate","startEl","endEl","startEndContainer","textRangeIsCollapsed","compareEndPoints","getTextRangeBoundaryPosition","wholeRangeContainerElement","isCollapsed","startInfo","workingRange","canHaveHTML","boundaryPosition","nodeInfo","workingNode","comparison","workingComparisonType","previousNode","boundaryNode","childNodeCount","moveToElementText","setEndPoint","tempRange","rangeLength","moveStart","createBoundaryTextRange","boundaryParent","boundaryOffset","nodeIsDataNode","startBoundary","rangeContainerElement","rangeToTextRange","startRange","endRange","toTextRange","globalObj","f","createRangyRange","checkSelectionRanges","BOOLEAN","NUMBER","getNativeSelection","CONTROL","isDirectionBackward","WrappedSelection","getWinSelection","winParam","getDocSelection","winSelectionIsBackward","sel","backward","anchorNode","anchorOffset","focusNode","focusOffset","implementsWinGetSelection","implementsDocSelection","useDocumentSelection","isSelectionValid","nativeSel","testSelection","selectionHasAnchorAndFocus","selectionHasExtend","selectionHasRangeCount","selectionSupportsMultipleRanges","collapsedNonEditableSelectionsSupported","addRangeBackwardToNative","nativeSelection","getNativeRange","originalSelectionRangeCount","selectionHasMultipleRanges","originalSelectionRanges","originalSelectionBackward","testEl","chromeMatch","appVersion","implementsControlRange","testControlRange","createControlRange","updateAnchorAndFocusFromRange","anchorPrefix","focusPrefix","updateAnchorAndFocusFromNativeSelection","updateEmptySelection","_ranges","rangeContainsSingleElement","rangeNodes","getSingleElementFromRange","updateFromTextRange","wrappedRange","updateControlSelection","docSelection","controlRange","addRangeToControlSelection","rangeElement","newControlRange","getSelectionRangeAt","deleteProperties","detached","cachedRangySelections","actOnCachedSelection","cached","docSel","selProto","createControlSelection","addRangeBackward","previousRangeCount","clonedNativeRange","selectionIsBackward","setRanges","empty","refreshSelection","checkForChanges","oldRanges","oldAnchorNode","oldAnchorOffset","removeRangeManually","getAllRanges","removeRange","isBackward","isBackwards","rangeTexts","assertNodeInSameDocument","setSingleRange","collapseToStart","collapseToEnd","selectAllChildren","deleteFromDocument","eachRange","callMethodOnEachRange","params","results","createStartOrEndSetter","changeEachRange","rangeBookmarks","selRanges","rangeBookmark","saveRanges","restoreRanges","rangeHtmls","getNativeTextRange","rangeInspects","anchor","detachAll","Selection","docReady","loadHandler","readyState","require$$0","CHARACTER","WORD","spacesRegex","spacesMinusLineBreaksRegex","allWhiteSpaceRegex","nonLineBreakWhiteSpaceRegex","lineBreakRegex","defaultLanguage","trailingSpaceInBlockCollapses","trailingSpaceBeforeBrCollapses","trailingSpaceBeforeBlockCollapses","trailingSpaceBeforeLineBreakInPreLineCollapses","defaultTokenizer","chars","wordOptions","word","tokenRanges","createTokenRange","isWord","lastWordEnd","wordStart","wordEnd","wordRegex","exec","includeTrailingSpace","convertCharRangeToToken","tokenRange","tokenChars","token","tokenize","tokenizer","tokens","defaultCharacterOptions","includeBlockContentTrailingSpace","includeSpaceBeforeBr","includeSpaceBeforeBlock","includePreLineTrailingSpace","ignoreCharacters","normalizeIgnoredCharacters","ignoredCharacters","ignoredChars","ignoredCharsArray","char1","char2","defaultCaretCharacterOptions","defaultWordOptions","defaultFindOptions","caseSensitive","withinRange","wholeWordsOnly","wrap","characterOptions","defaultMoveOptions","defaultExpandOptions","trimStart","trimEnd","defaultWordIteratorOptions","createWordOptions","language","createNestedOptions","tableCssDisplayBlock","table","defaultDisplayValueForTag","colgroup","col","thead","tbody","tfoot","tr","td","th","getComputedDisplay","isHidden","getAncestorsAndSelf","isVisibilityHiddenTextNode","isBlockNode","getLastDescendantOrSelf","containsPositions","getAncestors","nextNodeDescendants","excludeChildren","previous","isWhitespaceNode","computedWhiteSpace","isCollapsedWhitespaceNode","isCollapsedNode","isIgnoredNode","Cache","store","set","cachedCount","uncachedCount","createCachingGetter","objProperty","NodeWrapper","session","positions","nodeProto","Position","EMPTY","NON_SPACE","UNCOLLAPSIBLE_SPACE","COLLAPSIBLE_SPACE","TRAILING_SPACE_BEFORE_BLOCK","TRAILING_SPACE_IN_BLOCK","TRAILING_SPACE_BEFORE_BR","PRE_LINE_TRAILING_SPACE_BEFORE_LINE_BREAK","TRAILING_LINE_BREAK_AFTER_BR","INCLUDED_TRAILING_LINE_BREAK_AFTER_BR","isWhitespace","isCollapsedWhitespace","isIgnored","getTextNodeInfo","spaceRegex","collapseSpaces","cssWhitespace","preLine","hasInnerText","posAfterEl","firstPosInEl","endPos","prepopulateChar","isDefinitelyNonEmpty","previousVisible","nextVisible","isRenderedBlock","brs","getTrailingSpace","getNodeWrapper","getLeadingSpace","nodeWrapper","inspectPosition","positionProto","characterType","isBr","prepopulatedChar","visibleChar","charType","finalizedChar","textChar","nodePassed","checkForTrailingSpace","checkForLeadingSpace","isCharInvariant","resolveLeadingAndTrailingSpaces","trailingSpace","isTrailingSpace","leadingSpace","isLeadingSpace","getPrecedingUncollapsedPosition","getCharacter","thisChar","returnChar","isIgnoredCharacter","cacheKey","cachedChar","collapsible","nextPos","previousPos","gotPreviousPos","getPreviousPos","nextUncollapsed","nextOffset","previousOffset","newPos","currentSession","Session","createWrapperCache","nodeProperty","wrappersByProperty","wrapper","uniqueIDSupported","initCaches","elementCache","elementsCache","uniqueID","elWrapper","textNodeCache","otherNodeCache","wrapperCache","getRangeBoundaryPosition","startSession","endSession","getSession","createCharacterIterator","startPos","finished","charPos","previousTextPos","returnPreviousTextPos","rewind","dispose","arrayIndexOf","createTokenizedTextProvider","forwardIterator","backwardIterator","consumeWord","forward","newChars","passedWordBoundary","insideWord","forwardChars","backwardChars","forwardTokensBuffer","backwardTokensBuffer","inspectBuffer","buffer","textPositions","nextEndToken","lastToken","previousStartToken","movePositionBy","unit","count","unitsMoved","currentPos","charIterator","absCount","abs","tokenizedTextProvider","createRangeCharacterIterator","itStart","itEnd","getRangeCharacters","isWholeWord","expand","findTextFromPosition","initialPos","searchTerm","isRegex","searchScopeRange","findOptions","currentChar","matchStartIndex","matchEndIndex","insideRegexMatch","handleMatch","valid","createEntryPointFunction","sessionRunning","createRangeBoundaryMover","moveOptions","boundaryIsStart","moveResult","createRangeTrimmer","trimCharCount","trimmed","moveEnd","move","startTrimmed","endTrimmed","expandOptions","moved","startTokenizedTextProvider","startToken","newStartPos","endToken","newEndPos","endTokenizedTextProvider","selectCharacters","toCharacterRange","rangeStartsBeforeNode","rangeBetween","findText","searchTermParam","wrappedAround","findResult","pasteHtml","createSelectionTrimmer","saveCharacterRanges","rangeInfos","characterRange","restoreCharacterRanges","saved","rangeInfo","innerText","createWordIterator","iteratorOptions","noMutation","createPosition","keyCodes","moveCursor","getCursorCoordinates","expandSelection","collapseSelection","selectAll","deleteSelection","px","py","rect","isIE","triggerInputEvent","pasteContent","createFile","typeCharacters","typeNextCharacter","pressKey","typeCharacterInElement","capitalize","simulateKeypress","startComposition","updateComposition","endComposition","clickElement","dragToCoordinates","coordinates","format","dragstartData","dropData","mouseDownOnElementAndMove","distance","getElementCoordinates","destination","dragSpeed","drag","insertCharacter","getBoundingClientRect","insertImageAttachment","createImageAttachment","replaceDocument","clickToolbarButton","getToolbarButton","typeToolbarKeyCommand","trixKey","clickToolbarDialogButton","isToolbarButtonActive","isToolbarButtonDisabled","typeInToolbarDialog","getToolbarDialog","isToolbarDialogActive","hidepassed","testTimeout","insertAdjacentHTML","previewableTypes","nonPreviewableTypes","createAttachment","ok","notOk","previewable","blockA","blockB","consolidatedBlock","createDocumentWithAttachment","aDoc","bDoc","parsedDocument","cases","expectedHTML","entries","getOrigin","pattern","finalHTML","unsanitized","foregroundColor","withTextAttributeConfig","color","originalConfig","hostname","port","identifier","assertions","assertion","path","findContainer","expectedLocation","actualLocation","mapper","describe","summaries","observerTest","change","getCaptionElement","withPreviewCaptionConfig","ORC","expectDocument","createImageAttachments","num","img","getFigure","closeButton","captionElement","clientHeight","testOptions","cancelingInCapturingPhase","cancelingAtTarget","eventPhase","Event","CAPTURING_PHASE","AT_TARGET","removeCharacters","initializeEventCount","eventCount","afterChangeEvent","edit","elementA","elementB","eventCountA","eventCountB","focusEventCount","blurEventCount","hasFocus","notEqual","click","expectedDocument","pressCommandBackspace","replaceText","replaceElementWithText","getElementWithText","originalElement","clonedElement","recordInputEvent","inputEvents","stopImmediatePropagation","performInputTypeUsingExecCommand","createDataTransfer","origin","pasteEvent","canvas","toBlob","defineProperty","param","inputEvent","pressShiftReturn","br","boldElement","extraBR","commentNode","pasteData","first","second","third"],"mappings":"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"}